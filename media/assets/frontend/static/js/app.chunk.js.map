{"version":3,"sources":["components/context-menu/helpers.js","../node_modules/debug/src/browser.js","../node_modules/component-emitter/index.js","../node_modules/engine.io-parser/lib/browser.js","components/dialog/edit-filetag-dialog.js","components/context-menu/globalEventListener.js","components/context-menu/context-menu.js","components/rename.js","../node_modules/reactstrap/es/Table.js","assets/icons sync //.svg$","assets/icons/monitor.svg","components/dialog/create-folder-dialog.js","components/dialog/zip-download-dialog.js","components/system-notification.js","models/group.js","components/main-side-nav.js","components/dialog/about-dialog.js","components/side-nav-footer.js","components/side-panel.js","components/main-panel.js","pages/drafts/drafts-view.js","components/draft-list-view/draft-list-item.js","components/draft-list-view/draft-list-view.js","pages/drafts/draft-content.js","models/activity.js","components/dialog/list-created-files-dialog.js","pages/dashboard/files-activities.js","pages/starred/starred.js","components/dialog/confirm-unlink-device.js","pages/linked-devices/linked-devices.js","models/shared-repo-info.js","components/dialog/perm-select.js","pages/share-admin/libraries.js","models/shared-folder-info.js","pages/share-admin/folders.js","components/dialog/share-link-permission-select.js","components/dialog/sort-options.js","components/toolbar/top-toolbar.js","pages/share-admin/share-links.js","pages/share-admin/upload-links.js","models/repo.js","components/libs-mobile-thead.js","components/icon.js","components/repo-monitored-icon.js","pages/shared-libs/shared-libs.js","pages/share-with-ocm/shared-with-ocm.js","pages/ocm-via-webdav/ocm-via-webdav.js","pages/share-with-ocm/remote-dir-topbar.js","pages/share-with-ocm/remote-dir-path.js","pages/share-with-ocm/remote-dir-content.js","pages/share-with-ocm/remote-dir-view.js","components/dialog/create-repo-dialog.js","components/toolbar/repo-view-toobar.js","components/dirent-detail/lib-details.js","components/dialog/lib-history-setting-dialog.js","components/dialog/change-repo-password-dialog.js","components/dialog/reset-encrypted-repo-password-dialog.js","components/dialog/label-repo-state-dialog.js","components/dialog/lib-sub-folder-set-user-permission-dialog.js","components/dialog/lib-sub-folder-set-group-permission-dialog.js","components/dialog/lib-sub-folder-permission-dialog.js","pages/my-libs/mylib-repo-menu.js","components/select-editor/repo-api-token-permission-editor.js","components/dialog/repo-api-token-dialog.js","components/dialog/repo-share-admin/share-links.js","components/dialog/repo-share-admin/upload-links.js","components/dialog/repo-share-admin/user-shares.js","components/dialog/repo-share-admin/group-shares.js","components/dialog/repo-share-admin-dialog.js","components/dialog/lib-old-files-auto-del-dialog.js","pages/my-libs/mylib-repo-list-item.js","pages/my-libs/mylib-repo-list-view.js","components/dialog/guide-for-new-dialog.js","pages/my-libs/my-libs.js","pages/my-libs/my-libs-deleted.js","components/dialog/share-repo-dialog.js","components/shared-repo-list-view/shared-repo-list-item.js","components/shared-repo-list-view/shared-repo-list-view.js","pages/shared-with-all/public-shared-view.js","utils/collab-server.js","components/dialog/lib-decrypt-dialog.js","components/toolbar/view-mode-toolbar.js","components/dialog/create-file-dialog.js","components/toolbar/dir-operation-toolbar.js","components/dialog/move-dirent-dialog.js","components/dialog/copy-dirent-dialog.js","components/dialog/rename-dirent.js","components/toolbar/multiple-dir-operation-toolbar.js","components/toolbar/view-file-toolbar.js","pages/lib-content-view/lib-content-toolbar.js","components/cur-dir-path/dir-path.js","components/dialog/tag-color.js","components/dialog/tag-name.js","components/dialog/list-tag-dialog.js","components/cur-dir-path/dir-tool.js","components/cur-dir-path/index.js","components/dirent-detail/detail-comments-list.js","constants/zIndexes.js","constants/keyCodes.js","constants/index.js","utils/number-precision.js","utils/extra-attributes.js","components/dialog/extra-attributes-dialog/column/column-name.js","components/dialog/extra-attributes-dialog/editor/simple-text.js","components/dialog/extra-attributes-dialog/editor/formula-formatter.js","components/dialog/extra-attributes-dialog/editor/search-input.js","components/dialog/extra-attributes-dialog/editor/single-select/single-select-editor.js","components/dialog/extra-attributes-dialog/editor/single-select/index.js","components/dialog/extra-attributes-dialog/editor/number-editor.js","components/dialog/extra-attributes-dialog/editor/date-editor.js","components/dialog/extra-attributes-dialog/editor/ctime-formatter.js","components/dialog/extra-attributes-dialog/editor/index.js","components/dialog/extra-attributes-dialog/column/index.js","components/dialog/extra-attributes-dialog/index.js","components/dirent-detail/detail-list-view.js","components/dirent-detail/dirent-details.js","components/dirent-list-view/dirent-none-view.js","components/dirent-list-view/dirent-list-item.js","components/draggable/dirents-dragged-preview.js","components/dirent-list-view/dirent-list-view.js","components/dir-view-mode/dir-list-view.js","components/dirent-grid-view/dirent-grid-item.js","components/dirent-grid-view/dirent-grid-view.js","components/dir-view-mode/dir-grid-view.js","components/dialog/rename-dialog.js","components/dir-view-mode/dir-column-nav.js","components/dir-view-mode/dir-column-file.js","components/dir-view-mode/dir-column-view.js","pages/lib-content-view/lib-content-container.js","components/file-uploader/upload-list-item.js","components/file-uploader/forbid-upload-list-item.js","components/file-uploader/upload-progress-dialog.js","components/dialog/upload-remind-dialog.js","components/file-uploader/file-uploader.js","components/dialog/delete-folder-dialog.js","pages/lib-content-view/lib-content-view.js","components/dialog/dismiss-group-dialog.js","components/dialog/create-department-repo-dialog.js","components/dialog/rename-group-dialog.js","components/dialog/transfer-group-dialog.js","components/dialog/import-members-dialog.js","components/group-members.js","components/list-and-add-group-members.js","components/dialog/manage-members-dialog.js","components/dialog/leave-group-dialog.js","pages/groups/group-view.js","components/toolbar/groups-toolbar.js","components/dialog/create-group-dialog.js","pages/groups/groups-view.js","components/toolbar/invitations-toolbar.js","components/dialog/invite-people-dialog.js","components/dialog/invitation-revoke-dialog.js","pages/invitations/invitations-view.js","components/dialog/new-wiki-dialog.js","components/dialog/wiki-select-dialog.js","components/dialog/wiki-delete-dialog.js","components/wiki-list-view/wiki-list-item.js","components/wiki-list-view/wiki-list-view.js","pages/wikis/wikis.js","components/toolbar/general-toolbar.js","components/main-content-wrapper.js","app.js","components/dropdown-menu/item-dropdown-menu.js","../node_modules/parseqs/index.js","../node_modules/component-inherit/index.js","components/dialog/image-dialog.js","../node_modules/socket.io-parser/index.js","../node_modules/engine.io-client/lib/transports/xmlhttprequest.browser.js","../node_modules/engine.io-client/lib/globalThis.browser.js","../node_modules/engine.io-client/lib/transport.js","components/dialog/create-tag-dialog.js","components/dialog/share-admin-link.js","components/dialog/list-taggedfiles-dialog.js","models/draft.js","components/dialog/list-repo-drafts-dialog.js","components/dialog/readme-dialog.js","components/repo-info-bar.js","../node_modules/parseuri/index.js","../node_modules/socket.io-parser/node_modules/isarray/index.js","../node_modules/socket.io-parser/is-buffer.js","../node_modules/socket.io-client/lib/manager.js","../node_modules/engine.io-client/lib/transports/index.js","../node_modules/engine.io-client/lib/transports/polling.js","../node_modules/has-binary2/index.js","../node_modules/yeast/index.js","../node_modules/indexof/index.js","../node_modules/socket.io-client/lib/socket.js","../node_modules/socket.io-client/lib/on.js","../node_modules/component-bind/index.js","../node_modules/socket.io-client/lib/index.js","components/wiki-markdown-viewer.js","components/dialog/copy-move-dirent-progress-dialog.js","components/tree-view/tree-node-view.js","components/tree-view/tree-view.js","../node_modules/socket.io-client/lib/url.js","../node_modules/debug/src/debug.js","../node_modules/ms/index.js","../node_modules/socket.io-parser/binary.js","../node_modules/engine.io-client/lib/index.js","../node_modules/engine.io-client/lib/socket.js","../node_modules/has-cors/index.js","../node_modules/engine.io-client/lib/transports/polling-xhr.js","../node_modules/engine.io-parser/lib/keys.js","../node_modules/has-binary2/node_modules/isarray/index.js","../node_modules/arraybuffer.slice/index.js","../node_modules/after/index.js","../node_modules/engine.io-parser/lib/utf8.js","../node_modules/base64-arraybuffer/lib/base64-arraybuffer.js","../node_modules/blob/index.js","../node_modules/engine.io-client/lib/transports/polling-jsonp.js","../node_modules/engine.io-client/lib/transports/websocket.js","../node_modules/to-array/index.js","../node_modules/backo2/index.js","components/context-menu/actions.js","../node_modules/svg-baker-runtime/browser-symbol.js","../node_modules/svg-sprite-loader/runtime/browser-sprite.build.js"],"names":["callIfExists","func","args","hasOwnProp","obj","prop","Object","prototype","hasOwnProperty","call","uniqueId","Math","random","toString","substring","store","canUseDOM","Boolean","window","document","createElement","load","r","exports","storage","debug","e","process","DEBUG","module","require","log","console","Function","apply","arguments","formatArgs","useColors","this","namespace","humanize","diff","c","color","splice","index","lastC","replace","match","save","namespaces","removeItem","type","navigator","userAgent","toLowerCase","documentElement","style","WebkitAppearance","firebug","exception","table","parseInt","RegExp","$1","chrome","local","localStorage","localstorage","colors","formatters","j","v","JSON","stringify","err","message","enable","Emitter","key","mixin","on","addEventListener","event","fn","_callbacks","push","once","off","removeListener","removeAllListeners","removeEventListener","length","cb","callbacks","i","emit","Array","len","slice","listeners","hasListeners","base64encoder","keys","hasBinary","sliceBuffer","after","utf8","ArrayBuffer","isAndroid","test","isPhantomJS","dontSendBlobs","protocol","packets","open","close","ping","pong","upgrade","noop","packetslist","data","Blob","map","ary","each","done","result","next","eachWithIndex","el","error","msg","encodePacket","packet","supportsBinary","utf8encode","callback","undefined","buffer","encodeBase64Packet","contentArray","Uint8Array","resultBuffer","byteLength","encodeArrayBuffer","fr","FileReader","onload","readAsArrayBuffer","encodeBlobAsArrayBuffer","blob","encodeBlob","base64","encodeBase64Object","encoded","encode","String","strict","b64data","b64","split","readAsDataURL","fromCharCode","typed","basic","btoa","decodePacket","binaryType","utf8decode","charAt","decodeBase64Packet","substr","decode","tryDecode","Number","rest","encodePayload","isBinary","encodePayloadAsBlob","encodePayloadAsArrayBuffer","doneCallback","setLengthHeader","results","join","decodePayload","decodePayloadAsBinary","n","l","chr","encodedPackets","totalLength","reduce","acc","p","resultArray","bufferIndex","forEach","isString","ab","view","charCodeAt","lenStr","binaryIdentifier","size","lengthAry","bufferTail","buffers","tailArray","msgLength","total","TagItem","props","onMouseEnter","setState","isTagHighlighted","onMouseLeave","getRepoTagIdList","fileTagList","fileTag","repo_tag_id","onEditFileTag","repoID","repoTag","filePath","repoTagIdList","indexOf","id","seafileAPI","addFileTag","then","onFileTagChanged","catch","errMessage","Utils","getErrorMsg","toaster","danger","deleteFileTag","state","isTagSelected","className","onClick","backgroundColor","name","React","Component","TagList","getRepoTagList","listRepoTags","res","repotagList","repo_tags","item","RepoTag","toggle","toggleCancel","gettext","href","createNewTag","EditFileTagDialog","isCreateRepoTagShow","isListRepoTagShow","onRepoTagCreated","repoTagID","isOpen","autoFocus","onClose","handleShowEvent","show","handleHideEvent","hide","register","showCallback","hideCallback","unregister","MENU_SHOW","MENU_HIDE","ContextMenu","registerHandlers","handleOutsideClick","handleHide","handleKeyNavigation","unregisterHandlers","handleShow","detail","position","x","y","currentObject","menuList","isVisible","onShowMenu","onHideMenu","menu","contains","target","hideMenu","handleMouseLeave","preventDefault","hideOnLeave","handleContextMenu","keyCode","getMenuPosition","menuStyles","top","left","innerWidth","innerHeight","rect","getBoundingClientRect","height","width","getRTLMenuPosition","onMenuItemClick","stopPropagation","operation","getEventData","onContextMenu","listenId","listener","wrapper","requestAnimationFrame","setTimeout","rtl","opacity","pointerEvents","role","display","ref","menuItem","value","Rename","onChange","nativeEvent","stopImmediatePropagation","onKeyPress","onRenameConfirm","newName","trim","validateInput","isValid","onRenameCancel","refs","renameInput","focus","hasSuffix","endIndex","lastIndexOf","setSelectionRange","propTypes","PropTypes","string","cssModule","object","bordered","bool","borderless","striped","dark","hover","responsive","oneOfType","tag","tagPropType","responsiveTag","innerRef","Table","Tag","ResponsiveTag","attributes","_objectWithoutPropertiesLoose","classes","mapToCssModules","classNames","_extends","responsiveClassName","defaultProps","webpackContext","req","webpackContextResolve","__webpack_require__","o","Error","code","resolve","symbol","add","CreateForder","handleChange","isSubmitBtnActive","childName","handleSubmit","checkDuplicatedName","HTMLescape","path","parentPath","onAddFolder","handleKeyPress","addFolderCancel","for","disabled","interval","ZipDownloadDialog","queryZipProgress","zipToken","failed","clearInterval","isLoading","errorMsg","failed_reason","zipProgress","zipped","toFixed","toggleDialog","location","fileServerRoot","cancelZipTask","token","getShareLinkDirentsZipTask","getShareLinkZipTask","zipDownload","setInterval","Content","SystemNotification","isClosed","cookieEnabled","date","Date","cookies","cookie","infoIDExist","newInfoID","curNoteID","setTime","getTime","toGMTString","siteRoot","curNoteMsg","dangerouslySetInnerHTML","__html","title","Group","owner","admins","avatar_url","created_at","parent_group_id","wiki_enabled","repos","group_quota","group_quota_usage","MainSideNav","grpsExtend","groupsExtended","loadGroups","shExtend","sharedExtended","_this","listGroups","groupList","groupsHeight","listHeight","groupItems","sort","a","b","tabItemClick","param","uploader","isUploadProgressDialogShow","totalProgress","confirm","onDTableClick","url","dtableWebServer","getActiveClass","tab","currentTab","closeSideBar","adminHeight","to","linksNavItem","canGenerateShareLink","canGenerateUploadLink","canAddRepo","customNavItems","idx","link","desc","icon","showActivity","isDocs","isPro","isDBSqlite3","canViewOrg","renderSharedGroups","enableOCM","enableOCMViaWebdav","draftCounts","canInvitePeople","renderSharedAdmin","renderCustomNavItems","AboutDialog","renderExternalAboutLinks","additionalAboutDialogLinks","lang","onCloseAboutDialog","aboutDialogCustomHtml","Modal","ModalBody","src","mediaUrl","logoPath","logoHeight","logoWidth","siteTitle","alt","seafileVersion","getFullYear","SideNavFooter","onAboutDialogToggle","isAboutDialogShow","renderExternalAppLinks","additionalAppBottomLinks","sideNavFooterCustomHtml","rel","enableTC","SidePanel","isSidePanelClosed","onCloseSidePanel","MainPanel","children","DraftsView","moment","locale","DraftListItem","isItemFreezed","isMenuIconShow","highlight","onDropdownToggleClick","toggleOperationMenu","isItemMenuShow","onFreezedItem","onUnfreezedItem","onDeleteHandler","draft","onPublishHandler","origin_repo_id","draft_file_path","fileName","getFileName","draftUrl","libraryUrl","encodeURIComponent","repo_name","localTime","utc","updated_at","toDate","fromNow","iconUrl","getFileIconUrl","Dropdown","DropdownToggle","DropdownMenu","DropdownItem","status","DraftListView","drafts","draftList","DraftContent","draft_name","editUtilities","deleteDraft","updateDraftsList","msg_s","success","publishDraft","getDrafts","isLoadingDraft","Acticity","json","repo_id","obj_type","commit_id","author_email","author_name","author_contact_email","time","op_type","createdFilesCount","createdFilesList","days","old_repo_name","includes","old_path","old_name","endsWith","draft_id","ListCreatedFileDialog","activity","ModalHeader","fileURL","encodePath","serviceURL","fileLink","ModalFooter","Button","bind","app","config","FileActivitiesContent","isDesktop","items","isLoadingMore","desktopThead","mobileThead","ActivityItem","onListCreatedFilesToggle","isListCreatedFiles","op","details","moreDetails","userProfileURL","libURL","libLink","smallLibLink","fileCount","firstLine","isDraft","filePathLink","dirURL","dirLink","dirPathLink","isShowDate","lastEventTime","isSame","colSpan","format","datetime","is","FilesActivities","mergePublishEvents","events","curPathList","oldPathList","actuallyEvents","mergeFileCreateEvents","multiFilesActivity","isFulfilCondition","Activity","handleScroll","hasMore","clientHeight","scrollHeight","scrollTop","getMore","isFirstLoading","currentPage","avatarSize","listActivities","onScroll","loading","emptyTip","TableBody","getThumbnails","filter","imageCheck","obj_name","enableVideoThumbnail","videoCheck","repo_encrypted","getThumbnail","curItem","createThumbnail","encoded_thumbnail_src","listItems","item_icon_url","getDefaultLibIconUrl","is_dir","getFolderIconUrl","encoded_path","thumbnail_url","dirent_view_url","mtime_relative","mtime","Item","toggleOpMenu","isOpMenuOpen","handleMouseOver","showOpIcon","handleMouseOut","unstar","unstarItem","unstarred","visitItem","navigate","opClasses","linkUrl","desktopItem","onMouseOver","onMouseOut","onFocus","mobileItem","Starred","listStarredItems","starred_item_list","ConfirmUnlinkDevice","executeOperation","isChecked","onInputChange","checked","FormGroup","check","Label","Input","isOpIconShown","isConfirmUnlinkDialogOpen","handleClick","is_desktop_client","unlinkDevice","wipeDevice","platform","device_id","unlinked","device_name","last_login_ip","last_accessed","Fragment","LinkedDevices","listLinkedDevices","SharedRepoInfo","share_type","share_permission","share_permission_name","modifier_name","modifier_email","modifier_contact_email","encrypted","is_admin","user_name","user_email","contact_email","group_id","group_name","PermSelect","listCustomPermissions","customPermissions","permission_list","CustomPermission","switchOption","currentOption","changePerm","translatePermission","permission","sharePerms","find","translateExplanation","explanation","sharePermsExplanation","description","getPermissions","newPermissions","permissions","currentPerm","maxHeight","overflow","htmlFor","sortByName","sortOrder","sortItems","sortBy","sortIcon","togglePermSelectDialog","isPermSelectDialogOpen","options","user","updateRepoSharePerm","unshare","unshareRepo","unshared","onEditPermission","isShowPermEditor","showAdmin","assign","shareTo","getLibIconUrl","iconTitle","getLibIconTitle","repoUrl","shareType","startsWith","isTextMode","isEditing","isEditIconShow","currentPermission","onPermissionChanged","ShareAdminLibraries","sortRepos","listSharedRepos","SharedFolderInfo","folder_name","unshareFolder","postData","updateFolderSharePerm","is_readonly","getFolderIconTitle","folderUrl","ShareAdminFolders","_sortItems","comparator","compareTwoWord","listSharedFolders","ShareLinkPermissionSelect","getShareLinkPermissionObject","text","SortOptions","sortOptions","TopToolbar","onShowSidePanel","onSearchedClick","searchPlaceholder","sortByTime","columnWidths","onRemoveLink","updatePermissionOptions","itemType","repo_folder_permission","permissionOptions","getShareLinkPermissionList","can_edit","getShareLinkPermissionStr","toggleLinkDialog","isLinkDialogOpen","viewLink","removeLink","renderExpiration","expire_date","expire_time","is_expired","permissionDetails","updateShareLink","objUrl","deletedTip","obj_id","view_cnt","ShareAdminShareLinks","deleteShareLink","uploadItem","toggleSortOptionsDialog","isSortOptionsDialogOpen","toggleCleanInvalidShareLinksDialog","isCleanInvalidShareLinksDialogOpen","cleanInvalidShareLinks","newItems","listUserShareLinks","ShareLink","confirmBtnText","ShareAdminUploadLinks","deleteUploadLink","toggleCleanInvalidUploadLinksDialog","isCleanInvalidUploadLinksDialogOpen","cleanInvalidUploadLinks","listUserUploadLinks","UploadLink","Repo","size_original","bytesToSize","owner_name","owner_email","owner_contact_email","last_modified","starred","monitored","storage_name","LibsMobileThead","requireContext","Icon","iconClass","xlinkHref","RepoMonitoredIcon","UncontrolledTooltip","placement","freezeItem","freezed","sortBySize","onMonitorRepo","share","isShowSharedDialog","leaveShare","request","leaveShareRepo","leaveShareGroupOwnedRepo","toggleShareDialog","onToggleStarRepo","repoName","isStarred","starItem","visitRepo","repoURL","watchFileChanges","repo","monitorRepo","unwatchFileChanges","unMonitorRepo","icon_url","icon_title","iconVisibility","shareIconClassName","leaveShareIconClassName","shareRepoUrl","enableMonitorRepo","tabIndex","itemName","itemPath","repoEncrypted","enableDirPrivateShare","userPerm","isAdmin","SharedLibraries","listRepos","repoList","provider_id","from_user","from_server_url","ctime","SharedWithOCM","deleteOCMShareReceived","listOCMSharesReceived","ocm_share_received_list","OCMViaWebdav","getAllReceivedShares","server","get","shareID","received_share_list","delete","openFolder","parent_dir","onPathClick","currentPath","downloadFile","downloadUrl","shared_by","DirPath","turnPathToLink","pathList","nodePath","pathElem","MainPanelTopbar","isAdminPanel","onTabNavClick","DirentItem","dirent","downloadDirent","getDirentIcon","is_file","DirContent","direntList","deleteDirent","fromSystemRepo","Dirent","DirView","loadDirentList","direntPath","joinPath","providerID","listOCMRepoDir","dirent_list","user_perm","history","replaceState","getOCMRepoDownloadURL","openFileInput","fileInput","current","click","onFileInputChange","files","file","getOCMRepoUploadURL","formData","FormData","append","axios","post","fileObj","newDirent","dirs","isNewFolderDialogOpen","createRef","CreateRepoDialog","handleRepoNameChange","handlePassword1Change","password1","handlePassword2Change","password2","validateInputParams","repoData","prepareRepoData","libraryType","onCreateRepo","onCreateToggle","onPermissionChange","handleStorageInputChange","selectedItem","storage_id","handlelibraryTemplatesInputChange","library_template","onEncrypted","encrypt","password","passwd","storages","libraryTemplates","repoPasswordMinLength","Form","defaultValue","label","enableEncryptedLibrary","autoComplete","Alert","RepoViewToolbar","isCreateRepoDialogShow","toggleMore","onDropdownToggleKeyDown","visitDeletedviaKey","onKeyDown","LibDetail","getFileCounts","getRepoInfo","file_count","currentRepo","nextProps","smallIconUrl","bigIconUrl","closeDetails","LibHistorySetting","submit","keepDays","autoHistory","expireDays","setRepoHistoryLimit","keep_days","errorInfo","num","setLimitDays","allHistory","noHistory","getRepoHistoryLimit","enableRepoHistorySetting","ChangeRepoPasswordDialog","handleOldPasswordInputChange","oldPassword","handleNewPasswordInputChange","newPassword","handleNewPasswordAgainInputChange","newPasswordAgain","formSubmit","submitBtnDisabled","changeEncryptedRepoPassword","centered","generateDialogTitle","action","method","ResetEncryptedRepoPasswordDialog","showLoading","showSuccess","showError","resetAndSendEncryptedRepoPassword","response","error_msg","contactEmail","LabelRepoStateDialog","handleInputChange","inputValue","labels","addNewRepoLabels","formErrorMsg","existingLabels","getAllRepoSnapshotLabels","isMulti","placeholder","UserItem","isOperationShow","deleteUserFolderPermission","onChangeUserFolderPerm","folder_path","showPath","LibSubFolderSetUserPermissionDialog","handleUserSelectChange","option","selectedUsers","setPermission","addUserFolderPerm","folderPath","users","email","isDepartmentRepo","addDepartmentRepoUserFolderPerm","userFolderPermItems","concat","userSelect","clearSelect","deleteUserFolderPermItem","deleteDepartmentRepoUserFolderPerm","deleteUserFolderPerm","deletedItem","userEmail","updateDepartmentRepoUserFolderPerm","updateUserFolderPerm","onSetSubFolder","toggleFileChooser","showFileChooser","toggleSubFolder","handleFileChooserSubmit","onRepoItemClick","listDepartmentRepoUserFolderPerm","listUserFolderPerm","mode","onDirentItemClick","thead","onSelectChange","InputGroup","InputGroupAddon","addonType","GroupItem","deleteGroupPermissionItem","onChangeGroupPermission","NoOptionsMessage","innerProps","margin","textAlign","LibSubFolderSerGroupPermissionDialog","handleSelectChange","selectedOption","loadOptions","shareableGroups","listGroupPermissionItems","listDepartmentRepoGroupFolderPerm","listGroupFolderPerm","groupPermissionItems","addGroupFolderPerm","addDepartmentRepoGroupFolderPerm","deleteDepartmentRepoGroupFolderPerm","deleteGroupFolderPerm","updateDepartmentRepoGroupFolderPerm","updateGroupFolderPerm","updateGroupPermission","groupID","sharedItem","sharedItemGroupID","maxMenuHeight","inputId","components","LibSubFolderPermissionDialog","activeTab","renderContent","Nav","pills","NavItem","NavLink","TabContent","TabPane","tabId","folderName","maxWidth","MylibRepoMenu","onMenuItemKeyDown","dataset","generatorOperations","showResetPasswordMenuItem","enableResetEncryptedRepoPassword","isEmailConfigured","operations","folderPermEnabled","monitorOp","isPC","enableRepoSnapshotLabel","enableRepoAutoDel","translateOperations","translateResult","divider","unshift","RepoAPITokenPermissionEditor","onHideSelect","onSelectHandler","optionTranslation","captureMenuScroll","APITokenItem","onDeleteAPIToken","deleteAPIToken","app_name","onUpdateAPIToken","updateAPIToken","onCopyAPIToken","api_token","copy","RepoAPITokenDialog","listAPITokens","listRepoAPITokens","apiTokenList","repo_api_tokens","handleError","appName","addAPIToken","addRepoAPIToken","deleteRepoAPIToken","updateRepoAPIToken","duration","renderAPITokenList","minHeight","onRepoAPITokenToggle","onDeleteLink","deleteItem","creator_name","RepoShareAdminShareLinks","deleteRepoShareLink","linkItem","listRepoShareLinks","forDialog","RepoShareAdminUploadLinks","deleteRepoUploadLink","listRepoUploadLinks","updateShareToUserItemPermission","share_to","isRepoOwner","getFolderName","share_to_name","permission_name","RepoShareAdminUserShares","deleteShareToUserItem","shareItem","getAllRepoFolderShareInfo","share_info_list","username","updateShareToGroupItemPermission","RepoShareAdminGroupShares","deleteShareToGroupItem","RepoShareAdminDialog","getInitialActiveTab","enableShareLink","enableUploadLink","onTabKeyDown","LibOldFilesAutoDelDialog","daysNeedTobeSet","isAutoDel","autoDelDays","setRepoOldFilesAutoDelDays","updateRadioCheck","getRepoOldFilesAutoDelDays","auto_delete_days","MylibRepoListItem","isOpIconShow","onShareToggle","onDeleteToggle","onRenameToggle","onTransferToggle","onHistorySettingToggle","onChangePasswordToggle","onResetPasswordToggle","onFolderPermissionToggle","onLabelToggle","onAPITokenToggle","toggleRepoShareAdminDialog","toggleOldFilesAutoDelDialog","isRenaming","onRepoClick","isShareDialogShow","isDeleteDialogShow","isTransferDialogShow","isHistorySettingDialogShow","isChangePasswordDialogShow","isResetPasswordDialogShow","isLabelRepoStateDialogOpen","isFolderPermissionDialogShow","isAPITokenDialogShow","isRepoShareAdminDialogOpen","isOldFilesAutoDelDialogOpen","renameRepo","onRenameRepo","onTransferRepo","transferRepo","onDeleteRepo","deleteRepo","isRepoDeleted","renderPCUI","renderMobileUI","query","MylibRepoListView","sortRepoList","renderRepoListView","showStorageBackend","GuideForNewDialog","siteName","MyLibraries","createMineRepo","newRepo","repo_size","isShowDetails","onRepoDetails","toggleGuideForNewDialog","pageOptions","guideEnabled","isGuideForNewDialogOpen","MyLibsDeleted","refreshDeletedRepoList","deletedRepoList","listDeletedRepo","trashReposExpireDays","DeletedRepoTable","deletedRepos","DeletedRepoItem","hideRestoreMenu","restoreDeletedRepo","del_time","ShareRepoListItem","onRepoSelect","padding","sharePermission","ShareRepoDialog","selectedRepoList","onRepoSelectedHandler","onCloseDialog","onShareRepoDialogClose","SharedRepoListItem","clickOperationMenuToggle","getRepoComputeParams","libPath","onItemRenameToggle","onItemFolderPermissionToggle","onItemDetails","onItemShare","onItemUnshare","onItemRename","isFolderPermissionDialogOpen","onItemDeleteToggle","onItemDelete","currentGroup","deleteGroupOwnedLibrary","translateMenuItem","isStaff","isDeparementOnwerGroupMember","generatorMobileMenu","isSystemStaff","generatorPCMenu","shareOperation","unshareOperation","deleteOperation","isGroupOwnedRepo","SharedRepoListView","getSortMetaData","some","isShowTableThread","hasNextPage","PublicSharedView","createPublicRepo","addRepoItem","onCreateRepoToggle","selectOwnedRepoToPublic","isExist","repoIndex","newRepoList","onAddRepoToggle","isCreateMenuShow","onSelectRepoToggle","isSelectRepoDialpgShow","canAddPublicRepo","socket","seafileCollabServer","io","collabServer","LibDecryptDialog","setRepoDecryptPassword","onLibDecryptDialog","ViewModeToolbar","switchViewMode","currentMode","baseClass","isCustomPermission","CreateFile","isDuplicated","isMarkdownDraft","isSdocDraft","onAddFile","handleCheck","pos","fileType","onAfterModelOpened","newInput","toggleMarkSdocDraft","onOpened","DirOperationToolbar","toggleMobileOpMenu","isMobileOpMenuOpen","hideOperationMenu","isUploadMenuShow","targetRect","bottom","operationMenuStyle","onUploadClick","onUploadFile","onUploadFolder","onCreateClick","onShareClick","onCreateFolderToggle","isCreateFolderDialogShow","onCreateFileToggle","isCreateFileDialogShow","onCreateMarkdownToggle","onCreateExcelToggle","onCreatePPTToggle","onCreateWordToggle","onCreateSeaDocToggle","dirPath","getUserPermission","customPermission","canUpload","canCreate","upload","create","content","showShareBtn","isSupportUploadFolder","enableSeadoc","MoveDirent","isMutipleOperation","moveItems","moveItem","selectedPath","selectedDirentList","direntPaths","moveDirentPath","flag","onItemsMove","onItemMove","onCancelMove","nextState","CopyDirent","copyItems","copyItem","copyDirentPath","onItemsCopy","onItemCopy","onCancelCopy","onRename","changeState","MultipleDirOperationToolbar","onMoveToggle","isMoveDialogShow","onCopyToggle","isCopyDialogShow","onItemsDelete","onItemsDownload","isDir","URLDecorator","getUrl","useGoFileserver","isZipDialogOpen","closeZipDialog","checkDuplicatedNameInList","onPermissionItem","showLibContentViewDialogs","isPermissionDialogOpen","onMarkAsDraft","getDirentPath","sdocMarkAsDraft","updateDirent","onUnmarkAsDraft","sdocUnmarkAsDraft","onStartRevise","sdocStartRevise","file_path","onCommentItem","showDirentDetail","getDirentMenuList","currentRepoInfo","opList","getDirentOperationList","list","showShareDialog","isRenameDialogOpen","listFileTags","lockFile","unlockFile","onHistory","onAccessLog","onOpenViaClient","lockfile","is_locked","unSelectDirent","unlockfile","showEditFileTagDialog","file_tags","file_tag_id","onMenuFileTagChanged","onFilesTagChanged","multiFileTagList","canDelete","canDownload","canCopy","canModify","download","modify","ButtonGroup","tagName","toggleClass","getMenuList","ViewFileToolbar","onEditClick","onNewDraft","createDraft","onDraftHover","isDraftMessageShow","isMoreMenuShow","onEditFileTagToggle","isEditTagDialogShow","onHistoryClick","historyUrl","filePermission","hasDraft","Tooltip","fileTags","LibContentToolbar","isViewFile","onSideNavMenuClick","isLibView","isDirentSelected","tabName","tagTitle","pathPrefix","showName","zIndex","TagColor","togglePopover","isPopoverOpen","selectTagColor","newColor","updateRepoTag","tagColor","colorList","Popover","PopoverBody","defaultChecked","TagName","toggleMode","input","updateTagName","onInputKeyDown","onInputBlur","onBlur","TagListItem","deleteTag","onDeleteTag","ListTagDialog","onListTagCancel","onCreateRepoTag","targetTagID","deleteRepoTag","repo_tag","DirTool","onShowListRepoTag","isRepoTagDialogShow","isListTaggedFileShow","onCloseRepoTagDialog","onCreateRepoTagToggle","onListTaggedFileToggle","currentTag","isFile","isMarkdownFile","trashUrl","updateUsedRepoTags","CurDirPath","onDeleteRepoTag","DetailCommentList","handleCommentChange","comment","listComments","commentsList","comments","addComment","postComment","onSubmit","addParticipant","toBeAddedParticipant","addFileParticipants","onParticipantsChange","resolveComment","updateComment","deleteComment","editComment","commentID","newComment","listRepoRelatedUsers","user_list","relatedUsers","checkParticipant","fileParticipantList","participant","renderUserSuggestion","entry","search","highlightedDisplay","focused","oldTime","defaultStyle","trigger","displayTransform","renderSuggestion","defaultMentionStyle","onAdd","appendSpaceOnAdd","CommentItem","convertComment","mdFile","processor","html","toggleDropDownMenu","dropdownOpen","toggleEditComment","editable","onCommentClick","nodeName","preNode","previousSibling","nodeType","nodeValue","renderInfo","clos","rows","warp","resolved","EXTRA_ATTRIBUTES_DIALOG_MODAL","KeyCodes","Backspace","Tab","Enter","Shift","Ctrl","Alt","PauseBreak","CapsLock","Escape","Esc","Space","PageUp","PageDown","End","Home","LeftArrow","UpArrow","RightArrow","DownArrow","Insert","Delete","d","f","g","h","k","m","q","s","t","u","w","z","LeftWindowKey","RightWindowKey","SelectKey","NumPad0","NumPad1","NumPad2","NumPad3","NumPad4","NumPad5","NumPad6","NumPad7","NumPad8","NumPad9","Multiply","Add","Subtract","DecimalPoint","Divide","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F12","NumLock","ScrollLock","SemiColon","EqualSign","Comma","Dash","Period","ForwardSlash","GraveAccent","OpenBracket","BackSlash","CloseBracket","SingleQuote","ChineseInputMethod","DIALOG_MAX_HEIGHT","EXTRA_ATTRIBUTES_COLUMN_TYPE","EXTRA_ATTRIBUTES_NOT_DISPLAY_COLUMN_KEY","EXTRA_ATTRIBUTES_NOT_DISPLAY_COLUMN_NAME","FORMULA_RESULT_TYPE","DEFAULT_NUMBER_FORMAT","ERROR","ERROR_DIV_ZERO","ERROR_NAME","ERROR_NULL","ERROR_VALUE","GETTING_DATA","DURATION_FORMATS_MAP","DURATION_FORMATS","DURATION_ZERO_DISPLAY","DURATION_DECIMAL_DIGITS","strip","precision","parseFloat","toPrecision","digitLength","eSplit","float2Fixed","dLen","pow","checkBoundary","_boundaryCheckingState","MAX_SAFE_INTEGER","MIN_SAFE_INTEGER","warn","times","num1","num2","others","num1Changed","num2Changed","baseNum","leftValue","divide","plus","max","minus","round","ratio","base","enableBoundaryChecking","NP","getValidColumns","columns","editableColumns","isEmptyFile","isArray","column","validColumn","canEdit","getDateDisplayString","validValue","formatValueList","formatValuesList","formatDateList","getSelectColumnOptions","getDurationDisplayString","duration_format","findIndex","includeDecimal","positiveValue","abs","decimalDigits","_getMathRoundedDuration","decimalParts","decimalPartsLen","decimal","decimalSuffix","_getDurationDecimalSuffix","displayString","hours","minutes","seconds","_separatorMap","_toThousands","isCurrency","formatData","thousands","enable_precision","decimalString","thousandsString","numericString","removeZerosFromEnd","_getDecimalDigits","isMinus","integer","trunc","decimalValue","padEnd","counter","isInteger","valueArr","digitsLength","getNumberDisplayString","isNaN","Infinity","currency_symbol_position","currency_symbol","formatStringToNumber","numberString","newData","getFloatNumber","ColumnName","Col","md","SimpleText","blurInput","inputRef","blur","onCommit","updated","onCut","onPaste","currentTarget","selectionStart","selectionEnd","row","nextValue","FormulaFormatter","result_type","SearchInput","onCompositionStart","isInputtingChinese","timer","clearTimeout","wait","searchValue","onCompositionEnd","setFocus","isSelectAllText","activeElement","txtLength","classnames","SingleSelectEditor","getCascadeColumnValue","cascade_column_key","cascade_settings","cascadeColumnValue","cascadeSetting","onUpdateState","onChangeSearch","searchVal","val","filteredOptions","onSelectOption","optionID","highlightIndex","maxItemNum","itemHeight","editorKey","UncontrolledPopover","hideArrow","isSelected","textColor","SingleSelect","updateState","isShowSingleSelect","currentOptionID","optionStyle","optionName","NumberEditor","initValue","isMac","reg","replaceNumberNotAllowInput","setInputRef","DateEditor","CtimeFormatter","CONFIG","Column","Editor","ExtraAttributesDialog","startAnimation","animationEnd","dom","modalRef","firstChild","getDialogStyle","marginLeft","marginRight","marginTop","transition","getFormatUpdateData","update","updateData","getData","getFileExtendedProperties","metadata","editable_columns","_id","createData","newFileExtendedProperties","newRow","updateFileExtendedProperties","onHotKey","isHotkey","onToggle","getInitStyle","renderColumns","direntDetail","direntDetailId","repeat","zIndexes","contentClassName","modalClassName","wrapClassName","fade","DetailListView","getDirentPosition","repoInfo","isEditFileTagShow","toggleExtraAttributesDialog","isShowExtraAttributes","direntType","DirentDetail","loadDirentInfo","updateDetailView","getDirName","listDir","folderDirent","getFileInfo","listParticipants","getDirInfo","listFileParticipants","participant_list","renderNavItem","showTab","active","renderHeader","direntName","onItemDetailsClose","renderDetailBody","direntDetailPanelTab","isImg","isVideo","tabs","DirentNodeView","onCreateNewFile","isDirentListLoading","DirentListItem","canDrag","isDragTipShow","unfreezeItem","onItemSelected","onItemStarred","onDirentClick","onItemClick","isRenameing","canPreview","showImagePopup","closeSharedDialog","onMobileMenuItemClick","getAttribute","onItemDownload","onItemMoveToggle","onItemCopyToggle","onUnlockItem","onLockItem","openRevisionsPage","onConvertWithONLYOFFICE","lockName","generateRevisionsURL","onlyofficeConvert","onTagTooltipToggle","isShowTagTooltip","destRepo","onItemDragStart","isIEBrower","dataTransfer","effectAllowed","onShowDirentsDraggablePreview","setDragImage","empty_content","selectedList","nodeRootPath","nodeDirent","nodeParentPath","setData","drag_icon","dragStartItemData","onItemDragEnter","isDropTipshow","onItemDragOver","dropEffect","onItemDragLeave","onItemDragDrop","parse","draggedItem","dropItemData","onItemMouseDown","onItemContextMenu","renderItemOperation","isHasPermissionToShare","isHandleContextMenuEvent","getDirentItemMenuList","preview","activeDirent","dirHref","fileHref","is_sdoc_revision","revision_id","toolTipID","MD5","trClass","lockedInfo","lock_owner_name","draggable","onDragStart","onDragEnter","onDragOver","onDragLeave","onDrop","onMouseDown","isSdocFile","is_sdoc_draft","unix","DirentsDraggedPreview","handleDragEnd","element","onHideDirentsDraggablePreview","handleDragOver","clientY","clientX","handleDrop","inlineStyle","DirentListView","prepareImageItem","useThumbnail","isGIF","thumbnailSizeForOriginal","fullDirentList","imageItems","isImagePopupOpen","imageIndex","moveToPrevImage","imageItemsLength","prevState","moveToNextImage","closeImagePopup","selectedDirentNames","isProgressDialogShow","downloadItems","onCloseZipDownloadDialog","button","handleContextClick","touches","pageX","pageY","posX","posY","showMenuConfig","showMenu","onContainerClick","onContainerMouseDown","onContainerContextMenu","TextTranslation","NEW_FOLDER","NEW_FILE","persist","MOVE","COPY","DOWNLOAD","DELETE","onContainerMenuItemClick","onDirentsMenuItemClick","onThreadMouseDown","onThreadContextMenu","setDirentItemRef","direntItems","getDirentIndex","isContextmenu","onTableDragEnter","canDrop","enteredCounter","isListDropTipShow","onTableDragOver","onTableDragLeave","tableDrop","isShowDirentsDraggablePreview","clickedDirent","currentItemRef","onAllItemSelected","isAllItemSelected","dragStartPosition","DirListView","isRepoInfoBarShow","readmeMarkdown","usedRepoTags","DirentGridItem","isGridSelected","onGridItemClick","onItemLinkClick","onGridItemDragStart","onGridItemDragEnter","isGridDropTipShow","onGridItemDragOver","onGridItemDragLeave","onGridItemDragDrop","onGridItemMouseDown","getFileUrl","fileUrlArr","onGridItemContextMenu","fileUrl","gridClass","gridIcon","DirentGridView","isRenameDialogShow","onGridContainerMouseDown","gridContainerClick","isDirentDetailShow","onGridContainerContextMenu","isGridItemFreezed","DirGridView","onRenameNode","currentNode","DirColumnNav","onNodeClick","node","opNode","showNodeImagePopup","onAddFolderToggle","onAddFileToggle","onDeleteNode","onOpenFile","root","treeData","isAddFileDialogShow","isAddFolderDialogShow","onAddFolderNode","newUrl","parentNode","imageNames","isNodeImagePopupOpen","imageNodeItems","prepareImageItems","prepareItem","closeNodeImagePopup","stopTreeScrollPropagation","isNodeMenuShow","flex","navRate","select","inResizing","isTreeDataLoading","onNodeExpanded","onNodeCollapse","onUnFreezedItem","onAddFileNode","DirColumnFile","goDraftPage","hash","isFileLoadedErr","isTOCShow","isFileLoading","markdownContent","lastModified","latestContributor","onLinkClick","DirColumnView","onResizeMouseUp","setCookie","onResizeMouseDown","containerWidth","viewModeContainer","clientWidth","onResizeMouseMove","sizeNavWidth","rate","getCookie","cookiename","onResizeMove","mainFlex","onMouseMove","onMouseUp","LibContentContainer","onMainNavBarClick","closeDirentDetail","currentDirent","checkCurrentDirent","deletedDirent","onItemsScroll","onListContainerScroll","updateDetail","pathExist","isAllDirentSelected","onAllDirentSelected","UPLOAD_UPLOADING","UPLOAD_ERROR","UPLOAD_ISSAVING","UPLOAD_UPLOADED","UploadListItem","onUploadCancel","resumableFile","onUploadRetry","formatFileSize","uploadState","remainingTime","isSaved","progress","newFileName","isUploading","formatTime","ForbidUploadListItem","maxUploadFileSize","UploadProgressDialog","onCancelAllUploading","onMinimizeUpload","isMinimized","onCloseUpload","onCloseUploadDialog","uploadBitrate","formatBitRate","uploadedMessage","uploadingMessage","uploadingOptions","uploadedOptions","allFilesUploaded","retryFileList","onUploadRetryAll","forbidUploadFileList","uploadFileList","UploadRemindDialog","cancelFileUpload","replaceRepetitionFile","uploadFile","currentResumableFile","FileUploader","componentWillUnmount","onbeforeunload","dragAndDrop","resumable","disableDropOnDocument","bindCallbackHandler","minFileSizeErrorCallback","fileTypeErrorCallback","maxFilesErrorCallback","opts","maxFileSizeErrorCallback","bindEventHandler","onChunkingComplete","onFileAdded","filesAddedComplete","onFileProgress","onFileUploadSuccess","onProgress","onComplete","onPause","onFileRetry","onFileError","onError","onBeforeCancel","onCancel","errorCount","maxFiles","maxNumberOfFilesForFileupload","relativePath","relative_path","hasRepetition","isUploadRemindDialogShow","setUploadFileList","getFileServerUploadLink","resumableUpload","isUploadLinkLoaded","getFileUploadedBytes","uploadedBytes","blockSize","resumableUploadFileBlockSize","offset","floor","markChunksCompleted","registerGlobalVariable","getBitrate","uniqueIdentifier","lastSize","loaded","now","timestamp","timeDiff","bitrateInterval","currentTime","dir_name","notifiedFolders","getFileServerErrorMessage","errorMessage","setHeaders","chunkSize","getOpt","fileSize","startByte","endByte","min","encodeURI","setQuery","generateUniqueIdentifier","webkitRelativePath","onFileUpload","uploadInput","removeAttribute","onFolderUpload","setAttribute","uploadingItem","cancel","retryUploadFile","bootstrap","firedRetry","resumableObj","getUpdateLink","pop","Resumablejs","filetypes","maxFileSize","testMethod","testChunks","headers","withCredentials","simultaneousUploads","fileParameterName","forceChunkSize","maxChunkRetries","minFileSize","assignBrowse","enableDropOnDocument","DeleteFolderDialog","deleteFolder","sharedToUserCount","sharedToGroupCount","getRepoFolderShareInfo","opTarget","alert_message","LibContentView","toggleDirentDetail","onpopstate","showFile","onRepoUpdateEvent","lastModifyTime","dirID","updateColumnMarkdownData","dirMetaData","usedRepoTag","updateReadmeMarkdown","last_modifier_name","is_draft","has_draft","getFileDownloadLink","getFileContent","draftID","loadDirData","watchRepo","getRepoDraftCounts","draft_counts","loadSidePanel","showDir","tree","addResponseListToNode","loadNodeAndParentsByPath","isSessionExpired","resetShowLength","isNeedUpdateHistoryState","pushState","FileTag","errMsg","markdownItem","sortDirents","dir_id","itemsShowLength","curItemPath","updateMoveCopyTreeNode","nodeChildrenNames","clone","getNodeByPath","addNodeToTree","cancelCopyMoveDirent","taskId","asyncCopyMoveTaskId","cancelCopyMoveOperation","currentMoveItemName","currentMoveItemPath","onMoveProgressDialogToggle","asyncOperationProgress","isCopyMoveProgressDialogShow","onMoveItems","destDirentPath","asyncOperatedFilesLength","asyncOperationType","dirNames","getSelectedDirentNames","getSelectedDirentPaths","moveDir","task_id","getAsyncCopyMoveProgress","deleteTreeNodes","moveDirents","getMoveSuccessMessage","getMoveFailedMessage","onCopyItems","copyDir","getCopySuccessfulMessage","getCopyFailedMessage","restoreDeletedDirents","commitID","paths","closeAll","restoreDirents","addDirent","onDeleteItems","deleteMutipleDirents","deleteDirents","successTipWithUndo","createDir","createFile","getPaths","isWeChat","resetSelected","expandNode","isInternalMarkdownLink","getPathFromInternalMarkdownLink","isInternalDirLink","getPathFromInternalDirLink","onMainPanelItemRename","renameItem","onMainPanelItemDelete","onRenameTreeNode","onDeleteTreeNode","renameDir","renameItemAjaxCallback","renameFile","toggleDeleteFolderDialog","isDeleteFolderDialogOpen","folderToDelete","deleteDir","deleteItemAjaxCallback","onMoveItem","moveToDirentPath","dirName","deleteTreeNode","moveDirent","onCopyItem","copyToDirentPath","loadTreeNodeByPath","showColumnMarkdownFile","onDirentSelected","direntObject","createDirent","renameDirent","newDirentPath","isChildPath","oldName","isAncestorPath","newPath","renameAncestorPath","direntNames","recaculateSelectedStateAfterDirentDeleted","paramKey","paramValue","newDirentList","isLoaded","isExpanded","with_parents","parentDir","isLoadFailed","onTreeNodeClick","collapseNode","treeHelper","onTreeNodeCollapse","onTreeNodeExpanded","createTreeNode","addNodeToParentByPath","renameTreeNode","renameNodeByPath","deleteNodeByPath","deleteNodeListByPaths","moveTreeNode","moveToPath","moveToRepo","moveNodeByPath","copyTreeNode","copyToPath","copyNodeByPath","nodeList","TreeNode","addChildren","selectedDirent","names","libNeedDecrypt","onToolbarFileTagChanged","deletedTagID","buildTree","oldonpopstate","decodeURIComponent","repoRes","RepoInfo","permissionID","getCustomPermission","permissionRes","custom_permission","lib_need_decrypt","unwatchRepo","queryAsyncOperationProgress","successful","deleteFile","isVirtual","is_virtual","direntItemsList","onMenuClick","DismissGroupDialog","dismissGroup","that","deleteGroup","onGroupChanged","showDismissGroupDialog","toggleDismissGroupDialog","RenameGroupDialog","handleGroupNameChange","newGroupName","renameGroup","loadGroup","toggleRenameGroupDialog","handleKeyDown","currentGroupName","showRenameGroupDialog","TransferGroupDialog","transferGroup","toggleTransferGroupDialog","ImportMembersDialog","toggleImportMembersDialog","fileInputRef","importMembersInBatch","groupImportMembersExtraMsg","GroupMembers","groupMembers","changeMember","deleteMember","isOwner","toggleItemFreezed","Member","onChangeUserRole","setGroupAdmin","deleteGroupMember","translateRole","roles","deleteAuthority","scope","currentRole","onRoleChanged","PureComponent","ManageMembersDialog","listGroupMembers","page","perPage","members","addGroupMember","emails","addGroupMembers","newMembers","isFreezed","targetMember","searchMembers","keyword","membersFound","clearSearch","onSearchInputFocus","searchActive","onSearchInputBlur","InputGroupText","toggleManageMembersDialog","LeaveGroupDialog","leaveGroup","quitGroup","toggleLeaveGroupDialog","GroupView","getGroup","getEmptyTip","isDepartmentGroup","loadRepos","listGroupRepos","groupOwnerType","groupId","createGroupOwnedLibrary","createGroupRepo","group","unshareRepoToGroup","renameGroupOwnedLibrary","toggleGroupDropdown","showGroupDropdown","showTransferGroupDialog","showImportMembersDialog","notify","importGroupMembersViaFile","showManageMembersDialog","isLeaveGroupDialogOpen","toggleGroupMembersPopover","showGroupMembersPopover","isShowSettingIcon","useRate","GroupsToolbar","canAddGroup","toggleAddGroupModal","CreateGroupDialog","handleGroupChange","groupName","handleSubmitGroup","createGroup","onCreateGroup","showAddGroupModal","RepoListViewPanel","isShowRepoOwner","GroupsView","InvitationsToolbar","toggleInvitePeopleDialog","InvitePeopleDialog","handleSubmitInvite","emailsArray","isSubmitting","invitePeople","successMsg","accepter","onInvitePeople","failedMsg","InvitationRevokeDialog","onRevokeInvitation","revokeInvitation","invitation","deleteInvitation","deleted","revokeItem","toggleRevokeDialog","isRevokeDialogOpen","invite_time","accept_time","invitationsList","InvitationsView","invitationsArray","isInvitePeopleDialogOpen","listInvitations","NewWikiDialog","inputNewName","addWiki","WikiSelectDialog","WikiDeleteDialog","WikiListItem","isShowDeleteDialog","onDeleteCancel","deleteWiki","wiki","fileIconUrl","deleteIcon","owner_nickname","WikiListView","wikis","renameWiki","Wikis","getWikis","listWikis","clickMenuToggle","onMenuToggle","isShowAddWikiMenu","onSelectToggle","isShowSelectDialog","isShowCreateDialog","slug","canPublishRepo","GeneralToolbar","MainContentWrapper","WrapperedComponent","FilesActivitiesWrapper","DraftsViewWrapper","StarredWrapper","LinkedDevicesWrapper","SharedLibrariesWrapper","SharedWithOCMWrapper","ShareWithOCM","OCMViaWebdavWrapper","ShareAdminLibrariesWrapper","ShareAdminFoldersWrapper","App","navigateClientUrlToLib","splitUrlArray","repalce","listDrafts","dirViewPanels","generatorPrefix","navTab1","navTab2","navTab","getTabShowName","toggleSidePanel","home","ReactDom","render","getElementById","ItemDropdownMenu","listenerId","str","qs","qry","pairs","pair","constructor","ImageDialog","imageTitle","mainSrc","nextSrc","prevSrc","onCloseRequest","onMovePrevRequest","onMoveNextRequest","imagePadding","imageLoadErrorMessage","prevLabel","nextLabel","closeLabel","zoomInLabel","zoomOutLabel","binary","isBuf","Encoder","types","CONNECT","DISCONNECT","EVENT","ACK","BINARY_EVENT","BINARY_ACK","Decoder","ERROR_PACKET","encodeAsString","attachments","nsp","payload","tryStringify","reconstructor","BinaryReconstructor","reconPack","writeEncoding","bloblessData","deconstruction","deconstructPacket","pack","removeBlobs","encodeAsBinary","start","buf","tryParse","decodeString","takeBinaryData","destroy","finishedReconstruction","binData","reconstructPacket","hasCORS","globalThis","xdomain","xscheme","enablesXDR","XMLHttpRequest","XDomainRequest","self","parser","Transport","hostname","port","secure","timestampParam","timestampRequests","readyState","agent","pfx","passphrase","cert","ca","ciphers","rejectUnauthorized","forceNode","isReactNative","extraHeaders","localAddress","doOpen","doClose","send","write","onOpen","writable","onData","onPacket","CreateTagDialog","selectTagcolor","createTag","createRepoTag","newTag","canSave","ShareAdminLink","copyToClipboard","ListTaggedFilesDialog","TaggedFile","parent_path","filename","onDeleteTaggedFile","taggedFile","fileTagID","getTaggedFiles","file_deleted","shareLinkToken","getShareLinkTaggedFiles","listTaggedFiles","taggedFileList","tagged_files","enableFileDownload","Draft","created","createdStr","ownerNickname","originRepoID","draftFilePath","ListRepoDraftsDialog","onDeleteDraftItem","editorUtilities","listRepoDrafts","draftItem","DraftItem","ReadmeDialog","readmeContent","showTOC","scriptSource","RepoInfoBar","onListTaggedFiles","toggleDrafts","showRepoDrafts","toggleReadme","showReadmeDialog","re","parts","exec","uri","source","host","authority","ipv6uri","pathNames","regx","queryKey","$0","$2","arr","withNativeBuffer","Buffer","isBuffer","withNativeArrayBuffer","isView","eio","Socket","Backoff","has","Manager","nsps","subs","reconnection","reconnectionAttempts","reconnectionDelay","reconnectionDelayMax","randomizationFactor","backoff","jitter","timeout","connecting","lastPing","encoding","packetBuffer","_parser","encoder","decoder","autoConnect","emitAll","updateSocketIds","generateId","engine","_reconnection","_reconnectionAttempts","_reconnectionDelay","setMin","_randomizationFactor","setJitter","_reconnectionDelayMax","setMax","_timeout","maybeReconnectOnOpen","reconnecting","attempts","reconnect","connect","skipReconnect","openSub","onopen","errorSub","cleanup","onping","onpong","ondata","ondecoded","onerror","onConnecting","processPacketQueue","shift","subsLength","disconnect","reset","onclose","reason","delay","onreconnect","attempt","XHR","JSONP","websocket","polling","xd","xs","jsonp","isSSL","forceJSONP","parseqs","inherit","yeast","Polling","hasXHR2","responseType","forceBase64","poll","pause","doPoll","callbackfn","doWrite","schema","sid","withNativeBlob","withNativeFile","File","toJSON","prev","alphabet","seed","decoded","toArray","hasBin","connect_error","connect_timeout","reconnect_attempt","reconnect_failed","reconnect_error","ids","acks","receiveBuffer","sendBuffer","connected","disconnected","flags","subEvents","ev","compress","onpacket","sameNamespace","rootNamespaceError","onconnect","onevent","onack","ondisconnect","ack","sent","emitBuffered","lookup","cache","managers","parsed","forceNew","multiplex","contentClass","WikiMarkdownViewer","getTitlesInfo","titlesInfo","titleDom","querySelectorAll","updateTabTitle","headingList","offsetTop","onScrollHandler","activeTitleIndex","contentScrollTop","markdownContainer","titlesLength","changeInlineNode","imagePath","isPublicWiki","index2","originalPath","pathNormalize","isInternalFileLink","p1","p2","p3","sharedToken","modifyValueBeforeRender","changeMarkdownNodes","renderMarkdown","isWiki","links","MarkdownViewer","CopyMoveDirentProgressDialog","progressStyle","lineHeight","TreeNodeView","isShowOperationMenu","isHighlight","onLoadToggle","onNodeDragStart","onNodeDragEnter","isNodeDropShow","onNodeDragMove","onNodeDragLeave","onNodeDrop","getNodeTypeAndIcon","suffix","calculateMenuList","RENAME","OPEN_VIA_CLIENT","renderChildren","paddingLeft","hasChildren","hlClass","TreeView","dragStartNodeData","isTreeViewDropTipShow","dropNodeData","parseuri","loc","createDebug","prevTime","enabled","curr","ms","coerce","formatter","logFn","selectColor","init","instances","stack","disable","skips","instance","plural","ceil","long","fmtShort","_deconstructPacket","_placeholder","_reconstructPacket","packetData","pendingBlobs","_removeBlobs","curKey","containingObject","fileReader","transports","transportOptions","writeBuffer","prevBufferLen","policyPort","rememberUpgrade","onlyBinaryUpgrades","perMessageDeflate","threshold","product","upgrades","pingInterval","pingTimeout","pingIntervalTimer","pingTimeoutTimer","priorWebsocketSuccess","createTransport","EIO","transport","requestTimeout","protocols","setTransport","onDrain","probe","onTransportOpen","upgradeLosesBinary","upgrading","flush","freezeTransport","onTransportClose","onupgrade","onHandshake","setPing","filterUpgrades","onHeartbeat","sendPacket","waitForUpgrade","cleanupAndClose","filteredUpgrades","empty","Request","async","sendXhr","pollXhr","xhr","setDisableHeaderCheck","setRequestHeader","hasXDR","onLoad","responseText","onreadystatechange","contentType","getResponseHeader","requestsCount","requests","onSuccess","fromError","abort","attachEvent","unloadHandler","arraybuffer","end","bytes","abv","ii","count","err_cb","bail","proxy","byteArray","byteCount","byteIndex","stringFromCharCode","ucs2decode","extra","output","checkScalarValue","codePoint","toUpperCase","createByte","encodeCodePoint","readContinuationByte","continuationByte","decodeSymbol","byte1","version","codePoints","byteString","tmp","array","ucs2encode","chars","encoded1","encoded2","encoded3","encoded4","bufferLength","BlobBuilder","WebKitBlobBuilder","MSBlobBuilder","MozBlobBuilder","blobSupported","blobSupportsArrayBufferView","blobBuilderSupported","getBlob","mapArrayBufferViews","chunk","set","byteOffset","BlobBuilderConstructor","bb","part","BlobConstructor","JSONPPolling","rNewline","rEscapedNewline","___eio","script","removeChild","form","iframe","insertAt","getElementsByTagName","insertBefore","head","body","appendChild","area","iframeId","complete","initIframe","BrowserWebSocket","NodeWebSocket","WebSocket","MozWebSocket","WebSocketImpl","WS","usingBrowserWebSocket","ws","supports","addEventListeners","onmessage","factor","rand","deviation","dispatchGlobalEvent","eventName","CustomEvent","createEvent","initCustomEvent","dispatchEvent","factory","SpriteSymbol","viewBox","createCommonjsModule","this$1","global","deepmerge","isMergeableObject","emptyTarget","cloneIfNecessary","optionsArgument","defaultArrayMerge","destination","mergeObject","arrayMerge","all","namespaces_1","default","svg","xlink","defaultAttrs","wrapInSvgString","attrsRendered","attrs","attr","objectToAttrsString","BrowserSpriteSymbol","SpriteSymbol$$1","__proto__","prototypeAccessors","isMounted","createFromExistingNode","outerHTML","unmount","mount","mountTarget","querySelector","hasImportNode","importNode","doc","DOMParser","parseFromString","childNodes","defineProperties","svg$1","xlink$1","defaultConfig","Sprite","symbols","existing","remove","stringifiedSymbols","defaultConfig$1","autoConfigure","mountTo","syncUrlsWithBaseTag","listenLocationChangeEvent","locationChangeEvent","locationChangeAngularEmitter","usagesToUpdate","moveGradientsOutsideSymbol","arrayFrom","arrayLike","browser","getUrlWithoutFragment","angular","run","$rootScope","$on","oldUrl","selector","xLinkNS","xLinkAttrName","specialUrlCharsPattern","sprite","attList","attSelector","updateUrls","references","replaceWith","startsWithEncoded","replaceWithEncoded","nodes","matcher","arrayfied","matched","selectAttributes","localName","setAttributeNS","updateReferences","Events","BrowserSprite","Sprite$$1","cfg","emitter","handler","evt","_emitter","_autoConfigure","baseUrl","handleLocationChange","_handleLocationChange","spriteNode","symbolNode","updatedNodes","textContent","evalStylesIEWorkaround","isNewSymbol","attach","prepend","mountNode","usages","ready$1","fns","hack","doScroll","domContentLoaded","definition","spriteNodeId","spriteGlobalVarName","loadSprite"],"mappings":"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","file":"static/js/app.chunk.js","sourcesContent":["export function callIfExists(func, ...args) {\n  return (typeof func === 'function') && func(...args);\n}\n\nexport function hasOwnProp(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nexport function uniqueId() {\n  return Math.random().toString(36).substring(7);\n}\n\nexport const store = {};\n\nexport const canUseDOM = Boolean(\n  typeof window !== 'undefined' && window.document && window.document.createElement\n);\n","/**\n * This is the web browser implementation of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = require('./debug');\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = 'undefined' != typeof chrome\n               && 'undefined' != typeof chrome.storage\n                  ? chrome.storage.local\n                  : localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n  '#0000CC', '#0000FF', '#0033CC', '#0033FF', '#0066CC', '#0066FF', '#0099CC',\n  '#0099FF', '#00CC00', '#00CC33', '#00CC66', '#00CC99', '#00CCCC', '#00CCFF',\n  '#3300CC', '#3300FF', '#3333CC', '#3333FF', '#3366CC', '#3366FF', '#3399CC',\n  '#3399FF', '#33CC00', '#33CC33', '#33CC66', '#33CC99', '#33CCCC', '#33CCFF',\n  '#6600CC', '#6600FF', '#6633CC', '#6633FF', '#66CC00', '#66CC33', '#9900CC',\n  '#9900FF', '#9933CC', '#9933FF', '#99CC00', '#99CC33', '#CC0000', '#CC0033',\n  '#CC0066', '#CC0099', '#CC00CC', '#CC00FF', '#CC3300', '#CC3333', '#CC3366',\n  '#CC3399', '#CC33CC', '#CC33FF', '#CC6600', '#CC6633', '#CC9900', '#CC9933',\n  '#CCCC00', '#CCCC33', '#FF0000', '#FF0033', '#FF0066', '#FF0099', '#FF00CC',\n  '#FF00FF', '#FF3300', '#FF3333', '#FF3366', '#FF3399', '#FF33CC', '#FF33FF',\n  '#FF6600', '#FF6633', '#FF9900', '#FF9933', '#FFCC00', '#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\nfunction useColors() {\n  // NB: In an Electron preload script, document will be defined but not fully\n  // initialized. Since we know we're in Chrome, we'll just detect this case\n  // explicitly\n  if (typeof window !== 'undefined' && window.process && window.process.type === 'renderer') {\n    return true;\n  }\n\n  // Internet Explorer and Edge do not support colors.\n  if (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n    return false;\n  }\n\n  // is webkit? http://stackoverflow.com/a/16459606/376773\n  // document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n  return (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n    // is firebug? http://stackoverflow.com/a/398120/376773\n    (typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n    // is firefox >= v31?\n    // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n    // double check webkit in userAgent just in case we are in a worker\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nexports.formatters.j = function(v) {\n  try {\n    return JSON.stringify(v);\n  } catch (err) {\n    return '[UnexpectedJSONParseError]: ' + err.message;\n  }\n};\n\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n  var useColors = this.useColors;\n\n  args[0] = (useColors ? '%c' : '')\n    + this.namespace\n    + (useColors ? ' %c' : ' ')\n    + args[0]\n    + (useColors ? '%c ' : ' ')\n    + '+' + exports.humanize(this.diff);\n\n  if (!useColors) return;\n\n  var c = 'color: ' + this.color;\n  args.splice(1, 0, c, 'color: inherit')\n\n  // the final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-zA-Z%]/g, function(match) {\n    if ('%%' === match) return;\n    index++;\n    if ('%c' === match) {\n      // we only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n\n  args.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\n\nfunction log() {\n  // this hackery is required for IE8/9, where\n  // the `console.log` function doesn't have 'apply'\n  return 'object' === typeof console\n    && console.log\n    && Function.prototype.apply.call(console.log, console, arguments);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\nfunction save(namespaces) {\n  try {\n    if (null == namespaces) {\n      exports.storage.removeItem('debug');\n    } else {\n      exports.storage.debug = namespaces;\n    }\n  } catch(e) {}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\nfunction load() {\n  var r;\n  try {\n    r = exports.storage.debug;\n  } catch(e) {}\n\n  // If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n  if (!r && typeof process !== 'undefined' && 'env' in process) {\n    r = process.env.DEBUG;\n  }\n\n  return r;\n}\n\n/**\n * Enable namespaces listed in `localStorage.debug` initially.\n */\n\nexports.enable(load());\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n  try {\n    return window.localStorage;\n  } catch (e) {}\n}\n","\r\n/**\r\n * Expose `Emitter`.\r\n */\r\n\r\nif (typeof module !== 'undefined') {\r\n  module.exports = Emitter;\r\n}\r\n\r\n/**\r\n * Initialize a new `Emitter`.\r\n *\r\n * @api public\r\n */\r\n\r\nfunction Emitter(obj) {\r\n  if (obj) return mixin(obj);\r\n};\r\n\r\n/**\r\n * Mixin the emitter properties.\r\n *\r\n * @param {Object} obj\r\n * @return {Object}\r\n * @api private\r\n */\r\n\r\nfunction mixin(obj) {\r\n  for (var key in Emitter.prototype) {\r\n    obj[key] = Emitter.prototype[key];\r\n  }\r\n  return obj;\r\n}\r\n\r\n/**\r\n * Listen on the given `event` with `fn`.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.on =\r\nEmitter.prototype.addEventListener = function(event, fn){\r\n  this._callbacks = this._callbacks || {};\r\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\r\n    .push(fn);\r\n  return this;\r\n};\r\n\r\n/**\r\n * Adds an `event` listener that will be invoked a single\r\n * time then automatically removed.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.once = function(event, fn){\r\n  function on() {\r\n    this.off(event, on);\r\n    fn.apply(this, arguments);\r\n  }\r\n\r\n  on.fn = fn;\r\n  this.on(event, on);\r\n  return this;\r\n};\r\n\r\n/**\r\n * Remove the given callback for `event` or all\r\n * registered callbacks.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.off =\r\nEmitter.prototype.removeListener =\r\nEmitter.prototype.removeAllListeners =\r\nEmitter.prototype.removeEventListener = function(event, fn){\r\n  this._callbacks = this._callbacks || {};\r\n\r\n  // all\r\n  if (0 == arguments.length) {\r\n    this._callbacks = {};\r\n    return this;\r\n  }\r\n\r\n  // specific event\r\n  var callbacks = this._callbacks['$' + event];\r\n  if (!callbacks) return this;\r\n\r\n  // remove all handlers\r\n  if (1 == arguments.length) {\r\n    delete this._callbacks['$' + event];\r\n    return this;\r\n  }\r\n\r\n  // remove specific handler\r\n  var cb;\r\n  for (var i = 0; i < callbacks.length; i++) {\r\n    cb = callbacks[i];\r\n    if (cb === fn || cb.fn === fn) {\r\n      callbacks.splice(i, 1);\r\n      break;\r\n    }\r\n  }\r\n\r\n  // Remove event specific arrays for event types that no\r\n  // one is subscribed for to avoid memory leak.\r\n  if (callbacks.length === 0) {\r\n    delete this._callbacks['$' + event];\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\n/**\r\n * Emit `event` with the given args.\r\n *\r\n * @param {String} event\r\n * @param {Mixed} ...\r\n * @return {Emitter}\r\n */\r\n\r\nEmitter.prototype.emit = function(event){\r\n  this._callbacks = this._callbacks || {};\r\n\r\n  var args = new Array(arguments.length - 1)\r\n    , callbacks = this._callbacks['$' + event];\r\n\r\n  for (var i = 1; i < arguments.length; i++) {\r\n    args[i - 1] = arguments[i];\r\n  }\r\n\r\n  if (callbacks) {\r\n    callbacks = callbacks.slice(0);\r\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\r\n      callbacks[i].apply(this, args);\r\n    }\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\n/**\r\n * Return array of callbacks for `event`.\r\n *\r\n * @param {String} event\r\n * @return {Array}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.listeners = function(event){\r\n  this._callbacks = this._callbacks || {};\r\n  return this._callbacks['$' + event] || [];\r\n};\r\n\r\n/**\r\n * Check if this emitter has `event` handlers.\r\n *\r\n * @param {String} event\r\n * @return {Boolean}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.hasListeners = function(event){\r\n  return !! this.listeners(event).length;\r\n};\r\n","/**\n * Module dependencies.\n */\n\nvar keys = require('./keys');\nvar hasBinary = require('has-binary2');\nvar sliceBuffer = require('arraybuffer.slice');\nvar after = require('after');\nvar utf8 = require('./utf8');\n\nvar base64encoder;\nif (typeof ArrayBuffer !== 'undefined') {\n  base64encoder = require('base64-arraybuffer');\n}\n\n/**\n * Check if we are running an android browser. That requires us to use\n * ArrayBuffer with polling transports...\n *\n * http://ghinda.net/jpeg-blob-ajax-android/\n */\n\nvar isAndroid = typeof navigator !== 'undefined' && /Android/i.test(navigator.userAgent);\n\n/**\n * Check if we are running in PhantomJS.\n * Uploading a Blob with PhantomJS does not work correctly, as reported here:\n * https://github.com/ariya/phantomjs/issues/11395\n * @type boolean\n */\nvar isPhantomJS = typeof navigator !== 'undefined' && /PhantomJS/i.test(navigator.userAgent);\n\n/**\n * When true, avoids using Blobs to encode payloads.\n * @type boolean\n */\nvar dontSendBlobs = isAndroid || isPhantomJS;\n\n/**\n * Current protocol version.\n */\n\nexports.protocol = 3;\n\n/**\n * Packet types.\n */\n\nvar packets = exports.packets = {\n    open:     0    // non-ws\n  , close:    1    // non-ws\n  , ping:     2\n  , pong:     3\n  , message:  4\n  , upgrade:  5\n  , noop:     6\n};\n\nvar packetslist = keys(packets);\n\n/**\n * Premade error packet.\n */\n\nvar err = { type: 'error', data: 'parser error' };\n\n/**\n * Create a blob api even for blob builder when vendor prefixes exist\n */\n\nvar Blob = require('blob');\n\n/**\n * Encodes a packet.\n *\n *     <packet type id> [ <data> ]\n *\n * Example:\n *\n *     5hello world\n *     3\n *     4\n *\n * Binary is encoded in an identical principle\n *\n * @api private\n */\n\nexports.encodePacket = function (packet, supportsBinary, utf8encode, callback) {\n  if (typeof supportsBinary === 'function') {\n    callback = supportsBinary;\n    supportsBinary = false;\n  }\n\n  if (typeof utf8encode === 'function') {\n    callback = utf8encode;\n    utf8encode = null;\n  }\n\n  var data = (packet.data === undefined)\n    ? undefined\n    : packet.data.buffer || packet.data;\n\n  if (typeof ArrayBuffer !== 'undefined' && data instanceof ArrayBuffer) {\n    return encodeArrayBuffer(packet, supportsBinary, callback);\n  } else if (typeof Blob !== 'undefined' && data instanceof Blob) {\n    return encodeBlob(packet, supportsBinary, callback);\n  }\n\n  // might be an object with { base64: true, data: dataAsBase64String }\n  if (data && data.base64) {\n    return encodeBase64Object(packet, callback);\n  }\n\n  // Sending data as a utf-8 string\n  var encoded = packets[packet.type];\n\n  // data fragment is optional\n  if (undefined !== packet.data) {\n    encoded += utf8encode ? utf8.encode(String(packet.data), { strict: false }) : String(packet.data);\n  }\n\n  return callback('' + encoded);\n\n};\n\nfunction encodeBase64Object(packet, callback) {\n  // packet data is an object { base64: true, data: dataAsBase64String }\n  var message = 'b' + exports.packets[packet.type] + packet.data.data;\n  return callback(message);\n}\n\n/**\n * Encode packet helpers for binary types\n */\n\nfunction encodeArrayBuffer(packet, supportsBinary, callback) {\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  var data = packet.data;\n  var contentArray = new Uint8Array(data);\n  var resultBuffer = new Uint8Array(1 + data.byteLength);\n\n  resultBuffer[0] = packets[packet.type];\n  for (var i = 0; i < contentArray.length; i++) {\n    resultBuffer[i+1] = contentArray[i];\n  }\n\n  return callback(resultBuffer.buffer);\n}\n\nfunction encodeBlobAsArrayBuffer(packet, supportsBinary, callback) {\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  var fr = new FileReader();\n  fr.onload = function() {\n    exports.encodePacket({ type: packet.type, data: fr.result }, supportsBinary, true, callback);\n  };\n  return fr.readAsArrayBuffer(packet.data);\n}\n\nfunction encodeBlob(packet, supportsBinary, callback) {\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  if (dontSendBlobs) {\n    return encodeBlobAsArrayBuffer(packet, supportsBinary, callback);\n  }\n\n  var length = new Uint8Array(1);\n  length[0] = packets[packet.type];\n  var blob = new Blob([length.buffer, packet.data]);\n\n  return callback(blob);\n}\n\n/**\n * Encodes a packet with binary data in a base64 string\n *\n * @param {Object} packet, has `type` and `data`\n * @return {String} base64 encoded message\n */\n\nexports.encodeBase64Packet = function(packet, callback) {\n  var message = 'b' + exports.packets[packet.type];\n  if (typeof Blob !== 'undefined' && packet.data instanceof Blob) {\n    var fr = new FileReader();\n    fr.onload = function() {\n      var b64 = fr.result.split(',')[1];\n      callback(message + b64);\n    };\n    return fr.readAsDataURL(packet.data);\n  }\n\n  var b64data;\n  try {\n    b64data = String.fromCharCode.apply(null, new Uint8Array(packet.data));\n  } catch (e) {\n    // iPhone Safari doesn't let you apply with typed arrays\n    var typed = new Uint8Array(packet.data);\n    var basic = new Array(typed.length);\n    for (var i = 0; i < typed.length; i++) {\n      basic[i] = typed[i];\n    }\n    b64data = String.fromCharCode.apply(null, basic);\n  }\n  message += btoa(b64data);\n  return callback(message);\n};\n\n/**\n * Decodes a packet. Changes format to Blob if requested.\n *\n * @return {Object} with `type` and `data` (if any)\n * @api private\n */\n\nexports.decodePacket = function (data, binaryType, utf8decode) {\n  if (data === undefined) {\n    return err;\n  }\n  // String data\n  if (typeof data === 'string') {\n    if (data.charAt(0) === 'b') {\n      return exports.decodeBase64Packet(data.substr(1), binaryType);\n    }\n\n    if (utf8decode) {\n      data = tryDecode(data);\n      if (data === false) {\n        return err;\n      }\n    }\n    var type = data.charAt(0);\n\n    if (Number(type) != type || !packetslist[type]) {\n      return err;\n    }\n\n    if (data.length > 1) {\n      return { type: packetslist[type], data: data.substring(1) };\n    } else {\n      return { type: packetslist[type] };\n    }\n  }\n\n  var asArray = new Uint8Array(data);\n  var type = asArray[0];\n  var rest = sliceBuffer(data, 1);\n  if (Blob && binaryType === 'blob') {\n    rest = new Blob([rest]);\n  }\n  return { type: packetslist[type], data: rest };\n};\n\nfunction tryDecode(data) {\n  try {\n    data = utf8.decode(data, { strict: false });\n  } catch (e) {\n    return false;\n  }\n  return data;\n}\n\n/**\n * Decodes a packet encoded in a base64 string\n *\n * @param {String} base64 encoded message\n * @return {Object} with `type` and `data` (if any)\n */\n\nexports.decodeBase64Packet = function(msg, binaryType) {\n  var type = packetslist[msg.charAt(0)];\n  if (!base64encoder) {\n    return { type: type, data: { base64: true, data: msg.substr(1) } };\n  }\n\n  var data = base64encoder.decode(msg.substr(1));\n\n  if (binaryType === 'blob' && Blob) {\n    data = new Blob([data]);\n  }\n\n  return { type: type, data: data };\n};\n\n/**\n * Encodes multiple messages (payload).\n *\n *     <length>:data\n *\n * Example:\n *\n *     11:hello world2:hi\n *\n * If any contents are binary, they will be encoded as base64 strings. Base64\n * encoded strings are marked with a b before the length specifier\n *\n * @param {Array} packets\n * @api private\n */\n\nexports.encodePayload = function (packets, supportsBinary, callback) {\n  if (typeof supportsBinary === 'function') {\n    callback = supportsBinary;\n    supportsBinary = null;\n  }\n\n  var isBinary = hasBinary(packets);\n\n  if (supportsBinary && isBinary) {\n    if (Blob && !dontSendBlobs) {\n      return exports.encodePayloadAsBlob(packets, callback);\n    }\n\n    return exports.encodePayloadAsArrayBuffer(packets, callback);\n  }\n\n  if (!packets.length) {\n    return callback('0:');\n  }\n\n  function setLengthHeader(message) {\n    return message.length + ':' + message;\n  }\n\n  function encodeOne(packet, doneCallback) {\n    exports.encodePacket(packet, !isBinary ? false : supportsBinary, false, function(message) {\n      doneCallback(null, setLengthHeader(message));\n    });\n  }\n\n  map(packets, encodeOne, function(err, results) {\n    return callback(results.join(''));\n  });\n};\n\n/**\n * Async array map using after\n */\n\nfunction map(ary, each, done) {\n  var result = new Array(ary.length);\n  var next = after(ary.length, done);\n\n  var eachWithIndex = function(i, el, cb) {\n    each(el, function(error, msg) {\n      result[i] = msg;\n      cb(error, result);\n    });\n  };\n\n  for (var i = 0; i < ary.length; i++) {\n    eachWithIndex(i, ary[i], next);\n  }\n}\n\n/*\n * Decodes data when a payload is maybe expected. Possible binary contents are\n * decoded from their base64 representation\n *\n * @param {String} data, callback method\n * @api public\n */\n\nexports.decodePayload = function (data, binaryType, callback) {\n  if (typeof data !== 'string') {\n    return exports.decodePayloadAsBinary(data, binaryType, callback);\n  }\n\n  if (typeof binaryType === 'function') {\n    callback = binaryType;\n    binaryType = null;\n  }\n\n  var packet;\n  if (data === '') {\n    // parser error - ignoring payload\n    return callback(err, 0, 1);\n  }\n\n  var length = '', n, msg;\n\n  for (var i = 0, l = data.length; i < l; i++) {\n    var chr = data.charAt(i);\n\n    if (chr !== ':') {\n      length += chr;\n      continue;\n    }\n\n    if (length === '' || (length != (n = Number(length)))) {\n      // parser error - ignoring payload\n      return callback(err, 0, 1);\n    }\n\n    msg = data.substr(i + 1, n);\n\n    if (length != msg.length) {\n      // parser error - ignoring payload\n      return callback(err, 0, 1);\n    }\n\n    if (msg.length) {\n      packet = exports.decodePacket(msg, binaryType, false);\n\n      if (err.type === packet.type && err.data === packet.data) {\n        // parser error in individual packet - ignoring payload\n        return callback(err, 0, 1);\n      }\n\n      var ret = callback(packet, i + n, l);\n      if (false === ret) return;\n    }\n\n    // advance cursor\n    i += n;\n    length = '';\n  }\n\n  if (length !== '') {\n    // parser error - ignoring payload\n    return callback(err, 0, 1);\n  }\n\n};\n\n/**\n * Encodes multiple messages (payload) as binary.\n *\n * <1 = binary, 0 = string><number from 0-9><number from 0-9>[...]<number\n * 255><data>\n *\n * Example:\n * 1 3 255 1 2 3, if the binary contents are interpreted as 8 bit integers\n *\n * @param {Array} packets\n * @return {ArrayBuffer} encoded payload\n * @api private\n */\n\nexports.encodePayloadAsArrayBuffer = function(packets, callback) {\n  if (!packets.length) {\n    return callback(new ArrayBuffer(0));\n  }\n\n  function encodeOne(packet, doneCallback) {\n    exports.encodePacket(packet, true, true, function(data) {\n      return doneCallback(null, data);\n    });\n  }\n\n  map(packets, encodeOne, function(err, encodedPackets) {\n    var totalLength = encodedPackets.reduce(function(acc, p) {\n      var len;\n      if (typeof p === 'string'){\n        len = p.length;\n      } else {\n        len = p.byteLength;\n      }\n      return acc + len.toString().length + len + 2; // string/binary identifier + separator = 2\n    }, 0);\n\n    var resultArray = new Uint8Array(totalLength);\n\n    var bufferIndex = 0;\n    encodedPackets.forEach(function(p) {\n      var isString = typeof p === 'string';\n      var ab = p;\n      if (isString) {\n        var view = new Uint8Array(p.length);\n        for (var i = 0; i < p.length; i++) {\n          view[i] = p.charCodeAt(i);\n        }\n        ab = view.buffer;\n      }\n\n      if (isString) { // not true binary\n        resultArray[bufferIndex++] = 0;\n      } else { // true binary\n        resultArray[bufferIndex++] = 1;\n      }\n\n      var lenStr = ab.byteLength.toString();\n      for (var i = 0; i < lenStr.length; i++) {\n        resultArray[bufferIndex++] = parseInt(lenStr[i]);\n      }\n      resultArray[bufferIndex++] = 255;\n\n      var view = new Uint8Array(ab);\n      for (var i = 0; i < view.length; i++) {\n        resultArray[bufferIndex++] = view[i];\n      }\n    });\n\n    return callback(resultArray.buffer);\n  });\n};\n\n/**\n * Encode as Blob\n */\n\nexports.encodePayloadAsBlob = function(packets, callback) {\n  function encodeOne(packet, doneCallback) {\n    exports.encodePacket(packet, true, true, function(encoded) {\n      var binaryIdentifier = new Uint8Array(1);\n      binaryIdentifier[0] = 1;\n      if (typeof encoded === 'string') {\n        var view = new Uint8Array(encoded.length);\n        for (var i = 0; i < encoded.length; i++) {\n          view[i] = encoded.charCodeAt(i);\n        }\n        encoded = view.buffer;\n        binaryIdentifier[0] = 0;\n      }\n\n      var len = (encoded instanceof ArrayBuffer)\n        ? encoded.byteLength\n        : encoded.size;\n\n      var lenStr = len.toString();\n      var lengthAry = new Uint8Array(lenStr.length + 1);\n      for (var i = 0; i < lenStr.length; i++) {\n        lengthAry[i] = parseInt(lenStr[i]);\n      }\n      lengthAry[lenStr.length] = 255;\n\n      if (Blob) {\n        var blob = new Blob([binaryIdentifier.buffer, lengthAry.buffer, encoded]);\n        doneCallback(null, blob);\n      }\n    });\n  }\n\n  map(packets, encodeOne, function(err, results) {\n    return callback(new Blob(results));\n  });\n};\n\n/*\n * Decodes data when a payload is maybe expected. Strings are decoded by\n * interpreting each byte as a key code for entries marked to start with 0. See\n * description of encodePayloadAsBinary\n *\n * @param {ArrayBuffer} data, callback method\n * @api public\n */\n\nexports.decodePayloadAsBinary = function (data, binaryType, callback) {\n  if (typeof binaryType === 'function') {\n    callback = binaryType;\n    binaryType = null;\n  }\n\n  var bufferTail = data;\n  var buffers = [];\n\n  while (bufferTail.byteLength > 0) {\n    var tailArray = new Uint8Array(bufferTail);\n    var isString = tailArray[0] === 0;\n    var msgLength = '';\n\n    for (var i = 1; ; i++) {\n      if (tailArray[i] === 255) break;\n\n      // 310 = char length of Number.MAX_VALUE\n      if (msgLength.length > 310) {\n        return callback(err, 0, 1);\n      }\n\n      msgLength += tailArray[i];\n    }\n\n    bufferTail = sliceBuffer(bufferTail, 2 + msgLength.length);\n    msgLength = parseInt(msgLength);\n\n    var msg = sliceBuffer(bufferTail, 0, msgLength);\n    if (isString) {\n      try {\n        msg = String.fromCharCode.apply(null, new Uint8Array(msg));\n      } catch (e) {\n        // iPhone Safari doesn't let you apply to typed arrays\n        var typed = new Uint8Array(msg);\n        msg = '';\n        for (var i = 0; i < typed.length; i++) {\n          msg += String.fromCharCode(typed[i]);\n        }\n      }\n    }\n\n    buffers.push(msg);\n    bufferTail = sliceBuffer(bufferTail, msgLength);\n  }\n\n  var total = buffers.length;\n  buffers.forEach(function(buffer, i) {\n    callback(exports.decodePacket(buffer, binaryType, true), i, total);\n  });\n};\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport RepoTag from '../../models/repo-tag';\nimport CreateTagDialog from './create-tag-dialog';\nimport toaster from '../toast';\nrequire('../../css/repo-tag.css');\n\nconst TagItemPropTypes = {\n  repoID: PropTypes.string.isRequired,\n  repoTag: PropTypes.object.isRequired,\n  filePath: PropTypes.string.isRequired,\n  fileTagList: PropTypes.array.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n};\n\nclass TagItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isTagHighlighted: false\n    };\n  }\n\n  onMouseEnter = () => {\n    this.setState({\n      isTagHighlighted: true\n    });\n  }\n\n  onMouseLeave = () => {\n    this.setState({\n      isTagHighlighted: false\n    });\n  }\n\n  getRepoTagIdList = () => {\n    let repoTagIdList = [];\n    let fileTagList = this.props.fileTagList;\n    repoTagIdList = fileTagList.map((fileTag) => fileTag.repo_tag_id);\n    return repoTagIdList;\n  }\n\n  onEditFileTag = () => {\n    let { repoID, repoTag, filePath } = this.props;\n    let repoTagIdList = this.getRepoTagIdList();\n    if (repoTagIdList.indexOf(repoTag.id) === -1) {\n      let id = repoTag.id;\n      seafileAPI.addFileTag(repoID, filePath, id).then(() => {\n        repoTagIdList = this.getRepoTagIdList();\n        this.props.onFileTagChanged();\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      let fileTag = null;\n      let fileTagList = this.props.fileTagList;\n      for(let i = 0; i < fileTagList.length; i++) {\n        if (fileTagList[i].repo_tag_id === repoTag.id) {\n          fileTag = fileTagList[i];\n          break;\n        }\n      }\n      seafileAPI.deleteFileTag(repoID, fileTag.id).then(() => {\n        repoTagIdList = this.getRepoTagIdList();\n        this.props.onFileTagChanged();\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  render() {\n    const { isTagHighlighted } = this.state;\n    const { repoTag } = this.props;\n    const repoTagIdList = this.getRepoTagIdList();\n    const isTagSelected = repoTagIdList.indexOf(repoTag.id) != -1;\n    return (\n      <li\n        className={`tag-list-item cursor-pointer px-4 d-flex justify-content-between align-items-center ${isTagHighlighted ? 'hl' : ''}`}\n        onClick={this.onEditFileTag}\n        onMouseEnter={this.onMouseEnter}\n        onMouseLeave={this.onMouseLeave}\n      >\n        <div className=\"d-flex align-items-center\">\n          <span className=\"tag-color w-4 h-4 rounded-circle\" style={{backgroundColor: repoTag.color}}></span>\n          <span className=\"tag-name mx-2\">{repoTag.name}</span>\n        </div>\n        {isTagSelected && <i className=\"fas fa-check tag-selected-icon\"></i>}\n      </li>\n    );\n  }\n\n}\n\nTagItem.propTypes = TagItemPropTypes;\n\nconst TagListPropTypes = {\n  repoID: PropTypes.string.isRequired,\n  filePath: PropTypes.string.isRequired,\n  fileTagList: PropTypes.array.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  createNewTag: PropTypes.func.isRequired,\n};\n\nclass TagList extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      repotagList: [],\n    };\n  }\n\n  componentDidMount() {\n    this.getRepoTagList();\n  }\n\n  getRepoTagList = () => {\n    let repoID = this.props.repoID;\n    seafileAPI.listRepoTags(repoID).then(res => {\n      let repotagList = [];\n      res.data.repo_tags.forEach(item => {\n        let repoTag = new RepoTag(item);\n        repotagList.push(repoTag);\n      });\n      this.setState({repotagList: repotagList});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <ModalHeader toggle={this.props.toggleCancel}>{gettext('Select Tags')}</ModalHeader>\n        <ModalBody className=\"px-0\">\n          <ul className=\"tag-list tag-list-container\">\n            {this.state.repotagList.map((repoTag) => {\n              return (\n                <TagItem\n                  key={repoTag.id}\n                  repoTag={repoTag}\n                  repoID={this.props.repoID}\n                  filePath={this.props.filePath}\n                  fileTagList={this.props.fileTagList}\n                  onFileTagChanged={this.props.onFileTagChanged}\n                />\n              );\n            })}\n          </ul>\n          <a\n            href=\"#\"\n            className=\"add-tag-link px-4 py-2 d-flex align-items-center\"\n            onClick={this.props.createNewTag}\n          >\n            <span className=\"sf2-icon-plus mr-2\"></span>\n            {gettext('Create a new tag')}\n          </a>\n        </ModalBody>\n        <ModalFooter>\n          <Button onClick={this.props.toggleCancel}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Fragment>\n    );\n  }\n}\n\nTagList.propTypes = TagListPropTypes;\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  filePath: PropTypes.string.isRequired,\n  fileTagList: PropTypes.array.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n};\n\nclass EditFileTagDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isCreateRepoTagShow: false,\n      isListRepoTagShow: true,\n    };\n  }\n\n  createNewTag = () => {\n    this.setState({\n      isCreateRepoTagShow: !this.state.isCreateRepoTagShow,\n      isListRepoTagShow: !this.state.isListRepoTagShow,\n    });\n  }\n\n  onRepoTagCreated = (repoTagID) => {\n    let {repoID, filePath} = this.props;\n    seafileAPI.addFileTag(repoID, filePath, repoTagID).then(() => {\n      this.props.onFileTagChanged();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleCancel} autoFocus={false}>\n        {this.state.isListRepoTagShow &&\n          <TagList\n            repoID={this.props.repoID}\n            filePath={this.props.filePath}\n            fileTagList={this.props.fileTagList}\n            onFileTagChanged={this.props.onFileTagChanged}\n            toggleCancel={this.props.toggleCancel}\n            createNewTag={this.createNewTag}\n          />\n        }\n        {this.state.isCreateRepoTagShow &&\n          <CreateTagDialog\n            repoID={this.props.repoID}\n            onClose={this.props.toggleCancel}\n            toggleCancel={this.createNewTag}\n            onRepoTagCreated={this.onRepoTagCreated}\n          />\n        }\n      </Modal>\n    );\n  }\n}\n\nEditFileTagDialog.propTypes = propTypes;\n\nexport default EditFileTagDialog;\n","import { MENU_SHOW, MENU_HIDE } from './actions';\nimport { uniqueId, hasOwnProp, canUseDOM } from './helpers';\n\nclass GlobalEventListener {\n\n  constructor() {\n    this.callbacks = {};\n\n    if (canUseDOM) {\n      window.addEventListener(MENU_SHOW, this.handleShowEvent);\n      window.addEventListener(MENU_HIDE, this.handleHideEvent);\n    }\n  }\n\n  handleShowEvent = (event) => {\n    for (const id in this.callbacks) {\n      if (hasOwnProp(this.callbacks, id)) this.callbacks[id].show(event);\n    }\n  }\n\n  handleHideEvent = (event) => {\n    for (const id in this.callbacks) {\n      if (hasOwnProp(this.callbacks, id)) this.callbacks[id].hide(event);\n    }\n  }\n\n  register = (showCallback, hideCallback) => {\n    const id = uniqueId();\n\n    this.callbacks[id] = {\n      show: showCallback,\n      hide: hideCallback\n    };\n\n    return id;\n  }\n\n  unregister = (id) => {\n    if (id && this.callbacks[id]) {\n      delete this.callbacks[id];\n    }\n  }\n}\n\nexport default new GlobalEventListener();\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport listener from './globalEventListener';\nimport { hideMenu } from './actions';\nimport { callIfExists } from './helpers';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  id: PropTypes.string.isRequired,\n  rtl: PropTypes.bool,\n  onMenuItemClick: PropTypes.func.isRequired,\n  onShowMenu: PropTypes.func,\n  onHideMenu: PropTypes.func,\n};\n\nclass ContextMenu extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      x: 0,\n      y: 0,\n      isVisible: false,\n      currentObject: null,\n      menuList: [],\n    };\n  }\n\n  componentDidMount() {\n    this.listenId = listener.register(this.handleShow, this.handleHide);\n  }\n\n  componentDidUpdate () {\n    if (this.state.isVisible) {\n      const wrapper = window.requestAnimationFrame || setTimeout;\n\n      wrapper(() => {\n        const { x, y } = this.state;\n        const { top, left } = this.props.rtl ? this.getRTLMenuPosition(x, y) : this.getMenuPosition(x, y);\n\n        wrapper(() => {\n          if (!this.menu) return;\n          this.menu.style.top = `${top}px`;\n          this.menu.style.left = `${left}px`;\n          this.menu.style.opacity = 1;\n          this.menu.style.pointerEvents = 'auto';\n        });\n      });\n    } else {\n      if (!this.menu) return;\n      this.menu.style.opacity = 0;\n      this.menu.style.pointerEvents = 'none';\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.listenId) {\n      listener.unregister(this.listenId);\n    }\n\n    this.unregisterHandlers();\n  }\n\n  registerHandlers = () => {\n    document.addEventListener('mousedown', this.handleOutsideClick);\n    document.addEventListener('touchstart', this.handleOutsideClick);\n    document.addEventListener('scroll', this.handleHide);\n    document.addEventListener('contextmenu', this.handleHide);\n    document.addEventListener('keydown', this.handleKeyNavigation);\n    window.addEventListener('resize', this.handleHide);\n  }\n\n  unregisterHandlers = () => {\n    document.removeEventListener('mousedown', this.handleOutsideClick);\n    document.removeEventListener('touchstart', this.handleOutsideClick);\n    document.removeEventListener('scroll', this.handleHide);\n    document.removeEventListener('contextmenu', this.handleHide);\n    document.removeEventListener('keydown', this.handleKeyNavigation);\n    window.removeEventListener('resize', this.handleHide);\n  }\n\n  handleShow = (e) => {\n    if (e.detail.id !== this.props.id) return;\n\n    const { x, y } = e.detail.position;\n    const { currentObject, menuList} = e.detail;\n\n    this.setState({ isVisible: true, x, y, currentObject, menuList });\n    this.registerHandlers();\n    callIfExists(this.props.onShowMenu, e);\n  }\n\n  handleHide = (e) => {\n    if (this.state.isVisible && (!e.detail || !e.detail.id || e.detail.id === this.props.id)) {\n      this.unregisterHandlers();\n      this.setState({ isVisible: false});\n      callIfExists(this.props.onHideMenu, e);\n    }\n  }\n\n  handleOutsideClick = (e) => {\n    if (!this.menu.contains(e.target)) hideMenu();\n  }\n\n  handleMouseLeave = (event) => {\n    event.preventDefault();\n\n    if (this.props.hideOnLeave) hideMenu();\n  }\n\n  handleContextMenu = (e) => {\n    this.handleHide(e);\n  }\n\n  handleKeyNavigation = (e) => {\n    if (this.state.isVisible === false) {\n      return;\n    }\n    e.preventDefault();\n    this.hideMenu(e);\n  }\n\n  hideMenu = (e) => {\n    if (e.keyCode === 27 || e.keyCode === 13) { // ECS or enter\n      hideMenu();\n    }\n  }\n\n  getMenuPosition = (x = 0, y = 0) => {\n    let menuStyles = {\n      top: y,\n      left: x\n    };\n\n    if (!this.menu) return menuStyles;\n\n    const { innerWidth, innerHeight } = window;\n    const rect = this.menu.getBoundingClientRect();\n\n    if (y + rect.height > innerHeight) {\n      menuStyles.top -= rect.height;\n    }\n\n    if (x + rect.width > innerWidth) {\n      menuStyles.left -= rect.width;\n    }\n\n    if (menuStyles.top < 0) {\n      menuStyles.top = rect.height < innerHeight ? (innerHeight - rect.height) / 2 : 0;\n    }\n\n    if (menuStyles.left < 0) {\n      menuStyles.left = rect.width < innerWidth ? (innerWidth - rect.width) / 2 : 0;\n    }\n\n    return menuStyles;\n  }\n\n  getRTLMenuPosition = (x = 0, y = 0) => {\n    let menuStyles = {\n      top: y,\n      left: x\n    };\n\n    if (!this.menu) return menuStyles;\n\n    const { innerWidth, innerHeight } = window;\n    const rect = this.menu.getBoundingClientRect();\n\n    // Try to position the menu on the left side of the cursor\n    menuStyles.left = x - rect.width;\n\n    if (y + rect.height > innerHeight) {\n      menuStyles.top -= rect.height;\n    }\n\n    if (menuStyles.left < 0) {\n      menuStyles.left += rect.width;\n    }\n\n    if (menuStyles.top < 0) {\n      menuStyles.top = rect.height < innerHeight ? (innerHeight - rect.height) / 2 : 0;\n    }\n\n    if (menuStyles.left + rect.width > innerWidth) {\n      menuStyles.left = rect.width < innerWidth ? (innerWidth - rect.width) / 2 : 0;\n    }\n\n    return menuStyles;\n  }\n\n\n  onMenuItemClick = (event) => {\n    event.stopPropagation();\n    let operation = Utils.getEventData(event, 'operation');\n    let currentObject = this.state.currentObject;\n    this.props.onMenuItemClick(operation, currentObject, event);\n  }\n\n  onContextMenu = (event) => {\n    event.stopPropagation();\n  }\n\n  render() {\n    const inlineStyle = { position: 'fixed', opacity: 0, pointerEvents: 'none', display: 'block' };\n    return (\n      <div role=\"menu\" className=\"seafile-contextmenu dropdown-menu\" style={inlineStyle} ref={menu => { this.menu = menu; }}>\n        {this.state.menuList.map((menuItem, index) => {\n          if (menuItem === 'Divider') {\n            return <div key={index} className=\"seafile-divider dropdown-divider\"></div>;\n          } else {\n            return (\n              <button\n                key={index}\n                className=\"seafile-contextmenu-item dropdown-item\"\n                data-operation={menuItem.key}\n                onClick={this.onMenuItemClick}\n                onContextMenu={this.onContextMenu}\n              >\n                {menuItem.value}\n              </button>\n            );\n          }\n        })}\n      </div>\n    );\n  }\n}\n\nContextMenu.propTypes = propTypes;\n\nexport default ContextMenu;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../utils/constants';\nimport toaster from './toast';\n\nconst propTypes = {\n  hasSuffix: PropTypes.bool,\n  name: PropTypes.string.isRequired,\n  onRenameConfirm: PropTypes.func.isRequired,\n  onRenameCancel: PropTypes.func.isRequired,\n};\n\nclass Rename extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      name: props.name\n    };\n  }\n\n  componentDidMount() {\n    this.refs.renameInput.focus();\n    if (this.props.hasSuffix) {\n      var endIndex = this.props.name.lastIndexOf('.');\n      this.refs.renameInput.setSelectionRange(0, endIndex, 'forward');\n    } else {\n      this.refs.renameInput.setSelectionRange(0, -1);\n    }\n  }\n\n  onChange = (e) => {\n    this.setState({name: e.target.value});\n  }\n\n  onClick = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n  }\n\n  onKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.onRenameConfirm(e);\n    }\n  }\n\n  onRenameConfirm = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    let newName = this.state.name.trim();\n    if (newName === this.props.name) {\n      this.props.onRenameCancel();\n      return;\n    }\n\n    let { isValid, errMessage } = this.validateInput();\n    if (!isValid) {\n      toaster.danger(errMessage);\n    } else {\n      this.props.onRenameConfirm(newName);\n    }\n  }\n\n  onRenameCancel = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.props.onRenameCancel();\n  }\n\n  validateInput = () => {\n    let newName = this.state.name.trim();\n    let isValid = true;\n    let errMessage = '';\n    if (!newName) {\n      isValid = false;\n      errMessage = gettext('Name is required.');\n      return { isValid, errMessage };\n    }\n\n    if (newName.indexOf('/') > -1) {\n      isValid = false;\n      errMessage = gettext('Name should not include ' + '\\'/\\'' + '.');\n      return { isValid, errMessage };\n    }\n\n    return { isValid, errMessage };\n  }\n\n  render() {\n    return (\n      <div className=\"rename-container\">\n        <input\n          ref=\"renameInput\"\n          value={this.state.name}\n          onChange={this.onChange}\n          onKeyPress={this.onKeyPress}\n          onClick={this.onClick}\n        />\n        <button className=\"btn btn-secondary sf2-icon-confirm confirm\" onClick={this.onRenameConfirm}></button>\n        <button className=\"btn btn-secondary sf2-icon-cancel cancel\" onClick={this.onRenameCancel}></button>\n      </div>\n    );\n  }\n}\n\nRename.propTypes = propTypes;\n\nexport default Rename;\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { mapToCssModules, tagPropType } from './utils';\nvar propTypes = {\n  className: PropTypes.string,\n  cssModule: PropTypes.object,\n  size: PropTypes.string,\n  bordered: PropTypes.bool,\n  borderless: PropTypes.bool,\n  striped: PropTypes.bool,\n  dark: PropTypes.bool,\n  hover: PropTypes.bool,\n  responsive: PropTypes.oneOfType([PropTypes.bool, PropTypes.string]),\n  tag: tagPropType,\n  responsiveTag: tagPropType,\n  innerRef: PropTypes.oneOfType([PropTypes.func, PropTypes.string, PropTypes.object])\n};\nvar defaultProps = {\n  tag: 'table',\n  responsiveTag: 'div'\n};\n\nvar Table = function Table(props) {\n  var className = props.className,\n      cssModule = props.cssModule,\n      size = props.size,\n      bordered = props.bordered,\n      borderless = props.borderless,\n      striped = props.striped,\n      dark = props.dark,\n      hover = props.hover,\n      responsive = props.responsive,\n      Tag = props.tag,\n      ResponsiveTag = props.responsiveTag,\n      innerRef = props.innerRef,\n      attributes = _objectWithoutPropertiesLoose(props, [\"className\", \"cssModule\", \"size\", \"bordered\", \"borderless\", \"striped\", \"dark\", \"hover\", \"responsive\", \"tag\", \"responsiveTag\", \"innerRef\"]);\n\n  var classes = mapToCssModules(classNames(className, 'table', size ? 'table-' + size : false, bordered ? 'table-bordered' : false, borderless ? 'table-borderless' : false, striped ? 'table-striped' : false, dark ? 'table-dark' : false, hover ? 'table-hover' : false), cssModule);\n  var table = /*#__PURE__*/React.createElement(Tag, _extends({}, attributes, {\n    ref: innerRef,\n    className: classes\n  }));\n\n  if (responsive) {\n    var responsiveClassName = mapToCssModules(responsive === true ? 'table-responsive' : \"table-responsive-\" + responsive, cssModule);\n    return /*#__PURE__*/React.createElement(ResponsiveTag, {\n      className: responsiveClassName\n    }, table);\n  }\n\n  return table;\n};\n\nTable.propTypes = propTypes;\nTable.defaultProps = defaultProps;\nexport default Table;","var map = {\n\t\"./monitor.svg\": 1838\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 1837;","import SpriteSymbol from \"../../../node_modules/svg-baker-runtime/browser-symbol.js\";\nimport sprite from \"../../../node_modules/svg-sprite-loader/runtime/browser-sprite.build.js\";\nvar symbol = new SpriteSymbol({\n  \"id\": \"monitor\",\n  \"use\": \"monitor-usage\",\n  \"viewBox\": \"0 0 32 32\",\n  \"content\": \"<symbol xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" viewBox=\\\"0 0 32 32\\\" id=\\\"monitor\\\"><g><g transform=\\\"translate(1.000000, 1.000000)\\\"><path class=\\\"st0\\\" fill=\\\"currentColor\\\" d=\\\"M25.1,20.8c-0.5-0.2-0.8-0.6-0.9-1.1v-4.7c0-4.4-4.2-7.3-6-8.3c-0.1-0.5-0.4-1.4-1-2\\n\\t\\t\\tc-0.6-0.6-1.4-0.9-2.3-0.8h-0.1c-0.8,0-1.6,0.3-2.3,0.8c-0.7,0.6-0.9,1.5-1,2c-1.8,0.9-6,3.8-6,8.3v4.6c0,0.5-0.4,0.9-0.9,1.1\\n\\t\\t\\tc-1.6,0.7-1.8,2.1-1.4,3.1c0.2,0.5,0.6,1,3.6,1h2.5c0.2,2.6,2.5,4.6,5.4,4.6s5.3-2.1,5.4-4.6h2.6c3,0,3.4-0.5,3.6-1\\n\\t\\t\\tC26.9,22.9,26.7,21.5,25.1,20.8L25.1,20.8z M14.9,27.8c-1.9,0-3.4-1.3-3.6-2.9h7.1C18.3,26.5,16.8,27.8,14.9,27.8L14.9,27.8z\\n\\t\\t\\t M22.9,23.1H7c-0.6,0-1.3,0-1.9-0.1c0-0.3,0.1-0.4,0.5-0.6c1.1-0.5,1.9-1.5,1.9-2.7v-4.7c0-3.9,4.5-6.5,5.3-6.9L13.4,8V7.4\\n\\t\\t\\tc0-0.2,0.1-1.7,1.5-1.7H15c1.4,0,1.5,1.5,1.5,1.7V8L17,8.2c0.8,0.3,5.3,2.9,5.3,6.9v4.7c0,1.2,0.8,2.2,1.9,2.7\\n\\t\\t\\tc0.4,0.2,0.5,0.3,0.5,0.6C24.2,23.1,23.5,23.1,22.9,23.1L22.9,23.1z\\\" /><path class=\\\"st0\\\" d=\\\"M23.9,0.2c0.4,0.3,0.6,0.9,0.3,1.3l-2.1,3.2c-0.3,0.4-0.9,0.6-1.3,0.3s-0.6-0.9-0.3-1.3l2.1-3.2\\n\\t\\t\\tC22.8,0,23.4-0.1,23.9,0.2z M29.9,7.1c0.2,0.5,0,1.1-0.5,1.3L25.9,10c-0.5,0.2-1,0-1.3-0.5c-0.2-0.5,0-1,0.5-1.3l3.5-1.6\\n\\t\\t\\tC29.1,6.4,29.7,6.6,29.9,7.1L29.9,7.1z M0.1,7.1c0.1-0.2,0.3-0.4,0.5-0.5c0.2-0.1,0.5-0.1,0.7,0l3.5,1.6c0.3,0.1,0.5,0.5,0.5,0.8\\n\\t\\t\\tc0,0.3-0.1,0.7-0.4,0.9c-0.3,0.2-0.6,0.2-1,0.1L0.6,8.4C0.1,8.2-0.1,7.6,0.1,7.1L0.1,7.1z M6.1,0.2C6.3,0,6.6,0,6.8,0\\n\\t\\t\\ts0.5,0.2,0.6,0.4l2.1,3.2c0.2,0.3,0.2,0.7,0.1,1S9.1,5.2,8.8,5.2C8.4,5.2,8.1,5,7.9,4.7L5.8,1.5C5.7,1.3,5.6,1,5.7,0.8\\n\\t\\t\\tC5.8,0.5,5.9,0.3,6.1,0.2L6.1,0.2L6.1,0.2z\\\" /></g></g></symbol>\"\n});\nvar result = sprite.add(symbol);\nexport default symbol","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Form, FormGroup, Label, Alert } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  fileType: PropTypes.string,\n  parentPath: PropTypes.string.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  checkDuplicatedName: PropTypes.func.isRequired,\n  addFolderCancel: PropTypes.func.isRequired,\n};\n\nclass CreateForder extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      parentPath: '',\n      childName: '',\n      errMessage: '',\n      isSubmitBtnActive: false,\n    };\n  }\n\n  componentDidMount() {\n    let parentPath = this.props.parentPath;\n    if (parentPath[parentPath.length - 1] === '/') {  // mainPanel\n      this.setState({parentPath: parentPath});\n    } else {\n      this.setState({parentPath: parentPath + '/'}); // sidePanel\n    }\n  }\n\n  handleChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({childName: e.target.value});\n  }\n\n  handleSubmit = () => {\n    if (!this.state.isSubmitBtnActive) {\n      return;\n    }\n\n    let newName = this.state.childName;\n    let isDuplicated = this.checkDuplicatedName();\n\n    if (isDuplicated) {\n      let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n      errMessage = errMessage.replace('{name}', Utils.HTMLescape(newName));\n      this.setState({errMessage: errMessage});\n    } else {\n      let path = this.state.parentPath + newName;\n      this.props.onAddFolder(path);\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n      e.preventDefault();\n    }\n  }\n\n  toggle = () => {\n    this.props.addFolderCancel();\n  }\n\n  checkDuplicatedName = () => {\n    let isDuplicated = this.props.checkDuplicatedName(this.state.childName);\n    return isDuplicated;\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle} autoFocus={false}>\n        <ModalHeader toggle={this.toggle}>{gettext('New Folder')}</ModalHeader>\n        <ModalBody>\n          <Form>\n            <FormGroup>\n              <Label for=\"folderName\">{gettext('Name')}</Label>\n              <Input\n                id=\"folderName\"\n                value={this.state.childName}\n                onKeyPress={this.handleKeyPress}\n                onChange={this.handleChange}\n                autoFocus={true}\n              />\n            </FormGroup>\n          </Form>\n          {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nCreateForder.propTypes = propTypes;\n\nexport default CreateForder;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody } from 'reactstrap';\nimport { gettext, fileServerRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../loading';\n\nconst propTypes = {\n  token: PropTypes.string,\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string,\n  target: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.array\n  ]),\n  toggleDialog: PropTypes.func.isRequired\n};\n\nlet interval;\n\nclass ZipDownloadDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      errorMsg: '',\n      zipProgress: null\n    };\n  }\n\n  componentDidMount() {\n    const { token, path, repoID, target } = this.props;\n    let getZipTask;\n    if (token) {\n      getZipTask = target.length ?\n        seafileAPI.getShareLinkDirentsZipTask(token, path, target) :\n        seafileAPI.getShareLinkZipTask(token, path);\n    } else {\n      getZipTask = seafileAPI.zipDownload(repoID, path, target);\n    }\n    getZipTask.then((res) => {\n      const zipToken = res.data['zip_token'];\n      this.setState({\n        isLoading: false,\n        errorMsg: '',\n        zipToken: zipToken\n      });\n      this.queryZipProgress();\n      interval = setInterval(this.queryZipProgress, 1000);\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        isLoading: false,\n        errorMsg: errorMsg\n      });\n    });\n  }\n\n  queryZipProgress = () => {\n    const zipToken = this.state.zipToken;\n    seafileAPI.queryZipProgress(zipToken).then((res) => {\n      const data = res.data;\n      if (data.failed == 1) {\n        clearInterval(interval);\n        this.setState({\n          isLoading: false,\n          errorMsg: data.failed_reason\n        });\n      } else {\n        this.setState({\n          zipProgress: data.total == 0 ? '100%' : (data.zipped/data.total*100).toFixed(2) + '%'\n        });\n        if (data['total'] == data['zipped']) {\n          clearInterval(interval);\n          this.props.toggleDialog();\n          location.href = `${fileServerRoot}zip/${zipToken}`;\n        }\n      }\n    }).catch((error) => {\n      clearInterval(interval);\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        isLoading: false,\n        errorMsg: errorMsg\n      });\n    });\n  }\n\n  cancelZipTask = () => {\n    const zipToken = this.state.zipToken;\n    seafileAPI.cancelZipTask(zipToken).then((res) => {\n    // do nothing\n    }).catch((error) => {\n    // do nothing\n    });\n  }\n\n  toggleDialog = () => {\n    const zipProgress = this.state.zipProgress;\n    if (zipProgress && zipProgress != '100%') {\n      clearInterval(interval);\n      this.cancelZipTask();\n    }\n    this.props.toggleDialog();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggleDialog}>\n        <ModalHeader toggle={this.toggleDialog}>{gettext('Download')}</ModalHeader>\n        <ModalBody>\n          <Content data={this.state} />\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nclass Content extends React.Component {\n\n  render() {\n    const {isLoading, errorMsg, zipProgress} = this.props.data;\n\n    if (isLoading) {\n      return <Loading />;\n    }\n\n    if (errorMsg) {\n      return <p className=\"error mt-4 text-center\">{errorMsg}</p>;\n    }\n\n    return <p className=\"mt-4 text-center\">{`${gettext('Packaging...')} ${zipProgress}`}</p>;\n  }\n}\n\nZipDownloadDialog.propTypes = propTypes;\n\nexport default ZipDownloadDialog;\n","import React from 'react';\nimport { curNoteMsg, curNoteID, siteRoot, gettext } from '../utils/constants';\n\nimport '../css/system-notification.css';\n\nclass SystemNotification extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isClosed: false\n    };\n  }\n\n  close = () => {\n    this.setState({isClosed: true});\n\n    if (navigator.cookieEnabled) {\n      let date = new Date(),\n        cookies = document.cookie.split('; '),\n        infoIDExist = false,\n        newInfoID = curNoteID + '_';\n      date.setTime(date.getTime() + 14*24*60*60*1000);\n      newInfoID += '; expires=' + date.toGMTString() + '; path=' + siteRoot;\n      for (var i = 0, len = cookies.length; i < len; i++) {\n        if (cookies[i].split('=')[0] == 'info_id') {\n          infoIDExist = true;\n          document.cookie = 'info_id=' + cookies[i].split('=')[1] + newInfoID;\n          break;\n        }\n      }\n      if (!infoIDExist) {\n        document.cookie = 'info_id=' + newInfoID;\n      }\n    }\n  }\n\n  render() {\n    if (!curNoteMsg || this.state.isClosed) {\n      return null;\n    }\n\n    return (\n      <div id=\"info-bar\" className=\"d-flex justify-content-between\">\n        <p id=\"info-bar-info\" className=\"m-0\" dangerouslySetInnerHTML={{__html: curNoteMsg}}></p>\n        <button className=\"close sf2-icon-x1\" title={gettext('Close')} aria-label={gettext('Close')} onClick={this.close}></button>\n      </div>\n    );\n  }\n}\n\nexport default SystemNotification;\n","class Group {\n  constructor(object) {\n    this.id= object.id;\n    this.name = object.name;\n    this.owner = object.owner;\n    this.admins = object.admins || [];\n    this.avatar_url = object.avatar_url;\n    this.created_at = object.created_at;\n    this.parent_group_id = object.parent_group_id;\n    this.wiki_enabled = object.wiki_enabled;\n    this.repos = object.repos || [];\n    this.group_quota = object.group_quota;\n    this.group_quota_usage = object.group_quota_usage;\n  }\n}\n\nexport default Group;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from '@gatsbyjs/reach-router';\nimport { Badge } from 'reactstrap';\nimport { gettext, siteRoot, canAddRepo, canGenerateShareLink, canGenerateUploadLink, canInvitePeople, dtableWebServer, enableOCM, enableOCMViaWebdav } from '../utils/constants';\nimport { seafileAPI } from '../utils/seafile-api';\nimport { Utils } from '../utils/utils';\nimport toaster from './toast';\nimport Group from '../models/group';\n\nimport { canViewOrg, isDocs, isPro, isDBSqlite3, customNavItems } from '../utils/constants';\n\nconst propTypes = {\n  currentTab: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\n  tabItemClick: PropTypes.func.isRequired,\n  draftCounts: PropTypes.number,\n};\n\nclass MainSideNav extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      groupsExtended: false,\n      sharedExtended: false,\n      closeSideBar:false,\n      groupItems: [],\n    };\n\n    this.listHeight = 24; //for caculate tabheight\n    this.groupsHeight = 0;\n    this.adminHeight = 0;\n  }\n\n  grpsExtend = () => {\n    this.setState({\n      groupsExtended: !this.state.groupsExtended,\n    });\n    this.loadGroups();\n  }\n\n  shExtend = () => {\n    this.setState({\n      sharedExtended: !this.state.sharedExtended,\n    });\n  }\n\n  loadGroups = () => {\n    let _this = this;\n    seafileAPI.listGroups().then(res =>{\n      let groupList = res.data.map(item => {\n        let group = new Group(item);\n        return group;\n      });\n\n      this.groupsHeight = (groupList.length + 1) * _this.listHeight;\n      _this.setState({\n        groupItems: groupList.sort((a, b) => {\n          return a.name.toLowerCase() < b.name.toLowerCase() ? -1 : 1;\n        })\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  tabItemClick = (e, param, id) => {\n    if (window.uploader &&\n      window.uploader.isUploadProgressDialogShow &&\n      window.uploader.totalProgress !== 100) {\n      if (!window.confirm(gettext('A file is being uploaded. Are you sure you want to leave this page?'))) {\n        e.preventDefault();\n        return false;\n      }\n      window.uploader.isUploadProgressDialogShow = false;\n    }\n    this.props.tabItemClick(param, id);\n  }\n\n  onDTableClick = () => {\n    let url = dtableWebServer;\n    window.open(url);\n  }\n\n  getActiveClass = (tab) => {\n    return this.props.currentTab === tab ? 'active' : '';\n  }\n\n  renderSharedGroups() {\n    let style = {height: 0};\n    if (this.state.groupsExtended) {\n      style = {height: this.groupsHeight};\n    }\n    return (\n      <ul className={`nav sub-nav nav-pills flex-column grp-list ${this.state.groupsExtended ? 'side-panel-slide' : 'side-panel-slide-up'}`} style={style}>\n        <li className=\"nav-item\">\n          <Link to={siteRoot + 'groups/'}  className={`nav-link ellipsis ${this.getActiveClass('groups')}`} onClick={(e) => this.tabItemClick(e, 'groups')}>\n            <span className=\"sharp\" aria-hidden=\"true\">#</span>\n            <span className=\"nav-text\">{gettext('All Groups')}</span>\n          </Link>\n        </li>\n        {this.state.groupItems.map(item => {\n          return (\n            <li key={item.id} className=\"nav-item\">\n              <Link to={siteRoot + 'group/' + item.id + '/'} className={`nav-link ellipsis ${this.getActiveClass(item.name)}`} onClick={(e) => this.tabItemClick(e, item.name, item.id)}>\n                <span className=\"sharp\" aria-hidden=\"true\">#</span>\n                <span className=\"nav-text\">{item.name}</span>\n              </Link>\n            </li>\n          );\n        })}\n      </ul>\n    );\n  }\n\n  renderSharedAdmin() {\n    let height = 0;\n    if (this.state.sharedExtended) {\n      if (!this.adminHeight) {\n        this.adminHeight = 3 * this.listHeight;\n      }\n      height = this.adminHeight;\n    }\n    let style = {height: height};\n\n    let linksNavItem = null;\n    if (canGenerateShareLink) {\n      linksNavItem = (\n        <li className=\"nav-item\">\n          <Link to={siteRoot + 'share-admin-share-links/'} className={`nav-link ellipsis ${this.getActiveClass('share-admin-share-links')}`} title={gettext('Links')} onClick={(e) => this.tabItemClick(e, 'share-admin-share-links')}>\n            <span aria-hidden=\"true\" className=\"sharp\">#</span>\n            <span className=\"nav-text\">{gettext('Links')}</span>\n          </Link>\n        </li>\n      );\n    } else if (canGenerateUploadLink) {\n      linksNavItem = (\n        <li className=\"nav-item\">\n          <Link to={siteRoot + 'share-admin-upload-links/'} className={`nav-link ellipsis ${this.getActiveClass('share-admin-upload-links')}`} title={gettext('Links')} onClick={(e) => this.tabItemClick(e, 'share-admin-upload-links')}>\n            <span aria-hidden=\"true\" className=\"sharp\">#</span>\n            <span className=\"nav-text\">{gettext('Links')}</span>\n          </Link>\n        </li>\n      );\n    }\n    return (\n      <ul className={`nav sub-nav nav-pills flex-column ${this.state.sharedExtended ? 'side-panel-slide' : 'side-panel-slide-up'}`} style={style} >\n        {canAddRepo && (\n          <li className=\"nav-item\">\n            <Link to={siteRoot + 'share-admin-libs/'} className={`nav-link ellipsis ${this.getActiveClass('share-admin-libs')}`} title={gettext('Libraries')} onClick={(e) => this.tabItemClick(e, 'share-admin-libs')}>\n              <span aria-hidden=\"true\" className=\"sharp\">#</span>\n              <span className=\"nav-text\">{gettext('Libraries')}</span>\n            </Link>\n          </li>\n        )}\n        <li className=\"nav-item\">\n          <Link to={siteRoot + 'share-admin-folders/'} className={`nav-link ellipsis ${this.getActiveClass('share-admin-folders')}`} title={gettext('Folders')} onClick={(e) => this.tabItemClick(e, 'share-admin-folders')}>\n            <span aria-hidden=\"true\" className=\"sharp\">#</span>\n            <span className=\"nav-text\">{gettext('Folders')}</span>\n          </Link>\n        </li>\n        {linksNavItem}\n      </ul>\n    );\n  }\n\n  renderCustomNavItems() {\n    return (\n      customNavItems.map((item, idx) => {\n        return (\n          <li key={idx} className=\"nav-item\">\n            <a href={item.link} className=\"nav-link ellipsis\" title={item.desc}>\n              <span className={item.icon} aria-hidden=\"true\"></span>\n              <span className=\"nav-text\">{item.desc}</span>\n            </a>\n          </li>\n        );\n      })\n    );\n  }\n\n  render() {\n    let showActivity = isDocs || isPro || !isDBSqlite3;\n    return (\n      <div className=\"side-nav\">\n        <div className=\"side-nav-con\">\n          <h3 className=\"sf-heading\">{gettext('Files')}</h3>\n          <ul className=\"nav nav-pills flex-column nav-container\">\n            {canAddRepo && (\n              <li className=\"nav-item\">\n                <Link to={ siteRoot + 'my-libs/' } className={`nav-link ellipsis ${this.getActiveClass('my-libs') || this.getActiveClass('deleted') }`} title={gettext('My Libraries')} onClick={(e) => this.tabItemClick(e, 'my-libs')}>\n                  <span className=\"sf2-icon-user\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('My Libraries')}</span>\n                </Link>\n              </li>\n            )}\n            <li className=\"nav-item\">\n              <Link to={siteRoot + 'shared-libs/'} className={`nav-link ellipsis ${this.getActiveClass('shared-libs')}`} title={gettext('Shared with me')} onClick={(e) => this.tabItemClick(e, 'shared-libs')}>\n                <span className=\"sf2-icon-share\" aria-hidden=\"true\"></span>\n                <span className=\"nav-text\">{gettext('Shared with me')}</span>\n              </Link>\n            </li>\n            { canViewOrg &&\n              <li className=\"nav-item\" onClick={(e) => this.tabItemClick(e, 'org')}>\n                <Link to={ siteRoot + 'org/' } className={`nav-link ellipsis ${this.getActiveClass('org')}`} title={gettext('Shared with all')}>\n                  <span className=\"sf2-icon-organization\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('Shared with all')}</span>\n                </Link>\n              </li>\n            }\n            <li className=\"nav-item flex-column\" id=\"group-nav\">\n              <a className=\"nav-link ellipsis\" title={gettext('Shared with groups')} onClick={this.grpsExtend}>\n                <span className=\"sf2-icon-group\" aria-hidden=\"true\"></span>\n                <span className=\"nav-text\">{gettext('Shared with groups')}</span>\n                <span className={`toggle-icon fas ${this.state.groupsExtended ?'fa-caret-down':'fa-caret-left'}`} aria-hidden=\"true\"></span>\n              </a>\n              {this.renderSharedGroups()}\n            </li>\n            {enableOCM &&\n              <li className=\"nav-item\">\n                <Link to={siteRoot + 'shared-with-ocm/'} className={`nav-link ellipsis ${this.getActiveClass('shared-with-ocm')}`} title={gettext('Shared from other servers')} onClick={(e) => this.tabItemClick(e, 'shared-with-ocm')}>\n                  <span className=\"sf3-font-share-from-other-servers sf3-font\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('Shared from other servers')}</span>\n                </Link>\n              </li>\n            }\n            {enableOCMViaWebdav &&\n              <li className=\"nav-item\">\n                <Link to={siteRoot + 'ocm-via-webdav/'} className={`nav-link ellipsis ${this.getActiveClass('ocm-via-webdav')}`} title={gettext('Shared from other servers')} onClick={(e) => this.tabItemClick(e, 'ocm-via-webdav')}>\n                  <span className=\"sf3-font-share-from-other-servers sf3-font\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('Shared from other servers')}</span>\n                </Link>\n              </li>\n            }\n          </ul>\n\n\n          <h3 className=\"sf-heading\">{gettext('Tools')}</h3>\n          <ul className=\"nav nav-pills flex-column nav-container\">\n            <li className=\"nav-item\">\n              <Link className={`nav-link ellipsis ${this.getActiveClass('starred')}`} to={siteRoot + 'starred/'} title={gettext('Favorites')} onClick={(e) => this.tabItemClick(e, 'starred')}>\n                <span className=\"sf2-icon-star\" aria-hidden=\"true\"></span>\n                <span className=\"nav-text\">{gettext('Favorites')}</span>\n              </Link>\n            </li>\n            {showActivity &&\n              <li className=\"nav-item\">\n                <Link className={`nav-link ellipsis ${this.getActiveClass('dashboard')}`} to={siteRoot + 'dashboard/'} title={gettext('Activities')} onClick={(e) => this.tabItemClick(e, 'dashboard')}>\n                  <span className=\"sf2-icon-clock\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('Activities')}</span>\n                </Link>\n              </li>\n            }\n              <li className=\"nav-item\">\n                <Link className={`nav-link ellipsis ${this.getActiveClass('published')}`} to={siteRoot + 'published/'} title={gettext('Published Libraries')} onClick={(e) => this.tabItemClick(e, 'published')}>\n                  <span className=\"sf2-icon-wiki-view\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('Published Libraries')}</span>\n                </Link>\n              </li>\n            {isDocs &&\n              <li className=\"nav-item\" onClick={(e) => this.tabItemClick(e, 'drafts')}>\n                <Link className={`nav-link ellipsis ${this.getActiveClass('drafts')}`} to={siteRoot + 'drafts/'} title={gettext('Drafts')}>\n                  <span className=\"sf2-icon-edit\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('Drafts')}</span>\n                  {this.props.draftCounts > 0 && <span id=\"draft-num\">{this.props.draftCounts}</span>}\n                </Link>\n              </li>\n            }\n            <li className=\"nav-item\">\n              <Link className={`nav-link ellipsis ${this.getActiveClass('linked-devices')}`} to={siteRoot + 'linked-devices/'} title={gettext('Linked Devices')} onClick={(e) => this.tabItemClick(e, 'linked-devices')}>\n                <span className=\"sf2-icon-monitor\" aria-hidden=\"true\"></span>\n                <span className=\"nav-text\">{gettext('Linked Devices')}</span>\n              </Link>\n            </li>\n            {canInvitePeople &&\n              <li className=\"nav-item\">\n                <Link className={`nav-link ellipsis ${this.getActiveClass('invitations')}`} to={siteRoot + 'invitations/'} title={gettext('Invite Guest')} onClick={(e) => this.tabItemClick(e, 'invitations')}>\n                  <span className=\"sf2-icon-invite\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('Invite Guest')}</span>\n                </Link>\n              </li>\n            }\n            <li className=\"nav-item flex-column\" id=\"share-admin-nav\">\n              <a className=\"nav-link ellipsis\" title={gettext('Share Admin')} onClick={this.shExtend}>\n                <span className=\"sf2-icon-wrench\" aria-hidden=\"true\"></span>\n                <span className=\"nav-text\">{gettext('Share Admin')}</span>\n                <span className={`toggle-icon fas ${this.state.sharedExtended ? 'fa-caret-down':'fa-caret-left'}`} aria-hidden=\"true\"></span>\n              </a>\n              {this.renderSharedAdmin()}\n            </li>\n            {customNavItems && this.renderCustomNavItems()}\n          </ul>\n        </div>\n\n        {dtableWebServer &&\n          <div className=\"side-nav-link\" onClick={this.onDTableClick}>\n            <span className=\"link-icon icon-left sf3-font sf3-font-dtable-logo\" aria-hidden=\"true\"></span>\n            <span className=\"link-text\">SeaTable</span>\n            <span className=\"link-icon icon-right sf3-font sf3-font-arrow\"></span>\n          </div>\n        }\n      </div>\n    );\n  }\n}\n\nMainSideNav.propTypes = propTypes;\n\nexport default MainSideNav;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalBody } from 'reactstrap';\nimport { gettext, lang, mediaUrl, logoPath, logoWidth, logoHeight, siteTitle, seafileVersion, additionalAboutDialogLinks, aboutDialogCustomHtml } from '../../utils/constants';\n\nconst propTypes = {\n  onCloseAboutDialog: PropTypes.func.isRequired,\n};\n\nclass AboutDialog extends React.Component {\n\n  renderExternalAboutLinks = () => {\n    if (additionalAboutDialogLinks && (typeof additionalAboutDialogLinks) === 'object') {\n      let keys = Object.keys(additionalAboutDialogLinks);\n      return keys.map((key, index) => {\n        return <a key={index} className=\"d-block\" href={additionalAboutDialogLinks[key]}>{key}</a>;\n      });\n    }\n    return null;\n  }\n\n  render() {\n\n    let href = lang === lang == 'zh-cn' ? 'http://seafile.com/about/' : 'http://seafile.com/en/about/';\n    const { onCloseAboutDialog: toggleDialog } = this.props;\n\n    if (aboutDialogCustomHtml) {\n      return (\n        <Modal isOpen={true} toggle={toggleDialog}>\n          <ModalBody>\n            <button type=\"button\" className=\"close\" onClick={toggleDialog}><span aria-hidden=\"true\"></span></button>\n            <div className=\"about-content\" dangerouslySetInnerHTML={{__html: aboutDialogCustomHtml}}></div>\n          </ModalBody>\n        </Modal>\n      );\n    } else {\n      return (\n        <Modal isOpen={true} toggle={toggleDialog}>\n          <ModalBody>\n            <button type=\"button\" className=\"close\" onClick={toggleDialog}><span aria-hidden=\"true\"></span></button>\n            <div className=\"about-content\">\n              <p><img src={mediaUrl + logoPath} height={logoHeight} width={logoWidth} title={siteTitle} alt=\"logo\" /></p>\n              <p>{gettext('Server Version: ')}{seafileVersion}<br /> {(new Date()).getFullYear()} {gettext('Seafile')}</p>\n              <p>{this.renderExternalAboutLinks()}</p>\n              <p><a href={href} target=\"_blank\">{gettext('About Us')}</a></p>\n            </div>\n          </ModalBody>\n        </Modal>\n      );\n    }\n  }\n}\n\nAboutDialog.propTypes = propTypes;\n\nexport default AboutDialog;\n","import React, { Fragment } from 'react';\nimport { gettext, siteRoot, enableTC, sideNavFooterCustomHtml, additionalAppBottomLinks } from '../utils/constants';\nimport ModalPortal from './modal-portal';\nimport AboutDialog from './dialog/about-dialog';\n\nclass SideNavFooter extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isAboutDialogShow: false,\n    };\n  }\n\n  onAboutDialogToggle = (e) => {\n    e.preventDefault();\n    this.setState({isAboutDialogShow: !this.state.isAboutDialogShow});\n  }\n\n  renderExternalAppLinks = () => {\n    if (additionalAppBottomLinks && (typeof additionalAppBottomLinks) === 'object') {\n      let keys = Object.keys(additionalAppBottomLinks);\n      return keys.map((key, index) => {\n        return <a key={index} className=\"item\" href={additionalAppBottomLinks[key]}>{key}</a>;\n      });\n    }\n    return null;\n  }\n\n  render() {\n\n    if (sideNavFooterCustomHtml) {\n      return (<div className='side-nav-footer' dangerouslySetInnerHTML={{__html: sideNavFooterCustomHtml}}></div>);\n    }\n    return (\n      <Fragment>\n        <div className=\"side-nav-footer flex-wrap\">\n          <a href={siteRoot + 'help/'} target=\"_blank\" rel=\"noopener noreferrer\" className=\"item\">{gettext('Help')}</a>\n          <a href=\"#\" className=\"item\" onClick={this.onAboutDialogToggle}>{gettext('About')}</a>\n          {enableTC && <a href={`${siteRoot}terms/`} className=\"item\">{gettext('Terms')}</a>}\n          {this.renderExternalAppLinks()}\n          <a href={siteRoot + 'download_client_program/'} className={`item ${additionalAppBottomLinks ? '' : 'last-item'}`}>\n            <span aria-hidden=\"true\" className=\"sf2-icon-monitor vam\"></span>{' '}\n            <span className=\"vam\">{gettext('Clients')}</span>\n          </a>\n        </div>\n        {this.state.isAboutDialogShow && (\n          <ModalPortal>\n            <AboutDialog onCloseAboutDialog={this.onAboutDialogToggle} />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nexport default SideNavFooter;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Logo from './logo';\nimport MainSideNav from './main-side-nav';\nimport SideNavFooter from './side-nav-footer';\n\nconst propTypes = {\n  isSidePanelClosed: PropTypes.bool.isRequired,\n  currentTab: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\n  onCloseSidePanel: PropTypes.func.isRequired,\n  tabItemClick: PropTypes.func.isRequired,\n  draftCounts: PropTypes.number,\n};\n\nclass SidePanel extends React.Component {\n\n  render() {\n    return (\n      <div className={`side-panel ${this.props.isSidePanelClosed ? '' : 'left-zero'}`}>\n        <div className=\"side-panel-north\">\n          <Logo onCloseSidePanel={this.props.onCloseSidePanel}/>\n        </div>\n        <div className=\"side-panel-center\">\n          <MainSideNav tabItemClick={this.props.tabItemClick} currentTab={this.props.currentTab} draftCounts={this.props.draftCounts}/>\n        </div>\n        <div className=\"side-panel-footer\">\n          <SideNavFooter />\n        </div>\n      </div>\n    );\n  }\n}\n\nSidePanel.propTypes = propTypes;\n\nexport default SidePanel;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nconst propTypes = {\n  children: PropTypes.object.isRequired,\n};\n\nclass MainPanel extends Component {\n\n  render() {\n    return (\n      <div className=\"main-panel\">\n        {this.props.children}\n      </div>\n    );\n  }\n}\n\nMainPanel.propTypes = propTypes;\n\nexport default MainPanel;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\n\nconst propTypes = {\n  children: PropTypes.oneOfType([\n    PropTypes.array,\n    PropTypes.object\n  ]).isRequired,\n};\n\nclass DraftsView extends React.Component {\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\">\n          <div className=\"cur-view-path\">\n            <div className=\"path-container\">\n              <h3 className=\"sf-heading\">{gettext('Drafts')}</h3>\n            </div>\n          </div>\n          {this.props.children}\n        </div>\n      </div>\n    );\n  }\n}\n\nDraftsView.propTypes = propTypes;\n\nexport default DraftsView;\n","import React from 'react';\nimport moment from 'moment';\nimport PropTypes from 'prop-types';\nimport { Dropdown, DropdownMenu, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { gettext, siteRoot, lang } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nmoment.locale(lang);\nconst propTypes = {\n  draft: PropTypes.object.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  onFreezedItem: PropTypes.func.isRequired,\n  onUnfreezedItem: PropTypes.func.isRequired,\n  onDeleteHandler: PropTypes.func.isRequired,\n  onPublishHandler: PropTypes.func.isRequired,\n};\n\nclass DraftListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isMenuIconShow: false,\n      isItemMenuShow: false,\n      highlight: false,\n    };\n  }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isMenuIconShow: true,\n        highlight: true,\n      });\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isMenuIconShow: false,\n        highlight: false,\n      });\n    }\n  }\n\n  onDropdownToggleClick = (e) => {\n    e.preventDefault();\n    this.toggleOperationMenu(e);\n  }\n\n  toggleOperationMenu = (e) => {\n    e.stopPropagation();\n    this.setState(\n      {isItemMenuShow: !this.state.isItemMenuShow }, () => {\n        if (this.state.isItemMenuShow) {\n          this.props.onFreezedItem();\n        } else {\n          this.setState({\n            highlight: false,\n            isMenuIconShow: false,\n          });\n          this.props.onUnfreezedItem();\n        }\n      }\n    );\n  }\n\n  onDeleteHandler = () => {\n    this.props.onDeleteHandler(this.props.draft);\n  }\n\n  onPublishHandler = () => {\n    this.props.onPublishHandler(this.props.draft);\n  }\n\n  render() {\n    let draft = this.props.draft;\n    let repoID = draft.origin_repo_id;\n    let filePath = draft.draft_file_path;\n    let fileName = Utils.getFileName(filePath);\n    let draftUrl = siteRoot + 'drafts/' + draft.id + '/';\n    let libraryUrl = siteRoot + 'library/' + repoID + '/' + encodeURIComponent(draft.repo_name) + '/' ;\n    let localTime = moment.utc(draft.updated_at).toDate();\n    localTime = moment(localTime).fromNow();\n\n    let iconUrl = Utils.getFileIconUrl(fileName);\n    return (\n      <tr className={this.state.highlight ? 'tr-highlight' : ''} onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td className=\"text-center\"><img src={iconUrl} width=\"24\" alt='' /></td>\n        <td className=\"name\" >\n          <a href={draftUrl} target=\"_blank\">{fileName}</a>\n        </td>\n        <td className=\"library\">\n          <a href={libraryUrl} target=\"_blank\">{draft.repo_name}</a>\n        </td>\n        <td className=\"update\">{localTime}</td>\n        <td className=\"text-center\">\n          {this.state.isMenuIconShow && (\n            <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.toggleOperationMenu}>\n              <DropdownToggle\n                tag=\"i\"\n                className=\"fas fa-ellipsis-v attr-action-icon\"\n                title={gettext('More Operations')}\n                onClick={this.onDropdownToggleClick}\n                data-toggle=\"dropdown\"\n                aria-expanded={this.state.isItemMenuShow}\n              />\n              <DropdownMenu>\n                <DropdownItem onClick={this.onDeleteHandler}>{gettext('Delete')}</DropdownItem>\n                {draft.status == 'open' &&\n                  <DropdownItem onClick={this.onPublishHandler}>{gettext('Publish')}</DropdownItem>\n                }\n              </DropdownMenu>\n            </Dropdown>\n          )}\n        </td>\n      </tr>\n    );\n  }\n}\n\nDraftListItem.propTypes = propTypes;\n\nexport default DraftListItem;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport DraftListItem from './draft-list-item';\n\nconst propTypes = {\n  draftList: PropTypes.array.isRequired,\n  onDeleteHandler: PropTypes.func.isRequired,\n  onPublishHandler: PropTypes.func.isRequired,\n};\n\nclass DraftListView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n    };\n  }\n\n  onFreezedItem = () => {\n    this.setState({isItemFreezed: true});\n  }\n\n  onUnfreezedItem = () => {\n    this.setState({isItemFreezed: false});\n  }\n\n  render() {\n    let drafts = this.props.draftList;\n    return (\n      <table>\n        <thead>\n          <tr>\n            <th style={{width: '4%'}}>{/*img*/}</th>\n            <th style={{width: '46%'}}>{gettext('Name')}</th>\n            <th style={{width: '30%'}}>{gettext('Library')}</th>\n            <th style={{width: '10%'}}>{gettext('Last Update')}</th>\n            <th style={{width: '10%'}}></th>\n          </tr>\n        </thead>\n        <tbody>\n          { drafts && drafts.map((draft) => {\n            return (\n              <DraftListItem\n                key={draft.id}\n                draft={draft}\n                isItemFreezed={this.state.isItemFreezed}\n                onFreezedItem={this.onFreezedItem}\n                onUnfreezedItem={this.onUnfreezedItem}\n                onDeleteHandler={this.props.onDeleteHandler}\n                onPublishHandler={this.props.onPublishHandler}\n              />\n            );\n          })}\n        </tbody>\n      </table>\n    );\n  }\n}\n\nDraftListView.propTypes = propTypes;\n\nexport default DraftListView;\n","import React, { Fragment } from 'react';\nimport { gettext } from '../../utils/constants';\nimport editUtilities from '../../utils/editor-utilities';\nimport { Utils } from '../../utils/utils';\nimport PropTypes from 'prop-types';\nimport toaster from '../../components/toast';\nimport EmptyTip from '../../components/empty-tip';\nimport Loading from '../../components/loading';\nimport DraftListView from '../../components/draft-list-view/draft-list-view';\n\nconst propTypes = {\n  isLoadingDraft: PropTypes.bool.isRequired,\n  updateDraftsList: PropTypes.func.isRequired,\n  draftList: PropTypes.array.isRequired,\n  getDrafts: PropTypes.func.isRequired,\n};\n\nclass DraftContent extends React.Component {\n\n  componentDidMount() {\n    this.props.getDrafts();\n  }\n\n  onDeleteHandler = (draft) => {\n    // let draft = this.state.currentDraft;\n    let draft_name = Utils.getFileName(draft.draft_file_path);\n    editUtilities.deleteDraft(draft.id).then(res => {\n      this.props.updateDraftsList(draft.id);\n      let msg_s = gettext('Successfully deleted draft %(draft)s.');\n      msg_s = msg_s.replace('%(draft)s', draft_name);\n      toaster.success(msg_s);\n    }).catch(() => {\n      let msg_s = gettext('Failed to delete draft %(draft)s.');\n      msg_s = msg_s.replace('%(draft)s', draft_name);\n      toaster.danger(msg_s);\n    });\n  }\n\n  onPublishHandler = (draft) => {\n    // let draft = this.state.currentDraft;\n    let draft_name = Utils.getFileName(draft.draft_file_path);\n    editUtilities.publishDraft(draft.id).then(res => {\n      this.props.updateDraftsList(draft.id);\n      let msg_s = gettext('Successfully published draft %(draft)s.');\n      msg_s = msg_s.replace('%(draft)s', draft_name);\n      toaster.success(msg_s);\n    }).catch(() => {\n      let msg_s = gettext('Failed to publish draft %(draft)s.');\n      msg_s = msg_s.replace('%(draft)s', draft_name);\n      toaster.danger(msg_s);\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"cur-view-content\">\n        {this.props.isLoadingDraft && <Loading />}\n        {!this.props.isLoadingDraft && (\n          <Fragment>\n            {this.props.draftList.length === 0 && (\n              <EmptyTip>\n                <h2>{gettext('No draft yet')}</h2>\n                <p>{gettext('Draft is a way to let you collaborate with others on files. You can create a draft from a file, edit the draft and then ask for a review. The original file will be updated only after the draft has been reviewed.')}</p>\n              </EmptyTip>\n            )}\n            {this.props.draftList.length !==0 && (\n              <DraftListView\n                draftList={this.props.draftList}\n                onDeleteHandler={this.onDeleteHandler}\n                onPublishHandler={this.onPublishHandler}\n              />\n            )}\n          </Fragment>\n        )}\n      </div>\n    );\n  }\n}\n\nDraftContent.propTypes = propTypes;\n\nexport default DraftContent;\n","class Acticity {\n  constructor(json) {\n    this.repo_id = json.repo_id;\n    this.repo_name = json.repo_name;\n    this.obj_type = json.obj_type;\n    this.commit_id = json.commit_id;\n    this.path = json.path;\n    this.name = json.name;\n    this.author_email = json.author_email;\n    this.author_name = json.author_name;\n    this.author_contact_email = json.author_contact_email;\n    this.avatar_url = json.avatar_url;\n    this.time = json.time;\n    this.op_type = json.op_type;\n    this.createdFilesCount = 0;\n    this.createdFilesList = [];\n    if (json.op_type === 'clean-up-trash') {\n      this.days = json.days;\n    } else if (json.op_type === 'rename' && json.obj_type === 'repo') {\n      this.old_repo_name = json.old_repo_name;\n    } else if (json.op_type === 'move' && ['dir', 'file'].includes(json.obj_type)) {\n      this.old_path = json.old_path;\n    } else if (json.op_type === 'rename' && ['dir', 'file'].includes(json.obj_type)) {\n      this.old_path = json.old_path;\n      this.old_name = json.old_name;\n    } else if (json.op_type === 'publish') {\n      this.old_path = json.old_path;\n    } else if (json.name.endsWith('(draft).md')) {\n      this.draft_id = json.draft_id;\n    }\n  }\n}\n\nexport default Acticity;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Table } from 'reactstrap';\nimport { gettext, siteRoot, serviceURL } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  activity: PropTypes.object.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n};\n\nclass ListCreatedFileDialog extends React.Component {\n\n  toggle = (activity) => {\n    this.props.toggleCancel(activity);\n  }\n\n  render() {\n    let activity = this.props.activity;\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.toggle}>{gettext('Created Files')}</ModalHeader>\n        <ModalBody>\n          <Table>\n            <thead>\n              <tr>\n                <th width='75%'>{gettext('Name')}</th>\n                <th width='25%'>{gettext('Time')}</th>\n              </tr>\n            </thead>\n            <tbody>\n              {\n                activity.createdFilesList.map((item, index) => {\n                  let fileURL = `${siteRoot}lib/${item.repo_id}/file${Utils.encodePath(item.path)}`;\n                  if (item.name.endsWith('(draft).md')) {\n                    fileURL = serviceURL + '/drafts/' + item.draft_id + '/';\n                  }\n                  let fileLink = <a href={fileURL} target='_blank'>{item.name}</a>;\n                  if (item.name.endsWith('(draft).md') && !item.draft_id) {\n                    fileLink = item.name;\n                  }\n                  return (\n                    <tr key={index}>\n                      <td>{fileLink}</td>\n                      <td>{moment(item.time).fromNow()}</td>\n                    </tr>\n                  );\n                })\n              }\n            </tbody>\n          </Table>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle.bind(this, activity)}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nListCreatedFileDialog.propTypes = propTypes;\n\nexport default ListCreatedFileDialog;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, siteRoot, serviceURL } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../../components/loading';\nimport Activity from '../../models/activity';\nimport ListCreatedFileDialog from '../../components/dialog/list-created-files-dialog';\nimport ModalPortal from '../../components/modal-portal';\n\nimport '../../css/files-activities.css';\n\nmoment.locale(window.app.config.lang);\n\nconst contentPropTypes = {\n  isLoadingMore: PropTypes.bool.isRequired,\n  items: PropTypes.array.isRequired,\n};\n\nclass FileActivitiesContent extends Component {\n\n  render() {\n    const isDesktop = Utils.isDesktop();\n    let { items, isLoadingMore } = this.props;\n\n    const desktopThead = (\n      <thead>\n        <tr>\n          <th width=\"8%\">{/* avatar */}</th>\n          <th width=\"15%\">{gettext('User')}</th>\n          <th width=\"20%\">{gettext('Operation')}</th>\n          <th width=\"37%\">{gettext('File')} / {gettext('Library')}</th>\n          <th width=\"20%\">{gettext('Time')}</th>\n        </tr>\n      </thead>\n    );\n\n    const mobileThead = (\n      <thead>\n        <tr>\n          <th width=\"15%\"></th>\n          <th width=\"53%\"></th>\n          <th width=\"32%\"></th>\n        </tr>\n      </thead>\n    );\n\n    return (\n      <Fragment>\n        <table className=\"table-hover table-thead-hidden\">\n          {isDesktop ? desktopThead : mobileThead}\n          <tbody>\n            {items.map((item, index) => {\n              return (\n                <ActivityItem\n                  key={index}\n                  isDesktop={isDesktop}\n                  item={item}\n                  index={index}\n                  items={items}\n                />\n              );\n            })}\n          </tbody>\n        </table>\n        {isLoadingMore ? <span className=\"loading-icon loading-tip\"></span> : ''}\n      </Fragment>\n    );\n  }\n}\n\nFileActivitiesContent.propTypes = contentPropTypes;\n\nconst activityPropTypes = {\n  item: PropTypes.object.isRequired,\n  index: PropTypes.number.isRequired,\n  items: PropTypes.array.isRequired,\n};\n\nclass ActivityItem extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isListCreatedFiles: false,\n    };\n  }\n\n  onListCreatedFilesToggle = () => {\n    this.setState({\n      isListCreatedFiles: !this.state.isListCreatedFiles,\n    });\n  }\n\n  render() {\n    const isDesktop = this.props.isDesktop;\n    let {item, index, items} = this.props;\n    let op, details, moreDetails = false;\n    let userProfileURL = `${siteRoot}profile/${encodeURIComponent(item.author_email)}/`;\n\n    let libURL = siteRoot + 'library/' + item.repo_id + '/' + encodeURIComponent(item.repo_name) + '/';\n    let libLink = <a href={libURL}>{item.repo_name}</a>;\n    let smallLibLink = <a className=\"small text-secondary\" href={libURL}>{item.repo_name}</a>;\n\n    if (item.obj_type == 'repo') {\n      switch(item.op_type) {\n        case 'create':\n          op = gettext('Created library');\n          details = libLink;\n          break;\n        case 'rename':\n          op = gettext('Renamed library');\n          details = <span>{item.old_repo_name} => {libLink}</span>;\n          break;\n        case 'delete':\n          op = gettext('Deleted library');\n          details = item.repo_name;\n          break;\n        case 'recover':\n          op = gettext('Restored library');\n          details = libLink;\n          break;\n        case 'clean-up-trash':\n          op = gettext('Cleaned trash');\n          if (item.days == 0) {\n            details = gettext('Removed all items from trash.');\n          } else {\n            details = gettext('Removed items older than {n} days from trash.').replace('{n}', item.days);\n          }\n          moreDetails = true;\n          break;\n      }\n    } else if (item.obj_type == 'draft') {\n      let fileURL = `${siteRoot}lib/${item.repo_id}/file${Utils.encodePath(item.path)}`;\n      let fileLink = <a href={fileURL} target=\"_blank\">{item.name}</a>;\n      op = gettext('Publish draft');\n      details = fileLink;\n      moreDetails = true;\n    } else if (item.obj_type == 'files') {\n      let fileURL = `${siteRoot}lib/${item.repo_id}/file${Utils.encodePath(item.path)}`;\n      if (item.name.endsWith('(draft).md')) {\n        fileURL = serviceURL + '/drafts/' + item.draft_id + '/';\n      }\n      let fileLink = `<a href=${fileURL} target=\"_blank\">${item.name}</a>`;\n      if (item.name.endsWith('(draft).md') && !item.draft_id) {\n        fileLink = item.name;\n      }\n      let fileCount = item.createdFilesCount - 1;\n      let firstLine = gettext('{file} and {n} other files')\n        .replace('{file}', fileLink)\n        .replace('{n}', fileCount);\n      op = gettext('Created {n} files').replace('{n}', item.createdFilesCount);\n      details = (\n        <Fragment>\n          <p className=\"m-0 d-inline\" dangerouslySetInnerHTML={{__html: firstLine}}></p>\n          {isDesktop && <button type=\"button\" onClick={this.onListCreatedFilesToggle} className=\"activity-details text-secondary ml-2 border-0 p-0 bg-transparent\">{gettext('details')}</button>}\n        </Fragment>\n      );\n      moreDetails = true;\n    } else if (item.obj_type == 'file') {\n      const isDraft = item.name.endsWith('(draft).md');\n      const fileURL = isDraft ? serviceURL + '/drafts/' + item.draft_id + '/' :\n        `${siteRoot}lib/${item.repo_id}/file${Utils.encodePath(item.path)}`;\n      let fileLink = <a href={fileURL} target=\"_blank\">{item.name}</a>;\n      if (isDraft && !item.draft_id) {\n        fileLink = item.name;\n      }\n      switch (item.op_type) {\n        case 'create':\n          op = isDraft ? gettext('Created draft') : gettext('Created file');\n          details = fileLink;\n          moreDetails = true;\n          break;\n        case 'delete':\n          op = isDraft ? gettext('Deleted draft') : gettext('Deleted file');\n          details = item.name;\n          moreDetails = true;\n          break;\n        case 'recover':\n          op = gettext('Restored file');\n          details = fileLink;\n          moreDetails = true;\n          break;\n        case 'rename':\n          op = gettext('Renamed file');\n          details = <span>{item.old_name} => {fileLink}</span>;\n          moreDetails = true;\n          break;\n        case 'move':\n          const filePathLink = <a href={fileURL}>{item.path}</a>;\n          op = gettext('Moved file');\n          details = <span>{item.old_path} => {filePathLink}</span>;\n          moreDetails = true;\n          break;\n        case 'edit': // update\n          op = isDraft ? gettext('Updated draft') : gettext('Updated file');\n          details = fileLink;\n          moreDetails = true;\n          break;\n      }\n    } else { // dir\n      let dirURL = siteRoot + 'library/' + item.repo_id + '/' + encodeURIComponent(item.repo_name) + Utils.encodePath(item.path);\n      let dirLink = <a href={dirURL} target=\"_blank\">{item.name}</a>;\n      switch (item.op_type) {\n        case 'create':\n          op = gettext('Created folder');\n          details = dirLink;\n          moreDetails = true;\n          break;\n        case 'delete':\n          op = gettext('Deleted folder');\n          details = item.name;\n          moreDetails = true;\n          break;\n        case 'recover':\n          op = gettext('Restored folder');\n          details = dirLink;\n          moreDetails = true;\n          break;\n        case 'rename':\n          op = gettext('Renamed folder');\n          details = <span>{item.old_name} => {dirLink}</span>;\n          moreDetails = true;\n          break;\n        case 'move':\n          const dirPathLink = <a href={dirURL}>{item.path}</a>;\n          op = gettext('Moved folder');\n          details = <span>{item.old_path} => {dirPathLink}</span>;\n          moreDetails = true;\n          break;\n      }\n    }\n\n    let isShowDate = true;\n    if (index > 0) {\n      let lastEventTime = items[index - 1].time;\n      isShowDate = moment(item.time).isSame(lastEventTime, 'day') ? false : true;\n    }\n\n    return (\n      <Fragment>\n        {isShowDate &&\n          <tr>\n            <td colSpan={isDesktop ? 5 : 3} className=\"border-top-0\">{moment(item.time).format('YYYY-MM-DD')}</td>\n          </tr>\n        }\n        {isDesktop ? (\n          <tr>\n            <td className=\"text-center\">\n              <img src={item.avatar_url} alt=\"\" width=\"32\" height=\"32\" className=\"avatar\" />\n            </td>\n            <td>\n              <a href={userProfileURL}>{item.author_name}</a>\n            </td>\n            <td>{op}</td>\n            <td>\n              {details}\n              {moreDetails && <br /> }\n              {moreDetails && smallLibLink}\n            </td>\n            <td className=\"text-secondary\">\n              <time datetime={item.time} is=\"relative-time\" title={moment(item.time).format('llll')}>{moment(item.time).fromNow()}</time>\n            </td>\n          </tr>\n        ) : (\n          <tr>\n            <td className=\"text-center align-top\">\n              <img src={item.avatar_url} alt=\"\" width=\"32\" height=\"32\" className=\"avatar\" />\n            </td>\n            <td>\n              <a href={userProfileURL}>{item.author_name}</a>\n              <p className=\"m-0 text-secondary\">{op}</p>\n              {details}\n            </td>\n            <td className=\"text-right align-top\">\n              <span className=\"text-secondary mobile-activity-time\">\n                <time datetime={item.time} is=\"relative-time\" title={moment(item.time).format('llll')}>{moment(item.time).fromNow()}</time>\n              </span>\n              {moreDetails && <br /> }\n              {moreDetails && libLink}\n            </td>\n          </tr>\n        )}\n        {this.state.isListCreatedFiles &&\n          <ModalPortal>\n            <ListCreatedFileDialog\n              activity={item}\n              toggleCancel={this.onListCreatedFilesToggle}\n            />\n          </ModalPortal>\n        }\n      </Fragment>\n    );\n  }\n}\n\nActivityItem.propTypes = activityPropTypes;\n\nclass FilesActivities extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      errorMsg: '',\n      isFirstLoading: true,\n      isLoadingMore: false,\n      currentPage: 1,\n      hasMore: true,\n      items: [],\n    };\n    this.avatarSize = 72;\n    this.curPathList = [];\n    this.oldPathList = [];\n  }\n\n  componentDidMount() {\n    let currentPage = this.state.currentPage;\n    seafileAPI.listActivities(currentPage, this.avatarSize).then(res => {\n      // {\"events\":[...]}\n      let events = this.mergePublishEvents(res.data.events);\n      events = this.mergeFileCreateEvents(events);\n      this.setState({\n        items: events,\n        currentPage: currentPage + 1,\n        isFirstLoading: false,\n        hasMore: true,\n      });\n      if (this.state.items.length < 25) {\n        this.getMore();\n      }\n    }).catch(error => {\n      this.setState({\n        isFirstLoading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  mergePublishEvents = (events) => {\n    events.map((item) => {\n      if (item.op_type === 'publish') {\n        this.curPathList.push(item.path);\n        this.oldPathList.push(item.old_path);\n      }\n    });\n    let actuallyEvents = [];\n    for (var i = 0; i < events.length; i++) {\n      if (events[i].obj_type === 'file') {\n        if (events[i].op_type === 'delete' && this.oldPathList.includes(events[i].path)) {\n          this.oldPathList.splice(this.oldPathList.indexOf(events[i].path), 1);\n        } else if (events[i].op_type === 'edit' && this.curPathList.includes(events[i].path)) {\n          this.curPathList.splice(this.curPathList.indexOf(events[i].path), 1);\n        } else if (events[i].op_type === 'rename' && this.oldPathList.includes(events[i].old_path)) {\n          this.oldPathList.splice(this.oldPathList.indexOf(events[i].old_path), 1);\n        } else {\n          actuallyEvents.push(events[i]);\n        }\n      } else {\n        actuallyEvents.push(events[i]);\n      }\n    }\n    return actuallyEvents;\n  }\n\n  mergeFileCreateEvents = (events) => {\n    let actuallyEvents = [];\n    let multiFilesActivity = null;\n    for (var i = 0; i < events.length; i++) {\n      let isFulfilCondition = events[i].obj_type === 'file' &&\n                              events[i].op_type === 'create' &&\n                              events[i + 1] &&\n                              events[i + 1].obj_type === 'file' &&\n                              events[i + 1].op_type === 'create' &&\n                              events[i + 1].repo_name === events[i].repo_name &&\n                              events[i + 1].author_email === events[i].author_email;\n      if (multiFilesActivity != null) {\n        multiFilesActivity.createdFilesCount++;\n        multiFilesActivity.createdFilesList.push(events[i]);\n        if (isFulfilCondition) {\n          continue;\n        } else {\n          actuallyEvents.push(multiFilesActivity);\n          multiFilesActivity = null;\n        }\n      } else {\n        if (isFulfilCondition) {\n          multiFilesActivity = new Activity(events[i]);\n          multiFilesActivity.obj_type = 'files';\n          multiFilesActivity.createdFilesCount++;\n          multiFilesActivity.createdFilesList.push(events[i]);\n        } else {\n          actuallyEvents.push(events[i]);\n        }\n      }\n    }\n    return actuallyEvents;\n  }\n\n  getMore() {\n    let currentPage = this.state.currentPage;\n    seafileAPI.listActivities(currentPage, this.avatarSize).then(res => {\n      // {\"events\":[...]}\n      let events = this.mergePublishEvents(res.data.events);\n      events = this.mergeFileCreateEvents(events);\n      this.setState({\n        isLoadingMore: false,\n        items: [...this.state.items, ...events],\n        currentPage: currentPage + 1,\n        hasMore: res.data.events.length === 0 ? false : true\n      });\n      if (this.state.items.length < 25 && this.state.hasMore) {\n        this.getMore();\n      }\n    }).catch(error => {\n      this.setState({\n        isLoadingMore: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  handleScroll = (event) => {\n    if (!this.state.isLoadingMore && this.state.hasMore) {\n      const clientHeight = event.target.clientHeight;\n      const scrollHeight = event.target.scrollHeight;\n      const scrollTop    = event.target.scrollTop;\n      const isBottom = (clientHeight + scrollTop + 1 >= scrollHeight);\n      if (isBottom) { // scroll to the bottom\n        this.setState({isLoadingMore: true}, () => {\n          this.getMore();\n        });\n      }\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\" id=\"activities\">\n          <div className=\"cur-view-path\">\n            <h3 className=\"sf-heading\">{gettext('Activities')}</h3>\n          </div>\n          <div className=\"cur-view-content d-block\" onScroll={this.handleScroll}>\n            {this.state.isFirstLoading && <Loading />}\n            {(!this.state.isFirstLoading && this.state.errorMsg) &&\n              <p className=\"error text-center\">{this.state.errorMsg}</p>\n            }\n            {!this.state.isFirstLoading &&\n              <FileActivitiesContent items={this.state.items} isLoadingMore={this.state.isLoadingMore}/>\n            }\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default FilesActivities;\n","import React, { Component } from 'react';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { Link, navigate } from '@gatsbyjs/reach-router';\nimport moment from 'moment';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport { gettext, siteRoot, enableVideoThumbnail } from '../../utils/constants';\nimport EmptyTip from '../../components/empty-tip';\nimport Loading from '../../components/loading';\nimport toaster from '../../components/toast';\n\nclass Content extends Component {\n\n  render() {\n    const {loading, errorMsg, items} = this.props.data;\n\n    if (loading) {\n      return <Loading />;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const emptyTip = (\n        <EmptyTip>\n          <h2>{gettext('No favorites')}</h2>\n          <p>{gettext('You have not added any libraries, folders or files to your favorites yet. A favorite gives you quick access to your most frequently used objects. You can add a library, folder or file to your favorites by clicking the star to the left of its name.')}</p>\n        </EmptyTip>\n      );\n\n      const desktopThead = (\n        <thead>\n          <tr>\n            <th width=\"4%\"></th>\n            <th width=\"40%\">{gettext('Name')}</th>\n            <th width=\"32%\">{gettext('Library')}</th>\n            <th width=\"18%\">{gettext('Last Update')}</th>\n            <th width=\"6%\"></th>\n          </tr>\n        </thead>\n      );\n      const mobileThead = (\n        <thead>\n          <tr>\n            <th width=\"12%\"></th>\n            <th width=\"80%\"></th>\n            <th width=\"8%\"></th>\n          </tr>\n        </thead>\n      );\n\n      const isDesktop = Utils.isDesktop();\n      return items.length ? (\n        <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n          {isDesktop ? desktopThead : mobileThead}\n          <TableBody items={items} />\n        </table>\n      ) : emptyTip;\n    }\n  }\n}\n\nclass TableBody extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      items: this.props.items\n    };\n  }\n\n  componentDidMount() {\n    this.getThumbnails();\n  }\n\n  getThumbnails() {\n    let items = this.state.items.filter((item) => {\n      return (Utils.imageCheck(item.obj_name) || (enableVideoThumbnail && Utils.videoCheck(item.obj_name))) && !item.repo_encrypted;\n    });\n    if (items.length == 0) {\n      return ;\n    }\n\n    const len = items.length;\n    const thumbnailSize = 48;\n    const _this = this;\n    let getThumbnail = function(i) {\n      const curItem = items[i];\n      seafileAPI.createThumbnail(curItem.repo_id, curItem.path, thumbnailSize).then((res) => {\n        curItem.encoded_thumbnail_src = res.data.encoded_thumbnail_src;\n      }).catch((error) => {\n        // do nothing\n      }).then(() => {\n        if (i < len - 1) {\n          getThumbnail(++i);\n        } else {\n          // when done, `setState()`\n          _this.setState({\n            items: _this.state.items\n          });\n        }\n      });\n    };\n    getThumbnail(0);\n  }\n\n  render() {\n\n    let listItems = this.state.items.map(function(item, index) {\n\n      if (item.path === '/') {\n        item.item_icon_url = Utils.getDefaultLibIconUrl(false);\n      } else {\n        item.item_icon_url = item.is_dir ? Utils.getFolderIconUrl(false) : Utils.getFileIconUrl(item.obj_name);\n      }\n\n      item.encoded_path = Utils.encodePath(item.path);\n\n      item.thumbnail_url = item.encoded_thumbnail_src ? `${siteRoot}${item.encoded_thumbnail_src}` : '';\n      item.dirent_view_url = item.is_dir ? `${siteRoot}library/${item.repo_id}/${item.repo_name}${item.encoded_path}` : `${siteRoot}lib/${item.repo_id}/file${item.encoded_path}`;\n      // item is folder or file\n      if (item.encoded_path !== '/') {\n        item.dirent_view_url = item.dirent_view_url.replace(/\\/+$/, '');\n      }\n\n      item.mtime_relative = moment(item.mtime).fromNow();\n\n\n      return <Item key={index} data={item} />;\n    }, this);\n\n    return (\n      <tbody>{listItems}</tbody>\n    );\n  }\n}\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      showOpIcon: false,\n      unstarred: false,\n      isOpMenuOpen: false // for mobile\n    };\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  handleMouseOver = () => {\n    this.setState({\n      showOpIcon: true\n    });\n  }\n\n  handleMouseOut = () => {\n    this.setState({\n      showOpIcon: false\n    });\n  }\n\n  unstar = (e) => {\n    e.preventDefault();\n\n    const data = this.props.data;\n    seafileAPI.unstarItem(data.repo_id, data.path).then((res) => {\n      this.setState({unstarred: true});\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  visitItem = () => {\n    const data = this.props.data;\n    if (data.is_dir) {\n      navigate(data.dirent_view_url);\n    } else {\n      window.open(data.dirent_view_url);\n    }\n  }\n\n  render() {\n\n    if (this.state.unstarred) {\n      return null;\n    }\n\n    const data = this.props.data;\n\n    let opClasses = 'sf2-icon-x3 unstar action-icon';\n    opClasses += this.state.showOpIcon ? '' : ' invisible';\n    const linkUrl = data.dirent_view_url;\n\n    const desktopItem = (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut} onFocus={this.handleMouseOver}>\n        <td className=\"text-center\">\n          {\n            data.thumbnail_url ?\n              <img className=\"thumbnail\" src={data.thumbnail_url} alt=\"\" /> :\n              <img src={data.item_icon_url} alt={gettext('icon')} width=\"24\" />\n          }\n        </td>\n        <td>\n          { data.is_dir ?\n            <Link to={linkUrl}>{data.obj_name}</Link> :\n            <a className=\"normal\" href={data.dirent_view_url} target=\"_blank\">{data.obj_name}</a>\n          }\n        </td>\n        <td>{data.repo_name}</td>\n        <td dangerouslySetInnerHTML={{__html:data.mtime_relative}}></td>\n        <td>\n          <a href=\"#\" role=\"button\" className={opClasses} title={gettext('Unstar')} aria-label={gettext('Unstar')} onClick={this.unstar}></a>\n        </td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <tr>\n        <td className=\"text-center\" onClick={this.visitItem}>\n          {\n            data.thumbnail_url ?\n              <img className=\"thumbnail\" src={data.thumbnail_url} alt=\"\" /> :\n              <img src={data.item_icon_url} alt={gettext('icon')} width=\"24\" />\n          }\n        </td>\n        <td onClick={this.visitItem}>\n          { data.is_dir ?\n            <Link to={linkUrl}>{data.obj_name}</Link> :\n            <a className=\"normal\" href={data.dirent_view_url} target=\"_blank\">{data.obj_name}</a>\n          }\n          <br />\n          <span className=\"item-meta-info\">{data.repo_name}</span>\n          <span className=\"item-meta-info\" dangerouslySetInnerHTML={{__html:data.mtime_relative}}></span>\n        </td>\n        <td>\n          <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n            <DropdownToggle\n              tag=\"i\"\n              className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isOpMenuOpen}\n            />\n            <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n              <div className=\"mobile-operation-menu-bg-layer\"></div>\n              <div className=\"mobile-operation-menu\">\n                <DropdownItem className=\"mobile-menu-item\" onClick={this.unstar}>{gettext('Unstar')}</DropdownItem>\n              </div>\n            </div>\n          </Dropdown>\n        </td>\n      </tr>\n    );\n\n    return Utils.isDesktop() ? desktopItem : mobileItem;\n  }\n}\n\nclass Starred extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: []\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listStarredItems().then((res) => {\n      this.setState({\n        loading: false,\n        items: res.data.starred_item_list\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\" id=\"starred\">\n          <div className=\"cur-view-path\">\n            <h3 className=\"sf-heading\">{gettext('Favorites')}</h3>\n          </div>\n          <div className=\"cur-view-content\">\n            <Content data={this.state} />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Starred;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button, FormGroup, Label, Input } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\n\nconst propTypes = {\n  executeOperation: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass ConfirmUnlinkDevice extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isChecked: false\n    };\n  }\n\n  toggle = () => {\n    this.props.toggleDialog();\n  }\n\n  executeOperation = () => {\n    this.toggle();\n    this.props.executeOperation(this.state.isChecked);\n  }\n\n  onInputChange = (e) => {\n    this.setState({\n      isChecked: e.target.checked\n    });\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('Unlink device')}</ModalHeader>\n        <ModalBody>\n          <p>{gettext('Are you sure you want to unlink this device?')}</p>\n          <FormGroup check>\n            <Label check>\n              <Input type=\"checkbox\" checked={this.state.isChecked} onChange={this.onInputChange} />\n              <span>{gettext('Delete files from this device the next time it comes online.')}</span>\n            </Label>\n          </FormGroup>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.executeOperation}>{gettext('Unlink')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nConfirmUnlinkDevice.propTypes = propTypes;\n\nexport default ConfirmUnlinkDevice;\n","import React, { Component } from 'react';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport moment from 'moment';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext } from '../../utils/constants';\nimport toaster from '../../components/toast';\nimport EmptyTip from '../../components/empty-tip';\nimport ConfirmUnlinkDeviceDialog from '../../components/dialog/confirm-unlink-device';\nimport { Utils } from '../../utils/utils';\n\nclass Content extends Component {\n\n  render() {\n    const {loading, errorMsg, items} = this.props.data;\n\n    if (loading) {\n      return <span className=\"loading-icon loading-tip\"></span>;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const emptyTip = (\n        <EmptyTip>\n          <h2>{gettext('No linked devices')}</h2>\n          <p>{gettext('You have not accessed your files with any client (desktop or mobile) yet. Configure clients on your devices to access your data more comfortably.')}</p>\n        </EmptyTip>\n      );\n\n      const desktopThead = (\n        <thead>\n          <tr>\n            <th width=\"13%\">{gettext('Platform')}</th>\n            <th width=\"30%\">{gettext('Device Name')}</th>\n            <th width=\"30%\">{gettext('IP')}</th>\n            <th width=\"17%\">{gettext('Last Access')}</th>\n            <th width=\"10%\"></th>\n          </tr>\n        </thead>\n      );\n      const mobileThead = (\n        <thead>\n          <tr>\n            <th width=\"92%\"></th>\n            <th width=\"8%\"></th>\n          </tr>\n        </thead>\n      );\n\n      const isDesktop = Utils.isDesktop();\n      return items.length ? (\n        <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n          {isDesktop ? desktopThead : mobileThead}\n          <tbody>\n            {items.map((item, index) => {\n              return <Item key={index} data={item} isDesktop={isDesktop} />;\n            })}\n          </tbody>\n        </table>\n      ): emptyTip;\n    }\n  }\n}\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpMenuOpen: false, // for mobile\n      isOpIconShown: false,\n      unlinked: false,\n      isConfirmUnlinkDialogOpen: false\n    };\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  handleMouseOver = () => {\n    this.setState({\n      isOpIconShown: true\n    });\n  }\n\n  handleMouseOut = () => {\n    this.setState({\n      isOpIconShown: false\n    });\n  }\n\n  toggleDialog = () => {\n    this.setState({\n      isConfirmUnlinkDialogOpen: !this.state.isConfirmUnlinkDialogOpen\n    });\n  }\n\n  handleClick = (e) => {\n    e.preventDefault();\n\n    const data = this.props.data;\n    if (data.is_desktop_client) {\n      this.toggleDialog();\n    } else {\n      const wipeDevice = true;\n      this.unlinkDevice(wipeDevice);\n    }\n  }\n\n  unlinkDevice = (wipeDevice) => {\n    const data = this.props.data;\n    seafileAPI.unlinkDevice(data.platform, data.device_id, wipeDevice).then((res) => {\n      this.setState({\n        unlinked: true\n      });\n      let msg = gettext('Successfully unlinked %(name)s.');\n      msg = msg.replace('%(name)s', data.device_name);\n      toaster.success(msg);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    if (this.state.unlinked) {\n      return null;\n    }\n\n    const data = this.props.data;\n\n    let opClasses = 'sf2-icon-delete unlink-device action-icon';\n    opClasses += this.state.isOpIconShown ? '' : ' invisible';\n\n    const desktopItem = (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut} onFocus={this.handleMouseOver}>\n        <td>{data.platform}</td>\n        <td>{data.device_name}</td>\n        <td>{data.last_login_ip}</td>\n        <td>{moment(data.last_accessed).fromNow()}</td>\n        <td>\n          <a href=\"#\" className={opClasses} title={gettext('Unlink')} role=\"button\" aria-label={gettext('Unlink')} onClick={this.handleClick}></a>\n        </td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <tr>\n        <td>\n          {data.device_name}<br />\n          <span className=\"item-meta-info\">{data.last_login_ip}</span>\n          <span className=\"item-meta-info\">{moment(data.last_accessed).fromNow()}</span>\n          <span className=\"item-meta-info\">{data.platform}</span>\n        </td>\n        <td>\n          <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n            <DropdownToggle\n              tag=\"i\"\n              className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isOpMenuOpen}\n            />\n            <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n              <div className=\"mobile-operation-menu-bg-layer\"></div>\n              <div className=\"mobile-operation-menu\">\n                <DropdownItem className=\"mobile-menu-item\" onClick={this.handleClick}>{gettext('Unlink')}</DropdownItem>\n              </div>\n            </div>\n          </Dropdown>\n        </td>\n      </tr>\n    );\n\n    return (\n      <React.Fragment>\n        {this.props.isDesktop ? desktopItem : mobileItem}\n        {this.state.isConfirmUnlinkDialogOpen &&\n        <ConfirmUnlinkDeviceDialog\n          executeOperation={this.unlinkDevice}\n          toggleDialog={this.toggleDialog}\n        />\n        }\n      </React.Fragment>\n    );\n  }\n}\n\nclass LinkedDevices extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: []\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listLinkedDevices().then((res) => {\n      this.setState({\n        loading: false,\n        items: res.data\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\" id=\"linked-devices\">\n          <div className=\"cur-view-path\">\n            <h3 className=\"sf-heading\">{gettext('Linked Devices')}</h3>\n          </div>\n          <div className=\"cur-view-content\">\n            <Content data={this.state} />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default LinkedDevices;\n","class SharedRepoInfo {\n\n  constructor(object) {\n    this.repo_id = object.repo_id;\n    this.repo_name = object.repo_name;\n    this.share_type = object.share_type;\n    this.share_permission = object.share_permission;\n    this.share_permission_name = object.share_permission_name;\n    this.modifier_name = object.modifier_name;\n    this.modifier_email = object.modifier_email;\n    this.modifier_contact_email = object.modifier_contact_email;\n    this.encrypted = object.encrypted;\n    if (this.share_type === 'personal') {\n      this.is_admin = object.is_admin;\n      this.user_name = object.user_name;\n      this.user_email = object.user_email;\n      this.contact_email = object.contact_email;\n    } else if (this.share_type === 'group') {\n      this.is_admin = object.is_admin;\n      this.group_id = object.group_id;\n      this.group_name = object.group_name;\n    }\n  }\n\n}\n\nexport default SharedRepoInfo;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalBody } from 'reactstrap';\nimport { Utils } from '../../utils/utils';\nimport CustomPermission from '../../models/custom-permission';\nimport Loading from '../loading';\nimport toaster from '../toast';\nimport { seafileAPI } from '../../utils/seafile-api';\n\nconst propTypes = {\n  repoID: PropTypes.string,\n  currentPerm: PropTypes.string.isRequired,\n  permissions: PropTypes.array.isRequired,\n  changePerm: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass PermSelect extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isLoading: true,\n      currentOption: this.props.currentPerm,\n      customPermissions: []\n    };\n\n    this.customPermissions = null;\n  }\n\n  componentDidMount() {\n    if (this.props.repoID) {\n      this.listCustomPermissions();\n    } else {\n      this.setState({isLoading: false});\n    }\n  }\n\n  listCustomPermissions = () => {\n    const { repoID } = this.props;\n    seafileAPI.listCustomPermissions(repoID).then(res => {\n      const { permission_list: permissions } = res.data;\n      const customPermissions = permissions.map(item => new CustomPermission(item));\n      this.setState({\n        isLoading: false,\n        customPermissions: customPermissions\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n      this.setState({isLoading: false});\n    });\n  }\n\n  switchOption = (e) => {\n    if (!e.target.checked) {\n      return;\n    }\n\n    const currentOption = e.target.value;\n    this.setState({\n      currentOption: currentOption\n    });\n\n    this.props.changePerm(currentOption);\n    this.props.toggleDialog();\n  }\n\n  translatePermission = (permission) => {\n    let value = Utils.sharePerms(permission);\n    if (!value) {\n      const { customPermissions } = this.state;\n      const item = customPermissions.find(item => item.id + '' === permission);\n      value = item && item.name;\n    }\n    return value;\n    \n  }\n  \n  translateExplanation = (explanation) => {\n    let value = Utils.sharePermsExplanation(explanation);\n    if (!value) {\n      const { customPermissions } = this.state;\n      const item = customPermissions.find(item => item.id + '' === explanation);\n      value = item && item.description;\n    }\n    return value;\n  }\n\n  getPermissions = () => {\n    const { permissions } = this.props;\n    let newPermissions = permissions.slice();\n    const { customPermissions } = this.state;\n    if (!this.customPermissions) {\n      if (customPermissions.length > 0) {\n        customPermissions.forEach(item => {\n          newPermissions.push(item.id + '');\n        });\n      }\n      this.customPermissions = newPermissions;\n    }\n    return this.customPermissions;\n  }\n\n\n  render() {\n    const { isLoading, currentOption } = this.state;\n    let permissions = [];\n    if (!isLoading) {\n      permissions = this.getPermissions();\n    }\n\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleDialog}>\n        <ModalBody style={{maxHeight: '400px', overflow: 'auto'}}>\n          {isLoading && <Loading />}\n          {!isLoading && permissions.map((item, index) => {\n            return (\n              <div className=\"d-flex\" key={index}>\n                <input id={`option-${index}`} className=\"mt-1\" type=\"radio\" name=\"permission\" value={item} checked={currentOption == item} onChange={this.switchOption} />\n                <label htmlFor={`option-${index}`} className=\"ml-2\">\n                  {this.translatePermission(item)}\n                  <p className=\"text-secondary small m-0\">\n                    {this.translateExplanation(item)}\n                  </p>\n                </label>\n              </div>\n            );\n          })}\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nPermSelect.propTypes = propTypes;\n\nexport default PermSelect;\n","import React, { Fragment, Component } from 'react';\nimport { Link } from '@gatsbyjs/reach-router';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, siteRoot, isPro } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport EmptyTip from '../../components/empty-tip';\nimport SharePermissionEditor from '../../components/select-editor/share-permission-editor';\nimport SharedRepoInfo from '../../models/shared-repo-info';\nimport PermSelect from '../../components/dialog/perm-select';\n\nclass Content extends Component {\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  render() {\n    const { loading, errorMsg, items, sortBy, sortOrder } = this.props;\n\n    if (loading) {\n      return <span className=\"loading-icon loading-tip\"></span>;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const emptyTip = (\n        <EmptyTip>\n          <h2>{gettext('No libraries shared')}</h2>\n          <p>{gettext('You have not shared any libraries with other users yet. You can share a library with other users by clicking the share icon to the right of a library\\'s name in \"My Libraries\".')}</p>\n        </EmptyTip>\n      );\n\n      // sort\n      const sortByName = sortBy == 'name';\n      const sortIcon = sortOrder == 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>;\n\n      const isDesktop = Utils.isDesktop();\n      const table = (\n        <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n          <thead>\n            {isDesktop ? (\n              <tr>\n                <th width=\"4%\">{/*icon*/}</th>\n                <th width=\"34%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {sortByName && sortIcon}</a></th>\n                <th width=\"30%\">{gettext('Share To')}</th>\n                <th width=\"24%\">{gettext('Permission')}</th>\n                <th width=\"8%\"></th>\n              </tr>\n            ) : (\n              <tr>\n                <th width=\"12%\"></th>\n                <th width=\"80%\"></th>\n                <th width=\"8%\"></th>\n              </tr>\n            )}\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              return (<Item\n                key={index}\n                isDesktop={isDesktop}\n                item={item}\n              />);\n            })}\n          </tbody>\n        </table>\n      );\n\n      return items.length ? table : emptyTip;\n    }\n  }\n}\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n\n    let item = this.props.item;\n    this.state = {\n      share_permission: item.share_permission,\n      share_permission_name: item.share_permission_name,\n      is_admin: item.is_admin,\n      isOpIconShown: false,\n      isOpMenuOpen: false, // for mobile\n      isPermSelectDialogOpen: false, // for mobile\n      unshared: false,\n      isShowPermEditor: false,\n    };\n    let permissions = ['rw', 'r'];\n    this.permissions = permissions;\n    this.showAdmin = isPro && (item.share_type !== 'public');\n    if (this.showAdmin) {\n      permissions.push('admin');\n    }\n    if (isPro) {\n      permissions.push('cloud-edit', 'preview');\n    }\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  togglePermSelectDialog = () => {\n    this.setState({\n      isPermSelectDialogOpen: !this.state.isPermSelectDialogOpen\n    });\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOpIconShown: true});\n  }\n\n  onMouseLeave = () => {\n    this.setState({isOpIconShown: false});\n  }\n\n  changePerm = (permission) => {\n    const item = this.props.item;\n    const share_type = item.share_type;\n    let options = {\n      'share_type': share_type,\n      'permission': permission\n    };\n    if (share_type == 'personal') {\n      options.user = item.user_email;\n    } else if (share_type == 'group') {\n      options.group_id = item.group_id;\n    }\n\n    seafileAPI.updateRepoSharePerm(item.repo_id, options).then(() => {\n      this.setState({\n        share_permission: permission == 'admin' ? 'rw' : permission,\n        is_admin: permission == 'admin',\n      });\n      toaster.success(gettext('Successfully modified permission.'));\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  unshare = (e) => {\n    e.preventDefault();\n\n    const item = this.props.item;\n    const share_type = item.share_type;\n    let options = {\n      'share_type': share_type\n    };\n    if (share_type == 'personal') {\n      options.user = item.user_email;\n    } else if (share_type == 'group') {\n      options.group_id = item.group_id;\n    }\n\n    seafileAPI.unshareRepo(item.repo_id, options).then((res) => {\n      this.setState({\n        unshared: true\n      });\n      let message = gettext('Successfully unshared {name}').replace('{name}', item.repo_name);\n      toaster.success(message);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster(errMessage);\n    });\n  }\n\n  onEditPermission = (event) => {\n    event.nativeEvent.stopImmediatePropagation();\n    this.setState({isShowPermEditor: true});\n  }\n\n  render() {\n    if (this.state.unshared) {\n      return null;\n    }\n\n    let { share_permission, share_permission_name, is_admin, isOpIconShown, isPermSelectDialogOpen, isShowPermEditor } = this.state;\n    let item = this.props.item;\n    Object.assign(item, {\n      share_permission: share_permission,\n      is_admin: is_admin\n    });\n\n    let iconUrl = Utils.getLibIconUrl(item);\n    let iconTitle = Utils.getLibIconTitle(item);\n    let repoUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}/`;\n\n\n    let shareTo;\n    const shareType = item.share_type;\n    if (shareType == 'personal') {\n      shareTo = item.user_name;\n    } else if (shareType == 'group') {\n      shareTo = item.group_name;\n    } else if (shareType == 'public') {\n      shareTo = gettext('all members');\n    }\n\n    if (this.showAdmin && is_admin) {\n      share_permission = 'admin';\n    }\n\n    // custom defined permission\n    if (share_permission.startsWith('custom-')) {\n      share_permission = share_permission.slice(7);\n    }\n\n    const desktopItem = (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter}>\n        <td><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n        <td><Link to={repoUrl}>{item.repo_name}</Link></td>\n        <td>\n          {item.share_type == 'personal' ? <span title={item.contact_email}>{shareTo}</span> : shareTo}\n        </td>\n        <td>\n          {!isShowPermEditor && (\n            <div>\n              <span>{Utils.sharePerms(share_permission) || share_permission_name}</span>\n              {isOpIconShown && (\n                <a href=\"#\"\n                  role=\"button\"\n                  aria-label={gettext('Edit')}\n                  title={gettext('Edit')}\n                  className=\"fa fa-pencil-alt attr-action-icon\"\n                  onClick={this.onEditPermission}>\n                </a>\n              )}\n            </div>\n          )}\n          {isShowPermEditor && (\n            <SharePermissionEditor\n              repoID={item.repo_id}\n              isTextMode={true}\n              isEditing={true}\n              autoFocus={true}\n              isEditIconShow={this.state.isOpIconShown}\n              currentPermission={share_permission}\n              permissions={this.permissions}\n              onPermissionChanged={this.changePerm}\n            />\n          )}\n        </td>\n        <td><a href=\"#\" role=\"button\" aria-label={gettext('Unshare')} className={`action-icon sf2-icon-x3 ${isOpIconShown ? '': 'invisible'}`} title={gettext('Unshare')} onClick={this.unshare}></a></td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <Fragment>\n        <tr>\n          <td><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n          <td>\n            <Link to={repoUrl}>{item.repo_name}</Link>\n            <span className=\"item-meta-info-highlighted\">{Utils.sharePerms(share_permission)}</span>\n            <br />\n            <span className=\"item-meta-info\">{`${gettext('Share To:')} ${shareTo}`}</span>\n          </td>\n          <td>\n            <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n              <DropdownToggle\n                tag=\"i\"\n                className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n                title={gettext('More Operations')}\n                data-toggle=\"dropdown\"\n                aria-expanded={this.state.isOpMenuOpen}\n              />\n              <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n                <div className=\"mobile-operation-menu-bg-layer\"></div>\n                <div className=\"mobile-operation-menu\">\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.togglePermSelectDialog}>{gettext('Permission')}</DropdownItem>\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.unshare}>{gettext('Unshare')}</DropdownItem>\n                </div>\n              </div>\n            </Dropdown>\n          </td>\n        </tr>\n        {isPermSelectDialogOpen && (\n          <PermSelect\n            repoID={item.repo_id}\n            currentPerm={share_permission}\n            permissions={this.permissions}\n            changePerm={this.changePerm}\n            toggleDialog={this.togglePermSelectDialog}\n          />\n        )}\n      </Fragment>\n    );\n\n    return this.props.isDesktop ? desktopItem : mobileItem;\n  }\n}\n\nclass ShareAdminLibraries extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: [],\n      sortBy: 'name', // 'name' or 'time'\n      sortOrder: 'asc' // 'asc' or 'desc'\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listSharedRepos().then((res) => {\n      // res: {data: Array(2), status: 200, statusText: \"OK\", headers: {}, config: {},}\n      let items = res.data.map(item => {\n        return new SharedRepoInfo(item);\n      });\n      this.setState({\n        loading: false,\n        items: Utils.sortRepos(items, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      items: Utils.sortRepos(this.state.items, sortBy, sortOrder)\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\" id=\"share-admin-libs\">\n          <div className=\"cur-view-path\">\n            <h3 className=\"sf-heading\">{gettext('Libraries')}</h3>\n          </div>\n          <div className=\"cur-view-content\">\n            <Content\n              errorMsg={this.state.errorMsg}\n              loading={this.state.loading}\n              items={this.state.items}\n              sortBy={this.state.sortBy}\n              sortOrder={this.state.sortOrder}\n              sortItems={this.sortItems}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ShareAdminLibraries;\n","class SharedFolderInfo {\n\n  constructor(object) {\n    this.path = object.path;\n    this.folder_name = object.folder_name;\n    this.repo_id = object.repo_id;\n    this.repo_name = object.repo_name;\n    this.share_type = object.share_type;\n    this.share_permission = object.share_permission;\n    this.share_permission_name = object.share_permission_name;\n    if (object.share_type === 'group') {\n      this.group_id = object.group_id;\n      this.group_name = object.group_name;\n    } else {\n      this.user_name = object.user_name;\n      this.user_email = object.user_email;\n      this.contact_email = object.contact_email;\n    }\n  }\n\n}\n\nexport default SharedFolderInfo;\n","import React, { Fragment, Component } from 'react';\nimport { Link } from '@gatsbyjs/reach-router';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport { gettext, siteRoot, isPro } from '../../utils/constants';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport toaster from '../../components/toast';\nimport SharePermissionEditor from '../../components/select-editor/share-permission-editor';\nimport SharedFolderInfo from '../../models/shared-folder-info';\nimport PermSelect from '../../components/dialog/perm-select';\n\nclass Content extends Component {\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  render() {\n    const { loading, errorMsg, items, sortBy, sortOrder } = this.props;\n\n    if (loading) {\n      return <Loading />;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const emptyTip = (\n        <EmptyTip>\n          <h2>{gettext('No folders shared')}</h2>\n          <p>{gettext('You have not shared any folders with other users yet. You can share a folder with other users by clicking the share icon to the right of a folder\\'s name.')}</p>\n        </EmptyTip>\n      );\n\n      // sort\n      const sortByName = sortBy == 'name';\n      const sortIcon = sortOrder == 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>;\n\n      const isDesktop = Utils.isDesktop();\n      const table = (\n        <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n          <thead>\n            {isDesktop ? (\n              <tr>\n                <th width=\"4%\">{/*icon*/}</th>\n                <th width=\"34%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {sortByName && sortIcon}</a></th>\n                <th width=\"30%\">{gettext('Share To')}</th>\n                <th width=\"24%\">{gettext('Permission')}</th>\n                <th width=\"8%\"></th>\n              </tr>\n            ) : (\n              <tr>\n                <th width=\"12%\"></th>\n                <th width=\"80%\"></th>\n                <th width=\"8%\"></th>\n              </tr>\n            )}\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              return (<Item key={index} isDesktop={isDesktop} item={item} />);\n            })}\n          </tbody>\n        </table>\n      );\n\n      return items.length ? table : emptyTip;\n    }\n  }\n}\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      share_permission: this.props.item.share_permission,\n      share_permission_name: this.props.item.share_permission_name,\n      isOpIconShown: false,\n      isOpMenuOpen: false, // for mobile\n      isPermSelectDialogOpen: false, // for mobile\n      unshared: false,\n      isShowPermEditor: false,\n    };\n\n    this.permissions = ['rw', 'r'];\n    if (isPro) {\n      this.permissions.push('cloud-edit', 'preview');\n    }\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  togglePermSelectDialog = () => {\n    this.setState({\n      isPermSelectDialogOpen: !this.state.isPermSelectDialogOpen\n    });\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOpIconShown: true});\n  }\n\n  onMouseLeave = () => {\n    this.setState({isOpIconShown: false});\n  }\n\n  unshare = (e) => {\n    e.preventDefault();\n\n    const item = this.props.item;\n    let options = {\n      'p': item.path\n    };\n    if (item.share_type == 'personal') {\n      Object.assign(options, {\n        'share_type': 'user',\n        'username': item.user_email\n      });\n    } else {\n      Object.assign(options, {\n        'share_type': item.share_type, // 'group'\n        'group_id': item.group_id\n      });\n    }\n\n    seafileAPI.unshareFolder(item.repo_id, options).then((res) => {\n      this.setState({\n        unshared: true\n      });\n      let message = gettext('Successfully unshared {name}').replace('{name}', item.folder_name);\n      toaster.success(message);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster(errMessage);\n    });\n  }\n\n  changePerm = (permission) => {\n    const item = this.props.item;\n    const postData = {\n      'permission': permission\n    };\n    let options = {\n      'p': item.path\n    };\n    if (item.share_type == 'personal') {\n      Object.assign(options, {\n        'share_type': 'user',\n        'username': item.user_email\n      });\n    } else {\n      Object.assign(options, {\n        'share_type': item.share_type, // 'group'\n        'group_id': item.group_id\n      });\n    }\n\n    seafileAPI.updateFolderSharePerm(item.repo_id, postData, options).then((res) => {\n      this.setState({share_permission: permission});\n      toaster.success(gettext('Successfully modified permission.'));\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onEditPermission = (event) => {\n    event.nativeEvent.stopImmediatePropagation();\n    this.setState({isShowPermEditor: true});\n  }\n\n  render() {\n    if (this.state.unshared) {\n      return null;\n    }\n\n    const item = this.props.item;\n    let { share_permission, share_permission_name, isOpIconShown, isPermSelectDialogOpen, isShowPermEditor } = this.state;\n\n    let is_readonly = false;\n    if (share_permission == 'r' || share_permission == 'preview') {\n      is_readonly = true;\n    }\n    let iconUrl = Utils.getFolderIconUrl(is_readonly);\n    let iconTitle = Utils.getFolderIconTitle({\n      'permission': share_permission\n    });\n    let folderUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}${Utils.encodePath(item.path)}`;\n\n    // custom defined permission\n    if (share_permission.startsWith('custom-')) {\n      share_permission = share_permission.slice(7);\n    }\n    const desktopItem = (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter}>\n        <td><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n        <td><Link to={folderUrl}>{item.folder_name}</Link></td>\n        <td>\n          {item.share_type == 'personal' ?\n            <span title={item.contact_email}>{item.user_name}</span> : item.group_name}\n        </td>\n        <td>\n          {!isShowPermEditor && (\n            <div>\n              <span>{Utils.sharePerms(share_permission) || share_permission_name}</span>\n              {isOpIconShown && (\n                <a href=\"#\"\n                  role=\"button\"\n                  aria-label={gettext('Edit')}\n                  title={gettext('Edit')}\n                  className=\"fa fa-pencil-alt attr-action-icon\"\n                  onClick={this.onEditPermission}>\n                </a>\n              )}\n            </div>\n          )}\n          {isShowPermEditor && (\n            <SharePermissionEditor\n              repoID={item.repo_id}\n              isTextMode={true}\n              isEditIconShow={isOpIconShown}\n              isEditing={true}\n              autoFocus={true}\n              currentPermission={share_permission}\n              permissions={this.permissions}\n              onPermissionChanged={this.changePerm}\n            />\n          )}\n        </td>\n        <td><a href=\"#\" role=\"button\" aria-label={gettext('Unshare')} className={`action-icon sf2-icon-x3 ${isOpIconShown ? '': 'invisible'}`} title={gettext('Unshare')} onClick={this.unshare}></a></td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <Fragment>\n        <tr>\n          <td><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n          <td>\n            <Link to={folderUrl}>{item.folder_name}</Link>\n            <span className=\"item-meta-info-highlighted\">{Utils.sharePerms(share_permission)}</span>\n            <br />\n            <span className=\"item-meta-info\">{`${gettext('Share To:')} ${item.share_type == 'personal' ? item.user_name : item.group_name}`}</span>\n          </td>\n          <td>\n            <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n              <DropdownToggle\n                tag=\"i\"\n                className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n                title={gettext('More Operations')}\n                data-toggle=\"dropdown\"\n                aria-expanded={this.state.isOpMenuOpen}\n              />\n              <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n                <div className=\"mobile-operation-menu-bg-layer\"></div>\n                <div className=\"mobile-operation-menu\">\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.togglePermSelectDialog}>{gettext('Permission')}</DropdownItem>\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.unshare}>{gettext('Unshare')}</DropdownItem>\n                </div>\n              </div>\n            </Dropdown>\n          </td>\n        </tr>\n        {isPermSelectDialogOpen &&(\n          <PermSelect\n            repoID={item.repo_id}\n            currentPerm={share_permission}\n            permissions={this.permissions}\n            changePerm={this.changePerm}\n            toggleDialog={this.togglePermSelectDialog}\n          />\n        )}\n      </Fragment>\n    );\n\n    return this.props.isDesktop ? desktopItem : mobileItem;\n  }\n}\n\nclass ShareAdminFolders extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: [],\n      sortBy: 'name',\n      sortOrder: 'asc' // 'asc' or 'desc'\n    };\n  }\n\n  _sortItems = (items, sortBy, sortOrder) => {\n    let comparator;\n\n    switch (`${sortBy}-${sortOrder}`) {\n      case 'name-asc':\n        comparator = function(a, b) {\n          var result = Utils.compareTwoWord(a.folder_name, b.folder_name);\n          return result;\n        };\n        break;\n      case 'name-desc':\n        comparator = function(a, b) {\n          var result = Utils.compareTwoWord(a.folder_name, b.folder_name);\n          return -result;\n        };\n        break;\n    }\n\n    items.sort(comparator);\n    return items;\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      items: this._sortItems(this.state.items, sortBy, sortOrder)\n    });\n  }\n\n  componentDidMount() {\n    seafileAPI.listSharedFolders().then((res) => {\n      let items = res.data.map(item => {\n        return new SharedFolderInfo(item);\n      });\n      this.setState({\n        loading: false,\n        items: this._sortItems(items, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\" id=\"share-admin-libs\">\n          <div className=\"cur-view-path\">\n            <h3 className=\"sf-heading\">{gettext('Folders')}</h3>\n          </div>\n          <div className=\"cur-view-content\">\n            <Content\n              errorMsg={this.state.errorMsg}\n              loading={this.state.loading}\n              items={this.state.items}\n              sortBy={this.state.sortBy}\n              sortOrder={this.state.sortOrder}\n              sortItems={this.sortItems}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ShareAdminFolders;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalBody } from 'reactstrap';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  currentPerm: PropTypes.string.isRequired,\n  permissions: PropTypes.array.isRequired,\n  changePerm: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass ShareLinkPermissionSelect extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      currentOption: this.props.currentPerm\n    };\n  }\n\n  switchOption = (e) => {\n    if (!e.target.checked) {\n      return;\n    }\n\n    const currentOption = e.target.value;\n    this.setState({\n      currentOption: currentOption\n    });\n\n    this.props.changePerm(currentOption);\n    this.props.toggleDialog();\n  }\n\n  render() {\n    const options = this.props.permissions;\n    const { currentOption } = this.state;\n\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleDialog}>\n        <ModalBody>\n          {options.map((item, index) => {\n            return (\n              <div className=\"d-flex\" key={index}>\n                <input id={`option-${index}`} className=\"mt-1\" type=\"radio\" name=\"permission\" value={item} checked={currentOption == item} onChange={this.switchOption} />\n                <label htmlFor={`option-${index}`} className=\"ml-2\">\n                  {Utils.getShareLinkPermissionObject(item).text}\n                </label>\n              </div>\n            );\n          })}\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nShareLinkPermissionSelect.propTypes = propTypes;\n\nexport default ShareLinkPermissionSelect;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalBody } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\n\nconst propTypes = {\n  toggleDialog: PropTypes.func.isRequired,\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  sortOptions: PropTypes.array,\n  sortItems: PropTypes.func.isRequired\n};\n\nclass SortOptions extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.sortOptions = this.props.sortOptions || [\n      {value: 'name-asc', text: gettext('By name ascending')},\n      {value: 'name-desc', text: gettext('By name descending')},\n      {value: 'size-asc', text: gettext('By size ascending')},\n      {value: 'size-desc', text: gettext('By size descending')},\n      {value: 'time-asc', text: gettext('By time ascending')},\n      {value: 'time-desc', text: gettext('By time descending')}\n    ];\n    const { sortBy, sortOrder } = this.props;\n    this.state = {\n      currentOption: `${sortBy}-${sortOrder}`\n    };\n  }\n\n  switchOption = (e) => {\n    if (!e.target.checked) {\n      return;\n    }\n\n    this.setState({\n      currentOption: e.target.value\n    });\n\n    const [sortBy, sortOrder] = e.target.value.split('-');\n    this.props.sortItems(sortBy, sortOrder);\n    this.props.toggleDialog();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleDialog}>\n        <ModalBody>\n          {this.sortOptions.map((item, index) => {\n            return (\n              <Fragment key={index}>\n                <input id={`option-${index}`} className=\"align-middle\" type=\"radio\" name=\"sort-option\" value={item.value} checked={this.state.currentOption == item.value} onChange={this.switchOption} />\n                <label htmlFor={`option-${index}`} className=\"align-middle m-2\">{item.text}</label><br />\n              </Fragment>\n            );\n          })}\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nSortOptions.propTypes = propTypes;\n\nexport default SortOptions;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport CommonToolbar from './common-toolbar';\n\nconst propTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n  searchPlaceholder: PropTypes.string,\n  children: PropTypes.object\n};\n\nclass TopToolbar extends React.Component {\n\n  render() {\n    const { onShowSidePanel, onSearchedClick } = this.props;\n    return (\n      <div className=\"main-panel-north border-left-show\">\n        <div className=\"cur-view-toolbar\">\n          <span title=\"Side Nav Menu\" onClick={onShowSidePanel} className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\">\n          </span>\n          {this.props.children}\n        </div>\n        <CommonToolbar searchPlaceholder={this.props.searchPlaceholder} onSearchedClick={onSearchedClick} />\n      </div>\n    );\n  }\n}\n\nTopToolbar.propTypes = propTypes;\n\nexport default TopToolbar;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from '@gatsbyjs/reach-router';\nimport moment from 'moment';\nimport { Dropdown, DropdownToggle, DropdownItem, Button } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport { isPro, gettext, siteRoot, canGenerateUploadLink } from '../../utils/constants';\nimport ShareLink from '../../models/share-link';\nimport ShareLinkPermissionEditor from '../../components/select-editor/share-link-permission-editor';\nimport Loading from '../../components/loading';\nimport toaster from '../../components/toast';\nimport EmptyTip from '../../components/empty-tip';\nimport ShareLinkPermissionSelect from '../../components/dialog/share-link-permission-select';\nimport ShareAdminLink from '../../components/dialog/share-admin-link';\nimport SortOptionsDialog from '../../components/dialog/sort-options';\nimport CommonOperationConfirmationDialog from '../../components/dialog/common-operation-confirmation-dialog';\nimport TopToolbar from '../../components/toolbar/top-toolbar';\n\nconst contentPropTypes = {\n  loading: PropTypes.bool.isRequired,\n  errorMsg: PropTypes.string.isRequired,\n  items: PropTypes.array.isRequired,\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  sortItems: PropTypes.func.isRequired,\n  onRemoveLink: PropTypes.func.isRequired\n};\n\nclass Content extends Component {\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortByTime = (e) => {\n    e.preventDefault();\n    const sortBy = 'time';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  render() {\n    const { loading, errorMsg, items, sortBy, sortOrder } = this.props;\n\n    if (loading) {\n      return <Loading />;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const emptyTip = (\n        <EmptyTip>\n          <h2>{gettext('No share links')}</h2>\n          <p>{gettext('You have not created any share links yet. A share link can be used to share files and folders with anyone. You can create a share link for a file or folder by clicking the share icon to the right of its name.')}</p>\n        </EmptyTip>\n      );\n\n      // sort\n      const sortByName = sortBy == 'name';\n      const sortByTime = sortBy == 'time';\n      const sortIcon = sortOrder == 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>;\n\n      const isDesktop = Utils.isDesktop();\n      // only for some columns\n      const columnWidths = isPro ? ['14%', '7%', '14%'] : ['21%', '14%', '20%'];\n      const table = (\n        <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n          <thead>\n            {isDesktop ? (\n              <tr>\n                <th width=\"4%\">{/*icon*/}</th>\n                <th width=\"31%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {sortByName && sortIcon}</a></th>\n                <th width={columnWidths[0]}>{gettext('Library')}</th>\n                {isPro && <th width=\"20%\">{gettext('Permission')}</th>}\n                <th width={columnWidths[1]}>{gettext('Visits')}</th>\n                <th width={columnWidths[2]}><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByTime}>{gettext('Expiration')} {sortByTime && sortIcon}</a></th>\n                <th width=\"10%\">{/*Operations*/}</th>\n              </tr>\n            ) : (\n              <tr>\n                <th width=\"12%\"></th>\n                <th width=\"80%\"></th>\n                <th width=\"8%\"></th>\n              </tr>\n            )}\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              return (<Item key={index} isDesktop={isDesktop} item={item} onRemoveLink={this.props.onRemoveLink} />);\n            })}\n          </tbody>\n        </table>\n      );\n\n      return items.length ? table : emptyTip;\n    }\n  }\n}\n\nContent.propTypes = contentPropTypes;\n\nconst itemPropTypes = {\n  item: PropTypes.object.isRequired,\n  isDesktop: PropTypes.bool.isRequired,\n  onRemoveLink: PropTypes.func.isRequired\n};\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isOpIconShown: false,\n      isOpMenuOpen: false, // for mobile\n      isPermSelectDialogOpen: false, // for mobile\n      isLinkDialogOpen: false,\n      permissionOptions: [],\n      currentPermission: '',\n    };\n  }\n\n  componentDidMount() {\n    if (isPro) {\n      this.updatePermissionOptions();\n    }\n  }\n\n  updatePermissionOptions = () => {\n    const item = this.props.item;\n    let itemType = item.is_dir ? (item.path === '/' ? 'library' : 'dir') : 'file';\n    let permission = item.repo_folder_permission;\n    let permissionOptions = Utils.getShareLinkPermissionList(itemType, permission, item.path, item.can_edit);\n    let currentPermission = Utils.getShareLinkPermissionStr(this.props.item.permissions);\n    this.setState({\n      permissionOptions: permissionOptions,\n      currentPermission: currentPermission\n    });\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  togglePermSelectDialog = () => {\n    this.setState({\n      isPermSelectDialogOpen: !this.state.isPermSelectDialogOpen\n    });\n  }\n\n  toggleLinkDialog = () => {\n    this.setState({\n      isLinkDialogOpen: !this.state.isLinkDialogOpen\n    });\n  }\n\n  handleMouseOver = () => {\n    this.setState({isOpIconShown: true});\n  }\n\n  handleMouseOut = () => {\n    this.setState({isOpIconShown: false});\n  }\n\n  viewLink = (e) => {\n    e.preventDefault();\n    this.toggleLinkDialog();\n  }\n\n  removeLink = (e) => {\n    e.preventDefault();\n    this.props.onRemoveLink(this.props.item);\n  }\n\n  renderExpiration = () => {\n    const item = this.props.item;\n    if (!item.expire_date) {\n      return '--';\n    }\n    const expire_date = moment(item.expire_date).format('YYYY-MM-DD');\n    const expire_time = moment(item.expire_date).format('YYYY-MM-DD HH:mm:ss');\n    return (<span className={item.is_expired ? 'error' : ''} title={expire_time}>{expire_date}</span>);\n  }\n\n  changePerm = (permission) => {\n    const item = this.props.item;\n    const permissionDetails = Utils.getShareLinkPermissionObject(permission).permissionDetails;\n    seafileAPI.updateShareLink(item.token, JSON.stringify(permissionDetails)).then(() => {\n      this.setState({\n        currentPermission: permission\n      });\n      let message = gettext('Successfully modified permission.');\n      toaster.success(message);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    const item = this.props.item;\n    const { currentPermission, permissionOptions , isOpIconShown, isPermSelectDialogOpen, isLinkDialogOpen } = this.state;\n\n    let iconUrl, objUrl;\n    if (item.is_dir) {\n      let path = item.path === '/' ? '/' : item.path.slice(0, item.path.length - 1);\n      iconUrl = Utils.getFolderIconUrl(false);\n      objUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}${Utils.encodePath(path)}`;\n    } else {\n      iconUrl = Utils.getFileIconUrl(item.obj_name);\n      objUrl = `${siteRoot}lib/${item.repo_id}/file${Utils.encodePath(item.path)}`;\n    }\n\n    const deletedTip = item.obj_id === '' ? <span style={{color:'red'}}>{gettext('(deleted)')}</span> : null;\n    const desktopItem = (\n      <tr onMouseEnter={this.handleMouseOver} onMouseLeave={this.handleMouseOut} onFocus={this.handleMouseOver}>\n        <td><img src={iconUrl} width=\"24\" alt=\"\" /></td>\n        <td>\n          {item.is_dir ?\n            <Link to={objUrl}>{item.obj_name}</Link> :\n            <a href={objUrl} target=\"_blank\" rel=\"noreferrer\">{item.obj_name}</a>\n          }\n          {deletedTip}\n        </td>\n        <td><Link to={`${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}/`}>{item.repo_name}</Link></td>\n        {isPro &&\n        <td>\n          <ShareLinkPermissionEditor\n            isTextMode={true}\n            isEditIconShow={isOpIconShown && !item.is_expired}\n            currentPermission={currentPermission}\n            permissionOptions={permissionOptions}\n            onPermissionChanged={this.changePerm}\n          />\n        </td>\n        }\n        <td>{item.view_cnt}</td>\n        <td>{this.renderExpiration()}</td>\n        <td>\n          {!item.is_expired && <a href=\"#\" className={`sf2-icon-link action-icon ${isOpIconShown ? '': 'invisible'}`} title={gettext('View')} aria-label={gettext('View')} role=\"button\" onClick={this.viewLink}></a>}\n          <a href=\"#\" className={`sf2-icon-delete action-icon ${isOpIconShown ? '': 'invisible'}`} title={gettext('Remove')} aria-label={gettext('Remove')} role=\"button\" onClick={this.removeLink}></a>\n        </td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <Fragment>\n        <tr>\n          <td><img src={iconUrl} alt=\"\" width=\"24\" /></td>\n          <td>\n            {item.is_dir ?\n              <Link to={objUrl}>{item.obj_name}</Link> :\n              <a href={objUrl} target=\"_blank\" rel=\"noreferrer\">{item.obj_name}</a>\n            }\n            {isPro && <span className=\"item-meta-info-highlighted\">{Utils.getShareLinkPermissionObject(currentPermission).text}</span>}\n            <br />\n            <span>{item.repo_name}</span><br />\n            <span className=\"item-meta-info\">{gettext('Visits')}: {item.view_cnt}</span>\n            <span className=\"item-meta-info\">{gettext('Expiration')}: {this.renderExpiration()}</span>\n          </td>\n          <td>\n            <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n              <DropdownToggle\n                tag=\"i\"\n                className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n                title={gettext('More Operations')}\n                data-toggle=\"dropdown\"\n                aria-expanded={this.state.isOpMenuOpen}\n              />\n              <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n                <div className=\"mobile-operation-menu-bg-layer\"></div>\n                <div className=\"mobile-operation-menu\">\n                  {(isPro && !item.is_expired) && <DropdownItem className=\"mobile-menu-item\" onClick={this.togglePermSelectDialog}>{gettext('Permission')}</DropdownItem>}\n                  {!item.is_expired && <DropdownItem className=\"mobile-menu-item\" onClick={this.viewLink}>{gettext('View')}</DropdownItem>}\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.removeLink}>{gettext('Remove')}</DropdownItem>\n                </div>\n              </div>\n            </Dropdown>\n          </td>\n        </tr>\n        {isPermSelectDialogOpen &&\n        <ShareLinkPermissionSelect\n          currentPerm={currentPermission}\n          permissions={permissionOptions}\n          changePerm={this.changePerm}\n          toggleDialog={this.togglePermSelectDialog}\n        />\n        }\n      </Fragment>\n    );\n\n    return (\n      <Fragment>\n        {this.props.isDesktop ? desktopItem : mobileItem}\n        {isLinkDialogOpen &&\n        <ShareAdminLink\n          link={item.link}\n          toggleDialog={this.toggleLinkDialog}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nItem.propTypes = itemPropTypes;\n\nconst propTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired\n};\n\nclass ShareAdminShareLinks extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isCleanInvalidShareLinksDialogOpen: false,\n      loading: true,\n      errorMsg: '',\n      items: [],\n      sortBy: 'name', // 'name' or 'time'\n      sortOrder: 'asc' // 'asc' or 'desc'\n    };\n\n    // for mobile\n    this.sortOptions = [\n      {value: 'name-asc', text: gettext('By name ascending')},\n      {value: 'name-desc', text: gettext('By name descending')},\n      {value: 'time-asc', text: gettext('By expiration ascending')},\n      {value: 'time-desc', text: gettext('By expiration descending')}\n    ];\n  }\n\n  _sortItems = (items, sortBy, sortOrder) => {\n    let comparator;\n\n    switch (`${sortBy}-${sortOrder}`) {\n      case 'name-asc':\n        comparator = function(a, b) {\n          var result = Utils.compareTwoWord(a.obj_name, b.obj_name);\n          return result;\n        };\n        break;\n      case 'name-desc':\n        comparator = function(a, b) {\n          var result = Utils.compareTwoWord(a.obj_name, b.obj_name);\n          return -result;\n        };\n        break;\n      case 'time-asc':\n        comparator = function(a, b) {\n          return a.expire_date < b.expire_date ? -1 : 1;\n        };\n        break;\n      case 'time-desc':\n        comparator = function(a, b) {\n          return a.expire_date < b.expire_date ? 1 : -1;\n        };\n        break;\n\n      // no default\n    }\n\n    items.sort((a, b) => {\n      if (a.is_dir && !b.is_dir) {\n        return -1;\n      } else if (!a.is_dir && b.is_dir) {\n        return 1;\n      } else {\n        return comparator(a, b);\n      }\n    });\n    return items;\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      items: this._sortItems(this.state.items, sortBy, sortOrder)\n    });\n  }\n\n  componentDidMount() {\n    this.listUserShareLinks();\n  }\n\n  listUserShareLinks() {\n    seafileAPI.listUserShareLinks().then((res) => {\n      let items = res.data.map(item => {\n        return new ShareLink(item);\n      });\n      this.setState({\n        loading: false,\n        items: this._sortItems(items, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  onRemoveLink = (item) => {\n    seafileAPI.deleteShareLink(item.token).then(() => {\n      let items = this.state.items.filter(uploadItem => {\n        return uploadItem.token !== item.token;\n      });\n      this.setState({items: items});\n      let message = gettext('Successfully deleted 1 item.');\n      toaster.success(message);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  toggleSortOptionsDialog = () => {\n    this.setState({\n      isSortOptionsDialogOpen: !this.state.isSortOptionsDialogOpen\n    });\n  }\n\n  toggleCleanInvalidShareLinksDialog = () => {\n    this.setState({isCleanInvalidShareLinksDialogOpen: !this.state.isCleanInvalidShareLinksDialogOpen});\n  }\n\n  cleanInvalidShareLinks = () => {\n    seafileAPI.cleanInvalidShareLinks().then(res => {\n      const newItems = this.state.items.filter(item => item.obj_id !== '').filter(item => !item.is_expired);\n      this.setState({items: newItems});\n      toaster.success(gettext('Successfully cleaned invalid share links.'));\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <TopToolbar\n          onShowSidePanel={this.props.onShowSidePanel}\n          onSearchedClick={this.props.onSearchedClick}\n        >\n\n          <Button className=\"operation-item d-none d-md-block\" onClick={this.toggleCleanInvalidShareLinksDialog}>{gettext('Clean invalid share links')}</Button>\n        </TopToolbar>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path share-upload-nav\">\n              <ul className=\"nav\">\n                <li className=\"nav-item\">\n                  <Link to={`${siteRoot}share-admin-share-links/`} className=\"nav-link active\">{gettext('Share Links')}</Link>\n                </li>\n                {canGenerateUploadLink && (\n                  <li className=\"nav-item\"><Link to={`${siteRoot}share-admin-upload-links/`} className=\"nav-link\">{gettext('Upload Links')}</Link></li>\n                )}\n              </ul>\n              {(!Utils.isDesktop() && this.state.items.length > 0) && <span className=\"sf3-font sf3-font-sort action-icon\" onClick={this.toggleSortOptionsDialog}></span>}\n            </div>\n            <div className=\"cur-view-content\">\n              <Content\n                loading={this.state.loading}\n                errorMsg={this.state.errorMsg}\n                items={this.state.items}\n                sortBy={this.state.sortBy}\n                sortOrder={this.state.sortOrder}\n                sortItems={this.sortItems}\n                onRemoveLink={this.onRemoveLink}\n              />\n            </div>\n          </div>\n        </div>\n        {this.state.isSortOptionsDialogOpen &&\n        <SortOptionsDialog\n          toggleDialog={this.toggleSortOptionsDialog}\n          sortBy={this.state.sortBy}\n          sortOrder={this.state.sortOrder}\n          sortOptions={this.sortOptions}\n          sortItems={this.sortItems}\n        />\n        }\n        {this.state.isCleanInvalidShareLinksDialogOpen &&\n          <CommonOperationConfirmationDialog\n            title={gettext('Clean invalid share links')}\n            message={gettext('Are you sure you want to clean invalid share links?')}\n            executeOperation={this.cleanInvalidShareLinks}\n            confirmBtnText={gettext('Clean')}\n            toggleDialog={this.toggleCleanInvalidShareLinksDialog}\n          />\n        }\n      </Fragment>\n    );\n  }\n}\n\nShareAdminShareLinks.propTypes = propTypes;\n\nexport default ShareAdminShareLinks;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from '@gatsbyjs/reach-router';\nimport moment from 'moment';\nimport { Dropdown, DropdownToggle, DropdownItem, Button } from 'reactstrap';\nimport { gettext, siteRoot, canGenerateShareLink } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport UploadLink from '../../models/upload-link';\nimport ShareAdminLink from '../../components/dialog/share-admin-link';\nimport CommonOperationConfirmationDialog from '../../components/dialog/common-operation-confirmation-dialog';\nimport TopToolbar from '../../components/toolbar/top-toolbar';\n\nconst contentPropTypes = {\n  loading: PropTypes.bool.isRequired,\n  errorMsg: PropTypes.string.isRequired,\n  items: PropTypes.array.isRequired,\n  onRemoveLink: PropTypes.func.isRequired\n};\n\nclass Content extends Component {\n\n  render() {\n    const { loading, errorMsg, items } = this.props;\n\n    if (loading) {\n      return <Loading />;\n    }\n    if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    }\n\n    const emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No upload links')}</h2>\n        <p>{gettext('You have not created any upload links yet. An upload link allows anyone to upload files to a folder or library. You can create an upload link for a folder or library by clicking the share icon to the right of its name.')}</p>\n      </EmptyTip>\n    );\n\n    const isDesktop = Utils.isDesktop();\n    const table = (\n      <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n        <thead>\n          {isDesktop ? (\n            <tr>\n              <th width=\"4%\">{/*icon*/}</th>\n              <th width=\"30%\">{gettext('Name')}</th>\n              <th width=\"24%\">{gettext('Library')}</th>\n              <th width=\"16%\">{gettext('Visits')}</th>\n              <th width=\"16%\">{gettext('Expiration')}</th>\n              <th width=\"10%\">{/*Operations*/}</th>\n            </tr>\n          ) : (\n            <tr>\n              <th width=\"12%\"></th>\n              <th width=\"80%\"></th>\n              <th width=\"8%\"></th>\n            </tr>\n          )}\n        </thead>\n        <tbody>\n          {items.map((item, index) => {\n            return (<Item key={index} isDesktop={isDesktop} item={item} onRemoveLink={this.props.onRemoveLink}/>);\n          })}\n        </tbody>\n      </table>\n    );\n\n    return items.length ? table : emptyTip;\n  }\n}\n\nContent.propTypes = contentPropTypes;\n\nconst itemPropTypes = {\n  isDesktop: PropTypes.bool.isRequired,\n  item: PropTypes.object.isRequired,\n  onRemoveLink: PropTypes.func.isRequired\n};\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpIconShown: false,\n      isOpMenuOpen: false, // for mobile\n      isLinkDialogOpen: false\n    };\n  }\n\n toggleOpMenu = () => {\n   this.setState({\n     isOpMenuOpen: !this.state.isOpMenuOpen\n   });\n }\n\n  toggleLinkDialog = () => {\n    this.setState({\n      isLinkDialogOpen: !this.state.isLinkDialogOpen\n    });\n  }\n\n  handleMouseOver = () => {\n    this.setState({isOpIconShown: true});\n  }\n\n  handleMouseOut = () => {\n    this.setState({isOpIconShown: false});\n  }\n\n  viewLink = (e) => {\n    e.preventDefault();\n    this.toggleLinkDialog();\n  }\n\n  removeLink = (e) => {\n    e.preventDefault();\n    this.props.onRemoveLink(this.props.item);\n  }\n\n  renderExpiration = () => {\n    const item = this.props.item;\n    if (!item.expire_date) {\n      return '--';\n    }\n    const expire_date = moment(item.expire_date).format('YYYY-MM-DD');\n    const expire_time = moment(item.expire_date).format('YYYY-MM-DD HH:mm:ss');\n    return (<span className={item.is_expired ? 'error' : ''} title={expire_time}>{expire_date}</span>);\n  }\n\n  render() {\n    let item = this.props.item;\n    const { isOpIconShown, isLinkDialogOpen } = this.state;\n\n    const iconUrl = Utils.getFolderIconUrl(false);\n    const repoUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}`;\n    const objUrl = `${repoUrl}${Utils.encodePath(item.path)}`;\n\n    const deletedTip = item.obj_id === '' ? <span style={{color:'red'}}>{gettext('(deleted)')}</span> : null;\n    const desktopItem = (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut} onFocus={this.handleMouseOver}>\n        <td><img src={iconUrl} alt=\"\" width=\"24\" /></td>\n        <td><Link to={objUrl}>{item.obj_name}</Link>{deletedTip}</td>\n        <td><Link to={repoUrl}>{item.repo_name}</Link></td>\n        <td>{item.view_cnt}</td>\n        <td>{this.renderExpiration()}</td>\n        <td>\n          {!item.is_expired && <a href=\"#\" className={`sf2-icon-link action-icon ${isOpIconShown ? '' : 'invisible'}`} title={gettext('View')} aria-label={gettext('View')} role=\"button\" onClick={this.viewLink}></a>}\n          <a href=\"#\" className={`sf2-icon-delete action-icon ${isOpIconShown ? '' : 'invisible'}`} title={gettext('Remove')} aria-label={gettext('Remove')} role=\"button\" onClick={this.removeLink}></a>\n        </td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <tr>\n        <td><img src={iconUrl} alt=\"\" width=\"24\" /></td>\n        <td>\n          <Link to={objUrl}>{item.obj_name}</Link>\n          <br />\n          <span>{item.repo_name}</span><br />\n          <span className=\"item-meta-info\">{gettext('Visits')}: {item.view_cnt}</span>\n          <span className=\"item-meta-info\">{gettext('Expiration')}: {this.renderExpiration()}</span>\n        </td>\n        <td>\n          <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n            <DropdownToggle\n              tag=\"i\"\n              className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isOpMenuOpen}\n            />\n            <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n              <div className=\"mobile-operation-menu-bg-layer\"></div>\n              <div className=\"mobile-operation-menu\">\n                {!item.is_expired && <DropdownItem className=\"mobile-menu-item\" onClick={this.viewLink}>{gettext('View')}</DropdownItem>}\n                <DropdownItem className=\"mobile-menu-item\" onClick={this.removeLink}>{gettext('Remove')}</DropdownItem>\n              </div>\n            </div>\n          </Dropdown>\n        </td>\n      </tr>\n    );\n    return (\n      <Fragment>\n        {this.props.isDesktop ? desktopItem : mobileItem}\n        {isLinkDialogOpen &&\n        <ShareAdminLink\n          link={item.link}\n          toggleDialog={this.toggleLinkDialog}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nItem.propTypes = itemPropTypes;\n\nconst propTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired\n};\n\nclass ShareAdminUploadLinks extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isCleanInvalidUploadLinksDialogOpen: false,\n      loading: true,\n      errorMsg: '',\n      items: []\n    };\n  }\n\n  componentDidMount() {\n    this.listUserUploadLinks();\n  }\n\n  listUserUploadLinks() {\n    seafileAPI.listUserUploadLinks().then((res) => {\n      let items = res.data.map(item => {\n        return new UploadLink(item);\n      });\n      this.setState({\n        loading: false,\n        items: items\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  onRemoveLink = (item) => {\n    seafileAPI.deleteUploadLink(item.token).then(() => {\n      let items = this.state.items.filter(uploadItem => {\n        return uploadItem.token !== item.token;\n      });\n      this.setState({items: items});\n      const message = gettext('Successfully deleted 1 item.');\n      toaster.success(message);\n    }).catch((error) => {\n      const errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  toggleCleanInvalidUploadLinksDialog = () => {\n    this.setState({isCleanInvalidUploadLinksDialogOpen: !this.state.isCleanInvalidUploadLinksDialogOpen});\n  }\n\n  cleanInvalidUploadLinks = () => {\n    seafileAPI.cleanInvalidUploadLinks().then(res => {\n      const newItems = this.state.items.filter(item => item.obj_id !== '').filter(item => !item.is_expired);\n      this.setState({items: newItems});\n      toaster.success(gettext('Successfully cleaned invalid upload links.'));\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <TopToolbar\n          onShowSidePanel={this.props.onShowSidePanel}\n          onSearchedClick={this.props.onSearchedClick}\n        >\n          <Button className=\"operation-item d-none d-md-block\" onClick={this.toggleCleanInvalidUploadLinksDialog}>{gettext('Clean invalid upload links')}</Button>\n        </TopToolbar>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path share-upload-nav\">\n              <ul className=\"nav\">\n                {canGenerateShareLink && (\n                  <li className=\"nav-item\"><Link to={`${siteRoot}share-admin-share-links/`} className=\"nav-link\">{gettext('Share Links')}</Link></li>\n                )}\n                <li className=\"nav-item\"><Link to={`${siteRoot}share-admin-upload-links/`} className=\"nav-link active\">{gettext('Upload Links')}</Link></li>\n              </ul>\n            </div>\n            <div className=\"cur-view-content\">\n              <Content\n                loading={this.state.loading}\n                errorMsg={this.state.errorMsg}\n                items={this.state.items}\n                onRemoveLink={this.onRemoveLink}\n              />\n            </div>\n          </div>\n        </div>\n        {this.state.isCleanInvalidUploadLinksDialogOpen &&\n        <CommonOperationConfirmationDialog\n          title={gettext('Clean invalid upload links')}\n          message={gettext('Are you sure you want to clean invalid upload links?')}\n          executeOperation={this.cleanInvalidUploadLinks}\n          confirmBtnText={gettext('Clean')}\n          toggleDialog={this.toggleCleanInvalidUploadLinksDialog}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nShareAdminUploadLinks.propTypes = propTypes;\n\nexport default ShareAdminUploadLinks;\n","import { Utils } from '../utils/utils';\n\nclass Repo {\n  constructor(object) {\n    this.repo_id = object.repo_id;\n    this.repo_name = object.repo_name;\n    this.permission = object.permission;\n    this.size_original = object.size;\n    this.size = Utils.bytesToSize(object.size);\n    this.owner_name = object.owner_name;\n    this.owner_email = object.owner_email;\n    this.owner_contact_email = object.owner_contact_email;\n    this.encrypted = object.encrypted;\n    this.last_modified = object.last_modified;\n    this.modifier_contact_email = object.modifier_contact_email;\n    this.modifier_email = object.modifier_email;\n    this.modifier_name = object.modifier_name;\n    this.type = object.type;\n    this.starred = object.starred;\n    this.monitored = object.monitored;\n    this.status = object.status;\n    this.storage_name = object.storage_name;\n    if (object.is_admin != undefined) {\n      this.is_admin = object.is_admin;\n    }\n  }\n}\n\nexport default Repo;\n","import React from 'react';\nimport { gettext } from '../utils/constants';\n\nfunction LibsMobileThead() {\n  return (\n    <thead>\n      <tr>\n        <th width=\"12%\"><span className=\"sr-only\">{gettext('Library Type')}</span></th>\n        <th width=\"80%\"></th>\n        <th width=\"8%\"><span className=\"sr-only\">{gettext('Actions')}</span></th>\n      </tr>\n    </thead>\n  );\n}\n\nexport default LibsMobileThead;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport '../css/icon.css';\n\nconst importAll = (requireContext) => {\n  requireContext.keys().forEach(requireContext);\n};\ntry {\n  importAll(require.context('../assets/icons', true, /\\.svg$/));\n} catch (error) {\n  // eslint-disable-next-line no-console\n  console.log(error);\n}\n\nconst Icon = (props) => {\n  const { className, symbol } = props;\n  const iconClass = `seafile-multicolor-icon seafile-multicolor-icon-${symbol} ${className || ''}`;\n  return (\n    <svg className={iconClass}>\n      <use xlinkHref={`#${symbol}`} />\n    </svg>\n  );\n};\n\nIcon.propTypes = {\n  symbol: PropTypes.string.isRequired,\n  className: PropTypes.string,\n};\n\nexport default Icon;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { UncontrolledTooltip } from 'reactstrap';\nimport Icon from '../components/icon';\nimport { gettext } from '../utils/constants';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired\n};\n\nclass RepoMonitoredIcon extends React.Component {\n\n  render() {\n    const { repoID } = this.props;\n    return (\n      <Fragment>\n        <span id={`watching-${repoID}`} className=\"ml-1\">\n          <Icon symbol='monitor' />\n        </span>\n        <UncontrolledTooltip\n          placement=\"bottom\"\n          target={`#watching-${repoID}`}\n        >\n          {gettext('You are watching file changes of this library.')}\n        </UncontrolledTooltip>\n      </Fragment>\n    );\n  }\n}\n\nRepoMonitoredIcon.propTypes = propTypes;\n\nexport default RepoMonitoredIcon;\n","import React, { Component, Fragment } from 'react';\nimport { Dropdown, DropdownToggle, DropdownMenu, DropdownItem } from 'reactstrap';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport cookie from 'react-cookies';\nimport { Link, navigate } from '@gatsbyjs/reach-router';\nimport { gettext, siteRoot, isPro } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport Repo from '../../models/repo';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport LibsMobileThead from '../../components/libs-mobile-thead';\nimport ModalPotal from '../../components/modal-portal';\nimport ShareDialog from '../../components/dialog/share-dialog';\nimport SortOptionsDialog from '../../components/dialog/sort-options';\nimport RepoMonitoredIcon from '../../components/repo-monitored-icon';\n\nclass Content extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false\n    };\n  }\n\n  freezeItem = (freezed) => {\n    this.setState({\n      isItemFreezed: freezed\n    });\n  }\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortByTime = (e) => {\n    e.preventDefault();\n    const sortBy = 'time';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortBySize = (e) => {\n    e.preventDefault();\n    const sortBy = 'size';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  render() {\n    const { loading, errorMsg, items, sortBy, sortOrder } = this.props;\n\n    const emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No shared libraries')}</h2>\n        <p>{gettext('No libraries have been shared directly with you. A shared library can be shared with full or restricted permission. If you need access to a library owned by another user, ask the user to share the library with you.')}</p>\n      </EmptyTip>\n    );\n\n    if (loading) {\n      return <Loading />;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      // sort\n      const sortByName = sortBy == 'name';\n      const sortByTime = sortBy == 'time';\n      const sortBySize = sortBy == 'size';\n      const sortIcon = sortOrder == 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>;\n\n      const desktopThead = (\n        <thead>\n          <tr>\n            <th width=\"4%\"></th>\n            <th width=\"4%\"><span className=\"sr-only\">{gettext('Library Type')}</span></th>\n            <th width=\"34%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {sortByName && sortIcon}</a></th>\n            <th width=\"10%\"><span className=\"sr-only\">{gettext('Actions')}</span></th>\n            <th width=\"14%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortBySize}>{gettext('Size')} {sortBySize && sortIcon}</a></th>\n            <th width=\"18%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByTime}>{gettext('Last Update')} {sortByTime && sortIcon}</a></th>\n            <th width=\"16%\">{gettext('Owner')}</th>\n          </tr>\n        </thead>\n      );\n\n      const isDesktop = Utils.isDesktop();\n      const table = (\n        <table className={isDesktop ? '' : 'table-thead-hidden'}>\n          {isDesktop ? desktopThead : <LibsMobileThead />}\n          <tbody>\n            {items.map((item, index) => {\n              return <Item\n                key={index}\n                data={item}\n                isDesktop={isDesktop}\n                isItemFreezed={this.state.isItemFreezed}\n                freezeItem={this.freezeItem}\n                onMonitorRepo={this.props.onMonitorRepo}\n              />;\n            })}\n          </tbody>\n        </table>\n      );\n\n      return items.length ? table : emptyTip;\n    }\n  }\n}\n\nContent.propTypes = {\n  loading: PropTypes.bool.isRequired,\n  errorMsg: PropTypes.string.isRequired,\n  items: PropTypes.array.isRequired,\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  sortItems: PropTypes.func.isRequired,\n  onMonitorRepo: PropTypes.func.isRequired\n};\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      highlight: false,\n      showOpIcon: false,\n      unshared: false,\n      isShowSharedDialog: false,\n      isStarred: this.props.data.starred,\n      isOpMenuOpen: false\n    };\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    }, () => {\n      this.props.freezeItem(this.state.isOpMenuOpen);\n    });\n  }\n\n  handleMouseOver = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: true,\n        showOpIcon: true\n      });\n    }\n  }\n\n  handleMouseOut = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: false,\n        showOpIcon: false\n      });\n    }\n  }\n\n  share = (e) => {\n    e.preventDefault();\n    this.setState({isShowSharedDialog: true});\n  }\n\n  leaveShare = (e) => {\n    e.preventDefault();\n\n    const data = this.props.data;\n\n    let request;\n    if (data.owner_email.indexOf('@seafile_group') == -1) {\n      let options = {\n        'share_type': 'personal',\n        'from': data.owner_email\n      };\n      request = seafileAPI.leaveShareRepo(data.repo_id, options);\n    } else {\n      request = seafileAPI.leaveShareGroupOwnedRepo(data.repo_id);\n    }\n\n    request.then((res) => {\n      this.setState({unshared: true});\n      let message = gettext('Successfully unshared {name}').replace('{name}', data.repo_name);\n      toaster.success(message);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = gettext('Failed to unshare {name}').replace('{name}', data.repo_name);\n      }\n      toaster(errMessage);\n    });\n  }\n\n  toggleShareDialog = () => {\n    this.setState({isShowSharedDialog: false});\n  }\n\n  onToggleStarRepo = (e) => {\n    e.preventDefault();\n    const repoName = this.props.data.repo_name;\n    if (this.state.isStarred) {\n      seafileAPI.unstarItem(this.props.data.repo_id, '/').then(() => {\n        this.setState({isStarred: !this.state.isStarred});\n        const msg = gettext('Successfully unstarred {library_name_placeholder}.')\n          .replace('{library_name_placeholder}', repoName);\n        toaster.success(msg);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      seafileAPI.starItem(this.props.data.repo_id, '/').then(() => {\n        this.setState({isStarred: !this.state.isStarred});\n        const msg = gettext('Successfully starred {library_name_placeholder}.')\n          .replace('{library_name_placeholder}', repoName);\n        toaster.success(msg);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  visitRepo = () => {\n    navigate(this.repoURL);\n  }\n\n  watchFileChanges = () => {\n    const { data: repo } = this.props;\n    seafileAPI.monitorRepo(repo.repo_id).then(() => {\n      this.props.onMonitorRepo(repo, true);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  unwatchFileChanges = () => {\n    const { data: repo } = this.props;\n    seafileAPI.unMonitorRepo(repo.repo_id).then(() => {\n      this.props.onMonitorRepo(repo, false);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    if (this.state.unshared) {\n      return null;\n    }\n\n    const data = this.props.data;\n\n    data.icon_url = Utils.getLibIconUrl(data);\n    data.icon_title = Utils.getLibIconTitle(data);\n\n    let iconVisibility = this.state.showOpIcon ? '' : ' invisible';\n    let shareIconClassName = 'op-icon sf2-icon-share repo-share-btn' + iconVisibility;\n    let leaveShareIconClassName = 'op-icon sf2-icon-x3' + iconVisibility;\n    let shareRepoUrl = this.repoURL = `${siteRoot}library/${data.repo_id}/${Utils.encodePath(data.repo_name)}/`;\n\n    // at present, only repo shared with 'r', 'rw' can be monitored.(Fri Feb 10 16:24:49 CST 2023)\n    const enableMonitorRepo = isPro && (data.permission == 'r' || data.permission == 'rw');\n\n    const desktopItem = (\n      <Fragment>\n        <tr className={this.state.highlight ? 'tr-highlight' : ''} onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut} onFocus={this.handleMouseOver}>\n          <td className=\"text-center\">\n            <a href=\"#\" role=\"button\" aria-label={this.state.isStarred ? gettext('Unstar') : gettext('Star')} onClick={this.onToggleStarRepo}>\n              <i className={`fa-star ${this.state.isStarred ? 'fas' : 'far star-empty'}`}></i>\n            </a>\n          </td>\n          <td><img src={data.icon_url} title={data.icon_title} alt={data.icon_title} width=\"24\" /></td>\n          <td>\n            <Fragment>\n              <Link to={shareRepoUrl}>{data.repo_name}</Link>\n              {data.monitored && <RepoMonitoredIcon repoID={data.repo_id} />}\n            </Fragment>\n          </td>\n          <td>\n            {(isPro && data.is_admin) &&\n              <a href=\"#\" className={shareIconClassName} title={gettext('Share')} role=\"button\" aria-label={gettext('Share')} onClick={this.share}></a>\n            }\n            <a href=\"#\" className={leaveShareIconClassName} title={gettext('Leave Share')} role=\"button\" aria-label={gettext('Leave Share')} onClick={this.leaveShare}></a>\n            {enableMonitorRepo &&\n            <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n              <DropdownToggle\n                tag=\"i\"\n                role=\"button\"\n                tabIndex=\"0\"\n                className={`sf-dropdown-toggle sf2-icon-caret-down${iconVisibility}`}\n                title={gettext('More Operations')}\n                aria-label={gettext('More Operations')}\n                data-toggle=\"dropdown\"\n                aria-expanded={this.state.isOpMenuOpen}\n              />\n              <DropdownMenu>\n                <DropdownItem onClick={data.monitored ? this.unwatchFileChanges : this.watchFileChanges}>{data.monitored ? gettext('Unwatch File Changes') : gettext('Watch File Changes')}</DropdownItem>\n              </DropdownMenu>\n            </Dropdown>\n            }\n          </td>\n          <td>{data.size}</td>\n          <td title={moment(data.last_modified).format('llll')}>{moment(data.last_modified).fromNow()}</td>\n          <td title={data.owner_contact_email}>{data.owner_name}</td>\n        </tr>\n        {this.state.isShowSharedDialog && (\n          <ModalPotal>\n            <ShareDialog\n              itemType={'library'}\n              itemName={data.repo_name}\n              itemPath={'/'}\n              repoID={data.repo_id}\n              repoEncrypted={data.encrypted}\n              enableDirPrivateShare={true}\n              userPerm={data.permission}\n              isAdmin={true}\n              toggleDialog={this.toggleShareDialog}\n            />\n          </ModalPotal>\n        )}\n      </Fragment>\n    );\n\n    const mobileItem = (\n      <Fragment>\n        <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut}>\n          <td onClick={this.visitRepo}><img src={data.icon_url} title={data.icon_title} alt={data.icon_title} width=\"24\" /></td>\n          <td onClick={this.visitRepo}>\n            <Link to={shareRepoUrl}>{data.repo_name}</Link>\n            {data.monitored && <RepoMonitoredIcon repoID={data.repo_id} />}\n            <br />\n            <span className=\"item-meta-info\" title={data.owner_contact_email}>{data.owner_name}</span>\n            <span className=\"item-meta-info\">{data.size}</span>\n            <span className=\"item-meta-info\" title={moment(data.last_modified).format('llll')}>{moment(data.last_modified).fromNow()}</span>\n          </td>\n          <td>\n            <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n              <DropdownToggle\n                tag=\"i\"\n                className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n                title={gettext('More Operations')}\n                data-toggle=\"dropdown\"\n                aria-expanded={this.state.isOpMenuOpen}\n              />\n              <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n                <div className=\"mobile-operation-menu-bg-layer\"></div>\n                <div className=\"mobile-operation-menu\">\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.onToggleStarRepo}>{this.state.isStarred ? gettext('Unstar') : gettext('Star')}</DropdownItem>\n                  {(isPro && data.is_admin) && <DropdownItem className=\"mobile-menu-item\" onClick={this.share}>{gettext('Share')}</DropdownItem>}\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.leaveShare}>{gettext('Leave Share')}</DropdownItem>\n                  {enableMonitorRepo && <DropdownItem className=\"mobile-menu-item\" onClick={data.monitored ? this.unwatchFileChanges : this.watchFileChanges}>{data.monitored ? gettext('Unwatch File Changes') : gettext('Watch File Changes')}</DropdownItem>}\n                </div>\n              </div>\n            </Dropdown>\n          </td>\n        </tr>\n        {this.state.isShowSharedDialog && (\n          <ModalPotal>\n            <ShareDialog\n              itemType={'library'}\n              itemName={data.repo_name}\n              itemPath={'/'}\n              repoID={data.repo_id}\n              repoEncrypted={data.encrypted}\n              enableDirPrivateShare={true}\n              userPerm={data.permission}\n              isAdmin={true}\n              toggleDialog={this.toggleShareDialog}\n            />\n          </ModalPotal>\n        )}\n      </Fragment>\n    );\n\n    return this.props.isDesktop ? desktopItem : mobileItem;\n  }\n}\n\nItem.propTypes = {\n  isDesktop: PropTypes.bool.isRequired,\n  data: PropTypes.object.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  freezeItem: PropTypes.func.isRequired,\n  onMonitorRepo: PropTypes.func.isRequired\n};\n\nclass SharedLibraries extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: [],\n      sortBy: cookie.load('seafile-repo-dir-sort-by') || 'name', // 'name' or 'time' or 'size'\n      sortOrder: cookie.load('seafile-repo-dir-sort-order') || 'asc', // 'asc' or 'desc'\n      isSortOptionsDialogOpen: false\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepos({type:'shared'}).then((res) => {\n      let repoList = res.data.repos.map((item) => {\n        return new Repo(item);\n      });\n      this.setState({\n        loading: false,\n        items: Utils.sortRepos(repoList, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    cookie.save('seafile-repo-dir-sort-by', sortBy);\n    cookie.save('seafile-repo-dir-sort-order', sortOrder);\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      items: Utils.sortRepos(this.state.items, sortBy, sortOrder)\n    });\n  }\n\n  toggleSortOptionsDialog = () => {\n    this.setState({\n      isSortOptionsDialogOpen: !this.state.isSortOptionsDialogOpen\n    });\n  }\n\n  onMonitorRepo = (repo, monitored) => {\n    let items = this.state.items.map(item => {\n      if (item.repo_id === repo.repo_id) {\n        item.monitored = monitored;\n      }\n      return item;\n    });\n    this.setState({items: items});\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading m-0\">{gettext('Shared with me')}</h3>\n              {(!Utils.isDesktop() && this.state.items.length > 0) && <span className=\"sf3-font sf3-font-sort action-icon\" onClick={this.toggleSortOptionsDialog}></span>}\n            </div>\n            <div className=\"cur-view-content\">\n              <Content\n                loading={this.state.loading}\n                errorMsg={this.state.errorMsg}\n                items={this.state.items}\n                sortBy={this.state.sortBy}\n                sortOrder={this.state.sortOrder}\n                sortItems={this.sortItems}\n                onMonitorRepo={this.onMonitorRepo}\n              />\n            </div>\n          </div>\n        </div>\n        {this.state.isSortOptionsDialogOpen &&\n        <SortOptionsDialog\n          toggleDialog={this.toggleSortOptionsDialog}\n          sortBy={this.state.sortBy}\n          sortOrder={this.state.sortOrder}\n          sortItems={this.sortItems}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nexport default SharedLibraries;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Link } from '@gatsbyjs/reach-router';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\n\nclass Content extends Component {\n\n  render() {\n    const { loading, errorMsg, items } = this.props;\n\n    const emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No libraries have been shared with you')}</h2>\n        <p>{gettext('No libraries have been shared with you from other servers.')}</p>\n      </EmptyTip>\n    );\n\n    if (loading) {\n      return <Loading />;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const table = (\n        <table>\n          <thead>\n            <tr>\n              <th width=\"4%\"></th>\n              <th width=\"20%\">{gettext('Name')}</th>\n              <th width=\"20%\">{gettext('Shared by')}</th>\n              <th width=\"26%\">{gettext('At server')}</th>\n              <th width=\"20%\">{gettext('Time')}</th>\n              <th width=\"10%\">{/* operations */}</th>\n            </tr>\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              return <Item\n                key={index}\n                item={item}\n                leaveShare={this.props.leaveShare}\n              />;\n            })}\n          </tbody>\n        </table>\n      );\n\n      return items.length ? table : emptyTip;\n    }\n  }\n}\n\nContent.propTypes = {\n  loading: PropTypes.bool.isRequired,\n  errorMsg: PropTypes.string.isRequired,\n  items: PropTypes.array.isRequired,\n};\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpIconShown: false\n    };\n  }\n\n  handleMouseOver = () => {\n    this.setState({\n      isOpIconShown: true\n    });\n  }\n\n  handleMouseOut = () => {\n    this.setState({\n      isOpIconShown: false\n    });\n  }\n\n  leaveShare = (e) => {\n    e.preventDefault();\n    this.props.leaveShare(this.props.item);\n  }\n\n  render() {\n    const item = this.props.item;\n    const { isOpIconShown } = this.state;\n\n    item.icon_url = Utils.getLibIconUrl(item);\n    item.icon_title = Utils.getLibIconTitle(item);\n\n    let shareRepoUrl =`${siteRoot}remote-library/${this.props.item.provider_id}/${this.props.item.repo_id}/${Utils.encodePath(this.props.item.repo_name)}/`;\n    return (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut} onFocus={this.handleMouseOver}>\n        <td><img src={item.icon_url} title={item.icon_title} alt={item.icon_title} width=\"24\" /></td>\n        <td><Link to={shareRepoUrl}>{item.repo_name}</Link></td>\n        <td>{item.from_user}</td>\n        <td>{item.from_server_url}</td>\n        <td title={moment(item.last_modified).format('llll')}>{moment(item.ctime).fromNow()}</td>\n        <td>\n          <a href=\"#\" role=\"button\" className={`action-icon sf2-icon-x3 ${isOpIconShown ? '' : 'invisible'}`} title={gettext('Leave Share')} aria-label={gettext('Leave Share')} onClick={this.leaveShare}></a>\n        </td>\n      </tr>\n    );\n  }\n}\n\nItem.propTypes = {\n  item: PropTypes.object.isRequired\n};\n\nclass SharedWithOCM extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: []\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listOCMSharesReceived().then((res) => {\n      this.setState({\n        loading: false,\n        items: res.data.ocm_share_received_list\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  leaveShare = (item) => {\n    const { id, repo_name } = item;\n    seafileAPI.deleteOCMShareReceived(id).then((res) => {\n      let items = this.state.items.filter(item => {\n        return item.id != id;\n      });\n      this.setState({items: items});\n      toaster.success(gettext('Successfully unshared {name}').replace('{name}', repo_name));\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading m-0\">{gettext('Shared from other servers')}</h3>\n            </div>\n            <div className=\"cur-view-content\">\n              <Content\n                loading={this.state.loading}\n                errorMsg={this.state.errorMsg}\n                items={this.state.items}\n                leaveShare={this.leaveShare}\n              />\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nexport default SharedWithOCM;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Link } from '@gatsbyjs/reach-router';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\n\nclass OCMViaWebdav extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      shareID: '',\n      path: '',\n      items: [],\n      errorMsg: '',\n    };\n  }\n\n  componentDidMount() {\n    this.getAllReceivedShares()\n  }\n\n  getAllReceivedShares = () => {\n    const url = seafileAPI.server + '/ocm-via-webdav/received-shares/';\n    seafileAPI.req.get(url).then((res) => {\n      this.setState({\n        loading: false,\n        shareID: '',\n        path: '',\n        items: res.data.received_share_list,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  leaveShare = (item) => {\n    const { id, name } = item;\n    const url = seafileAPI.server + '/ocm-via-webdav/received-shares/' + id + '/';\n    seafileAPI.req.delete(url).then((res) => {\n      let items = this.state.items.filter(item => {\n        return item.id != id;\n      });\n      this.setState({items: items});\n      toaster.success(gettext('Successfully unshared {name}').replace('{name}', name));\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  openFolder = (item) => {\n\n    this.setState({\n      loading: true,\n    });\n\n    const url = seafileAPI.server + '/ocm-via-webdav/received-shares/' + item.id + '/?path=' + item.path;\n    seafileAPI.req.get(url).then((res) => {\n      this.setState({\n        loading: false,\n        shareID: item.id,\n        path: res.data.parent_dir,\n        items: res.data.received_share_list,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onPathClick = (path) => {\n\n    this.setState({\n      loading: true,\n    });\n\n    const url = seafileAPI.server + '/ocm-via-webdav/received-shares/' + this.state.shareID + '/?path=' + path;\n    seafileAPI.req.get(url).then((res) => {\n      this.setState({\n        loading: false,\n        items: res.data.received_share_list,\n        path: res.data.parent_dir,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path align-items-center\">\n              <DirPath\n                shareID={this.state.shareID}\n                currentPath={this.state.path}\n                onPathClick={this.onPathClick}\n                getAllReceivedShares={this.getAllReceivedShares}\n              />\n            </div>\n            <div className=\"cur-view-content\">\n              <Content\n                loading={this.state.loading}\n                errorMsg={this.state.errorMsg}\n                items={this.state.items}\n                path={this.state.path}\n                leaveShare={this.leaveShare}\n                openFolder={this.openFolder}\n              />\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\n\nclass Content extends Component {\n\n  static propTypes = {\n    loading: PropTypes.bool.isRequired,\n    errorMsg: PropTypes.string.isRequired,\n    items: PropTypes.array.isRequired,\n    path: PropTypes.string.isRequired,\n  }\n\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    const { loading, errorMsg, items, path } = this.props;\n    const emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No libraries have been shared with you')}</h2>\n        <p>{gettext('No libraries have been shared with you from other servers.')}</p>\n      </EmptyTip>\n    );\n\n    if (loading) {\n      return <Loading />;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const table = (\n        <table>\n          <thead>\n            <tr>\n              <th width=\"5%\"></th>\n              <th width=\"30%\">{gettext('Name')}</th>\n              <th width=\"35%\">{gettext('Shared By')}</th>\n              <th width=\"20%\">{gettext('Time')}</th>\n              <th width=\"5%\">{/* operations */}</th>\n              <th width=\"5%\">{/* operations */}</th>\n            </tr>\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              return <Item\n                key={index}\n                item={item}\n                path={path}\n                leaveShare={this.props.leaveShare}\n                openFolder={this.props.openFolder}\n              />;\n            })}\n          </tbody>\n        </table>\n      );\n\n      return items.length ? table : emptyTip;\n    }\n  }\n}\n\nclass Item extends Component {\n\n  static propTypes = {\n    item: PropTypes.object.isRequired\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpIconShown: false\n    };\n  }\n\n  handleMouseOver = () => {\n    this.setState({\n      isOpIconShown: true\n    });\n  }\n\n  handleMouseOut = () => {\n    this.setState({\n      isOpIconShown: false\n    });\n  }\n\n  downloadFile = () => {\n    let downloadUrl = siteRoot + 'ocm-via-webdav/download-received-file/?share_id=' + this.props.item.id + '&path=' + this.props.item.path;\n    window.location.href = downloadUrl;\n  }\n\n  leaveShare = (e) => {\n    e.preventDefault();\n    this.props.leaveShare(this.props.item);\n  }\n\n  openFolder = (e) => {\n    e.preventDefault();\n    this.props.openFolder(this.props.item);\n  }\n\n  render() {\n    const item = this.props.item;\n    const { isOpIconShown } = this.state;\n\n    if (item.is_dir) {\n      item.icon_url = Utils.getFolderIconUrl();\n    } else {\n      item.icon_url = Utils.getFileIconUrl(item.name);\n    }\n    return (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut}>\n        <td><img src={item.icon_url} width=\"24\" /></td>\n        <td>\n          {item.is_dir ? <a href=\"#\" onClick={this.openFolder}>{item.name}</a> : item.name}\n\t</td>\n        <td>{item.shared_by}</td>\n        <td title={moment(item.last_modified).format('llll')}>{moment(item.ctime).fromNow()}</td>\n        <td>\n\t  {item.is_dir ? \"\" : <a href=\"#\" className={`action-icon sf2-icon-download ${isOpIconShown ? '' : 'invisible'}`} title={gettext('Download')} onClick={this.downloadFile}></a>}\n        </td>\n        <td>\n\t  {this.props.path ? \"\" : <a href=\"#\" className={`action-icon sf2-icon-x3 ${isOpIconShown ? '' : 'invisible'}`} title={gettext('Leave Share')} onClick={this.leaveShare}></a>}\n        </td>\n      </tr>\n    );\n  }\n}\n\nclass DirPath extends React.Component {\n\n  static propTypes = {\n    currentPath: PropTypes.string.isRequired,\n    onPathClick: PropTypes.func.isRequired,\n    getAllReceivedShares: PropTypes.func.isRequired,\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n    };\n  }\n\n  onPathClick = (e) => {\n    let path = Utils.getEventData(e, 'path');\n    this.props.onPathClick(path);\n  }\n\n  turnPathToLink = (path) => {\n    path = path.slice(1, path.length - 1);\n    let pathList = path.split('/');\n    let nodePath = '';\n    let pathElem = pathList.map((item, index) => {\n      if (index === (pathList.length - 1)) {\n        return (\n          <Fragment key={index}>\n            <span className=\"path-split\">/</span>\n            <span className=\"path-file-name\">{item}</span>\n          </Fragment>\n        );\n      } else {\n\tif (index === 0) {\n          nodePath = '/';\n\t} else {\n          nodePath += item + '/';\n\t}\n        return (\n          <Fragment key={index} >\n            <span className=\"path-split\">/</span>\n            <a className=\"path-link\" data-path={nodePath} onClick={this.onPathClick}>{item}</a>\n          </Fragment>\n        );\n      }\n    });\n    return pathElem;\n  }\n\n  render() {\n    let pathElem = this.turnPathToLink(this.props.currentPath);\n    return (\n      <div className=\"path-container\">\n        <a href=\"#\" onClick={this.props.getAllReceivedShares}>{gettext('All')}</a>\n        {pathElem}\n      </div>\n    );\n  }\n}\n\nexport default OCMViaWebdav;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Account from '../../components/common/account';\n\nconst propTypes = {\n  children: PropTypes.object\n};\n\nclass MainPanelTopbar extends Component {\n\n  render() {\n    return (\n      <div className={`main-panel-north ${this.props.children ? 'border-left-show' : ''}`}>\n        <div className=\"cur-view-toolbar\">\n          <span className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\" title=\"Side Nav Menu\"></span>\n          <div className=\"operation\">\n            {this.props.children}\n          </div>\n        </div>\n        <div className=\"common-toolbar\">\n          <Account isAdminPanel={false} />\n        </div>\n      </div>\n    );\n  }\n}\n\nMainPanelTopbar.propTypes = propTypes;\n\nexport default MainPanelTopbar;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from '@gatsbyjs/reach-router';\nimport { siteRoot, gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  repoName: PropTypes.string.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  onPathClick: PropTypes.func.isRequired,\n  onTabNavClick: PropTypes.func.isRequired,\n  repoID: PropTypes.string.isRequired,\n};\n\nclass DirPath extends React.Component {\n\n  onPathClick = (e) => {\n    let path = Utils.getEventData(e, 'path');\n    this.props.onPathClick(path);\n  }\n\n  turnPathToLink = (path) => {\n    path = path[path.length - 1] === '/' ? path.slice(0, path.length - 1) : path;\n    let pathList = path.split('/');\n    let nodePath = '';\n    let pathElem = pathList.map((item, index) => {\n      if (item === '') {\n        return;\n      }\n      if (index === (pathList.length - 1)) {\n        return (\n          <Fragment key={index}>\n            <span className=\"path-split\">/</span>\n            <span className=\"path-file-name\">{item}</span>\n          </Fragment>\n        );\n      } else {\n        nodePath += '/' + item;\n        return (\n          <Fragment key={index} >\n            <span className=\"path-split\">/</span>\n            <a className=\"path-link\" data-path={nodePath} onClick={this.onPathClick}>{item}</a>\n          </Fragment>\n        );\n      }\n    });\n    return pathElem;\n  }\n\n  render() {\n    let { currentPath, repoName } = this.props;\n    let pathElem = this.turnPathToLink(currentPath);\n\n    return (\n      <div className=\"path-container\">\n        <Link to={siteRoot + 'shared-with-ocm/'} className=\"normal\" onClick={(e) => this.props.onTabNavClick('shared-with-ocm')}>{gettext('All')}</Link>\n        <span className=\"path-split\">/</span>\n        {(currentPath === '/' || currentPath === '') ?\n          <span className=\"path-repo-name\">{repoName}</span>:\n          <a className=\"path-link\" data-path=\"/\" onClick={this.onPathClick}>{repoName}</a>\n        }\n        {pathElem}\n      </div>\n    );\n  }\n}\n\nDirPath.propTypes = propTypes;\n\nexport default DirPath;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from '@gatsbyjs/reach-router';\nimport moment from 'moment';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../../components/loading';\n\nclass DirentItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpIconShown: false\n    };\n  }\n\n  handleMouseOver = () => {\n    this.setState({\n      isOpIconShown: true\n    });\n  }\n\n  handleMouseOut = () => {\n    this.setState({\n      isOpIconShown: false\n    });\n  }\n\n  openFolder = () => {\n    this.props.openFolder(this.props.dirent);\n  }\n\n  downloadDirent = (e) => {\n    e.preventDefault();\n    this.props.downloadDirent(this.props.dirent);\n  }\n\n  render () {\n    let { isOpIconShown } = this.state;\n    let { dirent } = this.props;\n    let iconUrl = Utils.getDirentIcon(dirent);\n\n    return (\n      <Fragment>\n        <tr onMouseEnter={this.handleMouseOver} onMouseLeave={this.handleMouseOut}>\n          <td className=\"text-center\"><img src={iconUrl} width=\"24\" alt='' /></td>\n          <td>\n            {dirent.is_file ?\n              dirent.name :\n              <Link to=\"#\" onClick={this.openFolder}>{dirent.name}</Link>\n            }\n          </td>\n          <td>\n            {isOpIconShown && dirent.is_file &&\n            <a href=\"#\" className=\"op-icon sf2-icon-download\" title={gettext('Download')} onClick={this.downloadDirent}></a>\n            }\n          </td>\n          <td>{Utils.bytesToSize(dirent.size)}</td>\n          <td>{moment(dirent.mtime).fromNow()}</td>\n        </tr>\n      </Fragment>\n    );\n  }\n}\n\n\nconst propTypes = {\n  direntList: PropTypes.array.isRequired\n};\n\nclass DirContent extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    let { loading, errorMsg, direntList } = this.props;\n\n    if (loading) {\n      return <Loading />;\n    }\n\n    if (errorMsg) {\n      return <p className=\"error text-center mt-4\">{errorMsg}</p>;\n    }\n\n    return (\n      <Fragment>\n        <table className=\"table-hover\">\n          <thead>\n            <tr>\n              <th width=\"5%\">{/*icon*/}</th>\n              <th width=\"55%\">{gettext('Name')}</th>\n              <th width=\"10%\">{/*operation*/}</th>\n              <th width=\"15%\">{gettext('Size')}</th>\n              <th width=\"15%\">{gettext('Last Update')}</th>\n            </tr>\n          </thead>\n          <tbody>\n            {direntList.map((dirent, index) => {\n              return <DirentItem\n                key={index}\n                dirent={dirent}\n                openFolder={this.props.openFolder}\n                deleteDirent={this.props.deleteDirent}\n                downloadDirent={this.props.downloadDirent}\n                fromSystemRepo={this.props.fromSystemRepo}\n              />;\n            })}\n          </tbody>\n        </table>\n      </Fragment>\n    );\n  }\n}\n\nDirContent.propTypes = propTypes;\n\nexport default DirContent;\n","import React, { Component, Fragment } from 'react';\nimport { Button } from 'reactstrap';\nimport axios from 'axios';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { loginUrl, siteRoot, gettext } from '../../utils/constants';\nimport toaster from '../../components/toast';\nimport MainPanelTopbar from './remote-dir-topbar';\nimport DirPathBar from './remote-dir-path';\nimport DirContent from './remote-dir-content';\n\nclass Dirent {\n  constructor(obj) {\n    this.name = obj.name;\n    this.mtime = obj.mtime;\n    this.size = obj.size;\n    this.is_file = obj.type === 'file';\n  }\n\n  isDir() {\n    return !this.is_file;\n  }\n}\n\nclass DirView extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      repoName: '',\n      path: '',\n      direntList: [],\n      isNewFolderDialogOpen: false,\n      userPerm: '',\n    };\n    this.fileInput = React.createRef();\n  }\n\n  componentDidMount () {\n    this.loadDirentList('/');\n  }\n\n  onPathClick = (path) => {\n    this.loadDirentList(path);\n  }\n\n  openFolder = (dirent) => {\n    let direntPath = Utils.joinPath(this.state.path, dirent.name);\n    if (!dirent.is_file) {\n      this.loadDirentList(direntPath);\n    }\n  }\n\n  loadDirentList = (path) => {\n    const { providerID, repoID } = this.props;\n    seafileAPI.listOCMRepoDir(providerID, repoID, path).then(res => {\n      const { repo_name: repoName, dirent_list, user_perm } = res.data;\n      let direntList = [];\n      dirent_list.forEach(item => {\n        let dirent = new Dirent(item);\n        direntList.push(dirent);\n      });\n      this.setState({\n        loading: false,\n        repoName: repoName,\n        direntList: direntList,\n        path: path,\n        userPerm: user_perm,\n      }, () => {\n        let url =`${siteRoot}remote-library/${providerID}/${repoID}/${repoName}${Utils.encodePath(path)}`;\n        window.history.replaceState({url: url, path: path}, path, url);\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  downloadDirent = (dirent) => {\n    let path = Utils.joinPath(this.state.path, dirent.name);\n    seafileAPI.getOCMRepoDownloadURL(this.props.providerID, this.props.repoID, path).then(res => {\n      location.href = res.data;\n    }).catch((err) => {\n      let errMessage = Utils.getErrorMsg(err);\n      toaster.danger(errMessage);\n    });\n  }\n\n  openFileInput = () => {\n    this.fileInput.current.click();\n  }\n\n  onFileInputChange = () => {\n    if (!this.fileInput.current.files.length) {\n      return;\n    }\n    const file = this.fileInput.current.files[0];\n\n    let { path } = this.state;\n    let { providerID, repoID } = this.props;\n    seafileAPI.getOCMRepoUploadURL(providerID, repoID, path).then(res => {\n      let formData = new FormData();\n      formData.append('parent_dir', path);\n      formData.append('file', file);\n      axios.post(res.data, formData).then(res => {\n        const fileObj = res.data[0];\n        let newDirent = new Dirent({\n          'type': 'file',\n          'name': fileObj.name,\n          'size': fileObj.size,\n          'mtime': (new Date()).getTime()\n        });\n        let direntList = this.state.direntList;\n        const dirs = direntList.filter(item => { return !item.is_file; });\n        direntList.splice(dirs.length, 0, newDirent);\n        this.setState({\n          direntList: direntList\n        });\n      });\n    }).catch((err) => {\n      let errMessage = Utils.getErrorMsg(err);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    const { loading, errorMsg,\n      repoName, direntList, path, userPerm } = this.state;\n    const { repoID } = this.props;\n\n    return (\n      <Fragment>\n        <MainPanelTopbar>\n          <Fragment>\n            <input className=\"d-none\" type=\"file\" onChange={this.onFileInputChange} ref={this.fileInput} />\n            {userPerm === 'rw' &&\n              <Button className=\"operation-item\" onClick={this.openFileInput}>{gettext('Upload')}</Button>\n            }\n          </Fragment>\n        </MainPanelTopbar>\n        <div className=\"main-panel-center flex-row\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path align-items-center\">\n              <DirPathBar\n                repoID={repoID}\n                repoName={repoName}\n                currentPath={path}\n                onPathClick={this.onPathClick}\n                onTabNavClick={this.props.onTabNavClick}\n              />\n            </div>\n            <div className=\"cur-view-content\">\n              <DirContent\n                loading={loading}\n                errorMsg={errorMsg}\n                direntList={direntList}\n                openFolder={this.openFolder}\n                deleteDirent={this.deleteDirent}\n                downloadDirent={this.downloadDirent}\n              />\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nexport default DirView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Select from 'react-select';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Form, FormGroup, Label, Alert } from 'reactstrap';\nimport { gettext, enableEncryptedLibrary, repoPasswordMinLength, storages, libraryTemplates } from '../../utils/constants';\n\nconst propTypes = {\n  libraryType: PropTypes.string.isRequired,\n  onCreateRepo: PropTypes.func.isRequired,\n  onCreateToggle: PropTypes.func.isRequired,\n};\n\nclass CreateRepoDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      repoName: '',\n      disabled: true,\n      encrypt: false,\n      password1: '',\n      password2: '',\n      errMessage: '',\n      permission: 'rw',\n      storage_id: storages.length ? storages[0].id : '',\n      library_template: libraryTemplates.length ? libraryTemplates[0] : '',\n      isSubmitBtnActive: false,\n    };\n  }\n\n  handleRepoNameChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({repoName: e.target.value});\n  }\n\n  handlePassword1Change = (e) => {\n    this.setState({password1: e.target.value});\n  }\n\n  handlePassword2Change = (e) => {\n    this.setState({password2: e.target.value});\n  }\n\n  handleSubmit = () => {\n    let isValid = this.validateInputParams();\n    if (isValid) {\n      let repoData = this.prepareRepoData();\n      if (this.props.libraryType === 'department') {\n        this.props.onCreateRepo(repoData, 'department');\n        return;\n      }\n      this.props.onCreateRepo(repoData);\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n      e.preventDefault();\n    }\n  }\n\n  toggle = () => {\n    this.props.onCreateToggle();\n  }\n\n  validateInputParams() {\n    let errMessage = '';\n    let repoName = this.state.repoName.trim();\n    if (!repoName.length) {\n      errMessage = gettext('Name is required');\n      this.setState({errMessage: errMessage});\n      return false;\n    }\n    if (repoName.indexOf('/') > -1) {\n      errMessage = gettext('Name should not include \\'/\\'.');\n      this.setState({errMessage: errMessage});\n      return false;\n    }\n    if (this.state.encrypt) {\n      let password1 = this.state.password1.trim();\n      let password2 = this.state.password2.trim();\n      if (!password1.length) {\n        errMessage = gettext('Please enter password');\n        this.setState({errMessage: errMessage});\n        return false;\n      }\n      if (!password2.length) {\n        errMessage = gettext('Please enter the password again');\n        this.setState({errMessage: errMessage});\n        return false;\n      }\n      if (password1.length < repoPasswordMinLength) {\n        errMessage = gettext('Password is too short');\n        this.setState({errMessage: errMessage});\n        return false;\n      }\n      if (password1 !== password2) {\n        errMessage = gettext('Passwords don\\'t match');\n        this.setState({errMessage: errMessage});\n        return false;\n      }\n    }\n    return true;\n  }\n\n  onPermissionChange = (e) => {\n    let permission = e.target.value;\n    this.setState({permission: permission});\n  }\n\n  handleStorageInputChange = (selectedItem) => {\n    this.setState({storage_id: selectedItem.value});\n  }\n\n  handlelibraryTemplatesInputChange = (selectedItem) => {\n    this.setState({library_template: selectedItem.value});\n  }\n\n  onEncrypted = (e) => {\n    let isChecked = e.target.checked;\n    this.setState({\n      encrypt: isChecked,\n      disabled: !isChecked\n    });\n  }\n\n  prepareRepoData = () => {\n    let libraryType = this.props.libraryType;\n\n    let repoName = this.state.repoName.trim();\n    let password = this.state.encrypt ? this.state.password1 : '';\n    let permission = this.state.permission;\n\n    let repo = null;\n    if (libraryType === 'mine' || libraryType === 'public') {\n      repo = {\n        name: repoName,\n        passwd: password\n      };\n    }\n    if (libraryType === 'group') {\n      repo = {\n        repo_name: repoName,\n        password: password,\n        permission: permission,\n      };\n    }\n    if (libraryType === 'department') {\n      repo = {\n        repo_name: repoName,\n        passwd: password,\n      };\n    }\n\n    const storage_id = this.state.storage_id;\n    if (storage_id) {\n      repo.storage_id = storage_id;\n    }\n\n    const library_template = this.state.library_template;\n    if (library_template) {\n      repo.library_template = library_template;\n    }\n\n    return repo;\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle} autoFocus={false}>\n        <ModalHeader toggle={this.toggle}>{gettext('New Library')}</ModalHeader>\n        <ModalBody>\n          <Form>\n            <FormGroup>\n              <Label for=\"repoName\">{gettext('Name')}</Label>\n              <Input\n                id=\"repoName\"\n                onKeyPress={this.handleKeyPress}\n                value={this.state.repoName}\n                onChange={this.handleRepoNameChange}\n                autoFocus={true}\n              />\n            </FormGroup>\n\n            {libraryTemplates.length > 0 && (\n              <FormGroup>\n                <Label for=\"library-template\">{gettext('Template')}</Label>\n                <Select\n                  id=\"library-template\"\n                  defaultValue={{value: libraryTemplates[0], label: libraryTemplates[0]}}\n                  options={libraryTemplates.map((item, index) => { return {value: item, label: item}; })}\n                  onChange={this.handlelibraryTemplatesInputChange}\n                /> \n              </FormGroup>\n            )}\n\n            {storages.length > 0 && (\n              <FormGroup>\n                <Label for=\"storage-backend\">{gettext('Storage Backend')}</Label>\n                <Select\n                  id=\"storage-backend\"\n                  defaultValue={{value: storages[0].id, label: storages[0].name}}\n                  options={storages.map((item, index) => { return {value: item.id, label: item.name}; })}\n                  onChange={this.handleStorageInputChange}\n                />\n              </FormGroup>\n            )}\n\n            {this.props.libraryType === 'group' && (\n              <FormGroup>\n                <Label for=\"exampleSelect\">{gettext('Permission')}</Label>\n                <Input type=\"select\" name=\"select\" id=\"exampleSelect\" onChange={this.onPermissionChange} value={this.state.permission}>\n                  <option value='rw'>{gettext('Read-Write')}</option>\n                  <option value='r'>{gettext('Read-Only')}</option>\n                </Input>\n              </FormGroup>\n            )}\n            {enableEncryptedLibrary &&\n              <div>\n                <FormGroup check>\n                  <Input type=\"checkbox\" id=\"encrypt\" onChange={this.onEncrypted} />\n                  <Label for=\"encrypt\">{gettext('Encrypt')}</Label>\n                </FormGroup>\n                {!this.state.disabled &&\n                  <FormGroup>\n                    {/* todo translate */}\n                    <Label for=\"passwd1\">{gettext('Password')}</Label><span className=\"tip\">{' '}{gettext('(at least {placeholder} characters)').replace('{placeholder}', repoPasswordMinLength)}</span>\n                    <Input\n                      id=\"passwd1\"\n                      type=\"password\"\n                      disabled={this.state.disabled}\n                      value={this.state.password1}\n                      onChange={this.handlePassword1Change}\n                      autoComplete=\"new-password\"\n                    />\n                  </FormGroup>\n                }\n                {!this.state.disabled &&\n                  <FormGroup>\n                    <Label for=\"passwd2\">{gettext('Password again')}</Label>\n                    <Input\n                      id=\"passwd2\"\n                      type=\"password\"\n                      disabled={this.state.disabled}\n                      value={this.state.password2}\n                      onChange={this.handlePassword2Change}\n                      autoComplete=\"new-password\"\n                    />\n                  </FormGroup>\n                }\n              </div>\n            }\n          </Form>\n          {this.state.errMessage && <Alert color=\"danger\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nCreateRepoDialog.propTypes = propTypes;\n\nexport default CreateRepoDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Utils } from '../../utils/utils';\nimport { Link, navigate } from '@gatsbyjs/reach-router';\nimport { siteRoot, gettext } from '../../utils/constants';\nimport ModalPortal from '../modal-portal';\nimport CreateRepoDialog from '../dialog/create-repo-dialog';\nimport { DropdownToggle, Dropdown, DropdownMenu, DropdownItem } from 'reactstrap';\n\nconst propTypes = {\n  libraryType: PropTypes.string.isRequired,\n  onCreateRepo: PropTypes.func.isRequired,\n  onShowSidePanel: PropTypes.func.isRequired,\n};\n\nclass RepoViewToolbar extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isCreateRepoDialogShow: false,\n      isOpen: false,\n    };\n  }\n\n  onCreateRepo = (repo) => {\n    this.props.onCreateRepo(repo);\n    this.onCreateToggle();\n  }\n\n  onCreateToggle = () => {\n    this.setState({isCreateRepoDialogShow: !this.state.isCreateRepoDialogShow});\n  }\n\n  toggleMore = () => {\n    this.setState({ isOpen: !this.state.isOpen });\n  }\n\n  onDropdownToggleKeyDown = (e) => {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      this.toggleMore();\n    }\n  }\n\n  visitDeletedviaKey = (e) => {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      navigate(`${siteRoot}my-libs/deleted/`);\n    }\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"cur-view-toolbar\">\n          <span className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\" title=\"Side Nav Menu\" onClick={this.props.onShowSidePanel}></span>\n          {Utils.isDesktop() ? (\n            <div className=\"operation\">\n              <button className=\"btn btn-secondary operation-item\" title={gettext('New Library')} onClick={this.onCreateToggle}>\n                <i className=\"fas fa-plus-square text-secondary mr-1\"></i>{gettext('New Library')}\n              </button>\n              <Dropdown isOpen={this.state.isOpen} toggle={this.toggleMore}>\n                <DropdownToggle className='btn btn-secondary operation-item' onKeyDown={this.onDropdownToggleKeyDown}>\n                  {gettext('More')}\n                </DropdownToggle>\n                <DropdownMenu>\n                  <DropdownItem className=\"link-dropdown-container\" onKeyDown={this.visitDeletedviaKey}>\n                    <Link className=\"link-dropdown-item\" to={siteRoot + 'my-libs/deleted/'}>{gettext('Deleted Libraries')}</Link>\n                  </DropdownItem>\n                </DropdownMenu>\n              </Dropdown>\n            </div>\n          ) : (\n            <span className=\"sf2-icon-plus mobile-toolbar-icon\" title={gettext('New Library')} onClick={this.onCreateToggle}></span>\n          )}\n        </div>\n        {this.state.isCreateRepoDialogShow && (\n          <ModalPortal>\n            <CreateRepoDialog\n              libraryType={this.props.libraryType}\n              onCreateRepo={this.onCreateRepo}\n              onCreateToggle={this.onCreateToggle}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nRepoViewToolbar.propTypes = propTypes;\n\nexport default RepoViewToolbar;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Utils } from '../../utils/utils';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport toaster from '../toast';\nimport '../../css/dirent-detail.css';\n\nconst propTypes = {\n  currentRepo: PropTypes.object.isRequired,\n  closeDetails: PropTypes.func.isRequired,\n};\n\nclass LibDetail extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      fileCount: 0,\n    };\n  }\n\n  componentDidMount() {\n    let repo = this.props.currentRepo;\n    this.getFileCounts(repo);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.currentRepo.repo_id !== this.props.currentRepo.repo_id) {\n      this.getFileCounts(nextProps.currentRepo);\n    }\n  }\n\n  getFileCounts = (repo) => {\n    seafileAPI.getRepoInfo(repo.repo_id).then(res => {\n      this.setState({fileCount: res.data.file_count});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    let repo = this.props.currentRepo;\n    let smallIconUrl = Utils.getLibIconUrl(repo);\n    let bigIconUrl = Utils.getLibIconUrl(repo, true);\n\n    return (\n      <div className=\"detail-container\">\n        <div className=\"detail-header\">\n          <div className=\"detail-control sf2-icon-x1\" onClick={this.props.closeDetails}></div>\n          <div className=\"detail-title dirent-title\">\n            <img src={smallIconUrl} width=\"24\" height=\"24\" alt=\"\" />{'  '}\n            <span className=\"name ellipsis\" title={repo.repo_name}>{repo.repo_name}</span>\n          </div>\n        </div>\n        <div className=\"detail-body dirent-info\">\n          <div className=\"img\">\n            <img src={bigIconUrl} height=\"96\"  alt=\"\" />\n          </div>\n          <div className=\"dirent-table-container\">\n            <table className=\"table-thead-hidden\">\n              <thead>\n                <tr><th width=\"35%\"></th><th width=\"65%\"></th></tr>\n              </thead>\n              <tbody>\n                <tr><th>{gettext('Files')}</th><td>{this.state.fileCount}</td></tr>\n                <tr><th>{gettext('Size')}</th><td>{repo.size}</td></tr>\n                <tr><th>{gettext('Last Update')}</th><td>{ moment(repo.last_modified).fromNow()}</td></tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nLibDetail.propTypes = propTypes;\n\nexport default LibDetail;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Form, FormGroup, Label, Input, Alert } from 'reactstrap';\nimport { gettext, enableRepoHistorySetting } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api.js';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nconst propTypes = {\n  itemName: PropTypes.string.isRequired,\n  toggleDialog: PropTypes.func.isRequired,\n  repoID: PropTypes.string.isRequired,\n};\n\nclass LibHistorySetting extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      keepDays: -1,\n      expireDays: 30,\n      disabled: true,\n      allHistory: true,\n      noHistory: false,\n      autoHistory: false,\n      errorInfo: ''\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.getRepoHistoryLimit(this.props.repoID).then(res => {\n      this.setState({\n        keepDays: res.data.keep_days,\n        allHistory: res.data.keep_days < 0 ? true : false,\n        noHistory: res.data.keep_days === 0 ? true : false,\n        autoHistory: res.data.keep_days > 0 ? true : false,\n        disabled: res.data.keep_days > 0 ? false : true,\n        expireDays: res.data.keep_days > 0 ? res.data.keep_days : 30,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  submit = () => {\n    let days = this.state.keepDays;\n    if (this.state.autoHistory) {\n      days = this.state.expireDays;\n    }\n    let repoID = this.props.repoID;\n    let reg = /^-?\\d+$/;\n    let flag = reg.test(days);\n    if (flag) {\n      let message = gettext('Successfully set library history.');\n      seafileAPI.setRepoHistoryLimit(repoID, days).then(res => {\n        toaster.success(message);\n        this.setState({keepDays: res.data.keep_days});\n        this.props.toggleDialog();\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      this.setState({\n        errorInfo: gettext('Please enter a non-negative integer'),\n      });\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.submit();\n      e.preventDefault();\n    }\n  }\n\n  onChange = (e) => {\n    let num = e.target.value;\n    this.setState({\n      keepDays: num,\n      expireDays: num,\n    });\n  }\n\n  setLimitDays = (type) => {\n    if (type === 'allHistory') {\n      this.setState({\n        keepDays: -1,\n        disabled: true\n      });\n    } else if (type === 'noHistory') {\n      this.setState({\n        keepDays: 0,\n        disabled: true\n      });\n    } else {\n      this.setState({\n        disabled: false\n      });\n    }\n\n    this.setState({\n      allHistory: type === 'allHistory' ? true : false,\n      noHistory: type === 'noHistory' ? true : false,\n      autoHistory: type === 'autoHistory' ? true : false,\n    });\n  }\n\n  render() {\n    const itemName = this.props.itemName;\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.props.toggleDialog}>\n          <span className=\"op-target\" title={itemName}>{itemName}</span>{' '}\n          {gettext('History Setting')}\n        </ModalHeader>\n        <ModalBody>\n          <Form>\n            {!enableRepoHistorySetting &&\n              <FormGroup>\n                <Label className=\"error\">{gettext('Setting library history is disabled by Admin.')}</Label>\n              </FormGroup>\n            }\n            <FormGroup check>\n              <Input type=\"radio\" name=\"radio1\" checked={this.state.allHistory} disabled={!enableRepoHistorySetting} onChange={() => {this.setLimitDays('allHistory');}}/>{' '}\n              <Label>{gettext('Keep full history')}</Label>\n            </FormGroup>\n            <FormGroup check>\n              <Input type=\"radio\" name=\"radio1\" checked={this.state.noHistory} disabled={!enableRepoHistorySetting} onChange={() =>{this.setLimitDays('noHistory');}}/>{' '}\n              <Label>{gettext('Don\\'t keep history')}</Label>\n            </FormGroup>\n            <FormGroup check>\n              <Input type=\"radio\" name=\"radio1\" checked={this.state.autoHistory} disabled={!enableRepoHistorySetting} onChange={() =>{this.setLimitDays('autoHistory');}}/>{' '}\n              <Label>{gettext('Only keep a period of history:')}</Label>\n              <Input\n                type=\"text\"\n                className=\"expire-input\"\n                value={this.state.expireDays}\n                onChange={this.onChange}\n                disabled={this.state.disabled}\n                onKeyDown={this.handleKeyPress}\n              />{' '}\n              <Label><span>{gettext('days')}</span></Label>\n            </FormGroup>\n            {this.state.errorInfo && <Alert color=\"danger\">{this.state.errorInfo}</Alert>}\n          </Form>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.submit}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nLibHistorySetting.propTypes = propTypes;\n\nexport default LibHistorySetting;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Alert } from 'reactstrap';\nimport { gettext, repoPasswordMinLength } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport toaster from '../toast';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  repoName: PropTypes.string.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass ChangeRepoPasswordDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      oldPassword: '',\n      newPassword: '',\n      newPasswordAgain: '',\n      submitBtnDisabled: false,\n      errorMsg: ''\n    };\n  }\n\n  handleOldPasswordInputChange = (e) => {\n    this.setState({\n      oldPassword: e.target.value\n    });\n  }\n\n  handleNewPasswordInputChange = (e) => {\n    this.setState({\n      newPassword: e.target.value\n    });\n  }\n\n  handleNewPasswordAgainInputChange = (e) => {\n    this.setState({\n      newPasswordAgain: e.target.value\n    });\n  }\n\n  formSubmit = (e) => {\n    const { oldPassword, newPassword, newPasswordAgain } = this.state;\n    if (!oldPassword) {\n      this.setState({\n        errorMsg: gettext('Please enter the old password')\n      });\n      return false;\n    }\n    if (!newPassword) {\n      this.setState({\n        errorMsg: gettext('Please enter a new password')\n      });\n      return false;\n    }\n    if (newPassword.length < repoPasswordMinLength) {\n      this.setState({\n        errorMsg: gettext('New password is too short')\n      });\n      return false;\n    }\n    if (!newPasswordAgain) {\n      this.setState({\n        errorMsg: gettext('Please enter the new password again')\n      });\n      return false;\n    }\n    if (newPassword != newPasswordAgain) {\n      this.setState({\n        errorMsg: gettext('New passwords don\\'t match')\n      });\n      return false;\n    }\n\n    this.setState({\n      submitBtnDisabled: true\n    });\n    seafileAPI.changeEncryptedRepoPassword(this.props.repoID, oldPassword, newPassword)\n      .then(() => {\n        this.props.toggleDialog();\n        toaster.success(gettext('Successfully changed library password.'));\n      }).catch((error) => {\n        let errorMsg = Utils.getErrorMsg(error);\n        this.setState({\n          errorMsg: errorMsg,\n          submitBtnDisabled: false\n        });\n      });\n  }\n\n\n  render() {\n    const { repoName, toggleDialog } = this.props;\n\n    return (\n      <Modal isOpen={true} centered={true} style={{height: 'auto'}}>\n        <ModalHeader toggle={toggleDialog}>\n          <span>\n            {Utils.generateDialogTitle(gettext('Change Password of Library {placeholder}'), repoName)}\n          </span>\n        </ModalHeader>\n        <ModalBody>\n          <form id=\"repo-change-passwd-form\" action=\"\" method=\"post\">\n            <label htmlFor=\"passwd\">{gettext('Old Password')}</label><br />\n            <input type=\"password\" name=\"old_passwd\" className=\"form-control\" id=\"passwd\" value={this.state.oldPassword} onChange={this.handleOldPasswordInputChange} /><br />\n            <label htmlFor=\"new-passwd\">{gettext('New Password')}</label><span className=\"tip\">{gettext('(at least {placeholder} characters)').replace('{placeholder}', repoPasswordMinLength)}</span><br />\n            <input type=\"password\" name=\"new_passwd\" className=\"form-control\" id=\"new-passwd\" value={this.state.newPassword} onChange={this.handleNewPasswordInputChange} /><br />\n            <label htmlFor=\"new-passwd-again\">{gettext('New Password Again')}</label><br />\n            <input type=\"password\" name=\"new_passwd_again\" className=\"form-control\" id=\"new-passwd-again\" value={this.state.newPasswordAgain} onChange={this.handleNewPasswordAgainInputChange} /><br />\n            {this.state.errorMsg && <Alert color=\"danger\">{this.state.errorMsg}</Alert>}\n          </form>\n        </ModalBody>\n        <ModalFooter>\n          <button className=\"btn btn-primary\" disabled={this.state.submitBtnDisabled} onClick={this.formSubmit}>{gettext('Submit')}</button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nChangeRepoPasswordDialog.propTypes = propTypes;\n\nexport default ChangeRepoPasswordDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport toaster from '../../components/toast';\nimport { Button, Form, FormGroup, Label, Input, Modal, ModalHeader, ModalBody, ModalFooter, Alert } from 'reactstrap';\nimport { gettext, contactEmail } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  toggleDialog: PropTypes.func.isRequired,\n};\n\nclass ResetEncryptedRepoPasswordDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      errMessage: '',\n      showLoading: true,\n      showSuccess: false,\n      showError: false,\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.resetAndSendEncryptedRepoPassword(this.props.repoID).then((res) => {\n      this.setState({showLoading: false});\n      this.setState({showSuccess: true});\n    }).catch((error) => {\n      if (error.response) {\n        this.setState({\n          errMessage: error.response.data.error_msg\n        });\n        this.setState({showLoading: false});\n        this.setState({showError: true});\n      }\n    });\n  }\n\n  render() {\n\n    let user_email = '<strong>' + contactEmail + '</strong>';\n    let message = gettext('New password has been sent to your email {mail}. Please check your mailbox. If you dont receive the password, please check if your email address is properly configured.').replace('{mail}', user_email);\n\n    return (\n      <Modal isOpen={true}  centered={true}>\n        <ModalHeader toggle={this.props.toggleDialog}>\n          {gettext('Reset library password')}\n        </ModalHeader>\n        <ModalBody>\n          {this.state.showLoading && (\n            <span>{gettext('Sending new password...')}</span>\n          )}\n          {this.state.showSuccess && (\n            <div dangerouslySetInnerHTML={{__html:message}} />\n          )}\n          {this.state.showError && (\n            <span className=\"err-message\">{this.state.errMessage}</span>\n          )}\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nResetEncryptedRepoPasswordDialog.propTypes = propTypes;\n\nexport default ResetEncryptedRepoPasswordDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport CreatableSelect from 'react-select/creatable';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../loading';\nimport toaster from '../toast';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  repoName: PropTypes.string.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass LabelRepoStateDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      existingLabels: null,\n      errorMsg: '',\n      submitBtnDisabled: false\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.getAllRepoSnapshotLabels().then((res) => {\n      this.setState({\n        isLoading: false,\n        existingLabels: res.data,\n        errorMsg: ''\n      });\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        isLoading: false,\n        errorMsg: errorMsg\n      });\n    });\n  }\n\n  handleInputChange = (value) => {\n    this.setState({\n      inputValue: value\n    });\n  }\n\n  formSubmit = () => {\n    const inputValue = this.state.inputValue;\n\n    if (!inputValue || !inputValue.length) { // undefined or []\n      this.setState({\n        formErrorMsg: gettext('It is required.')\n      });\n      return;\n    }\n\n    this.setState({\n      submitBtnDisabled: true\n    });\n\n    const {repoID, repoName} = this.props;\n    const labels = inputValue.map((item, index) => item.value).join(',');\n    seafileAPI.addNewRepoLabels(repoID, labels).then((res) => {\n      const msg = gettext('Successfully added label(s) for library {placeholder}').replace('{placeholder}', repoName);\n      toaster.success(msg);\n      this.props.toggleDialog();\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        formErrorMsg: errorMsg,\n        submitBtnDisabled: false\n      });\n    });\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleDialog}>\n        <ModalHeader toggle={this.props.toggleDialog}>{gettext('Label Current State')}</ModalHeader>\n        <ModalBody>\n          <Content data={this.state} handleChange={this.handleInputChange} />\n        </ModalBody>\n        {this.state.existingLabels && (\n          <ModalFooter>\n            <button className=\"btn btn-secondary\" onClick={this.props.toggleDialog}>{gettext('Cancel')}</button>\n            <button className=\"btn btn-primary\" disabled={this.state.submitBtnDisabled} onClick={this.formSubmit}>{gettext('Submit')}</button>\n          </ModalFooter>\n        )}\n      </Modal>\n    );\n  }\n}\n\nclass Content extends React.Component {\n\n  render() {\n    const { isLoading, errorMsg, existingLabels, formErrorMsg } = this.props.data;\n\n    if (isLoading) {\n      return <Loading />;\n    }\n\n    if (errorMsg) {\n      return <p className=\"error mt-4 text-center\">{errorMsg}</p>;\n    }\n\n    return (\n      <React.Fragment>\n        <CreatableSelect\n          isMulti={true}\n          onChange={this.props.handleChange}\n          placeholder=''\n          options={existingLabels.map((item, index) => { return {label: item, value: item}; })}\n        />\n        {formErrorMsg && <p className=\"error m-0 mt-2\">{formErrorMsg}</p>}\n      </React.Fragment>\n    );\n  }\n}\n\nLabelRepoStateDialog.propTypes = propTypes;\n\nexport default LabelRepoStateDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext, isPro, siteRoot } from '../../utils/constants';\nimport { Button, Input, InputGroup, InputGroupAddon } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api.js';\nimport { Utils } from '../../utils/utils.js';\nimport UserSelect from '../user-select';\nimport SharePermissionEditor from '../select-editor/share-permission-editor';\nimport FileChooser from '../file-chooser/file-chooser';\n\nclass UserItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOperationShow: false\n    };\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOperationShow: true});\n  }\n\n  onMouseLeave = () => {\n    this.setState({isOperationShow: false});\n  }\n\n  deleteUserFolderPermission = () => {\n    let item = this.props.item;\n    this.props.deleteUserFolderPermission(item);\n  }\n\n  onChangeUserFolderPerm = (permission) => {\n    let item = this.props.item;\n    this.props.onChangeUserFolderPerm(item.repo_id, permission, item.folder_path, item.user_email);\n  }\n\n  render() {\n    let item = this.props.item;\n    let currentPermission = item.permission;\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter}>\n        <td>\n          <a href={`${siteRoot}profile/${encodeURIComponent(item.user_email)}/`} target=\"_blank\">{item.user_name}</a>\n        </td>\n        {this.props.showPath &&\n          <td>\n            <a href={`${siteRoot}library/${item.repo_id}/${Utils.encodePath(this.props.repoName + item.folder_path)}`}>{item.folder_name}</a>\n          </td>\n        }\n        <td>\n          <SharePermissionEditor\n            isTextMode={true}\n            autoFocus={true}\n            isEditIconShow={this.state.isOperationShow}\n            currentPermission={currentPermission}\n            permissions={this.props.permissions}\n            onPermissionChanged={this.onChangeUserFolderPerm}\n          />\n        </td>\n        <td>\n          <span\n            tabIndex=\"0\"\n            role=\"button\"\n            className={`sf2-icon-x3 action-icon ${this.state.isOperationShow ? '' : 'hide'}`}\n            onClick={this.deleteUserFolderPermission}\n            onKeyDown={Utils.onKeyDown}\n            title={gettext('Delete')}\n            aria-label={gettext('Delete')}\n          >\n          </span>\n        </td>\n      </tr>\n    );\n  }\n}\n\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  isDepartmentRepo: PropTypes.bool\n};\n\n\nclass LibSubFolderSetUserPermissionDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      selectedUsers: null,\n      errorMsg: [],\n      permission: 'rw',\n      userFolderPermItems: [],\n      folderPath: '',\n      showFileChooser: false\n    };\n    if (!isPro) {\n      this.permissions = ['r', 'rw'];\n    } else {\n      this.permissions = ['r', 'rw', 'cloud-edit', 'preview', 'invisible'];\n    }\n  }\n\n  handleUserSelectChange = (option) => {\n    this.setState({selectedUsers: option});\n  }\n\n  componentDidMount() {\n    const {repoID, folderPath, isDepartmentRepo} = this.props;\n    const request = isDepartmentRepo ?\n      seafileAPI.listDepartmentRepoUserFolderPerm(repoID, folderPath) :\n      seafileAPI.listUserFolderPerm(repoID, folderPath);\n    request.then((res) => {\n      if (res.data.length !== 0) {\n        this.setState({userFolderPermItems: res.data});\n      }\n    });\n  }\n\n  setPermission = (permission) => {\n    this.setState({permission: permission});\n  }\n\n  addUserFolderPerm = () => {\n    const { selectedUsers } = this.state;\n    const folderPath = this.props.folderPath || this.state.folderPath;\n    if (!selectedUsers || !selectedUsers.length || !folderPath) { // selectedUsers: null or []\n      return false;\n    }\n\n    const users = selectedUsers.map((item, index) => item.email);\n\n    const request = this.props.isDepartmentRepo ?\n      seafileAPI.addDepartmentRepoUserFolderPerm(this.props.repoID, this.state.permission, folderPath, users) :\n      seafileAPI.addUserFolderPerm(this.props.repoID, this.state.permission, folderPath, users);\n    request.then(res => {\n      let errorMsg = [];\n      if (res.data.failed.length > 0) {\n        for (let i = 0; i < res.data.failed.length; i++) {\n          errorMsg[i] = res.data.failed[i];\n        }\n      }\n      this.setState({\n        errorMsg: errorMsg,\n        userFolderPermItems: this.state.userFolderPermItems.concat(res.data.success),\n        selectedUsers: null,\n        permission: 'rw',\n        folderPath: '',\n      });\n      this.refs.userSelect.clearSelect();\n    }).catch((error) => {\n      let errorMsg = '';\n      if (error.response) {\n        if (error.response.data && error.response.data['error_msg']) {\n          errorMsg = error.response.data['error_msg'];\n        } else {\n          errorMsg = gettext('Error');\n        }\n      } else {\n        errorMsg = gettext('Please check the network.');\n      }\n      this.setState({\n        errorMsg: [errorMsg]\n      });\n    });\n  }\n\n  deleteUserFolderPermItem = (item) => {\n    const request = this.props.isDepartmentRepo ?\n      seafileAPI.deleteDepartmentRepoUserFolderPerm(item.repo_id, item.permission, item.folder_path, item.user_email) :\n      seafileAPI.deleteUserFolderPerm(item.repo_id, item.permission, item.folder_path, item.user_email);\n    request.then(res => {\n      this.setState({\n        userFolderPermItems: this.state.userFolderPermItems.filter(deletedItem => {\n          return deletedItem != item;\n        })\n      });\n    });\n  }\n\n  onChangeUserFolderPerm = (repoID, permission, folderPath, userEmail) => {\n    const request = this.props.isDepartmentRepo ?\n      seafileAPI.updateDepartmentRepoUserFolderPerm(repoID, permission, folderPath, userEmail) :\n      seafileAPI.updateUserFolderPerm(repoID, permission, folderPath, userEmail);\n    request.then(res => {\n      let userFolderPermItems = this.state.userFolderPermItems.map(item => {\n        if (item.user_email === userEmail && item.folder_path === folderPath) {\n          item.permission = permission;\n        }\n        return item;\n      });\n      this.setState({userFolderPermItems: userFolderPermItems});\n    });\n  }\n\n  onSetSubFolder = (e) => {\n    this.setState({\n      folderPath: e.target.value\n    });\n  }\n\n  toggleFileChooser = () => {\n    this.setState({\n      showFileChooser: !this.state.showFileChooser,\n      folderPath: ''\n    });\n  }\n\n  toggleSubFolder = (repo, path, item) => {\n    this.setState({\n      folderPath: path,\n    });\n  }\n\n  handleFileChooserSubmit = () => {\n    this.setState({\n      showFileChooser: !this.state.showFileChooser\n    });\n  }\n\n  onRepoItemClick = () => {\n    this.setState({\n      folderPath: '/'\n    });\n  }\n\n  render() {\n    let showPath = this.props.folderPath ? false : true;\n    let { userFolderPermItems } = this.state;\n\n    if (this.state.showFileChooser) {\n      return (\n        <div>\n          <FileChooser\n            repoID={this.props.repoID}\n            mode={'only_current_library'}\n            onDirentItemClick={this.toggleSubFolder}\n            onRepoItemClick={this.onRepoItemClick}\n          />\n          <div className=\"modal-footer\">\n            <Button color=\"secondary\" onClick={this.toggleFileChooser}>{gettext('Cancel')}</Button>\n            <Button color=\"primary\" onClick={this.handleFileChooserSubmit}>{gettext('Submit')}</Button>\n          </div>\n        </div>\n      );\n    }\n\n    const thead = (\n      <thead>\n        <tr>\n          <th width={showPath ? '32%': '55%'}>{gettext('User')}</th>\n          {showPath &&\n          <th width=\"32%\">{gettext('Folder')}</th>\n          }\n          <th width={showPath ? '24%': '30%'}>{gettext('Permission')}</th>\n          <th width={showPath ? '12%' : '15%'}></th>\n        </tr>\n      </thead>\n    );\n    return (\n      <Fragment>\n        <table className=\"w-xs-250\">\n          {thead}\n          <tbody>\n            <tr>\n              <td>\n                <UserSelect\n                  ref=\"userSelect\"\n                  isMulti={true}\n                  className=\"reviewer-select\"\n                  placeholder={gettext('Search users...')}\n                  onSelectChange={this.handleUserSelectChange}\n                  value={this.state.selectedUsers}\n                />\n              </td>\n              {showPath &&\n                <td>\n                  <InputGroup>\n                    <Input value={this.state.folderPath} onChange={this.onSetSubFolder} />\n                    <InputGroupAddon addonType=\"append\"><Button className=\"sf2-icon-plus\" onClick={this.toggleFileChooser}></Button></InputGroupAddon>\n                  </InputGroup>\n                </td>\n              }\n              <td>\n                <SharePermissionEditor\n                  isTextMode={false}\n                  isEditIconShow={false}\n                  currentPermission={this.state.permission}\n                  permissions={this.permissions}\n                  onPermissionChanged={this.setPermission}\n                />\n              </td>\n              <td>\n                <Button onClick={this.addUserFolderPerm}>{gettext('Submit')}</Button>\n              </td>\n            </tr>\n            {this.state.errorMsg.length > 0 &&\n              this.state.errorMsg.map((item, index) => {\n                let errMessage = '';\n                if (item.user_email) {\n                  errMessage = item.user_email + ': ' + item.error_msg;\n                } else {\n                  errMessage = item;\n                }\n                return (\n                  <tr key={index}>\n                    <td colSpan={3}><p className=\"error\">{errMessage}</p></td>\n                  </tr>\n                );\n              })\n            }\n          </tbody>\n        </table>\n        <div className=\"share-list-container\">\n          <table className=\"table-thead-hidden w-xs-250\">\n            {thead}\n            <tbody>\n              {userFolderPermItems.map((item, index) => {\n                return (\n                  <UserItem\n                    key={index}\n                    item={item}\n                    permissions={this.permissions}\n                    deleteUserFolderPermission={this.deleteUserFolderPermItem}\n                    onChangeUserFolderPerm={this.onChangeUserFolderPerm}\n                    showPath={showPath}\n                    repoName={this.props.repoName}\n                  />\n                );\n              })}\n            </tbody>\n          </table>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nLibSubFolderSetUserPermissionDialog.propTypes = propTypes;\n\nexport default LibSubFolderSetUserPermissionDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Input, InputGroup, InputGroupAddon } from 'reactstrap';\nimport Select from 'react-select';\nimport { gettext, isPro, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api.js';\nimport { Utils } from '../../utils/utils.js';\nimport SharePermissionEditor from '../select-editor/share-permission-editor';\nimport FileChooser from '../file-chooser/file-chooser';\n\nclass GroupItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOperationShow: false\n    };\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOperationShow: true});\n  }\n\n  onMouseLeave = () => {\n    this.setState({isOperationShow: false});\n  }\n\n  deleteGroupPermissionItem = () => {\n    let item = this.props.item;\n    this.props.deleteGroupPermissionItem(item);\n  }\n\n  onChangeGroupPermission = (permission) => {\n    let item = this.props.item;\n    this.props.onChangeGroupPermission(item, permission);\n  }\n\n  render() {\n    let item = this.props.item;\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter}>\n        <td>\n          <a href={`${siteRoot}group/${item.group_id}/`} target=\"_blank\">{item.group_name}</a>\n        </td>\n        {this.props.showPath &&\n          <td>\n            <a href={`${siteRoot}library/${item.repo_id}/${Utils.encodePath(this.props.repoName + item.folder_path)}`}>{item.folder_name}</a>\n          </td>\n        }\n        <td>\n          <SharePermissionEditor\n            isTextMode={true}\n            autoFocus={true}\n            isEditIconShow={this.state.isOperationShow}\n            currentPermission={item.permission}\n            permissions={this.props.permissions}\n            onPermissionChanged={this.onChangeGroupPermission}\n          />\n        </td>\n        <td>\n          <span\n            tabIndex=\"0\"\n            role=\"button\"\n            className={`sf2-icon-x3 action-icon ${this.state.isOperationShow ? '' : 'hide'}`}\n            onClick={this.deleteGroupPermissionItem}\n            onKeyDown={Utils.onKeyDown}\n            title={gettext('Delete')}\n            aria-label={gettext('Delete')}\n          >\n          </span>\n        </td>\n      </tr>\n    );\n  }\n}\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  isDepartmentRepo: PropTypes.bool\n};\n\nconst NoOptionsMessage = (props) => {\n  return (\n    <div {...props.innerProps} style={{margin: '6px 10px', textAlign: 'center', color: 'hsl(0,0%,50%)'}}>{gettext('Group not found')}</div>\n  );\n};\n\nclass LibSubFolderSerGroupPermissionDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      selectedOption: null,\n      errorMsg: [],\n      permission: 'rw',\n      groupPermissionItems: [],\n      folderPath: '',\n      showFileChooser: false\n    };\n    this.options = [];\n    if (!isPro) {\n      this.permissions = ['r', 'rw'];\n    } else {\n      this.permissions = ['r', 'rw', 'cloud-edit', 'preview'];\n    }\n  }\n\n  handleSelectChange = (option) => {\n    this.setState({selectedOption: option});\n  }\n\n  componentDidMount() {\n    this.loadOptions();\n    this.listGroupPermissionItems();\n  }\n\n  loadOptions = () => {\n    seafileAPI.shareableGroups().then((res) => {\n      this.options = res.data.map((item, index) => {\n        return {\n          id: item.id,\n          label: item.name,\n          value: item.name\n        };\n      });\n    });\n  }\n\n  listGroupPermissionItems = () => {\n    const { isDepartmentRepo, repoID, folderPath } = this.props;\n    const request = isDepartmentRepo ?\n      seafileAPI.listDepartmentRepoGroupFolderPerm(repoID, folderPath) :\n      seafileAPI.listGroupFolderPerm(repoID, folderPath);\n    request.then((res) => {\n      if (res.data.length !== 0) {\n        this.setState({\n          groupPermissionItems: res.data\n        });\n      }\n    });\n  }\n\n  setPermission = (permission) => {\n    this.setState({permission: permission});\n  }\n\n  addGroupFolderPerm = () => {\n    const { selectedOption } = this.state;\n    const folderPath = this.props.folderPath || this.state.folderPath;\n    if (!selectedOption || !folderPath) {\n      return false;\n    }\n\n    const request = this.props.isDepartmentRepo ?\n      seafileAPI.addDepartmentRepoGroupFolderPerm(this.props.repoID, this.state.permission, folderPath, selectedOption.id) :\n      seafileAPI.addGroupFolderPerm(this.props.repoID, this.state.permission, folderPath, selectedOption.id);\n    request.then(res => {\n      let errorMsg = [];\n      if (res.data.failed.length > 0) {\n        for (let i = 0; i < res.data.failed.length; i++) {\n          errorMsg[i] = res.data.failed[i];\n        }\n      }\n\n      this.setState({\n        errorMsg: errorMsg,\n        groupPermissionItems: this.state.groupPermissionItems.concat(res.data.success),\n        selectedOption: null,\n        permission: 'rw',\n        folderPath: ''\n      });\n    }).catch((error) => {\n      let errorMsg = '';\n      if (error.response) {\n        if (error.response.data && error.response.data['error_msg']) {\n          errorMsg = error.response.data['error_msg'];\n        } else {\n          errorMsg = gettext('Error');\n        }\n      } else {\n        errorMsg = gettext('Please check the network.');\n      }\n      this.setState({\n        errorMsg: [errorMsg]\n      });\n    });\n  }\n\n  deleteGroupPermissionItem = (item) => {\n    const request = this.props.isDepartmentRepo ?\n      seafileAPI.deleteDepartmentRepoGroupFolderPerm(item.repo_id, item.permission, item.folder_path, item.group_id) :\n      seafileAPI.deleteGroupFolderPerm(item.repo_id, item.permission, item.folder_path, item.group_id);\n    request.then(() => {\n      this.setState({\n        groupPermissionItems: this.state.groupPermissionItems.filter(deletedItem => { return deletedItem != item; })\n      });\n    });\n  }\n\n  onChangeGroupPermission = (item, permission) => {\n    const request = this.props.isDepartmentRepo ?\n      seafileAPI.updateDepartmentRepoGroupFolderPerm(item.repo_id, permission, item.folder_path, item.group_id) :\n      seafileAPI.updateGroupFolderPerm(item.repo_id, permission, item.folder_path, item.group_id);\n    request.then(() => {\n      this.updateGroupPermission(item, permission);\n    });\n  }\n\n  updateGroupPermission = (item, permission) => {\n    let groupID = item.group_id;\n    let groupPermissionItems = this.state.groupPermissionItems.map(sharedItem => {\n      let sharedItemGroupID = sharedItem.group_id;\n      if (groupID === sharedItemGroupID && item.folder_path === sharedItem.folder_path) {\n        sharedItem.permission = permission;\n      }\n      return sharedItem;\n    });\n    this.setState({groupPermissionItems: groupPermissionItems});\n  }\n\n  onSetSubFolder = (e) => {\n    this.setState({\n      folderPath: e.target.value\n    });\n  }\n\n  toggleFileChooser = () => {\n    this.setState({\n      showFileChooser: !this.state.showFileChooser,\n      folderPath: ''\n    });\n  }\n\n  toggleSubFolder = (repo, path, item) => {\n    this.setState({\n      folderPath: path,\n    });\n  }\n\n  handleSubmit = () => {\n    this.setState({\n      showFileChooser: !this.state.showFileChooser\n    });\n  }\n\n  onRepoItemClick = () => {\n    this.setState({\n      folderPath: '/'\n    });\n  }\n\n  render() {\n    let showPath = this.props.folderPath ? false : true;\n\n    if (this.state.showFileChooser) {\n      return (\n        <div>\n          <FileChooser\n            repoID={this.props.repoID}\n            mode={'only_current_library'}\n            onDirentItemClick={this.toggleSubFolder}\n            onRepoItemClick={this.onRepoItemClick}\n          />\n          <div className=\"modal-footer\">\n            <Button color=\"secondary\" onClick={this.toggleFileChooser}>{gettext('Cancel')}</Button>\n            <Button color=\"primary\" onClick={this.handleSubmit}>{gettext('Submit')}</Button>\n          </div>\n        </div>\n      );\n    }\n\n    const thead = (\n      <thead>\n        <tr>\n          <th width={showPath ? '32%' : '55%'}>{gettext('Group')}</th>\n          {showPath &&\n          <th width=\"32%\">{gettext('Folder')}</th>\n          }\n          <th width={showPath ? '24%' : '30%'}>{gettext('Permission')}</th>\n          <th width={showPath ? '12%' : '15%'}></th>\n        </tr>\n      </thead>\n    );\n    return (\n      <Fragment>\n        <table className=\"w-xs-250\">\n          {thead}\n          <tbody>\n            <tr>\n              <td>\n                <Select\n                  onChange={this.handleSelectChange}\n                  options={this.options}\n                  placeholder={gettext('Select a group')}\n                  maxMenuHeight={200}\n                  inputId={'react-select-2-input'}\n                  value={this.state.selectedOption}\n                  components={{ NoOptionsMessage }}\n                />\n              </td>\n              {showPath &&\n                <td>\n                  <InputGroup>\n                    <Input value={this.state.folderPath} onChange={this.onSetSubFolder} />\n                    <InputGroupAddon addonType=\"append\"><Button className=\"sf2-icon-plus\" onClick={this.toggleFileChooser}></Button></InputGroupAddon>\n                  </InputGroup>\n                </td>\n              }\n              <td>\n                <SharePermissionEditor\n                  isTextMode={false}\n                  isEditIconShow={false}\n                  currentPermission={this.state.permission}\n                  permissions={this.permissions}\n                  onPermissionChanged={this.setPermission}\n                />\n              </td>\n              <td>\n                <Button onClick={this.addGroupFolderPerm}>{gettext('Submit')}</Button>\n              </td>\n            </tr>\n            {this.state.errorMsg.length > 0 &&\n              this.state.errorMsg.map((item, index) => {\n                let errMessage = item.group_id + ': ' + item.error_msg;\n                return (\n                  <tr key={index}>\n                    <td colSpan={3}><p className=\"error\">{errMessage}</p></td>\n                  </tr>\n                );\n              })\n            }\n          </tbody>\n        </table>\n        <div className=\"share-list-container\">\n          <table className=\"table-thead-hidden w-xs-250\">\n            {thead}\n            <tbody>\n              {this.state.groupPermissionItems.map((item, index) => {\n                return (\n                  <GroupItem\n                    key={index}\n                    item={item}\n                    permissions={this.permissions}\n                    deleteGroupPermissionItem={this.deleteGroupPermissionItem}\n                    onChangeGroupPermission={this.onChangeGroupPermission}\n                    showPath={showPath}\n                    repoName={this.props.repoName}\n                  />\n                );\n              })}\n            </tbody>\n          </table>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nLibSubFolderSerGroupPermissionDialog.propTypes = propTypes;\n\nexport default LibSubFolderSerGroupPermissionDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, TabContent, TabPane, Nav, NavItem, NavLink } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport LibSubFolderSetUserPermissionDialog from './lib-sub-folder-set-user-permission-dialog';\nimport LibSubFolderSetGroupPermissionDialog from './lib-sub-folder-set-group-permission-dialog';\nimport '../../css/share-link-dialog.css';\nimport '../../css/sub-folder-permission.css';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  repoName: PropTypes.string,\n  isDepartmentRepo: PropTypes.bool,\n  folderPath: PropTypes.string,\n  folderName: PropTypes.string,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass LibSubFolderPermissionDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      activeTab: 'userPermission'\n    };\n  }\n\n  toggle = (tab) => {\n    if (this.state.activeTab !== tab) {\n      this.setState({activeTab: tab});\n    }\n  }\n\n  renderContent = () => {\n    const activeTab = this.state.activeTab;\n\n    return (\n      <Fragment>\n        <div className=\"share-dialog-side\">\n          <Nav pills>\n            <NavItem role=\"tab\" aria-selected={activeTab === 'userPermission'} aria-controls=\"user-perm-panel\">\n              <NavLink className={activeTab === 'userPermission' ? 'active' : ''} onClick={this.toggle.bind(this, 'userPermission')} tabIndex=\"0\" onKeyDown={Utils.onKeyDown}>\n                {gettext('User Permission')}\n              </NavLink>\n            </NavItem>\n            <NavItem role=\"tab\" aria-selected={activeTab === 'groupPermission'} aria-controls=\"group-perm-panel\">\n              <NavLink className={activeTab === 'groupPermission' ? 'active' : ''} onClick={this.toggle.bind(this, 'groupPermission')} tabIndex=\"0\" onKeyDown={Utils.onKeyDown}>\n                {gettext('Group Permission')}\n              </NavLink>\n            </NavItem>\n          </Nav>\n        </div>\n        <div className=\"share-dialog-main\">\n          <TabContent activeTab={this.state.activeTab}>\n            <TabPane tabId=\"userPermission\" role=\"tabpanel\" id=\"user-perm-panel\">\n              <LibSubFolderSetUserPermissionDialog repoID={this.props.repoID} repoName={this.props.repoName} folderPath={this.props.folderPath} isDepartmentRepo={this.props.isDepartmentRepo} />\n            </TabPane>\n            <TabPane tabId=\"groupPermission\" role=\"tabpanel\" id=\"group-perm-panel\">\n              <LibSubFolderSetGroupPermissionDialog repoID={this.props.repoID} repoName={this.props.repoName} folderPath={this.props.folderPath} isDepartmentRepo={this.props.isDepartmentRepo} />\n            </TabPane>\n          </TabContent>\n        </div>\n      </Fragment>\n    );\n  }\n\n  render() {\n    const { repoName, folderName } = this.props;\n    return (\n      <div>\n        <Modal isOpen={true} style={{maxWidth: '980px'}} className=\"share-dialog\" toggle={this.props.toggleDialog}>\n          <ModalHeader toggle={this.props.toggleDialog}>\n            <span>{repoName ? Utils.generateDialogTitle(gettext('{placeholder} Folder Permission'), repoName) : Utils.generateDialogTitle(gettext('Set {placeholder}\\'s permission'), folderName)}</span>\n          </ModalHeader>\n          <ModalBody className=\"dialog-list-container share-dialog-content\" role=\"tablist\">\n            {this.renderContent()}\n          </ModalBody>\n        </Modal>\n      </div>\n    );\n  }\n}\n\nLibSubFolderPermissionDialog.propTypes = propTypes;\n\nexport default LibSubFolderPermissionDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Dropdown, DropdownMenu, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { gettext, isPro, folderPermEnabled, enableRepoSnapshotLabel, enableResetEncryptedRepoPassword, isEmailConfigured, enableRepoAutoDel } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  isPC: PropTypes.bool,\n  repo: PropTypes.object.isRequired,\n  isStarred: PropTypes.bool,\n  onFreezedItem: PropTypes.func.isRequired,\n  onUnfreezedItem: PropTypes.func.isRequired,\n  onMenuItemClick: PropTypes.func.isRequired,\n};\n\nclass MylibRepoMenu extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemMenuShow: false,\n    };\n  }\n\n  onMenuItemClick = (e) => {\n    let operation = Utils.getEventData(e, 'toggle');\n    this.props.onMenuItemClick(operation);\n  }\n\n  onMenuItemKeyDown = (e) => {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      this.onMenuItemClick(e);\n    }\n  }\n\n  onDropdownToggleClick = (e) => {\n    this.toggleOperationMenu(e);\n  }\n\n  onDropdownToggleKeyDown = (e) => {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      this.onDropdownToggleClick(e);\n    }\n  }\n\n  toggleOperationMenu = (e) => {\n    let dataset = e.target ? e.target.dataset : null;\n    if (dataset && dataset.toggle && dataset.toggle === 'Rename') {\n      this.setState({isItemMenuShow: !this.state.isItemMenuShow});\n      return;\n    }\n\n    this.setState(\n      {isItemMenuShow: !this.state.isItemMenuShow},\n      () => {\n        if (this.state.isItemMenuShow) {\n          this.props.onFreezedItem();\n        } else {\n          this.props.onUnfreezedItem();\n        }\n      }\n    );\n  }\n\n  generatorOperations = () => {\n    let repo = this.props.repo;\n    let showResetPasswordMenuItem = isPro && repo.encrypted && enableResetEncryptedRepoPassword && isEmailConfigured;\n    let operations = ['Rename', 'Transfer'];\n    if (folderPermEnabled) {\n      operations.push('Folder Permission');\n    }\n    operations.push('Share Admin', 'Divider');\n\n    if (repo.encrypted) {\n      operations.push('Change Password');\n    }\n    if (showResetPasswordMenuItem) {\n      operations.push('Reset Password');\n    }\n\n    if (isPro) {\n      const monitorOp = repo.monitored ? 'Unwatch File Changes' : 'Watch File Changes';\n      operations.push(monitorOp);\n    }\n\n    operations.push('API Token');\n    if (this.props.isPC && enableRepoSnapshotLabel) {\n      operations.push('Label Current State');\n    }\n    operations.push('Divider', 'History Setting');\n    if (enableRepoAutoDel) {\n      operations.push('Old Files Auto Delete');\n    }\n    return operations;\n  }\n\n  translateOperations = (item) => {\n    let translateResult = '';\n    switch(item) {\n      case 'Star':\n        translateResult = gettext('Star');\n        break;\n      case 'Unstar':\n        translateResult = gettext('Unstar');\n        break;\n      case 'Share':\n        translateResult = gettext('Share');\n        break;\n      case 'Delete':\n        translateResult = gettext('Delete');\n        break;\n      case 'Rename':\n        translateResult = gettext('Rename');\n        break;\n      case 'Transfer':\n        translateResult = gettext('Transfer');\n        break;\n      case 'History Setting':\n        translateResult = gettext('History Setting');\n        break;\n      case 'Change Password':\n        translateResult = gettext('Change Password');\n        break;\n      case 'Reset Password':\n        translateResult = gettext('Reset Password');\n        break;\n      case 'Watch File Changes':\n        translateResult = gettext('Watch File Changes');\n        break;\n      case 'Unwatch File Changes':\n        translateResult = gettext('Unwatch File Changes');\n        break;\n      case 'Folder Permission':\n        translateResult = gettext('Folder Permission');\n        break;\n      case 'Label Current State':\n        translateResult = gettext('Label Current State');\n        break;\n      case 'API Token':\n        translateResult = 'API Token'; // translation is not needed here\n        break;\n      case 'Share Admin':\n        translateResult = gettext('Share Admin');\n        break;\n      case 'Old Files Auto Delete':\n        translateResult = gettext('Auto Deletion Setting');\n        break;\n      default:\n        break;\n    }\n\n    return translateResult;\n  }\n\n  render() {\n    let operations = this.generatorOperations();\n\n    // pc menu\n    if (this.props.isPC) {\n      return (\n        <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.toggleOperationMenu}>\n          <DropdownToggle\n            tag=\"i\"\n            role=\"button\"\n            tabIndex=\"0\"\n            className=\"sf-dropdown-toggle sf2-icon-caret-down\"\n            title={gettext('More Operations')}\n            aria-label={gettext('More Operations')}\n            onClick={this.onDropdownToggleClick}\n            onKeyDown={this.onDropdownToggleKeyDown}\n            data-toggle=\"dropdown\"\n          />\n          <DropdownMenu>\n            {operations.map((item, index)=> {\n              if (item == 'Divider') {\n                return <DropdownItem key={index} divider />;\n              } else {\n                return (<DropdownItem key={index} data-toggle={item} onClick={this.onMenuItemClick} onKeyDown={this.onMenuItemKeyDown}>{this.translateOperations(item)}</DropdownItem>);\n              }\n            })}\n          </DropdownMenu>\n        </Dropdown>\n      );\n    }\n\n    // mobile menu\n    operations.unshift('Delete');\n    operations.unshift('Share');\n    this.props.isStarred ? operations.unshift('Unstar') : operations.unshift('Star');\n\n    return (\n      <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.toggleOperationMenu}>\n        <DropdownToggle\n          tag=\"i\"\n          className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n          title={gettext('More Operations')}\n          // onClick={this.clickOperationMenuToggle}\n          data-toggle=\"dropdown\"\n          aria-expanded={this.state.isItemMenuShow}\n        />\n        <div className={`${this.state.isItemMenuShow ? '' : 'd-none'}`} onClick={this.toggleOperationMenu}>\n          <div className=\"mobile-operation-menu-bg-layer\"></div>\n          <div className=\"mobile-operation-menu\">\n            {operations.map((item, index) => {\n              if (item != 'Divider') {\n                return (<DropdownItem key={index} className=\"mobile-menu-item\" data-toggle={item} onClick={this.onMenuItemClick}>{this.translateOperations(item)}</DropdownItem>);\n              }\n            })}\n          </div>\n        </div>\n      </Dropdown>\n    );\n  }\n}\n\nMylibRepoMenu.propTypes = propTypes;\n\nexport default MylibRepoMenu;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport Select from 'react-select';\nimport { gettext } from '../../utils/constants';\nimport OpIcon from '../op-icon';\n\nconst propTypes = {\n  isTextMode: PropTypes.bool.isRequired,\n  isEditIconShow: PropTypes.bool.isRequired,\n  currentPermission: PropTypes.string.isRequired,\n  onPermissionChanged: PropTypes.func.isRequired,\n};\n\nclass RepoAPITokenPermissionEditor extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isEditing: false,\n    };\n    this.options = [\n      { value: 'rw', label: <div>{gettext('Read-Write')}</div> },\n      { value: 'r', label: <div>{gettext('Read-Only')}</div> }\n    ];\n  }\n\n  componentDidMount() {\n    document.addEventListener('click', this.onHideSelect);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('click', this.onHideSelect);\n  }\n\n  onHideSelect = () => {\n    this.setState({ isEditing: false });\n  }\n\n  onEditPermission = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.setState({ isEditing: true });\n  }\n\n  onPermissionChanged = (e) => {\n    if (e.value !== this.props.currentPermission) {\n      this.props.onPermissionChanged(e.value);\n    }\n    this.setState({ isEditing: false });\n  }\n\n  onSelectHandler = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n  }\n\n  render() {\n    const { currentPermission, isTextMode } = this.props;\n    let optionTranslation = currentPermission === 'rw' ? gettext('Read-Write') : gettext('Read-Only');\n    return (\n      <div onClick={this.onSelectHandler}>\n        {(isTextMode && !this.state.isEditing) ?\n          <Fragment>\n            <span>{optionTranslation}</span>\n            {this.props.isEditIconShow &&\n              <OpIcon title={gettext('Edit')} className=\"fa fa-pencil-alt attr-action-icon\" op={this.onEditPermission} />\n            }\n          </Fragment>\n          :\n          <Select\n            options={this.options}\n            placeholder={optionTranslation}\n            onChange={this.onPermissionChanged}\n            captureMenuScroll={false}\n          />\n        }\n      </div>\n    );\n  }\n}\n\nRepoAPITokenPermissionEditor.propTypes = propTypes;\n\nexport default RepoAPITokenPermissionEditor;\n","import React, {Fragment} from 'react';\nimport PropTypes from 'prop-types';\nimport {gettext} from '../../utils/constants';\nimport {Modal, ModalHeader, ModalBody, Button, Input} from 'reactstrap';\nimport RepoAPITokenPermissionEditor from '../select-editor/repo-api-token-permission-editor';\nimport {seafileAPI} from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport copy from 'copy-to-clipboard';\nimport Loading from '../loading';\nimport OpIcon from '../op-icon';\n\nconst apiTokenItemPropTypes = {\n  item: PropTypes.object.isRequired,\n  deleteAPIToken: PropTypes.func.isRequired,\n  updateAPIToken: PropTypes.func.isRequired,\n};\n\nclass APITokenItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOperationShow: false,\n    };\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOperationShow: true});\n  };\n\n  onMouseLeave = () => {\n    this.setState({isOperationShow: false});\n  };\n\n  onDeleteAPIToken = () => {\n    this.props.deleteAPIToken(this.props.item.app_name);\n  };\n\n  onUpdateAPIToken = (permission) => {\n    this.props.updateAPIToken(this.props.item.app_name, permission);\n  };\n\n  onCopyAPIToken = () => {\n    let api_token = this.props.item.api_token;\n    copy(api_token);\n    toaster.success(gettext('API token is copied to the clipboard.'));\n  };\n\n  render() {\n    let item = this.props.item;\n\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} tabIndex=\"0\" onFocus={this.onMouseEnter}>\n        <td className=\"name\">{item.app_name}</td>\n        <td>\n          <RepoAPITokenPermissionEditor\n            isTextMode={true}\n            isEditIconShow={this.state.isOperationShow}\n            currentPermission={item.permission}\n            onPermissionChanged={this.onUpdateAPIToken}\n          />\n        </td>\n        <td>\n          <span>{item.api_token}</span>\n          {this.state.isOperationShow &&\n            <OpIcon\n              className=\"far fa-copy action-icon\"\n              op={this.onCopyAPIToken}\n              title={gettext('Copy')}\n            />\n          }\n        </td>\n        <td>\n          <OpIcon\n            className={`sf2-icon-x3 action-icon ${this.state.isOperationShow ? '' : 'hide'}`}\n            op={this.onDeleteAPIToken}\n            title={gettext('Delete')}\n          />\n        </td>\n      </tr>\n    );\n  }\n}\n\nAPITokenItem.propTypes = apiTokenItemPropTypes;\n\nconst propTypes = {\n  repo: PropTypes.object.isRequired,\n  onRepoAPITokenToggle: PropTypes.func.isRequired,\n};\n\nclass RepoAPITokenDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      apiTokenList: [],\n      permission: 'rw',\n      appName: '',\n      errorMsg: '',\n      loading: true,\n      isSubmitBtnActive: true,\n    };\n    this.repo = this.props.repo;\n  }\n\n  listAPITokens = () => {\n    seafileAPI.listRepoAPITokens(this.repo.repo_id).then((res) => {\n      this.setState({\n        apiTokenList: res.data.repo_api_tokens,\n        loading: false,\n      });\n    }).catch(error => {\n      if (error.response.status === 403) {\n        this.setState({\n          errorMsg: gettext('Permission denied'),\n        });\n      } else {\n        this.handleError(error);\n      }\n    });\n  };\n\n  onInputChange = (e) => {\n    let appName = e.target.value;\n    this.setState({\n      appName: appName,\n    });\n  };\n\n  onKeyDown = (e) => {\n    if (e.keyCode === 13) {\n      e.preventDefault();\n      this.addAPIToken();\n    }\n  };\n\n  setPermission = (permission) => {\n    this.setState({permission: permission});\n  };\n\n  addAPIToken = () => {\n    if (!this.state.appName) {\n      return;\n    }\n\n    this.setState({\n      isSubmitBtnActive: false,\n    });\n    const {appName, permission, apiTokenList} = this.state;\n\n    seafileAPI.addRepoAPIToken(this.repo.repo_id, appName, permission).then((res) => {\n      apiTokenList.push(res.data);\n      this.setState({\n        apiTokenList: apiTokenList,\n        isSubmitBtnActive: true,\n      });\n    }).catch(error => {\n      this.handleError(error);\n      this.setState({\n        isSubmitBtnActive: true,\n      });\n    });\n  };\n\n  deleteAPIToken = (appName) => {\n    seafileAPI.deleteRepoAPIToken(this.repo.repo_id, appName).then((res) => {\n      const apiTokenList = this.state.apiTokenList.filter(item => {\n        return item.app_name !== appName;\n      });\n      this.setState({\n        apiTokenList: apiTokenList,\n      });\n    }).catch(error => {\n      this.handleError(error);\n    });\n  };\n\n  updateAPIToken = (appName, permission) => {\n    seafileAPI.updateRepoAPIToken(this.repo.repo_id, appName, permission).then((res) => {\n      let apiTokenList = this.state.apiTokenList.filter(item => {\n        if (item.app_name === appName) {\n          item.permission = permission;\n        }\n        return item;\n      });\n      this.setState({\n        apiTokenList: apiTokenList,\n      });\n    }).catch(error => {\n      this.handleError(error);\n    });\n  };\n\n  handleError = (e) => {\n    if (e.response) {\n      toaster.danger(e.response.data.error_msg || e.response.data.detail || gettext('Error'), {duration: 3});\n    } else {\n      toaster.danger(gettext('Please check the network.'), {duration: 3});\n    }\n  };\n\n  componentDidMount() {\n    this.listAPITokens();\n  }\n\n  renderContent = () => {\n    const renderAPITokenList = this.state.apiTokenList.map((item, index) => {\n      return (\n        <APITokenItem\n          key={index}\n          item={item}\n          deleteAPIToken={this.deleteAPIToken}\n          updateAPIToken={this.updateAPIToken}\n        />\n      );\n    });\n\n    const thead = (\n      <thead>\n        <tr>\n          <th width=\"20%\">{gettext('App Name')}</th>\n          <th width=\"20%\">{gettext('Permission')}</th>\n          <th width=\"48%\">API Token</th>\n          <th width=\"12%\"></th>\n        </tr>\n      </thead>\n    );\n    return (\n      <Fragment>\n        {this.state.errorMsg &&\n          <p className=\"error text-center\">{this.state.errorMsg}</p>\n        }\n        {!this.state.errorMsg &&\n        <Fragment>\n          <table className=\"w-xs-250\">\n            {thead}\n            <tbody>\n              <tr>\n                <td>\n                  <Input\n                    type=\"text\"\n                    id=\"appName\"\n                    value={this.state.appName}\n                    onChange={this.onInputChange}\n                    onKeyDown={this.onKeyDown}\n                  />\n                </td>\n                <td>\n                  <RepoAPITokenPermissionEditor\n                    isTextMode={false}\n                    isEditIconShow={false}\n                    currentPermission={this.state.permission}\n                    onPermissionChanged={this.setPermission}\n                  />\n                </td>\n                <td><span className=\"text-secondary\">--</span></td>\n                <td>\n                  <Button onClick={this.addAPIToken} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n          <div style={{minHeight: '10rem', maxHeight: '18rem'}}>\n            {this.state.apiTokenList.length !== 0 &&\n            <table className=\"table-thead-hidden w-xs-250\">\n              {thead}\n              <tbody>\n                {renderAPITokenList}\n              </tbody>\n            </table>\n            }\n          </div>\n          {this.state.loading && <Loading/>}\n        </Fragment>\n        }\n      </Fragment>\n    );\n  };\n\n  render() {\n    let repo = this.repo;\n\n    const itemName = '<span class=\"op-target\">' + Utils.HTMLescape(repo.repo_name) + '</span>';\n    const title = gettext('{placeholder} API Token').replace('{placeholder}', itemName);\n    return (\n      <Modal\n        isOpen={true} style={{maxWidth: '800px'}}\n        toggle={this.props.onRepoAPITokenToggle}\n      >\n        <ModalHeader toggle={this.props.onRepoAPITokenToggle}>\n          <p dangerouslySetInnerHTML={{__html: title}} className=\"m-0\"></p>\n        </ModalHeader>\n        <ModalBody>\n          <div className=\"o-auto\">\n            {this.renderContent()}\n          </div>\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nRepoAPITokenDialog.propTypes = propTypes;\n\nexport default RepoAPITokenDialog;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from '@gatsbyjs/reach-router';\nimport { Utils } from '../../../utils/utils';\nimport { seafileAPI } from '../../../utils/seafile-api';\nimport { gettext, siteRoot } from '../../../utils/constants';\nimport Loading from '../../../components/loading';\nimport toaster from '../../../components/toast';\nimport EmptyTip from '../../../components/empty-tip';\n\nconst itemPropTypes = {\n  item: PropTypes.object.isRequired,\n  deleteItem: PropTypes.func.isRequired\n};\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOperationShow: false\n    };\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOperationShow: true});\n  };\n\n  onMouseLeave = () => {\n    this.setState({isOperationShow: false});\n  };\n\n  onDeleteLink = (e) => {\n    e.preventDefault();\n    this.props.deleteItem(this.props.item);\n  };\n\n  render() {\n    let objUrl;\n    let item = this.props.item;\n    let path = item.path === '/' ? '/' : item.path.slice(0, item.path.length - 1);\n\n    if (item.is_dir) {\n      objUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}${Utils.encodePath(path)}`;\n    } else {\n      objUrl = `${siteRoot}lib/${item.repo_id}/file${Utils.encodePath(item.path)}`;\n    }\n\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter}>\n        <td className=\"name\">{item.creator_name}</td>\n        <td>\n          {item.is_dir ? <Link to={objUrl}>{item.obj_name}</Link> :\n            <a href={objUrl} target=\"_blank\" rel=\"noreferrer\">{item.obj_name}</a>}\n        </td>\n        <td>\n          <a href={item.link} target=\"_blank\" rel=\"noreferrer\">{item.link}</a>\n        </td>\n        <td>\n          <span\n            tabIndex=\"0\"\n            role=\"button\"\n            className={`sf2-icon-x3 action-icon ${this.state.isOperationShow ? '' : 'invisible'}`}\n            onClick={this.onDeleteLink}\n            onKeyDown={Utils.onKeyDown}\n            title={gettext('Delete')}\n            aria-label={gettext('Delete')}\n          >\n          </span>\n        </td>\n      </tr>\n    );\n  }\n}\n\nItem.propTypes = itemPropTypes;\n\nconst propTypes = {\n  repo: PropTypes.object.isRequired,\n};\n\nclass RepoShareAdminShareLinks extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: []\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepoShareLinks(this.props.repo.repo_id).then((res) => {\n      this.setState({\n        loading: false,\n        items: res.data,\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  deleteItem = (item) => {\n    seafileAPI.deleteRepoShareLink(this.props.repo.repo_id, item.token).then(() => {\n      let items = this.state.items.filter(linkItem => {\n        return linkItem.token !== item.token;\n      });\n      this.setState({items: items});\n      let message = gettext('Successfully deleted 1 item');\n      toaster.success(message);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    const { loading, errorMsg, items } = this.state;\n    return (\n      <Fragment>\n        {loading && <Loading />}\n        {!loading && errorMsg && <p className=\"error text-center mt-8\">{errorMsg}</p>}\n        {!loading && !errorMsg && !items.length &&\n        <EmptyTip forDialog={true}>\n          <p className=\"text-secondary\">{gettext('No share links')}</p>\n        </EmptyTip>\n        }\n        {!loading && !errorMsg && items.length > 0 &&\n        <table className=\"table-hover\">\n          <thead>\n            <tr>\n              <th width=\"22%\">{gettext('Creator')}</th>\n              <th width=\"20%\">{gettext('Name')}</th>\n              <th width=\"50%\">{gettext('Link')}</th>\n              <th width=\"8%\"></th>\n            </tr>\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              return (\n                <Item\n                  key={index}\n                  item={item}\n                  deleteItem={this.deleteItem}\n                />\n              );\n            })}\n          </tbody>\n        </table>\n        }\n      </Fragment>\n    );\n  }\n}\n\nRepoShareAdminShareLinks.propTypes = propTypes;\n\nexport default RepoShareAdminShareLinks;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from '@gatsbyjs/reach-router';\nimport { Utils } from '../../../utils/utils';\nimport { seafileAPI } from '../../../utils/seafile-api';\nimport { gettext, siteRoot } from '../../../utils/constants';\nimport Loading from '../../../components/loading';\nimport toaster from '../../../components/toast';\nimport EmptyTip from '../../../components/empty-tip';\n\nconst itemPropTypes = {\n  item: PropTypes.object.isRequired,\n  deleteItem: PropTypes.func.isRequired\n};\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOperationShow: false\n    };\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOperationShow: true});\n  };\n\n  onMouseLeave = () => {\n    this.setState({isOperationShow: false});\n  };\n\n  onDeleteLink = (e) => {\n    e.preventDefault();\n    this.props.deleteItem(this.props.item);\n  };\n\n  render() {\n    let item = this.props.item;\n    let path = item.path === '/' ? '/' : item.path.slice(0, item.path.length - 1);\n    let objUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}${Utils.encodePath(path)}`;\n\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter}>\n        <td className=\"name\">{item.creator_name}</td>\n        <td>\n          <Link to={objUrl}>{item.obj_name}</Link>\n        </td>\n        <td>\n          <a href={item.link} target=\"_blank\" rel=\"noreferrer\">{item.link}</a>\n        </td>\n        <td>\n          <span\n            tabIndex=\"0\"\n            role=\"button\"\n            className={`sf2-icon-x3 action-icon ${this.state.isOperationShow ? '' : 'invisible'}`}\n            onClick={this.onDeleteLink}\n            onKeyDown={Utils.onKeyDown}\n            title={gettext('Delete')}\n            aria-label={gettext('Delete')}\n          >\n          </span>\n        </td>\n      </tr>\n    );\n  }\n}\n\nItem.propTypes = itemPropTypes;\n\nconst propTypes = {\n  repo: PropTypes.object.isRequired,\n};\n\nclass RepoShareAdminUploadLinks extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: [],\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepoUploadLinks(this.props.repo.repo_id).then((res) => {\n      this.setState({\n        loading: false,\n        items: res.data,\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  deleteItem = (item) => {\n    seafileAPI.deleteRepoUploadLink(this.props.repo.repo_id, item.token).then(() => {\n      let items = this.state.items.filter(linkItem => {\n        return linkItem.token !== item.token;\n      });\n      this.setState({items: items});\n      let message = gettext('Successfully deleted 1 item');\n      toaster.success(message);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    const { loading, errorMsg, items } = this.state;\n    return (\n      <Fragment>\n        {loading && <Loading />}\n        {!loading && errorMsg && <p className=\"error text-center mt-8\">{errorMsg}</p>}\n        {!loading && !errorMsg && !items.length &&\n        <EmptyTip forDialog={true}>\n          <p className=\"text-secondary\">{gettext('No upload links')}</p>\n        </EmptyTip>\n        }\n        {!loading && !errorMsg && items.length > 0 &&\n        <table className=\"table-hover\">\n          <thead>\n            <tr>\n              <th width=\"22%\">{gettext('Creator')}</th>\n              <th width=\"20%\">{gettext('Name')}</th>\n              <th width=\"50%\">{gettext('Link')}</th>\n              <th width=\"8%\"></th>\n            </tr>\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              return (\n                <Item\n                  key={index}\n                  item={item}\n                  deleteItem={this.deleteItem}\n                />\n              );\n            })}\n          </tbody>\n        </table>\n        }\n      </Fragment>\n    );\n  }\n}\n\nRepoShareAdminUploadLinks.propTypes = propTypes;\n\nexport default RepoShareAdminUploadLinks;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from '@gatsbyjs/reach-router';\nimport { Utils } from '../../../utils/utils';\nimport { seafileAPI } from '../../../utils/seafile-api';\nimport { gettext, siteRoot, isPro, username } from '../../../utils/constants';\nimport Loading from '../../../components/loading';\nimport toaster from '../../../components/toast';\nimport EmptyTip from '../../../components/empty-tip';\nimport SharePermissionEditor from '../../../components/select-editor/share-permission-editor';\n\nconst itemPropTypes = {\n  item: PropTypes.object.isRequired,\n  deleteItem: PropTypes.func.isRequired,\n  isRepoOwner: PropTypes.bool.isRequired\n};\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      permission: this.props.item.permission,\n      isOperationShow: false,\n      isShowPermEditor: false,\n    };\n    this.permissions = ['rw', 'r'];\n    if (isPro) {\n      if (this.props.item.path === '/' && this.props.isRepoOwner) {\n        this.permissions.push('admin');\n      }\n      this.permissions.push('cloud-edit', 'preview');\n    }\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOperationShow: true});\n  };\n\n  onMouseLeave = () => {\n    this.setState({isOperationShow: false});\n  };\n\n  onDeleteLink = (e) => {\n    e.preventDefault();\n    this.props.deleteItem(this.props.item);\n  };\n\n  changePerm = (permission) => {\n    const item = this.props.item;\n    seafileAPI.updateShareToUserItemPermission(item.repo_id, item.path, 'user', item.share_to, permission).then(() => {\n      this.setState({\n        permission: permission,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onEditPermission = (event) => {\n    event.nativeEvent.stopImmediatePropagation();\n    this.setState({isShowPermEditor: true});\n  }\n\n  render() {\n\n    let objUrl;\n    let item = this.props.item;\n    let path = item.path === '/' ? '/' : item.path.slice(0, item.path.length - 1);\n\n    objUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}${Utils.encodePath(path)}`;\n\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter}>\n        <td>\n          <Link to={objUrl}>{Utils.getFolderName(item.path)}</Link>\n        </td>\n        <td className=\"name\">{item.share_to_name}</td>\n        <td>\n          {!this.state.isShowPermEditor && (\n            <div>\n              <span>{item.permission_name || Utils.sharePerms(this.state.permission)}</span>\n              {this.state.isOperationShow && (\n                <a href=\"#\"\n                  role=\"button\"\n                  aria-label={gettext('Edit')}\n                  title={gettext('Edit')}\n                  className=\"fa fa-pencil-alt attr-action-icon\"\n                  onClick={this.onEditPermission}>\n                </a>\n              )}\n            </div>\n          )}\n          {this.state.isShowPermEditor && (\n            <SharePermissionEditor\n              repoID={item.repo_id}\n              isTextMode={true}\n              isEditIconShow={this.state.isOperationShow}\n              isEditing={true}\n              currentPermission={this.state.permission}\n              permissions={this.permissions}\n              onPermissionChanged={this.changePerm}\n            />\n          )}\n        </td>\n        <td>\n          <span\n            tabIndex=\"0\"\n            role=\"button\"\n            className={`sf2-icon-x3 action-icon ${this.state.isOperationShow ? '' : 'invisible'}`}\n            onClick={this.onDeleteLink}\n            onKeyDown={Utils.onKeyDown}\n            title={gettext('Delete')}\n            aria-label={gettext('Delete')}\n          >\n          </span>\n        </td>\n      </tr>\n    );\n  }\n}\n\nItem.propTypes = itemPropTypes;\n\nconst propTypes = {\n  repo: PropTypes.object.isRequired,\n};\n\nclass RepoShareAdminUserShares extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: [],\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.getAllRepoFolderShareInfo(this.props.repo.repo_id, 'user').then((res) => {\n      this.setState({\n        loading: false,\n        items: res.data.share_info_list,\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  deleteItem = (item) => {\n    seafileAPI.deleteShareToUserItem(item.repo_id, item.path, 'user', item.share_to).then(res => {\n      let items = this.state.items.filter(shareItem => {\n        return shareItem.path + shareItem.share_to !== item.path + item.share_to;\n      });\n      this.setState({items: items});\n      let message = gettext('Successfully deleted 1 item');\n      toaster.success(message);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    const { loading, errorMsg, items } = this.state;\n    const { repo } = this.props;\n    const isRepoOwner = repo.owner_email === username;\n    return (\n      <Fragment>\n        {loading && <Loading />}\n        {!loading && errorMsg && <p className=\"error text-center mt-8\">{errorMsg}</p>}\n        {!loading && !errorMsg && !items.length &&\n        <EmptyTip forDialog={true}>\n          <p className=\"text-secondary\">{gettext('No user shares')}</p>\n        </EmptyTip>\n        }\n        {!loading && !errorMsg && items.length > 0 &&\n        <table className=\"table-hover\">\n          <thead>\n            <tr>\n              <th width=\"30%\">{gettext('Name')}</th>\n              <th width=\"30%\">{gettext('User')}</th>\n              <th width=\"30%\">{gettext('Permission')}</th>\n              <th width=\"10%\"></th>\n            </tr>\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              return (\n                <Item\n                  key={index}\n                  item={item}\n                  deleteItem={this.deleteItem}\n                  isRepoOwner={isRepoOwner}\n                />\n              );\n            })}\n          </tbody>\n        </table>\n        }\n      </Fragment>\n    );\n  }\n}\n\nRepoShareAdminUserShares.propTypes = propTypes;\n\nexport default RepoShareAdminUserShares;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from '@gatsbyjs/reach-router';\nimport { Utils } from '../../../utils/utils';\nimport { seafileAPI } from '../../../utils/seafile-api';\nimport { gettext, siteRoot, isPro, username } from '../../../utils/constants';\nimport Loading from '../../../components/loading';\nimport toaster from '../../../components/toast';\nimport EmptyTip from '../../../components/empty-tip';\nimport SharePermissionEditor from '../../../components/select-editor/share-permission-editor';\n\nconst itemPropTypes = {\n  item: PropTypes.object.isRequired,\n  deleteItem: PropTypes.func.isRequired,\n  isRepoOwner: PropTypes.bool.isRequired\n};\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      permission: this.props.item.permission,\n      isOperationShow: false,\n      isShowPermEditor: false,\n    };\n    this.permissions = ['rw', 'r'];\n    if (isPro) {\n      if (this.props.item.path === '/' && this.props.isRepoOwner) {\n        this.permissions.push('admin');\n      }\n      this.permissions.push('cloud-edit', 'preview');\n    }\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOperationShow: true});\n  };\n\n  onMouseLeave = () => {\n    this.setState({isOperationShow: false});\n  };\n\n  onDeleteLink = (e) => {\n    e.preventDefault();\n    this.props.deleteItem(this.props.item);\n  };\n\n  changePerm = (permission) => {\n    const item = this.props.item;\n    seafileAPI.updateShareToGroupItemPermission(item.repo_id, item.path, 'group', item.share_to, permission).then(() => {\n      this.setState({\n        permission: permission,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onEditPermission = (event) => {\n    event.nativeEvent.stopImmediatePropagation();\n    this.setState({isShowPermEditor: true});\n  }\n\n  render() {\n\n    let objUrl;\n    let item = this.props.item;\n    let path = item.path === '/' ? '/' : item.path.slice(0, item.path.length - 1);\n\n    objUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}${Utils.encodePath(path)}`;\n\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter}>\n        <td>\n          <Link to={objUrl}>{Utils.getFolderName(item.path)}</Link>\n        </td>\n        <td className=\"name\">{item.share_to_name}</td>\n        <td>\n          {!this.state.isShowPermEditor && (\n            <div>\n              <span>{item.permission_name || Utils.sharePerms(this.state.permission)}</span>\n              {this.state.isOperationShow && (\n                <a href=\"#\"\n                  role=\"button\"\n                  aria-label={gettext('Edit')}\n                  title={gettext('Edit')}\n                  className=\"fa fa-pencil-alt attr-action-icon\"\n                  onClick={this.onEditPermission}>\n                </a>\n              )}\n            </div>\n          )}\n          {this.state.isShowPermEditor && (\n            <SharePermissionEditor\n              repoID={item.repo_id}\n              isTextMode={true}\n              isEditIconShow={this.state.isOperationShow}\n              isEditing={true}\n              currentPermission={this.state.permission}\n              permissions={this.permissions}\n              onPermissionChanged={this.changePerm}\n            />\n          )}\n        </td>\n        <td>\n          <span\n            tabIndex=\"0\"\n            role=\"button\"\n            className={`sf2-icon-x3 action-icon ${this.state.isOperationShow ? '' : 'invisible'}`}\n            onClick={this.onDeleteLink}\n            onKeyDown={Utils.onKeyDown}\n            title={gettext('Delete')}\n            aria-label={gettext('Delete')}\n          >\n          </span>\n        </td>\n      </tr>\n    );\n  }\n}\n\nItem.propTypes = itemPropTypes;\n\nconst propTypes = {\n  repo: PropTypes.object.isRequired,\n};\n\nclass RepoShareAdminGroupShares extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: [],\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.getAllRepoFolderShareInfo(this.props.repo.repo_id, 'group').then((res) => {\n      this.setState({\n        loading: false,\n        items: res.data.share_info_list,\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  deleteItem = (item) => {\n    seafileAPI.deleteShareToGroupItem(item.repo_id, item.path, 'group', item.share_to).then(res => {\n      let items = this.state.items.filter(shareItem => {\n        return shareItem.path + shareItem.share_to !== item.path + item.share_to;\n      });\n      this.setState({items: items});\n      let message = gettext('Successfully deleted 1 item');\n      toaster.success(message);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    const { loading, errorMsg, items } = this.state;\n    const { repo } = this.props;\n    const isRepoOwner = repo.owner_email === username;\n    return (\n      <Fragment>\n        {loading && <Loading />}\n        {!loading && errorMsg && <p className=\"error text-center mt-8\">{errorMsg}</p>}\n        {!loading && !errorMsg && !items.length &&\n        <EmptyTip forDialog={true}>\n          <p className=\"text-secondary\">{gettext('No group shares')}</p>\n        </EmptyTip>\n        }\n        {!loading && !errorMsg && items.length > 0 &&\n        <table className=\"table-hover\">\n          <thead>\n            <tr>\n              <th width=\"30%\">{gettext('Name')}</th>\n              <th width=\"30%\">{gettext('Group')}</th>\n              <th width=\"30%\">{gettext('Permission')}</th>\n              <th width=\"10%\"></th>\n            </tr>\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              return (\n                <Item\n                  key={index}\n                  item={item}\n                  deleteItem={this.deleteItem}\n                  isRepoOwner={isRepoOwner}\n                />\n              );\n            })}\n          </tbody>\n        </table>\n        }\n      </Fragment>\n    );\n  }\n}\n\nRepoShareAdminGroupShares.propTypes = propTypes;\n\nexport default RepoShareAdminGroupShares;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, TabContent, TabPane, Nav, NavItem, NavLink } from 'reactstrap';\nimport { gettext, canGenerateShareLink, canGenerateUploadLink } from '../../utils/constants';\nimport RepoShareAdminShareLinks from './repo-share-admin/share-links';\nimport RepoShareAdminUploadLinks from './repo-share-admin/upload-links';\nimport RepoShareAdminUserShares from './repo-share-admin/user-shares';\nimport RepoShareAdminGroupShares from './repo-share-admin/group-shares';\n\nconst propTypes = {\n  repo: PropTypes.object.isRequired,\n  toggleDialog: PropTypes.func.isRequired,\n};\n\nclass RepoShareAdminDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.enableShareLink = !this.props.repo.encrypted && canGenerateShareLink;\n    this.enableUploadLink = !this.props.repo.encrypted && canGenerateUploadLink;\n    this.state = {\n      activeTab: this.getInitialActiveTab()\n    };\n  }\n\n  getInitialActiveTab = () => {\n    if (this.enableShareLink) {\n      return 'shareLink';\n    } else if (this.enableUploadLink) {\n      return 'uploadLink';\n    } else {\n      return 'shareToUser';\n    }\n  }\n\n  toggle = (tab) => {\n    if (this.state.activeTab !== tab) {\n      this.setState({ activeTab: tab });\n    }\n  }\n\n  onTabKeyDown = (e) => {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      e.target.click();\n    }\n  }\n\n  render() {\n    const { activeTab } = this.state;\n    const { repoName } = this.props.repo;\n\n    return (\n      <div>\n        <Modal isOpen={true} style={{maxWidth: '760px'}} className=\"share-dialog\" toggle={this.props.toggleDialog}>\n          <ModalHeader toggle={this.props.toggleDialog}>\n            <span className=\"op-target\" title={repoName}>{repoName}</span> {gettext('Share Admin')}\n          </ModalHeader>\n          <ModalBody className=\"dialog-list-container share-dialog-content\" role=\"tablist\">\n            <Fragment>\n              <div className=\"share-dialog-side\">\n                <Nav pills>\n                  {this.enableShareLink &&\n                  <NavItem role=\"tab\" aria-selected={activeTab === 'shareLink'} aria-controls=\"share-link-panel\">\n                    <NavLink className={activeTab === 'shareLink' ? 'active' : ''} onClick={(this.toggle.bind(this, 'shareLink'))} tabIndex=\"0\" onKeyDown={this.onTabKeyDown}>\n                      {gettext('Share Links')}\n                    </NavLink>\n                  </NavItem>\n                  }\n                  {this.enableUploadLink &&\n                    <NavItem role=\"tab\" aria-selected={activeTab === 'uploadLink'} aria-controls=\"upload-link-panel\">\n                      <NavLink className={activeTab === 'uploadLink' ? 'active' : ''} onClick={this.toggle.bind(this, 'uploadLink')} tabIndex=\"0\" onKeyDown={this.onTabKeyDown}>\n                        {gettext('Upload Links')}\n                      </NavLink>\n                    </NavItem>\n                  }\n                  <NavItem role=\"tab\" aria-selected={activeTab === 'shareToUser'} aria-controls=\"share-to-user-panel\">\n                    <NavLink className={activeTab === 'shareToUser' ? 'active' : ''} onClick={this.toggle.bind(this, 'shareToUser')} tabIndex=\"0\" onKeyDown={this.onTabKeyDown}>\n                      {gettext('User Shares')}\n                    </NavLink>\n                  </NavItem>\n                  <NavItem role=\"tab\" aria-selected={activeTab === 'shareToGroup'} aria-controls=\"share-to-group-panel\">\n                    <NavLink className={activeTab === 'shareToGroup' ? 'active' : ''} onClick={this.toggle.bind(this, 'shareToGroup')} tabIndex=\"0\" onKeyDown={this.onTabKeyDown}>\n                      {gettext('Group Shares')}\n                    </NavLink>\n                  </NavItem>\n                </Nav>\n              </div>\n              <div className=\"share-dialog-main\">\n                <TabContent activeTab={this.state.activeTab}>\n                  {(this.enableShareLink && activeTab === 'shareLink') &&\n                    <TabPane tabId=\"shareLink\" role=\"tabpanel\" id=\"share-link-panel\">\n                      <RepoShareAdminShareLinks\n                        repo={this.props.repo}\n                      />\n                    </TabPane>\n                  }\n                  {(this.enableUploadLink && activeTab === 'uploadLink') &&\n                    <TabPane tabId=\"uploadLink\" role=\"tabpanel\" id=\"upload-link-panel\">\n                      <RepoShareAdminUploadLinks\n                        repo={this.props.repo}\n                      />\n                    </TabPane>\n                  }\n                  {activeTab === 'shareToUser' &&\n                    <TabPane tabId=\"shareToUser\" role=\"tabpanel\" id=\"share-to-user-panel\">\n                      <RepoShareAdminUserShares\n                        repo={this.props.repo}\n                      />\n                    </TabPane>\n                  }\n                  {activeTab === 'shareToGroup' &&\n                    <TabPane tabId=\"shareToGroup\" role=\"tabpanel\" id=\"share-to-group-panel\">\n                      <RepoShareAdminGroupShares\n                        repo={this.props.repo}\n                      />\n                    </TabPane>\n                  }\n                </TabContent>\n              </div>\n            </Fragment>\n          </ModalBody>\n        </Modal>\n      </div>\n    );\n  }\n}\n\nRepoShareAdminDialog.propTypes = propTypes;\n\nexport default RepoShareAdminDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Form, FormGroup, Label, Input, Alert } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api.js';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nconst propTypes = {\n  toggleDialog: PropTypes.func.isRequired,\n  repoID: PropTypes.string.isRequired,\n};\n\nclass LibOldFilesAutoDelDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      autoDelDays: 0,\n      isAutoDel: false,\n      errorInfo: '',\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.getRepoOldFilesAutoDelDays(this.props.repoID).then(res => {\n      this.setState({\n        autoDelDays: res.data.auto_delete_days,\n        isAutoDel: res.data.auto_delete_days > 0,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  submit = () => {\n    let daysNeedTobeSet;\n\n    if (this.state.isAutoDel) {\n      daysNeedTobeSet = this.state.autoDelDays;\n\n      let reg = /^-?\\d+$/;\n      let isvalid_days = reg.test(daysNeedTobeSet);\n      if (!isvalid_days || daysNeedTobeSet <= 0) {\n        this.setState({\n          errorInfo: gettext('Please enter a positive integer'),\n        });\n        return;\n      }\n\n    } else {\n      daysNeedTobeSet = 0;    // if no auto del, give 0 to server\n    }\n\n\n    let repoID = this.props.repoID;\n\n    seafileAPI.setRepoOldFilesAutoDelDays(repoID, daysNeedTobeSet).then(res => {\n      this.props.toggleDialog();\n      toaster.success(gettext('Successfully set it.'));\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.submit();\n      e.preventDefault();\n    }\n  }\n\n  onChange = (e) => {\n    let days = e.target.value;\n    this.setState({\n      autoDelDays: days,\n    });\n  }\n\n  updateRadioCheck = (type) => {\n    if (type === 'noAutoDel') {\n      this.setState({\n        isAutoDel: false,\n      });\n    } else if (type === 'autoDel') {\n      this.setState({\n        isAutoDel: true,\n      });\n    }\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.props.toggleDialog}>\n          {gettext('Auto deletion')}\n        </ModalHeader>\n        <ModalBody>\n          <Form>\n            <FormGroup check>\n              <Input type=\"radio\" name=\"radio1\" checked={!this.state.isAutoDel} onChange={() =>{this.updateRadioCheck('noAutoDel');}}/>{' '}\n              <Label>{gettext('Do not automatically delete files')}</Label>\n            </FormGroup>\n            <FormGroup check>\n              <Input type=\"radio\" name=\"radio1\" checked={this.state.isAutoDel} onChange={() =>{this.updateRadioCheck('autoDel');}}/>{' '}\n              <Label>{gettext('Automatically delete files that are not modified within certain days:')}</Label>\n              <Input\n                type=\"text\"\n                className=\"expire-input\"\n                value={this.state.autoDelDays}\n                disabled={!this.state.isAutoDel}\n                onChange={this.onChange}\n                onKeyDown={this.handleKeyPress}\n              />{' '}\n              <Label><span>{gettext('days')}</span></Label>\n            </FormGroup>\n            {this.state.errorInfo && <Alert color=\"danger\">{this.state.errorInfo}</Alert>}\n          </Form>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.submit}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nLibOldFilesAutoDelDialog.propTypes = propTypes;\n\nexport default LibOldFilesAutoDelDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport MediaQuery from 'react-responsive';\nimport moment from 'moment';\nimport { Link, navigate } from '@gatsbyjs/reach-router';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, siteRoot, storages } from '../../utils/constants';\nimport ModalPortal from '../../components/modal-portal';\nimport ShareDialog from '../../components/dialog/share-dialog';\nimport toaster from '../../components/toast';\nimport DeleteRepoDialog from '../../components/dialog/delete-repo-dialog';\nimport TransferDialog from '../../components/dialog/transfer-dialog';\nimport LibHistorySettingDialog from '../../components/dialog/lib-history-setting-dialog';\nimport ChangeRepoPasswordDialog from '../../components/dialog/change-repo-password-dialog';\nimport ResetEncryptedRepoPasswordDialog from '../../components/dialog/reset-encrypted-repo-password-dialog';\nimport LabelRepoStateDialog from '../../components/dialog/label-repo-state-dialog';\nimport LibSubFolderPermissionDialog from '../../components/dialog/lib-sub-folder-permission-dialog';\nimport Rename from '../../components/rename';\nimport MylibRepoMenu from './mylib-repo-menu';\nimport RepoAPITokenDialog from '../../components/dialog/repo-api-token-dialog';\nimport RepoShareAdminDialog from '../../components/dialog/repo-share-admin-dialog';\nimport LibOldFilesAutoDelDialog from '../../components/dialog/lib-old-files-auto-del-dialog';\nimport RepoMonitoredIcon from '../../components/repo-monitored-icon';\n\nconst propTypes = {\n  repo: PropTypes.object.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  onFreezedItem: PropTypes.func.isRequired,\n  onUnfreezedItem: PropTypes.func.isRequired,\n  onRenameRepo: PropTypes.func.isRequired,\n  onDeleteRepo: PropTypes.func.isRequired,\n  onTransferRepo: PropTypes.func.isRequired,\n  onRepoClick: PropTypes.func.isRequired,\n};\n\nclass MylibRepoListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpIconShow: false,\n      isStarred: this.props.repo.starred,\n      isRenaming: false,\n      isShareDialogShow: false,\n      isDeleteDialogShow: false,\n      isTransferDialogShow: false,\n      isHistorySettingDialogShow: false,\n      isChangePasswordDialogShow: false,\n      isResetPasswordDialogShow: false,\n      isLabelRepoStateDialogOpen: false,\n      isFolderPermissionDialogShow: false,\n      isAPITokenDialogShow: false,\n      isRepoShareAdminDialogOpen: false,\n      isRepoDeleted: false,\n      isOldFilesAutoDelDialogOpen: false,\n    };\n  }\n\n  onFocus = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isOpIconShow: true\n      });\n    }\n  }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isOpIconShow: true,\n        highlight: true,\n      });\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isOpIconShow: false,\n        highlight: false\n      });\n    }\n  }\n\n  onMenuItemClick = (item) => {\n    switch(item) {\n      case 'Star':\n      case 'Unstar':\n        this.onToggleStarRepo();\n        break;\n      case 'Share':\n        this.onShareToggle();\n        break;\n      case 'Delete':\n        this.onDeleteToggle();\n        break;\n      case 'Rename':\n        this.onRenameToggle();\n        break;\n      case 'Transfer':\n        this.onTransferToggle();\n        break;\n      case 'History Setting':\n        this.onHistorySettingToggle();\n        break;\n      case 'Change Password':\n        this.onChangePasswordToggle();\n        break;\n      case 'Reset Password':\n        this.onResetPasswordToggle();\n        break;\n      case 'Watch File Changes':\n        this.watchFileChanges();\n        break;\n      case 'Unwatch File Changes':\n        this.unwatchFileChanges();\n        break;\n      case 'Folder Permission':\n        this.onFolderPermissionToggle();\n        break;\n      case 'Label Current State':\n        this.onLabelToggle();\n        break;\n      case 'API Token':\n        this.onAPITokenToggle();\n        break;\n      case 'Share Admin':\n        this.toggleRepoShareAdminDialog();\n        break;\n      case 'Old Files Auto Delete':\n        this.toggleOldFilesAutoDelDialog();\n        break;\n      default:\n        break;\n    }\n  }\n\n  visitRepo = () => {\n    if (!this.state.isRenaming && this.props.repo.repo_name) {\n      navigate(this.repoURL);\n    }\n  }\n\n  onRepoClick = () => {\n    this.props.onRepoClick(this.props.repo);\n  }\n\n  onToggleStarRepo = (e) => {\n    e.preventDefault();\n    const repoName = this.props.repo.repo_name;\n    if (this.state.isStarred) {\n      seafileAPI.unstarItem(this.props.repo.repo_id, '/').then(() => {\n        this.setState({isStarred: !this.state.isStarred});\n        const msg = gettext('Successfully unstarred {library_name_placeholder}.')\n          .replace('{library_name_placeholder}', repoName);\n        toaster.success(msg);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      seafileAPI.starItem(this.props.repo.repo_id, '/').then(() => {\n        this.setState({isStarred: !this.state.isStarred});\n        const msg = gettext('Successfully starred {library_name_placeholder}.')\n          .replace('{library_name_placeholder}', repoName);\n        toaster.success(msg);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  watchFileChanges = () => {\n    const { repo } = this.props;\n    seafileAPI.monitorRepo(repo.repo_id).then(() => {\n      this.props.onMonitorRepo(repo, true);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  unwatchFileChanges = () => {\n    const { repo } = this.props;\n    seafileAPI.unMonitorRepo(repo.repo_id).then(() => {\n      this.props.onMonitorRepo(repo, false);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onShareToggle = (e) => {\n    // when close share dialog after send share link email,\n    // there is no event\n    if (e != undefined) {\n      e.preventDefault();\n    }\n    this.setState({isShareDialogShow: !this.state.isShareDialogShow});\n  }\n\n  onDeleteToggle = (e) => {\n    e.preventDefault();\n    this.setState({isDeleteDialogShow: !this.state.isDeleteDialogShow});\n  }\n\n  onRenameToggle = () => {\n    this.props.onFreezedItem();\n    this.setState({isRenaming: !this.state.isRenaming});\n  }\n\n  onTransferToggle = () => {\n    this.setState({isTransferDialogShow: !this.state.isTransferDialogShow});\n  }\n\n  onHistorySettingToggle = () => {\n    this.setState({isHistorySettingDialogShow: !this.state.isHistorySettingDialogShow});\n  }\n\n  onChangePasswordToggle = () => {\n    this.setState({isChangePasswordDialogShow: !this.state.isChangePasswordDialogShow});\n  }\n\n  onResetPasswordToggle = () => {\n    this.setState({isResetPasswordDialogShow: !this.state.isResetPasswordDialogShow});\n  }\n\n  onLabelToggle = () => {\n    this.setState({isLabelRepoStateDialogOpen: !this.state.isLabelRepoStateDialogOpen});\n  }\n\n  onFolderPermissionToggle = () => {\n    this.setState({isFolderPermissionDialogShow: !this.state.isFolderPermissionDialogShow});\n  }\n\n  onAPITokenToggle = () => {\n    this.setState({isAPITokenDialogShow: !this.state.isAPITokenDialogShow});\n  }\n\n  toggleRepoShareAdminDialog = () => {\n    this.setState({isRepoShareAdminDialogOpen: !this.state.isRepoShareAdminDialogOpen});\n  }\n\n  toggleOldFilesAutoDelDialog = () => {\n    this.setState({isOldFilesAutoDelDialogOpen: !this.state.isOldFilesAutoDelDialogOpen});\n  }\n\n  onUnfreezedItem = () => {\n    this.setState({\n      highlight: false,\n      isOpIconShow: false,\n    });\n    this.props.onUnfreezedItem();\n  }\n\n  onRenameConfirm = (newName) => {\n    let repo = this.props.repo;\n    let repoID = repo.repo_id;\n    seafileAPI.renameRepo(repoID, newName).then(() => {\n      this.props.onRenameRepo(repo, newName);\n      this.onRenameCancel();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onRenameCancel = () => {\n    this.props.onUnfreezedItem();\n    this.setState({isRenaming: !this.state.isRenaming});\n  }\n\n  onTransferRepo = (user) => {\n    let repoID = this.props.repo.repo_id;\n    seafileAPI.transferRepo(repoID, user.email).then(res => {\n      this.props.onTransferRepo(repoID);\n      let message = gettext('Successfully transferred the library.');\n      toaster.success(message);\n    }).catch(error => {\n      if (error.response){\n        toaster.danger(error.response.data.error_msg || gettext('Error'), {duration: 3});\n      } else {\n        toaster.danger(gettext('Failed. Please check the network.'), {duration: 3});\n      }\n    });\n    this.onTransferToggle();\n  }\n\n  onDeleteRepo = (repo) => {\n    seafileAPI.deleteRepo(repo.repo_id).then((res) => {\n\n      this.setState({\n        isRepoDeleted: true,\n        isDeleteDialogShow: false,\n      });\n\n      this.props.onDeleteRepo(repo);\n      let name = repo.repo_name;\n      var msg = gettext('Successfully deleted {name}.').replace('{name}', name);\n      toaster.success(msg);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        let name = repo.repo_name;\n        errMessage = gettext('Failed to delete {name}.').replace('{name}', name);\n      }\n      toaster.danger(errMessage);\n\n      this.setState({isRepoDeleted: false});\n    });\n  }\n\n  renderPCUI = () => {\n    let repo = this.props.repo;\n    let iconUrl = Utils.getLibIconUrl(repo);\n    let iconTitle = Utils.getLibIconTitle(repo);\n    let repoURL = `${siteRoot}library/${repo.repo_id}/${Utils.encodePath(repo.repo_name)}/`;\n    return (\n      <tr className={this.state.highlight ? 'tr-highlight' : ''} onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onClick={this.onRepoClick} onFocus={this.onFocus}>\n        <td className=\"text-center\">\n          <a href=\"#\" role=\"button\" aria-label={this.state.isStarred ? gettext('Unstar') : gettext('Star')} onClick={this.onToggleStarRepo}>\n            <i className={`fa-star ${this.state.isStarred ? 'fas' : 'far star-empty'}`}></i>\n          </a>\n        </td>\n        <td><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n        <td>\n          {this.state.isRenaming && (\n            <Rename\n              name={repo.repo_name}\n              onRenameConfirm={this.onRenameConfirm}\n              onRenameCancel={this.onRenameCancel}\n            />\n          )}\n          {!this.state.isRenaming && repo.repo_name && (\n            <Fragment>\n              <Link to={repoURL}>{repo.repo_name}</Link>\n              {repo.monitored && <RepoMonitoredIcon repoID={repo.repo_id} />}\n            </Fragment>\n          )}\n          {!this.state.isRenaming && !repo.repo_name &&\n            (gettext('Broken (please contact your administrator to fix this library)'))\n          }\n        </td>\n        <td>\n          {(repo.repo_name && this.state.isOpIconShow) && (\n            <div>\n              <a href=\"#\" className=\"op-icon sf2-icon-share\" title={gettext('Share')} role=\"button\" aria-label={gettext('Share')} onClick={this.onShareToggle}></a>\n              <a href=\"#\" className=\"op-icon sf2-icon-delete\" title={gettext('Delete')} role=\"button\" aria-label={gettext('Delete')} onClick={this.onDeleteToggle}></a>\n              <MylibRepoMenu\n                isPC={true}\n                repo={this.props.repo}\n                onMenuItemClick={this.onMenuItemClick}\n                onFreezedItem={this.props.onFreezedItem}\n                onUnfreezedItem={this.onUnfreezedItem}\n              />\n            </div>\n          )}\n        </td>\n        <td>{repo.size}</td>\n        {storages.length > 0 && <td>{repo.storage_name}</td>}\n        <td title={moment(repo.last_modified).format('llll')}>{moment(repo.last_modified).fromNow()}</td>\n      </tr>\n    );\n  }\n\n  renderMobileUI = () => {\n    let repo = this.props.repo;\n    let iconUrl = Utils.getLibIconUrl(repo);\n    let iconTitle = Utils.getLibIconTitle(repo);\n    let repoURL = this.repoURL = `${siteRoot}library/${repo.repo_id}/${Utils.encodePath(repo.repo_name)}/`;\n\n    return (\n      <tr className={this.state.highlight ? 'tr-highlight' : ''}  onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onClick={this.onRepoClick}>\n        <td onClick={this.visitRepo}><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n        <td onClick={this.visitRepo}>\n          {this.state.isRenaming && (\n            <Rename\n              name={repo.repo_name}\n              onRenameConfirm={this.onRenameConfirm}\n              onRenameCancel={this.onRenameCancel}\n            />\n          )}\n          {!this.state.isRenaming && repo.repo_name && (\n            <div>\n              <Link to={repoURL}>{repo.repo_name}</Link>\n              {repo.monitored && <RepoMonitoredIcon repoID={repo.repo_id} />}\n            </div>\n          )}\n          {!this.state.isRenaming && !repo.repo_name &&\n            <div>(gettext('Broken (please contact your administrator to fix this library)'))</div>\n          }\n          <span className=\"item-meta-info\">{repo.size}</span>\n          <span className=\"item-meta-info\" title={moment(repo.last_modified).format('llll')}>{moment(repo.last_modified).fromNow()}</span>\n        </td>\n        <td>\n          {repo.repo_name && (\n            <MylibRepoMenu\n              repo={this.props.repo}\n              isStarred={this.state.isStarred}\n              onMenuItemClick={this.onMenuItemClick}\n              onFreezedItem={this.props.onFreezedItem}\n              onUnfreezedItem={this.onUnfreezedItem}\n            />\n          )}\n        </td>\n      </tr>\n    );\n  }\n\n  render() {\n    let repo = this.props.repo;\n    return (\n      <Fragment>\n        <MediaQuery query=\"(min-width: 768px)\">\n          {this.renderPCUI()}\n        </MediaQuery>\n        <MediaQuery query=\"(max-width: 767.8px)\">\n          {this.renderMobileUI()}\n        </MediaQuery>\n        {this.state.isShareDialogShow && (\n          <ModalPortal>\n            <ShareDialog\n              itemType={'library'}\n              itemName={repo.repo_name}\n              itemPath={'/'}\n              repoID={repo.repo_id}\n              repoEncrypted={repo.encrypted}\n              enableDirPrivateShare={true}\n              userPerm={repo.permission}\n              toggleDialog={this.onShareToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isDeleteDialogShow && (\n          <ModalPortal>\n            <DeleteRepoDialog\n              repo={repo}\n              isRepoDeleted={this.state.isRepoDeleted}\n              onDeleteRepo={this.onDeleteRepo}\n              toggle={this.onDeleteToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isTransferDialogShow && (\n          <ModalPortal>\n            <TransferDialog\n              itemName={repo.repo_name}\n              submit={this.onTransferRepo}\n              toggleDialog={this.onTransferToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isHistorySettingDialogShow && (\n          <ModalPortal>\n            <LibHistorySettingDialog\n              repoID={repo.repo_id}\n              itemName={repo.repo_name}\n              toggleDialog={this.onHistorySettingToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isChangePasswordDialogShow && (\n          <ModalPortal>\n            <ChangeRepoPasswordDialog\n              repoID={repo.repo_id}\n              repoName={repo.repo_name}\n              toggleDialog={this.onChangePasswordToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isResetPasswordDialogShow && (\n          <ModalPortal>\n            <ResetEncryptedRepoPasswordDialog\n              repoID={repo.repo_id}\n              toggleDialog={this.onResetPasswordToggle}\n            />\n          </ModalPortal>\n        )}\n\n        {this.state.isLabelRepoStateDialogOpen && (\n          <ModalPortal>\n            <LabelRepoStateDialog\n              repoID={repo.repo_id}\n              repoName={repo.repo_name}\n              toggleDialog={this.onLabelToggle}\n            />\n          </ModalPortal>\n        )}\n\n        {this.state.isFolderPermissionDialogShow && (\n          <ModalPortal>\n            <LibSubFolderPermissionDialog\n              toggleDialog={this.onFolderPermissionToggle}\n              repoID={repo.repo_id}\n              repoName={repo.repo_name}\n            />\n          </ModalPortal>\n        )}\n\n        {this.state.isAPITokenDialogShow && (\n          <ModalPortal>\n            <RepoAPITokenDialog\n              repo={repo}\n              onRepoAPITokenToggle={this.onAPITokenToggle}\n            />\n          </ModalPortal>\n        )}\n\n        {this.state.isRepoShareAdminDialogOpen && (\n          <ModalPortal>\n            <RepoShareAdminDialog\n              repo={repo}\n              toggleDialog={this.toggleRepoShareAdminDialog}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isOldFilesAutoDelDialogOpen && (\n          <ModalPortal>\n            <LibOldFilesAutoDelDialog\n              repoID={repo.repo_id}\n              toggleDialog={this.toggleOldFilesAutoDelDialog}\n            />\n          </ModalPortal>\n        )}\n\n      </Fragment>\n    );\n  }\n}\n\nMylibRepoListItem.propTypes = propTypes;\n\nexport default MylibRepoListItem;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport MediaQuery from 'react-responsive';\nimport { gettext, storages } from '../../utils/constants';\nimport MylibRepoListItem from './mylib-repo-list-item';\nimport LibsMobileThead from '../../components/libs-mobile-thead';\n\nconst propTypes = {\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  repoList: PropTypes.array.isRequired,\n  sortRepoList: PropTypes.func.isRequired,\n  onRenameRepo: PropTypes.func.isRequired,\n  onDeleteRepo: PropTypes.func.isRequired,\n  onTransferRepo: PropTypes.func.isRequired,\n  onRepoClick: PropTypes.func.isRequired,\n};\n\nclass MylibRepoListView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n    };\n  }\n\n  onFreezedItem = () => {\n    this.setState({isItemFreezed: true});\n  }\n\n  onUnfreezedItem = () => {\n    this.setState({isItemFreezed: false});\n  }\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortRepoList(sortBy, sortOrder);\n  }\n\n  sortByTime = (e) => {\n    e.preventDefault();\n    const sortBy = 'time';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortRepoList(sortBy, sortOrder);\n  }\n\n  sortBySize = (e) => {\n    e.preventDefault();\n    const sortBy = 'size';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortRepoList(sortBy, sortOrder);\n  }\n\n  renderRepoListView = () => {\n    return (\n      <Fragment>\n        {this.props.repoList.map(item => {\n          return (\n            <MylibRepoListItem\n              key={item.repo_id}\n              repo={item}\n              isItemFreezed={this.state.isItemFreezed}\n              onFreezedItem={this.onFreezedItem}\n              onUnfreezedItem={this.onUnfreezedItem}\n              onRenameRepo={this.props.onRenameRepo}\n              onDeleteRepo={this.props.onDeleteRepo}\n              onTransferRepo={this.props.onTransferRepo}\n              onMonitorRepo={this.props.onMonitorRepo}\n              onRepoClick={this.props.onRepoClick}\n            />\n          );\n        })}\n      </Fragment>\n    );\n  }\n\n  renderPCUI = () => {\n    const showStorageBackend = storages.length > 0;\n    const sortIcon = this.props.sortOrder === 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>;\n    return (\n      <table>\n        <thead>\n          <tr>\n            <th width=\"4%\"></th>\n            <th width=\"4%\"><span className=\"sr-only\">{gettext('Library Type')}</span></th>\n            <th width={showStorageBackend ? '33%' : '38%'}><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {this.props.sortBy === 'name' && sortIcon}</a></th>\n            <th width=\"14%\"><span className=\"sr-only\">{gettext('Actions')}</span></th>\n            <th width={showStorageBackend ? '15%' : '20%'}><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortBySize}>{gettext('Size')} {this.props.sortBy === 'size' && sortIcon}</a></th>\n            {showStorageBackend ? <th width=\"15%\">{gettext('Storage Backend')}</th> : null}\n            <th width={showStorageBackend ? '15%' : '20%'}><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByTime}>{gettext('Last Update')} {this.props.sortBy === 'time' && sortIcon}</a></th>\n          </tr>\n        </thead>\n        <tbody>\n          {this.renderRepoListView()}\n        </tbody>\n      </table>\n    );\n  }\n\n  renderMobileUI = () => {\n    return (\n      <table className=\"table-thead-hidden\">\n        <LibsMobileThead />\n        <tbody>\n          {this.renderRepoListView()}\n        </tbody>\n      </table>\n    );\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <MediaQuery query=\"(min-width: 768px)\">\n          {this.renderPCUI()}\n        </MediaQuery>\n        <MediaQuery query=\"(max-width: 767.8px)\">\n          {this.renderMobileUI()}\n        </MediaQuery>\n      </Fragment>\n    );\n  }\n}\n\nMylibRepoListView.propTypes = propTypes;\n\nexport default MylibRepoListView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalBody } from 'reactstrap';\nimport { gettext, mediaUrl, siteName, canAddRepo } from '../../utils/constants';\n\nconst propTypes = {\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass GuideForNewDialog extends React.Component {\n\n  toggle = () => {\n    this.props.toggleDialog();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalBody>\n          <button type=\"button\" className=\"close text-gray\" onClick={this.toggle}><span aria-hidden=\"true\"></span></button>\n          <div className=\"p-2 text-center\">\n            <img src={`${mediaUrl}img/welcome.png`} width=\"180\" alt=\"\" />\n            <h3 id=\"dialogTitle\">{gettext('Welcome to {site_name_placeholder}').replace('{site_name_placeholder}', siteName)}</h3>\n            {canAddRepo ?\n              <p>{gettext('{site_name_placeholder} organizes files into libraries. Each library can be synced and shared separately. We have created a personal library for you. You can create more libraries later.').replace('{site_name_placeholder}', siteName)}</p> :\n              <p>{gettext('{site_name_placeholder} organizes files into libraries. Each library can be synced and shared separately. However, since you are a guest user now, you can not create libraries.').replace('{site_name_placeholder}', siteName)}</p>\n            }\n          </div>\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nGuideForNewDialog.propTypes = propTypes;\n\nexport default GuideForNewDialog;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport cookie from 'react-cookies';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport Repo from '../../models/repo';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport CommonToolbar from '../../components/toolbar/common-toolbar';\nimport RepoViewToolbar from '../../components/toolbar/repo-view-toobar';\nimport LibDetail from '../../components/dirent-detail/lib-details';\nimport MylibRepoListView from './mylib-repo-list-view';\nimport SortOptionsDialog from '../../components/dialog/sort-options';\nimport GuideForNewDialog from '../../components/dialog/guide-for-new-dialog';\n\nconst propTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n};\n\nclass MyLibraries extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      errorMsg: '',\n      isLoading: true,\n      repoList: [],\n      isShowDetails: false,\n      isSortOptionsDialogOpen: false,\n      isGuideForNewDialogOpen: window.app.pageOptions.guideEnabled,\n      sortBy: cookie.load('seafile-repo-dir-sort-by') || 'name', // 'name' or 'time' or 'size'\n      sortOrder: cookie.load('seafile-repo-dir-sort-order') || 'asc', // 'asc' or 'desc'\n    };\n\n    this.emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No libraries')}</h2>\n        <p>{gettext('You have not created any libraries yet. A library is a container to organize your files and folders. A library can also be shared with others and synced to your connected devices. You can create a library by clicking the \"New Library\" button in the menu bar.')}</p>\n      </EmptyTip>\n    );\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepos({type: 'mine'}).then((res) => {\n      let repoList = res.data.repos.map((item) => {\n        return new Repo(item);\n      });\n      this.setState({\n        isLoading: false,\n        repoList: Utils.sortRepos(repoList, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        isLoading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  toggleSortOptionsDialog = () => {\n    this.setState({\n      isSortOptionsDialogOpen: !this.state.isSortOptionsDialogOpen\n    });\n  }\n\n  onCreateRepo = (repo) => {\n    seafileAPI.createMineRepo(repo).then((res) => {\n      const newRepo = new Repo({\n        repo_id: res.data.repo_id,\n        repo_name: res.data.repo_name,\n        size: res.data.repo_size,\n        mtime: res.data.mtime,\n        owner_email: res.data.email,\n        encrypted: res.data.encrypted,\n        permission: res.data.permission,\n        storage_name: res.data.storage_name\n      });\n      this.state.repoList.unshift(newRepo);\n      this.setState({repoList: this.state.repoList});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  sortRepoList = (sortBy, sortOrder) => {\n    cookie.save('seafile-repo-dir-sort-by', sortBy);\n    cookie.save('seafile-repo-dir-sort-order', sortOrder);\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      repoList: Utils.sortRepos(this.state.repoList, sortBy, sortOrder)\n    });\n  }\n\n  onTransferRepo = (repoID) => {\n    let repoList = this.state.repoList.filter(item => {\n      return item.repo_id !== repoID;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  onRenameRepo = (repo, newName) => {\n    let repoList = this.state.repoList.map(item => {\n      if (item.repo_id === repo.repo_id) {\n        item.repo_name = newName;\n      }\n      return item;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  onMonitorRepo = (repo, monitored) => {\n    let repoList = this.state.repoList.map(item => {\n      if (item.repo_id === repo.repo_id) {\n        item.monitored = monitored;\n      }\n      return item;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  onDeleteRepo = (repo) => {\n    let repoList = this.state.repoList.filter(item => {\n      return item.repo_id !== repo.repo_id;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  onRepoClick = (repo) => {\n    if (this.state.isShowDetails) {\n      this.onRepoDetails(repo);\n    }\n  }\n\n  onRepoDetails = (repo) => {\n    this.setState({\n      currentRepo: repo,\n      isShowDetails: true,\n    });\n  }\n\n  closeDetails = () => {\n    this.setState({isShowDetails: !this.state.isShowDetails});\n  }\n\n  toggleGuideForNewDialog = () => {\n    window.app.pageOptions.guideEnabled = false;\n    this.setState({\n      isGuideForNewDialogOpen: false\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"main-panel-north border-left-show\">\n          <RepoViewToolbar onShowSidePanel={this.props.onShowSidePanel} onCreateRepo={this.onCreateRepo} libraryType={'mine'}/>\n          <CommonToolbar onSearchedClick={this.props.onSearchedClick} />\n        </div>\n        <div className=\"main-panel-center flex-row\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading m-0\">{gettext('My Libraries')}</h3>\n              {(!Utils.isDesktop() && this.state.repoList.length > 0) && <span className=\"sf3-font sf3-font-sort action-icon\" onClick={this.toggleSortOptionsDialog}></span>}\n            </div>\n            <div className=\"cur-view-content\">\n              {this.state.isLoading && <Loading />}\n              {!this.state.isLoading && this.state.errorMsg && <p className=\"error text-center mt-8\">{this.state.errorMsg}</p>}\n              {!this.state.isLoading && !this.state.errorMsg && this.state.repoList.length === 0 && this.emptyTip}\n              {!this.state.isLoading && !this.state.errorMsg && this.state.repoList.length > 0 &&\n                <MylibRepoListView\n                  sortBy={this.state.sortBy}\n                  sortOrder={this.state.sortOrder}\n                  repoList={this.state.repoList}\n                  onRenameRepo={this.onRenameRepo}\n                  onDeleteRepo={this.onDeleteRepo}\n                  onTransferRepo={this.onTransferRepo}\n                  onMonitorRepo={this.onMonitorRepo}\n                  onRepoClick={this.onRepoClick}\n                  sortRepoList={this.sortRepoList}\n                />\n              }\n            </div>\n          </div>\n          {!this.state.isLoading && !this.state.errorMsg && this.state.isGuideForNewDialogOpen &&\n            <GuideForNewDialog\n              toggleDialog={this.toggleGuideForNewDialog}\n            />\n          }\n          {this.state.isSortOptionsDialogOpen &&\n            <SortOptionsDialog\n              toggleDialog={this.toggleSortOptionsDialog}\n              sortBy={this.state.sortBy}\n              sortOrder={this.state.sortOrder}\n              sortItems={this.sortRepoList}\n            />\n          }\n          {this.state.isShowDetails && (\n            <div className=\"cur-view-detail\">\n              <LibDetail\n                currentRepo={this.state.currentRepo}\n                closeDetails={this.closeDetails}\n              />\n            </div>\n          )}\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nMyLibraries.propTypes = propTypes;\n\nexport default MyLibraries;\n","import React, { Component, Fragment } from 'react';\nimport { Link } from '@gatsbyjs/reach-router';\nimport moment from 'moment';\nimport { gettext, siteRoot, lang, trashReposExpireDays } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport CommonToolbar from '../../components/toolbar/common-toolbar';\n\nmoment.locale(lang);\n\nclass MyLibsDeleted extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      deletedRepoList: [],\n      isLoading: true,\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listDeletedRepo().then(res => {\n      this.setState({\n        deletedRepoList: res.data,\n        isLoading: false,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  refreshDeletedRepoList = (repoID) => {\n    let deletedRepoList = this.state.deletedRepoList.filter(item => {\n      return item.repo_id !== repoID;\n    });\n    this.setState({deletedRepoList: deletedRepoList});\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"main-panel-north\">\n          <CommonToolbar onSearchedClick={this.props.onSearchedClick} />\n        </div>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <div className=\"path-container\">\n                <Link to={ siteRoot + 'my-libs/' }>{gettext('My Libraries')}</Link>\n                <span className=\"path-split\">/</span>\n                <span>{gettext('Deleted Libraries')}</span>\n              </div>\n            </div>\n            <div className=\"cur-view-content\">\n              {this.state.isLoading && <Loading />}\n              {(!this.state.isLoading && this.state.deletedRepoList.length === 0) &&\n              <EmptyTip>\n                <h2>{gettext('No deleted libraries')}</h2>\n                <p>{gettext('You have not deleted any libraries in the last {placeholder} days. A deleted library will be cleaned automatically after this period.').replace('{placeholder}', trashReposExpireDays)}</p>\n              </EmptyTip>\n              }\n              {this.state.deletedRepoList.length !== 0 &&\n                <div>\n                  <p className=\"tip mt-2\">{gettext('Tip: libraries deleted {placeholder} days ago will be cleaned automatically.').replace('{placeholder}', trashReposExpireDays)}</p>\n                  <DeletedRepoTable\n                    deletedRepoList={this.state.deletedRepoList}\n                    refreshDeletedRepoList={this.refreshDeletedRepoList}\n                  />\n                </div>\n              }\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nclass DeletedRepoTable extends Component {\n\n  render() {\n    let deletedRepos = this.props.deletedRepoList;\n    return (\n      <table>\n        <thead>\n          <tr>\n            <th style={{width: '4%'}}>{/*img*/}</th>\n            <th style={{width: '52%'}}>{gettext('Name')}</th>\n            <th style={{width: '30%'}}>{gettext('Deleted Time')}</th>\n            <th style={{width: '14%'}}></th>\n          </tr>\n        </thead>\n        <tbody>\n          { deletedRepos && deletedRepos.map((item) => {\n            return (\n              <DeletedRepoItem\n                key={item.repo_id}\n                repo={item}\n                refreshDeletedRepoList={this.props.refreshDeletedRepoList}\n              />\n            );\n          })}\n        </tbody>\n      </table>\n    );\n  }\n}\n\nclass DeletedRepoItem extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      hideRestoreMenu: true,\n      highlight: false,\n    };\n  }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        hideRestoreMenu: false,\n        highlight: true,\n      });\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        hideRestoreMenu: true,\n        highlight: false,\n      });\n    }\n  }\n\n  restoreDeletedRepo = (e) => {\n    e.preventDefault();\n    let repoID = this.props.repo.repo_id;\n    let repoName = this.props.repo.repo_name;\n    seafileAPI.restoreDeletedRepo(repoID).then(res => {\n      let message = gettext('Successfully restored the library.') + '  ' + repoName;\n      toaster.success(message);\n      this.props.refreshDeletedRepoList(repoID);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = gettext('Failed. Please check the network.');\n      }\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    let localTime = moment.utc(this.props.repo.del_time).toDate();\n    localTime = moment(localTime).fromNow();\n    let iconUrl = Utils.getLibIconUrl(this.props.repo);\n\n    return (\n      <tr\n        className={this.state.highlight ? 'tr-highlight' : ''}\n        onMouseEnter={this.onMouseEnter}\n        onMouseLeave={this.onMouseLeave}\n        tabIndex=\"0\"\n        onFocus={this.onMouseEnter}\n      >\n        <td className=\"text-center\"><img src={iconUrl} alt='' width=\"24\" /></td>\n        <td className=\"name\">{this.props.repo.repo_name}</td>\n        <td className=\"update\">{localTime}</td>\n        <td>\n          <a href=\"#\" onClick={this.restoreDeletedRepo} title={gettext('Restore')}\n            role=\"button\" aria-label={gettext('Restore')}\n            className={`sf2-icon-reply action-icon ${this.state.highlight ? '' : 'vh'}`}></a>\n        </td>\n      </tr>\n    );\n  }\n}\n\nexport default MyLibsDeleted;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Input, Alert } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport Repo from '../../models/repo';\n\nconst shareRepoListItemProps = {\n  repo: PropTypes.object.isRequired,\n  onRepoSelect: PropTypes.func.isRequired,\n  onPermissionChange: PropTypes.func.isRequired,\n};\n\nclass ShareRepoListItem extends React.Component {\n\n  onRepoSelect = (e) => {\n    let isChecked = e.target.checked;\n    this.props.onRepoSelect(this.props.repo, isChecked);\n  }\n\n  onPermissionChange = (e) => {\n    let permission = e.target.value;\n    let repo = this.props.repo;\n    this.props.onPermissionChange(repo, permission);\n  }\n\n  render() {\n    let repo = this.props.repo;\n    let iconUrl = Utils.getLibIconUrl(repo);\n    return (\n      <tr>\n        <td className=\"text-center\"><input type=\"checkbox\" className=\"vam\" name=\"repo\" onChange={this.onRepoSelect} /></td>\n        <td className=\"text-center\"><img src={iconUrl} width=\"24\" alt={gettext('icon')} /></td>\n        <td className=\"name\">{repo.repo_name}</td>\n        <td>{moment(repo.last_modified).fromNow()}</td>\n        <td>\n          <Input style={{height: '1.5rem', padding: 0}} type=\"select\" name=\"select\" onChange={this.onPermissionChange} value={repo.sharePermission}>\n            <option value='rw'>{gettext('Read-Write')}</option>\n            <option value='r'>{gettext('Read-Only')}</option>\n          </Input>\n        </td>\n      </tr>\n    );\n  }\n}\n\nShareRepoListItem.propTypes = shareRepoListItemProps;\n\nconst propTypes = {\n  onRepoSelectedHandler: PropTypes.func.isRequired,\n  onShareRepoDialogClose: PropTypes.func.isRequired,\n};\n\nclass ShareRepoDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      repoList: [],\n      currentRepo: null,\n      permission: 'rw',\n      selectedRepoList: [],\n      errMessage: '',\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepos({type: 'mine'}).then(res => {\n      let repoList = res.data.repos.map(item => {\n        let repo = new Repo(item);\n        repo.sharePermission = 'rw';\n        return repo;\n      });\n      this.setState({repoList: repoList});\n    });\n  }\n\n  onRepoSelect = (repo, isChecked) => {\n    let selectedRepoList = [];\n    if (isChecked) {\n      this.state.selectedRepoList.push(repo);\n      selectedRepoList = this.state.selectedRepoList;\n    } else {\n      selectedRepoList = this.state.selectedRepoList.filter(item => {\n        return item.repo_id !== repo.repo_id;\n      });\n    }\n    this.setState({selectedRepoList: selectedRepoList});\n  }\n\n  onPermissionChange = (repo, permission) => {\n    let repoList = this.state.repoList.map(item => {\n      if (item.repo_id === repo.repo_id) {\n        item.sharePermission = permission;\n      }\n      return item;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  handleSubmit = () => {\n    if (this.state.selectedRepoList.length === 0) {\n      let errMessage = gettext('Please select a library to share.');\n      this.setState({errMessage: errMessage});\n      return;\n    }\n\n    this.props.onRepoSelectedHandler(this.state.selectedRepoList);\n    this.onCloseDialog();\n  }\n\n  onCloseDialog = () => {\n    this.props.onShareRepoDialogClose();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.toggle}>{gettext('Select libraries to share')}</ModalHeader>\n        <ModalBody className=\"dialog-list-container\">\n          <table>\n            <thead>\n              <tr>\n                <th width='4%'>{/* select */}</th>\n                <th width='6%'>{/* icon */}</th>\n                <th width='35%'>{gettext('Name')}</th>\n                <th width='25%'>{gettext('Last Update')}</th>\n                <th width='30%'>{gettext('Permission')}</th>\n              </tr>\n            </thead>\n            <tbody>\n              {this.state.repoList.map((repo, index) => {\n                return (\n                  <ShareRepoListItem\n                    key={index}\n                    repo={repo}\n                    onRepoSelect={this.onRepoSelect}\n                    onPermissionChange={this.onPermissionChange}\n                  />\n                );\n              })}\n            </tbody>\n          </table>\n        </ModalBody>\n        {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.onCloseDialog}>{gettext('Close')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nShareRepoDialog.propTypes = propTypes;\n\nexport default ShareRepoDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Dropdown, DropdownMenu, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { Link, navigate } from '@gatsbyjs/reach-router';\nimport { Utils } from '../../utils/utils';\nimport { gettext, siteRoot, isPro, username, folderPermEnabled, isSystemStaff, enableResetEncryptedRepoPassword, isEmailConfigured } from '../../utils/constants';\nimport ModalPortal from '../../components/modal-portal';\nimport ShareDialog from '../../components/dialog/share-dialog';\nimport LibSubFolderPermissionDialog from '../../components/dialog/lib-sub-folder-permission-dialog';\nimport DeleteRepoDialog from '../../components/dialog/delete-repo-dialog';\nimport ChangeRepoPasswordDialog from '../../components/dialog/change-repo-password-dialog';\nimport ResetEncryptedRepoPasswordDialog from '../../components/dialog/reset-encrypted-repo-password-dialog';\nimport Rename from '../rename';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport LibHistorySettingDialog from '../dialog/lib-history-setting-dialog';\nimport toaster from '../toast';\nimport RepoAPITokenDialog from '../dialog/repo-api-token-dialog';\nimport RepoShareAdminDialog from '../dialog/repo-share-admin-dialog';\nimport RepoMonitoredIcon from '../../components/repo-monitored-icon';\n\nconst propTypes = {\n  currentGroup: PropTypes.object,\n  libraryType: PropTypes.string,\n  repo: PropTypes.object.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  onFreezedItem: PropTypes.func.isRequired,\n  onUnfreezedItem: PropTypes.func.isRequired,\n  onItemUnshare: PropTypes.func.isRequired,\n  onItemDetails: PropTypes.func,\n  onItemRename: PropTypes.func,\n  onItemDelete: PropTypes.func,\n  onMonitorRepo: PropTypes.func\n};\n\nclass SharedRepoListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      highlight: false,\n      isOperationShow: false,\n      isItemMenuShow: false,\n      isShowSharedDialog: false,\n      isRenaming: false,\n      isStarred: this.props.repo.starred,\n      isFolderPermissionDialogOpen: false,\n      isHistorySettingDialogShow: false,\n      isDeleteDialogShow: false,\n      isAPITokenDialogShow: false,\n      isRepoShareAdminDialogOpen: false,\n      isRepoDeleted: false,\n      isChangePasswordDialogShow: false,\n      isResetPasswordDialogShow: false\n    };\n    this.isDeparementOnwerGroupMember = false;\n  }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: true,\n        isOperationShow: true,\n      });\n    }\n  }\n\n  onMouseOver = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: true,\n        isOperationShow: true,\n      });\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: false,\n        isOperationShow: false,\n      });\n    }\n  }\n\n  clickOperationMenuToggle = (e) => {\n    this.toggleOperationMenu(e);\n  }\n\n  onDropdownToggleKeyDown = (e) => {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      this.clickOperationMenuToggle(e);\n    }\n  }\n\n  toggleOperationMenu = (e) => {\n    let dataset = e.target ? e.target.dataset : null;\n    if (dataset && dataset.toggle && dataset.toggle === 'Rename') {\n      this.setState({isItemMenuShow: !this.state.isItemMenuShow});\n      return;\n    }\n\n    this.setState(\n      {isItemMenuShow: !this.state.isItemMenuShow},\n      () => {\n        if (this.state.isItemMenuShow) {\n          this.props.onFreezedItem();\n        } else {\n          this.props.onUnfreezedItem();\n          this.setState({\n            highlight: false,\n            isOperationShow: false,\n          });\n        }\n      }\n    );\n  }\n\n  getRepoComputeParams = () => {\n    let repo = this.props.repo;\n\n    let iconUrl = Utils.getLibIconUrl(repo);\n    let iconTitle = Utils.getLibIconTitle(repo);\n    let libPath = `${siteRoot}library/${repo.repo_id}/${Utils.encodePath(repo.repo_name)}/`;\n\n    return { iconUrl, iconTitle, libPath };\n  }\n\n  onMenuItemKeyDown = (e) => {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      this.onMenuItemClick(e);\n    }\n  }\n\n  onMenuItemClick = (e) => {\n    let operation = e.target.dataset.toggle;\n    switch(operation) {\n      case 'Rename':\n        this.onItemRenameToggle();\n        break;\n      case 'Folder Permission':\n        this.onItemFolderPermissionToggle();\n        break;\n      case 'Details':\n        this.onItemDetails();\n        break;\n      case 'Share':\n        this.onItemShare();\n        break;\n      case 'Unshare':\n        this.onItemUnshare();\n        break;\n      case 'History Setting':\n        this.onHistorySettingToggle();\n        break;\n      case 'API Token':\n        this.onAPITokenToggle();\n        break;\n      case 'Share Admin':\n        this.toggleRepoShareAdminDialog();\n        break;\n      case 'Change Password':\n        this.onChangePasswordToggle();\n        break;\n      case 'Reset Password':\n        this.onResetPasswordToggle();\n        break;\n      case 'Watch File Changes':\n        this.watchFileChanges();\n        break;\n      case 'Unwatch File Changes':\n        this.unwatchFileChanges();\n        break;\n      // no default\n    }\n  }\n\n  watchFileChanges = () => {\n    const { repo } = this.props;\n    seafileAPI.monitorRepo(repo.repo_id).then(() => {\n      this.props.onMonitorRepo(repo, true);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  unwatchFileChanges = () => {\n    const { repo } = this.props;\n    seafileAPI.unMonitorRepo(repo.repo_id).then(() => {\n      this.props.onMonitorRepo(repo, false);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onItemRenameToggle = () => {\n    this.props.onFreezedItem();\n    this.setState({\n      isRenaming: !this.state.isRenaming,\n      isOperationShow: !this.state.isOperationShow\n    });\n  }\n\n  onRenameConfirm = (name) => {\n    this.props.onItemRename(this.props.repo, name);\n    this.onRenameCancel();\n  }\n\n  onRenameCancel = () => {\n    this.props.onUnfreezedItem();\n    this.setState({isRenaming: !this.state.isRenaming});\n  }\n\n  onItemFolderPermissionToggle = () => {\n    this.setState({isFolderPermissionDialogOpen: !this.state.isFolderPermissionDialogOpen});\n  }\n\n  onHistorySettingToggle = () => {\n    this.setState({isHistorySettingDialogShow: !this.state.isHistorySettingDialogShow});\n  }\n\n  onItemDetails = () => {\n    this.props.onItemDetails(this.props.repo);\n  }\n\n  onItemShare = (e) => {\n    e.preventDefault();\n    this.setState({isShowSharedDialog: true});\n  }\n\n  onItemUnshare = (e) => {\n    e.preventDefault();\n    this.props.onItemUnshare(this.props.repo);\n  }\n\n  onItemDeleteToggle = (e) => {\n    e.preventDefault();\n    this.setState({isDeleteDialogShow: !this.state.isDeleteDialogShow});\n  }\n\n  onItemDelete = () => {\n    const { currentGroup, repo } = this.props;\n    if (!currentGroup) {  // repo can not be deleted in share all module\n      return;\n    }\n\n    const groupID = currentGroup.id;\n\n    seafileAPI.deleteGroupOwnedLibrary(groupID, repo.repo_id).then(() => {\n\n      this.setState({\n        isRepoDeleted: true,\n        isDeleteDialogShow: false,\n      });\n\n      this.props.onItemDelete(repo);\n      let name = repo.repo_name;\n      var msg = gettext('Successfully deleted {name}.').replace('{name}', name);\n      toaster.success(msg);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        let name = repo.repo_name;\n        errMessage = gettext('Failed to delete {name}.').replace('{name}', name);\n      }\n      toaster.danger(errMessage);\n\n      this.setState({isRepoDeleted: false});\n    });\n  }\n\n  toggleShareDialog = () => {\n    this.setState({isShowSharedDialog: false});\n  }\n\n  toggleRepoShareAdminDialog = () => {\n    this.setState({isRepoShareAdminDialogOpen: !this.state.isRepoShareAdminDialogOpen});\n  }\n\n  onAPITokenToggle = () => {\n    this.setState({isAPITokenDialogShow: !this.state.isAPITokenDialogShow});\n  }\n\n  onChangePasswordToggle = () => {\n    this.setState({isChangePasswordDialogShow: !this.state.isChangePasswordDialogShow});\n  }\n\n  onResetPasswordToggle = () => {\n    this.setState({isResetPasswordDialogShow: !this.state.isResetPasswordDialogShow});\n  }\n\n  translateMenuItem = (menuItem) => {\n    let translateResult = '';\n    switch(menuItem) {\n      case 'Rename':\n        translateResult = gettext('Rename');\n        break;\n      case 'Folder Permission':\n        translateResult = gettext('Folder Permission');\n        break;\n      case 'Details':\n        translateResult = gettext('Details');\n        break;\n      case 'Unshare':\n        translateResult = gettext('Unshare');\n        break;\n      case 'Share':\n        translateResult = gettext('Share');\n        break;\n      case 'History Setting':\n        translateResult = gettext('History Setting');\n        break;\n      case 'Share Admin':\n        translateResult = gettext('Share Admin');\n        break;\n      case 'Change Password':\n        translateResult = gettext('Change Password');\n        break;\n      case 'Reset Password':\n        translateResult = gettext('Reset Password');\n        break;\n      case 'Watch File Changes':\n        translateResult = gettext('Watch File Changes');\n        break;\n      case 'Unwatch File Changes':\n        translateResult = gettext('Unwatch File Changes');\n        break;\n      case 'API Token':\n        translateResult = 'API Token'; // translation is not needed here\n        break;\n      default:\n        break;\n    }\n    return translateResult;\n  }\n\n  generatorOperations = () => {\n    let { repo, currentGroup } = this.props;\n    //todo this have a bug; use current api is not return admins param;\n    let isStaff = currentGroup && currentGroup.admins && currentGroup.admins.indexOf(username) > -1; //for group repolist;\n    let isRepoOwner = repo.owner_email === username;\n    let isAdmin = repo.is_admin;\n    let operations = [];\n    if (isPro) {\n      if (repo.owner_email.indexOf('@seafile_group') != -1) {\n        if (isStaff) {\n          if (repo.owner_email == currentGroup.id + '@seafile_group') {\n            this.isDeparementOnwerGroupMember = true;\n            operations = ['Rename'];\n            if (folderPermEnabled) {\n              operations.push('Folder Permission');\n            }\n            operations.push('Share Admin');\n            if (repo.encrypted) {\n              operations.push('Change Password');\n            }\n            if (repo.encrypted && enableResetEncryptedRepoPassword && isEmailConfigured) {\n              operations.push('Reset Password');\n            }\n            operations.push('History Setting', 'API Token', 'Details');\n          } else {\n            operations.push('Unshare');\n          }\n        }\n      } else {\n        if (isRepoOwner || isAdmin) {\n          operations.push('Share');\n        }\n        if (isStaff || isRepoOwner || isAdmin) {\n          operations.push('Unshare');\n        }\n      }\n      if (repo.permission == 'r' || repo.permission == 'rw') {\n        const monitorOp = repo.monitored ? 'Unwatch File Changes' : 'Watch File Changes';\n        operations.push(monitorOp);\n      }\n    } else {\n      if (isRepoOwner) {\n        operations.push('Share');\n      }\n      if (isStaff || isRepoOwner) {\n        operations.push('Unshare');\n      }\n    }\n    return operations;\n  }\n\n  generatorMobileMenu = () => {\n    let operations = [];\n    if (this.props.libraryType && this.props.libraryType === 'public') {\n      let isRepoOwner = this.props.repo.owner_email === username;\n      if (isSystemStaff || isRepoOwner) {\n        operations.push('Unshare');\n      }\n    } else {\n      operations = this.generatorOperations();\n      if (this.isDeparementOnwerGroupMember) {\n        operations.unshift('Unshare');\n        operations.unshift('Share');\n      }\n    }\n\n    if (!operations.length) {\n      return null;\n    }\n    return (\n      <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.toggleOperationMenu}>\n        <DropdownToggle\n          tag=\"i\"\n          className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n          title={gettext('More Operations')}\n          data-toggle=\"dropdown\"\n          aria-expanded={this.state.isItemMenuShow}\n          onClick={this.clickOperationMenuToggle}\n        />\n        <div className={`${this.state.isItemMenuShow?'':'d-none'}`} onClick={this.toggleOperationMenu}>\n          <div className=\"mobile-operation-menu-bg-layer\"></div>\n          <div className=\"mobile-operation-menu\">\n            {operations.map((item, index) => {\n              return (\n                <DropdownItem key={index} data-toggle={item} onClick={this.onMenuItemClick}>{this.translateMenuItem(item)}</DropdownItem>\n              );\n            })}\n          </div>\n        </div>\n      </Dropdown>\n    );\n  }\n\n  generatorPCMenu = () => {\n    let operations = [];\n    if (this.props.libraryType && this.props.libraryType === 'public') {\n      let isRepoOwner = this.props.repo.owner_email === username;\n      if (isSystemStaff || isRepoOwner) {\n        operations.push('Unshare');\n      }\n    } else {\n      operations = this.generatorOperations();\n    }\n    const shareOperation   = <a href=\"#\" className=\"op-icon sf2-icon-share\" title={gettext('Share')} role=\"button\" aria-label={gettext('Share')} onClick={this.onItemShare}></a>;\n    const unshareOperation = <a href=\"#\" className=\"op-icon sf2-icon-x3\" title={gettext('Unshare')} role=\"button\" aria-label={gettext('Unshare')} onClick={this.onItemUnshare}></a>;\n    const deleteOperation  = <a href=\"#\" className=\"op-icon sf2-icon-delete\" title={gettext('Delete')} role=\"button\" aria-label={gettext('Delete')} onClick={this.onItemDeleteToggle}></a>;\n\n    if (this.isDeparementOnwerGroupMember) {\n      return (\n        <Fragment>\n          {shareOperation}\n          {deleteOperation}\n          <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.toggleOperationMenu}>\n            <DropdownToggle\n              className=\"sf-dropdown-toggle sf2-icon-caret-down border-0 p-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isItemMenuShow}\n              aria-haspopup={true}\n              style={{'minWidth': '0'}}\n              onClick={this.clickOperationMenuToggle}\n              onKeyDown={this.onDropdownToggleKeyDown}\n            />\n            <DropdownMenu>\n              {operations.map((item, index) => {\n                return <DropdownItem key={index} data-toggle={item} onClick={this.onMenuItemClick} onKeyDown={this.onMenuItemKeyDown}>{this.translateMenuItem(item)}</DropdownItem>;\n              })}\n            </DropdownMenu>\n          </Dropdown>\n        </Fragment>\n      );\n    } else {\n      return (\n        <Fragment>\n          {operations.map(item => {\n            switch (item) {\n              case 'Share':\n                return <Fragment key={item}>{shareOperation}</Fragment>;\n              case 'Unshare':\n                return <Fragment key={item}>{unshareOperation}</Fragment>;\n              case 'Watch File Changes':\n              case 'Unwatch File Changes':\n                return (\n                  <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.toggleOperationMenu} key={item}>\n                    <DropdownToggle\n                      className=\"sf-dropdown-toggle sf2-icon-caret-down border-0 p-0\"\n                      title={gettext('More Operations')}\n                      data-toggle=\"dropdown\"\n                      aria-expanded={this.state.isItemMenuShow}\n                      aria-haspopup={true}\n                      style={{'minWidth': '0'}}\n                      onClick={this.clickOperationMenuToggle}\n                      onKeyDown={this.onDropdownToggleKeyDown}\n                    />\n                    <DropdownMenu>\n                      {[item].map((item, index) => {\n                        return <DropdownItem key={index} data-toggle={item} onClick={this.onMenuItemClick} onKeyDown={this.onMenuItemKeyDown}>{this.translateMenuItem(item)}</DropdownItem>;\n                      })}\n                    </DropdownMenu>\n                  </Dropdown>\n                );\n              // no default\n            }\n          })}\n        </Fragment>\n      );\n    }\n  }\n\n  onToggleStarRepo = (e) => {\n    e.preventDefault();\n    const { repo_name: repoName } = this.props.repo;\n    if (this.state.isStarred) {\n      seafileAPI.unstarItem(this.props.repo.repo_id, '/').then(() => {\n        this.setState({isStarred: !this.state.isStarred});\n        const msg = gettext('Successfully unstarred {library_name_placeholder}.')\n          .replace('{library_name_placeholder}', repoName);\n        toaster.success(msg);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      seafileAPI.starItem(this.props.repo.repo_id, '/').then(() => {\n        this.setState({isStarred: !this.state.isStarred});\n        const msg = gettext('Successfully starred {library_name_placeholder}.')\n          .replace('{library_name_placeholder}', repoName);\n        toaster.success(msg);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  renderPCUI = () => {\n    let { iconUrl, iconTitle, libPath } = this.getRepoComputeParams();\n    let { repo } = this.props;\n    return (\n      <Fragment>\n        <tr className={this.state.highlight ? 'tr-highlight' : ''} onMouseEnter={this.onMouseEnter} onMouseOver={this.onMouseOver} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter}>\n          <td className=\"text-center\">\n            <a href=\"#\" role=\"button\" aria-label={this.state.isStarred ? gettext('Unstar') : gettext('Star')} onClick={this.onToggleStarRepo}>\n              <i className={`fa-star ${this.state.isStarred ? 'fas' : 'far star-empty'}`}></i>\n            </a>\n          </td>\n          <td><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n          <td>\n            {this.state.isRenaming ?\n              <Rename name={repo.repo_name} onRenameConfirm={this.onRenameConfirm} onRenameCancel={this.onRenameCancel}/> :\n              <Fragment>\n                <Link to={libPath}>{repo.repo_name}</Link>\n                {repo.monitored && <RepoMonitoredIcon repoID={repo.repo_id} />}\n              </Fragment>\n            }\n          </td>\n          <td>{this.state.isOperationShow && this.generatorPCMenu()}</td>\n          <td>{repo.size}</td>\n          <td title={moment(repo.last_modified).format('llll')}>{moment(repo.last_modified).fromNow()}</td>\n          <td title={repo.owner_contact_email}>{repo.owner_name}</td>\n        </tr>\n      </Fragment>\n    );\n  }\n\n  visitRepo = () => {\n    if (!this.state.isRenaming) {\n      navigate(this.repoURL);\n    }\n  }\n\n  renderMobileUI = () => {\n    let { iconUrl, iconTitle, libPath } = this.getRepoComputeParams();\n    let { repo } = this.props;\n    this.repoURL = libPath;\n    return (\n      <Fragment>\n        <tr className={this.state.highlight ? 'tr-highlight' : ''}  onMouseEnter={this.onMouseEnter} onMouseOver={this.onMouseOver} onMouseLeave={this.onMouseLeave}>\n          <td onClick={this.visitRepo}><img src={iconUrl} title={iconTitle} width=\"24\" alt={iconTitle}/></td>\n          <td onClick={this.visitRepo}>\n            {this.state.isRenaming ?\n              <Rename name={repo.repo_name} onRenameConfirm={this.onRenameConfirm} onRenameCancel={this.onRenameCancel} /> :\n              <Fragment>\n                <Link to={libPath}>{repo.repo_name}</Link>\n                {repo.monitored && <RepoMonitoredIcon repoID={repo.repo_id} />}\n              </Fragment>\n            }\n            <br />\n            <span className=\"item-meta-info\" title={repo.owner_contact_email}>{repo.owner_name}</span>\n            <span className=\"item-meta-info\">{repo.size}</span>\n            <span className=\"item-meta-info\" title={moment(repo.last_modified).format('llll')}>{moment(repo.last_modified).fromNow()}</span>\n          </td>\n          <td>{this.generatorMobileMenu()}</td>\n        </tr>\n      </Fragment>\n    );\n  }\n\n  render() {\n    let { repo } = this.props;\n    let isGroupOwnedRepo = repo.owner_email.indexOf('@seafile_group') > -1;\n    return (\n      <Fragment>\n        {Utils.isDesktop() ? this.renderPCUI() : this.renderMobileUI()}\n        {this.state.isShowSharedDialog && (\n          <ModalPortal>\n            <ShareDialog\n              itemType={'library'}\n              itemName={repo.repo_name}\n              itemPath={'/'}\n              repoID={repo.repo_id}\n              repoEncrypted={repo.encrypted}\n              enableDirPrivateShare={true}\n              userPerm={repo.permission}\n              isAdmin={repo.is_admin}\n              isGroupOwnedRepo={isGroupOwnedRepo}\n              toggleDialog={this.toggleShareDialog}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isFolderPermissionDialogOpen && (\n          <ModalPortal>\n            <LibSubFolderPermissionDialog\n              toggleDialog={this.onItemFolderPermissionToggle}\n              repoID={repo.repo_id}\n              repoName={repo.repo_name}\n              isDepartmentRepo={true}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isDeleteDialogShow &&\n          <ModalPortal>\n            <DeleteRepoDialog\n              repo={this.props.repo}\n              isRepoDeleted={this.state.isRepoDeleted}\n              onDeleteRepo={this.onItemDelete}\n              toggle={this.onItemDeleteToggle}\n            />\n          </ModalPortal>\n        }\n        {this.state.isHistorySettingDialogShow && (\n          <ModalPortal>\n            <LibHistorySettingDialog\n              repoID={repo.repo_id}\n              itemName={repo.repo_name}\n              toggleDialog={this.onHistorySettingToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isAPITokenDialogShow && (\n          <ModalPortal>\n            <RepoAPITokenDialog\n              repo={repo}\n              onRepoAPITokenToggle={this.onAPITokenToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isRepoShareAdminDialogOpen && (\n          <ModalPortal>\n            <RepoShareAdminDialog\n              repo={repo}\n              toggleDialog={this.toggleRepoShareAdminDialog}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isChangePasswordDialogShow && (\n          <ModalPortal>\n            <ChangeRepoPasswordDialog\n              repoID={repo.repo_id}\n              repoName={repo.repo_name}\n              toggleDialog={this.onChangePasswordToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isResetPasswordDialogShow && (\n          <ModalPortal>\n            <ResetEncryptedRepoPasswordDialog\n              repoID={repo.repo_id}\n              toggleDialog={this.onResetPasswordToggle}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nSharedRepoListItem.propTypes = propTypes;\n\nexport default SharedRepoListItem;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport SharedRepoListItem from './shared-repo-list-item';\nimport toaster from '../toast';\nimport LibsMobileThead from '../libs-mobile-thead';\nimport Loading from '../loading';\n\nconst propTypes = {\n  libraryType: PropTypes.string,\n  currentGroup: PropTypes.object,\n  isShowTableThread: PropTypes.bool,\n  sortBy: PropTypes.string,\n  sortOrder: PropTypes.string,\n  sortItems: PropTypes.func,\n  repoList: PropTypes.array.isRequired,\n  onItemUnshare: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func,\n  onItemDetails: PropTypes.func,\n  onItemRename: PropTypes.func,\n  hasNextPage: PropTypes.bool\n};\n\nclass SharedRepoListView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n    };\n  }\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortByTime = (e) => {\n    e.preventDefault();\n    const sortBy = 'time';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortBySize = (e) => {\n    e.preventDefault();\n    const sortBy = 'size';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  getSortMetaData = () => {\n    return {\n      sortByName: this.props.sortBy == 'name',\n      sortByTime: this.props.sortBy == 'time',\n      sortBySize: this.props.sortBy == 'size',\n      sortIcon: this.props.sortOrder == 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>\n    };\n  }\n\n  onFreezedItem = () => {\n    this.setState({isItemFreezed: true});\n  }\n\n  onUnfreezedItem = () => {\n    this.setState({isItemFreezed: false});\n  }\n\n  onItemRename = (repo, newName) => {\n    let isDuplicated = this.props.repoList.some(item => {\n      return item.name === newName;\n    });\n    if (isDuplicated) {\n      let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n      errMessage = errMessage.replace('{name}', Utils.HTMLescape(newName));\n      toaster.danger(errMessage);\n      return false;\n    }\n    this.props.onItemRename(repo, newName);\n  }\n\n  renderRepoListView = () => {\n    return (\n      <Fragment>\n        {this.props.repoList.map(repo => {\n          return (\n            <SharedRepoListItem\n              key={repo.repo_id}\n              repo={repo}\n              libraryType={this.props.libraryType}\n              currentGroup={this.props.currentGroup}\n              isItemFreezed={this.state.isItemFreezed}\n              onFreezedItem={this.onFreezedItem}\n              onUnfreezedItem={this.onUnfreezedItem}\n              onItemUnshare={this.props.onItemUnshare}\n              onItemDelete={this.props.onItemDelete}\n              onItemDetails={this.props.onItemDetails}\n              onItemRename={this.props.onItemRename}\n              onMonitorRepo={this.props.onMonitorRepo}\n            />\n          );\n        })}\n      </Fragment>\n    );\n  }\n\n  renderPCUI = () => {\n    let isShowTableThread = this.props.isShowTableThread !== undefined ? this.props.isShowTableThread : true;\n\n    const { sortByName, sortByTime, sortBySize, sortIcon } = this.getSortMetaData();\n\n    return (\n      <table className={isShowTableThread ? '' : 'table-thead-hidden'}>\n        <thead>\n          <tr>\n            <th width=\"4%\"></th>\n            <th width=\"4%\"><span className=\"sr-only\">{gettext('Library Type')}</span></th>\n            <th width=\"36%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {sortByName && sortIcon}</a></th>\n            <th width=\"12%\"><span className=\"sr-only\">{gettext('Actions')}</span></th>\n            <th width={'14%'}><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortBySize}>{gettext('Size')} {sortBySize && sortIcon}</a></th>\n            <th width={'14%'}><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByTime}>{gettext('Last Update')} {sortByTime && sortIcon}</a></th>\n            <th width=\"16%\">{gettext('Owner')}</th>\n          </tr>\n        </thead>\n        <tbody>\n          {this.renderRepoListView()}\n        </tbody>\n      </table>\n    );\n  }\n\n  renderMobileUI = () => {\n    return (\n      <table className=\"table-thead-hidden\">\n        <LibsMobileThead />\n        <tbody>\n          {this.renderRepoListView()}\n        </tbody>\n      </table>\n    );\n  }\n\n  render() {\n    const table = Utils.isDesktop() ? this.renderPCUI() : this.renderMobileUI();\n    if (this.props.hasNextPage) {\n      return (\n        <Fragment>\n          {table}\n          <Loading />\n        </Fragment>\n      );\n    } else {\n      return table;\n    }\n  }\n}\n\nSharedRepoListView.propTypes = propTypes;\n\nexport default SharedRepoListView;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport cookie from 'react-cookies';\nimport MediaQuery from 'react-responsive';\nimport { Dropdown, DropdownToggle, DropdownMenu, DropdownItem } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, canAddPublicRepo } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport Repo from '../../models/repo';\nimport toaster from '../../components/toast';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport ModalPortal from '../../components/modal-portal';\nimport CommonToolbar from '../../components/toolbar/common-toolbar';\nimport CreateRepoDialog from '../../components/dialog/create-repo-dialog';\nimport ShareRepoDialog from '../../components/dialog/share-repo-dialog';\nimport SharedRepoListView from '../../components/shared-repo-list-view/shared-repo-list-view';\nimport SortOptionsDialog from '../../components/dialog/sort-options';\n\nconst propTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n};\n\nclass PublicSharedView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      errMessage: '',\n      emptyTip: '',\n      repoList: [],\n      sortBy: cookie.load('seafile-repo-dir-sort-by') || 'name', // 'name' or 'time' or 'size'\n      sortOrder: cookie.load('seafile-repo-dir-sort-order') || 'asc', // 'asc' or 'desc'\n      isSortOptionsDialogOpen: false,\n      libraryType: 'public',\n      isCreateMenuShow: false,\n      isCreateRepoDialogShow: false,\n      isSelectRepoDialpgShow: false,\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepos({type: 'public'}).then((res) => {\n      let repoList = res.data.repos.map(item => {\n        let repo = new Repo(item);\n        return repo;\n      });\n      this.setState({\n        isLoading: false,\n        repoList: Utils.sortRepos(repoList, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        isLoading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  onCreateRepo = (repo) => {\n    seafileAPI.createPublicRepo(repo).then(res => {\n      let object = {  // need modify api return value\n        repo_id: res.data.id,\n        repo_name: res.data.name,\n        permission: res.data.permission,\n        size: res.data.size,\n        owner_name: res.data.owner_name,\n        owner_email: res.data.owner,\n        mtime: res.data.mtime,\n        encrypted: res.data.encrypted,\n      };\n      let repo = new Repo(object);\n      let repoList = this.addRepoItem(repo);\n      this.setState({repoList: repoList});\n      this.onCreateRepoToggle();\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onRepoSelectedHandler = (selectedRepoList) => {\n    selectedRepoList.forEach(repo => {\n      seafileAPI.selectOwnedRepoToPublic(repo.repo_id, {share_type: 'public', permission: repo.sharePermission}).then(() => {\n        let repoList = this.addRepoItem(repo);\n        this.setState({repoList: repoList});\n      }).catch((error) => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    });\n  }\n\n  onItemUnshare = (repo) => {\n    seafileAPI.unshareRepo(repo.repo_id, {share_type: 'public'}).then(() => {\n      let repoList = this.state.repoList.filter(item => {\n        return item.repo_id !== repo.repo_id;\n      });\n      this.setState({repoList: repoList});\n      let message = gettext('Successfully unshared {name}').replace('{name}', repo.repo_name);\n      toaster.success(message);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = gettext('Failed to unshare {name}').replace('{name}', repo.repo_name);\n      }\n      toaster(errMessage);\n    });\n  }\n\n  onItemDelete = () => {\n    // todo need to optimized\n  }\n\n  addRepoItem = (repo) => {\n    let isExist = false;\n    let repoIndex = 0;\n    let repoList = this.state.repoList;\n    for (let i = 0; i < repoList.length; i ++) {\n      if (repo.repo_id === repoList[i].repo_id) {\n        isExist = true;\n        repoIndex = i;\n        break;\n      }\n    }\n    if (isExist) {\n      this.state.repoList.splice(repoIndex, 1);\n    }\n\n    let newRepoList = this.state.repoList.map(item => {return item;});\n    newRepoList.unshift(repo);\n    return newRepoList;\n  }\n\n  onAddRepoToggle = () => {\n    this.setState({isCreateMenuShow: !this.state.isCreateMenuShow});\n  }\n\n  onCreateRepoToggle = () => {\n    this.setState({isCreateRepoDialogShow: !this.state.isCreateRepoDialogShow});\n  }\n\n  onSelectRepoToggle = () => {\n    this.setState({isSelectRepoDialpgShow: !this.state.isSelectRepoDialpgShow});\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    cookie.save('seafile-repo-dir-sort-by', sortBy);\n    cookie.save('seafile-repo-dir-sort-order', sortOrder);\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      repoList: Utils.sortRepos(this.state.repoList, sortBy, sortOrder)\n    });\n  }\n\n  toggleSortOptionsDialog = () => {\n    this.setState({\n      isSortOptionsDialogOpen: !this.state.isSortOptionsDialogOpen\n    });\n  }\n\n  render() {\n    let errMessage = this.state.errMessage;\n    let emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No public libraries')}</h2>\n        <p>{gettext('No public libraries have been created yet. A public library is accessible by all users. You can create a public library by clicking the \"Add Library\" button in the menu bar.')}</p>\n      </EmptyTip>\n    );\n    return (\n      <Fragment>\n        <div className=\"main-panel-north border-left-show\">\n          {canAddPublicRepo &&\n            <div className=\"cur-view-toolbar\">\n              <span className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\" title=\"Side Nav Menu\" onClick={this.props.onShowSidePanel}></span>\n              <div className=\"operation\">\n                <Dropdown isOpen={this.state.isCreateMenuShow} toggle={this.onAddRepoToggle}>\n                  <MediaQuery query=\"(min-width: 768px)\">\n                    <DropdownToggle className='btn btn-secondary operation-item'>\n                      <i className=\"fas fa-plus-square text-secondary mr-1\"></i>{gettext('Add Library')}\n                    </DropdownToggle>\n                  </MediaQuery>\n                  <MediaQuery query=\"(max-width: 767.8px)\">\n                    <DropdownToggle\n                      tag=\"span\"\n                      className=\"sf2-icon-plus mobile-toolbar-icon\"\n                      title={gettext('Add Library')}\n                    />\n                  </MediaQuery>\n                  <DropdownMenu>\n                    <DropdownItem onClick={this.onSelectRepoToggle}>{gettext('Share existing libraries')}</DropdownItem>\n                    <DropdownItem onClick={this.onCreateRepoToggle}>{gettext('New Library')}</DropdownItem>\n                  </DropdownMenu>\n                </Dropdown>\n              </div>\n            </div>\n          }\n          <CommonToolbar onSearchedClick={this.props.onSearchedClick} />\n        </div>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading m-0\">{gettext('Shared with all')}</h3>\n              {(!Utils.isDesktop() && this.state.repoList.length > 0) && <span className=\"sf3-font sf3-font-sort action-icon\" onClick={this.toggleSortOptionsDialog}></span>}\n            </div>\n            <div className=\"cur-view-content\">\n              {this.state.isLoading && <Loading />}\n              {(!this.state.isLoading && errMessage) && errMessage}\n              {(!this.state.isLoading && this.state.repoList.length === 0) && emptyTip}\n              {(!this.state.isLoading && this.state.repoList.length > 0) &&\n                <SharedRepoListView\n                  libraryType={this.state.libraryType}\n                  repoList={this.state.repoList}\n                  sortBy={this.state.sortBy}\n                  sortOrder={this.state.sortOrder}\n                  sortItems={this.sortItems}\n                  onItemUnshare={this.onItemUnshare}\n                  onItemDelete={this.onItemDelete}\n                />\n              }\n            </div>\n          </div>\n        </div>\n        {this.state.isSortOptionsDialogOpen &&\n        <SortOptionsDialog\n          toggleDialog={this.toggleSortOptionsDialog}\n          sortBy={this.state.sortBy}\n          sortOrder={this.state.sortOrder}\n          sortItems={this.sortItems}\n        />\n        }\n        {this.state.isCreateRepoDialogShow && (\n          <ModalPortal>\n            <CreateRepoDialog\n              libraryType={this.state.libraryType}\n              onCreateToggle={this.onCreateRepoToggle}\n              onCreateRepo={this.onCreateRepo}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isSelectRepoDialpgShow && (\n          <ModalPortal>\n            <ShareRepoDialog\n              onRepoSelectedHandler={this.onRepoSelectedHandler}\n              onShareRepoDialogClose={this.onSelectRepoToggle}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nPublicSharedView.propTypes = propTypes;\n\nexport default PublicSharedView;\n","import io from 'socket.io-client';\nimport { name, username, contactEmail, seafileCollabServer } from './constants';\n\nconst socket = (seafileCollabServer !== '') ? io(seafileCollabServer) : undefined;\n\nclass CollabServer {\n\n  watchRepo(repoID, fn) {\n    if (!socket) {\n      return;\n    }\n    socket.emit('repo_update', {\n      request: 'watch_update',\n      repo_id: repoID,\n      user: {\n        name: name,\n        username: username,\n        contact_email: contactEmail,\n      },\n    });\n    socket.on('repo_update', fn);\n  }\n\n  unwatchRepo(repoID, fn) {\n    if (!socket) {\n      return;\n    }\n    socket.emit('repo_update', {\n      request: 'unwatch_update',\n      repo_id: repoID,\n      user: {\n        name: name,\n        username: username,\n        contact_email: contactEmail,\n      },\n    });\n    socket.off('repo_update', fn);\n  }\n}\n\nconst collabServer = new CollabServer();\n\nexport default collabServer;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalBody, Form } from 'reactstrap';\nimport { gettext, siteRoot, mediaUrl } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\n\nimport '../../css/lib-decrypt.css';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  onLibDecryptDialog: PropTypes.func.isRequired\n};\n\n\nclass LibDecryptDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      password: '',\n      showError: false,\n    };\n  }\n\n  handleSubmit = (e) => {\n    let repoID = this.props.repoID;\n    let password = this.state.password;\n    seafileAPI.setRepoDecryptPassword(repoID, password).then(res => {\n      this.props.onLibDecryptDialog();\n    }).catch(res => {\n      this.setState({\n        showError: true\n      });\n    });\n\n    e.preventDefault();\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key == 'Enter') {\n      this.handleSubmit(e);\n    }\n  };\n\n  handleChange = (e) => {\n    this.setState({\n      password: e.target.value,\n      showError: false\n    });\n  }\n\n  toggle = () => {\n    window.location.href = siteRoot;\n  };\n\n  render() {\n    return (\n      <Modal isOpen={true}>\n        <ModalBody>\n          <button type=\"button\" className=\"close\" onClick={this.toggle}><span aria-hidden=\"true\"></span></button>\n          <Form className=\"lib-decrypt-form text-center\">\n            <img src={`${mediaUrl}img/lock.png`} alt=\"\" aria-hidden=\"true\" />\n            <p className=\"intro\">{gettext('This library is password protected')}</p>\n            {this.state.showError &&\n              <p className=\"error\">{gettext('Wrong password')}</p>\n            }\n            <input type=\"password\" name=\"password\" className=\"form-control password-input\" autoComplete=\"off\" onKeyPress={this.handleKeyPress} placeholder={gettext('Password')} onChange={this.handleChange} />\n            <button type=\"submit\" className=\"btn btn-primary submit\" onClick={this.handleSubmit}>{gettext('Submit')}</button>\n            <p className=\"tip\">{'* '}{gettext('The password will be kept in the server for only 1 hour.')}</p>\n          </Form>\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nLibDecryptDialog.propTypes = propTypes;\n\nexport default LibDecryptDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\n\nconst propTypes = {\n  currentMode: PropTypes.string.isRequired,\n  switchViewMode: PropTypes.func.isRequired,\n  isCustomPermission: PropTypes.bool,\n};\n\nclass ViewModeToolbar extends React.Component {\n\n  static defaultProps = {\n    isCustomPermission: false,\n  }\n\n  switchViewMode = (e) => {\n    e.preventDefault();\n    let id = e.target.id;\n    if (id === this.props.currentMode) {\n      return;\n    }\n    this.props.switchViewMode(id);\n  }\n\n  render() {\n    let baseClass = 'btn btn-secondary btn-icon sf-view-mode-btn ';\n    return (\n      <React.Fragment>\n        <div className=\"view-mode btn-group\">\n          <button className={`${baseClass} sf2-icon-list-view ${this.props.currentMode === 'list' ? 'current-mode' : ''}`} id='list' title={gettext('List')} aria-label={gettext('List')} onClick={this.switchViewMode}></button>\n          <button className={`${baseClass} sf2-icon-grid-view ${this.props.currentMode === 'grid' ? 'current-mode' : ''}`} id='grid' title={gettext('Grid')} aria-label={gettext('Grid')} onClick={this.switchViewMode}></button>\n          <button className={`${baseClass} sf2-icon-two-columns ${this.props.currentMode === 'column' ? 'current-mode' : ''}`} id='column' title={gettext('Column')} aria-label={gettext('Column')} onClick={this.switchViewMode}></button>\n        </div>\n        {!this.props.isCustomPermission && (\n          <div className=\"detail-btn btn-group\">\n            <button className=\"btn btn-secondary btn-icon ml-1 fas fa-info\" id='detail' title={gettext('Properties')} aria-label={gettext('Properties')} onClick={this.switchViewMode}></button>\n          </div>\n        )}\n      </React.Fragment>\n    );\n  }\n}\n\nViewModeToolbar.propTypes = propTypes;\n\nexport default ViewModeToolbar;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Form, FormGroup, Label, Alert } from 'reactstrap';\nimport { gettext, isDocs } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  fileType: PropTypes.string,\n  parentPath: PropTypes.string.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  checkDuplicatedName: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired,\n};\n\nclass CreateFile extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      parentPath: '',\n      childName: props.fileType || '',\n      isMarkdownDraft: false,\n      isSdocDraft: false,\n      errMessage: '',\n      isSubmitBtnActive: false,\n    };\n    this.newInput = React.createRef();\n  }\n\n  componentDidMount() {\n    let parentPath = this.props.parentPath;\n    if (parentPath[parentPath.length - 1] === '/') {  // mainPanel\n      this.setState({parentPath: parentPath});\n    } else {\n      this.setState({parentPath: parentPath + '/'}); // sidePanel\n    }\n  }\n\n  handleChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({\n      childName: e.target.value,\n    }) ;\n  }\n\n  handleSubmit = () => {\n    if (!this.state.isSubmitBtnActive) {\n      return;\n    }\n\n    let isDuplicated = this.checkDuplicatedName();\n    let newName = this.state.childName;\n\n    if (isDuplicated) {\n      let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n      errMessage = errMessage.replace('{name}', Utils.HTMLescape(newName));\n      this.setState({errMessage: errMessage});\n    } else {\n      let path = this.state.parentPath + newName;\n      const { isMarkdownDraft, isSdocDraft } = this.state;\n      this.props.onAddFile(path, isMarkdownDraft, isSdocDraft);\n      this.props.toggleDialog();\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n      e.preventDefault();\n    }\n  }\n\n  handleCheck = () => {\n    let pos = this.state.childName.lastIndexOf('.');\n\n    if (this.state.isMarkdownDraft) {\n      // from draft to not draft\n      // case 1, normally, the file name is ended with `(draft)`, like `test(draft).md`\n      // case 2, the file name is not ended with `(draft)`, the user has deleted some characters, like `test(dra.md`\n      let p = this.state.childName.substring(pos-7, pos);\n      let fileName = this.state.childName.substring(0, pos-7);\n      let fileType = this.state.childName.substring(pos);\n      if (p === '(draft)') {\n        // remove `(draft)` from file name\n        this.setState({\n          childName: fileName + fileType,\n          isMarkdownDraft: !this.state.isMarkdownDraft\n        });\n      } else {\n        // don't change file name\n        this.setState({\n          isMarkdownDraft: !this.state.isMarkdownDraft\n        });\n      }\n    }\n\n    if (!this.state.isMarkdownDraft) {\n      // from not draft to draft\n      // case 1, test.md  ===> test(draft).md\n      // case 2, .md ===> (draft).md\n      // case 3, no '.' in the file name, don't change the file name\n      if (pos > 0) {\n        let fileName = this.state.childName.substring(0, pos);\n        let fileType = this.state.childName.substring(pos);\n        this.setState({\n          childName: fileName + '(draft)' + fileType,\n          isMarkdownDraft: !this.state.isMarkdownDraft\n        });\n      } else if (pos === 0 ) {\n        this.setState({\n          childName: '(draft)' + this.state.childName,\n          isMarkdownDraft: !this.state.isMarkdownDraft\n        });\n      } else {\n        this.setState({\n          isMarkdownDraft: !this.state.isMarkdownDraft\n        });\n      }\n    }\n  }\n\n  checkDuplicatedName = () => {\n    let isDuplicated = this.props.checkDuplicatedName(this.state.childName);\n    return isDuplicated;\n  }\n\n  onAfterModelOpened = () => {\n    if (!this.newInput.current) return;\n    this.newInput.current.focus();\n    this.newInput.current.setSelectionRange(0,0);\n  }\n\n  toggleMarkSdocDraft = (e) => {\n    this.setState({\n      isSdocDraft: e.target.checked\n    });\n  }\n\n  render() {\n    const { isSdocDraft } = this.state;\n    const { toggleDialog } = this.props;\n    return (\n      <Modal isOpen={true} toggle={toggleDialog} onOpened={this.onAfterModelOpened}>\n        <ModalHeader toggle={toggleDialog}>{gettext('New File')}</ModalHeader>\n        <ModalBody>\n          <Form>\n            <FormGroup>\n              <Label for=\"fileName\">{gettext('Name')}</Label>\n              <Input\n                id=\"fileName\"\n                onKeyPress={this.handleKeyPress}\n                innerRef={this.newInput}\n                value={this.state.childName}\n                onChange={this.handleChange}\n              />\n            </FormGroup>\n            {this.props.fileType == '.md' && isDocs && (\n              <FormGroup check>\n                <Label check>\n                  <Input type=\"checkbox\" onChange={this.handleCheck}/>{'  '}{gettext('This is a draft')}\n                </Label>\n              </FormGroup>\n            )}\n            {this.props.fileType == '.sdoc' && (\n              <FormGroup check>\n                <Label check>\n                  <Input type=\"checkbox\" checked={isSdocDraft} onChange={this.toggleMarkSdocDraft}/>\n                  <span>{gettext('Mark as draft')}</span>\n                </Label>\n              </FormGroup>\n            )}\n          </Form>\n          {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={toggleDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nCreateFile.propTypes = propTypes;\n\nexport default CreateFile;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Dropdown, DropdownToggle, DropdownMenu, DropdownItem } from 'reactstrap';\nimport { Utils } from '../../utils/utils';\nimport { enableSeadoc, gettext } from '../../utils/constants';\nimport ModalPortal from '../modal-portal';\nimport CreateFolder from '../../components/dialog/create-folder-dialog';\nimport CreateFile from '../../components/dialog/create-file-dialog';\nimport ShareDialog from '../../components/dialog/share-dialog';\nimport ViewModeToolbar from './view-mode-toolbar';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  repoName: PropTypes.string.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  showShareBtn: PropTypes.bool.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onUploadFile: PropTypes.func.isRequired,\n  onUploadFolder: PropTypes.func.isRequired,\n  direntList: PropTypes.array.isRequired,\n  currentMode: PropTypes.string.isRequired,\n  switchViewMode: PropTypes.func.isRequired,\n};\n\nclass DirOperationToolbar extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      fileType: '.md',\n      isCreateFileDialogShow: false,\n      isCreateFolderDialogShow: false,\n      isUploadMenuShow: false,\n      isCreateMenuShow: false,\n      isShareDialogShow: false,\n      operationMenuStyle: '',\n      isMobileOpMenuOpen: false\n    };\n  }\n\n  componentDidMount() {\n    document.addEventListener('click', this.hideOperationMenu);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('click', this.hideOperationMenu);\n  }\n\n  toggleMobileOpMenu = () => {\n    this.setState({isMobileOpMenuOpen: !this.state.isMobileOpMenuOpen});\n  }\n\n  hideOperationMenu = () => {\n    this.setState({\n      isUploadMenuShow: false,\n      isCreateMenuShow: false,\n    });\n  }\n\n  toggleOperationMenu = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    let targetRect = e.target.getBoundingClientRect();\n    let left = targetRect.left;\n    let top  = targetRect.bottom;\n    let style = {position: 'fixed', display: 'block', left: left, top: top};\n    this.setState({operationMenuStyle: style});\n  }\n\n  onUploadClick = (e) => {\n    this.toggleOperationMenu(e);\n    this.setState({\n      isUploadMenuShow: !this.state.isUploadMenuShow,\n      isCreateMenuShow: false,\n    });\n  }\n\n  onUploadFile = (e) => {\n    this.setState({isUploadMenuShow: false});\n    this.props.onUploadFile(e);\n  }\n\n  onUploadFolder = (e) => {\n    this.setState({isUploadMenuShow: false});\n    this.props.onUploadFolder(e);\n  }\n\n  onCreateClick = (e) => {\n    this.toggleOperationMenu(e);\n    this.setState({\n      isCreateMenuShow: !this.state.isCreateMenuShow,\n      isUploadMenuShow: false,\n    });\n  }\n\n  onShareClick = () => {\n    this.setState({\n      isShareDialogShow: !this.state.isShareDialogShow\n    });\n  }\n\n  onCreateFolderToggle = () => {\n    this.setState({isCreateFolderDialogShow: !this.state.isCreateFolderDialogShow});\n  }\n\n  onCreateFileToggle = () => {\n    this.setState({\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n      fileType: ''\n    });\n  }\n\n  onCreateMarkdownToggle = () => {\n    this.setState({\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n      fileType: '.md'\n    });\n  }\n\n  onCreateExcelToggle = () => {\n    this.setState({\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n      fileType: '.xlsx'\n    });\n  }\n\n  onCreatePPTToggle = () => {\n    this.setState({\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n      fileType: '.pptx'\n    });\n  }\n\n  onCreateWordToggle = () => {\n    this.setState({\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n      fileType: '.docx'\n    });\n  }\n\n  onCreateSeaDocToggle = () => {\n    this.setState({\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n      fileType: '.sdoc'\n    });\n  }\n\n  onAddFolder = (dirPath) => {\n    this.setState({isCreateFolderDialogShow: false});\n    this.props.onAddFolder(dirPath);\n  }\n\n  checkDuplicatedName = (newName) => {\n    let direntList = this.props.direntList;\n    let isDuplicated = direntList.some(object => {\n      return object.name === newName;\n    });\n    return isDuplicated;\n  }\n\n  render() {\n    let { path, repoName, userPerm } = this.props;\n\n    let itemType = path === '/' ? 'library' : 'dir';\n    let itemName = path == '/' ? repoName : Utils.getFolderName(path);\n\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    let canUpload = true;\n    let canCreate = true;\n    if (isCustomPermission) {\n      const { permission } = customPermission;\n      canUpload = permission.upload;\n      canCreate = permission.create;\n    }\n\n    let content = null;\n    if (Utils.isDesktop()) {\n      let { showShareBtn } = this.props;\n      content = (\n        <Fragment>\n          {canUpload && (\n            <Fragment>\n              {Utils.isSupportUploadFolder() ?\n                <Fragment>\n                  <button className=\"btn btn-secondary operation-item\" onClick={this.onUploadClick} aria-haspopup=\"true\" aria-expanded={this.state.isUploadMenuShow} aria-controls=\"upload-menu\">{gettext('Upload')}</button>\n                  {this.state.isUploadMenuShow && (\n                    <div className=\"menu dropdown-menu\" style={this.state.operationMenuStyle} role=\"menu\" id=\"upload-menu\">\n                      <button type=\"button\" className=\"dropdown-item\" onClick={this.onUploadFile} role=\"menuitem\">{gettext('Upload Files')}</button>\n                      <button type=\"button\" className=\"dropdown-item\" onClick={this.onUploadFolder} role=\"menuitem\">{gettext('Upload Folder')}</button>\n                    </div>\n                  )}\n                </Fragment>\n                :\n                <button className=\"btn btn-secondary operation-item\" title={gettext('Upload')} onClick={this.onUploadFile}>{gettext('Upload')}</button>}\n            </Fragment>\n          )}\n          {canCreate &&\n          <Fragment>\n            <button className=\"btn btn-secondary operation-item\" onClick={this.onCreateClick} aria-haspopup=\"true\" aria-expanded={this.state.isUploadMenuShow} aria-controls=\"new-menu\">{gettext('New')}</button>\n            {this.state.isCreateMenuShow && (\n              <div className=\"menu dropdown-menu\" style={this.state.operationMenuStyle} role=\"menu\" id=\"new-menu\">\n                <button className=\"dropdown-item\" onClick={this.onCreateFolderToggle} role=\"menuitem\">{gettext('New Folder')}</button>\n                <button className=\"dropdown-item\" onClick={this.onCreateFileToggle}>{gettext('New File')}</button>\n                <div className=\"dropdown-divider\"></div>\n                <button className=\"dropdown-item\" onClick={this.onCreateMarkdownToggle} role=\"menuitem\">{gettext('New Markdown File')}</button>\n                <button className=\"dropdown-item\" onClick={this.onCreateExcelToggle} role=\"menuitem\">{gettext('New Excel File')}</button>\n                <button className=\"dropdown-item\" onClick={this.onCreatePPTToggle} role=\"menuitem\">{gettext('New PowerPoint File')}</button>\n                <button className=\"dropdown-item\" onClick={this.onCreateWordToggle} role=\"menuitem\">{gettext('New Word File')}</button>\n                {enableSeadoc && <button className=\"dropdown-item\" onClick={this.onCreateSeaDocToggle} role=\"menuitem\">{gettext('New SeaDoc File')} (beta)</button>}\n              </div>\n            )}\n          </Fragment>\n          }\n          {showShareBtn && <button className=\"btn btn-secondary operation-item\" title={gettext('Share')} onClick={this.onShareClick}>{gettext('Share')}</button>}\n        </Fragment>\n      );\n    } else {\n      content = (\n        <Dropdown isOpen={this.state.isMobileOpMenuOpen} toggle={this.toggleMobileOpMenu}>\n          <DropdownToggle tag=\"span\" className=\"sf2-icon-plus mobile-toolbar-icon\" />\n          <DropdownMenu>\n            {canUpload && (\n              <DropdownItem onClick={this.onUploadFile}>{gettext('Upload')}</DropdownItem>\n            )}\n            {canCreate && (\n              <Fragment>\n                <DropdownItem onClick={this.onCreateFolderToggle}>{gettext('New Folder')}</DropdownItem>\n                <DropdownItem onClick={this.onCreateFileToggle}>{gettext('New File')}</DropdownItem>\n              </Fragment>\n            )}\n          </DropdownMenu>\n        </Dropdown>\n      );\n    }\n\n    return (\n      <Fragment>\n        {(userPerm === 'rw' || userPerm === 'admin' || userPerm === 'cloud-edit' || isCustomPermission) && (\n          <div className=\"dir-operation\">\n            {content}\n          </div>\n        )}\n        {Utils.isDesktop() && <ViewModeToolbar currentMode={this.props.currentMode} switchViewMode={this.props.switchViewMode} isCustomPermission={isCustomPermission} />}\n        {this.state.isCreateFileDialogShow && (\n          <ModalPortal>\n            <CreateFile\n              parentPath={this.props.path}\n              fileType={this.state.fileType}\n              onAddFile={this.props.onAddFile}\n              checkDuplicatedName={this.checkDuplicatedName}\n              toggleDialog={this.onCreateFileToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isCreateFolderDialogShow && (\n          <ModalPortal>\n            <CreateFolder\n              parentPath={this.props.path}\n              onAddFolder={this.onAddFolder}\n              checkDuplicatedName={this.checkDuplicatedName}\n              addFolderCancel={this.onCreateFolderToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isShareDialogShow &&\n          <ModalPortal>\n            <ShareDialog\n              itemType={itemType}\n              itemName={itemName}\n              itemPath={this.props.path}\n              repoID={this.props.repoID}\n              repoEncrypted={this.props.repoEncrypted}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              userPerm={this.props.userPerm}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              toggleDialog={this.onShareClick}\n            />\n          </ModalPortal>\n        }\n      </Fragment>\n    );\n  }\n}\n\nDirOperationToolbar.propTypes = propTypes;\n\nexport default DirOperationToolbar;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalFooter, ModalBody, Alert } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport FileChooser from '../file-chooser/file-chooser';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  dirent: PropTypes.object,\n  selectedDirentList: PropTypes.array,\n  isMutipleOperation: PropTypes.bool.isRequired,\n  onItemMove: PropTypes.func,\n  onItemsMove: PropTypes.func,\n  onCancelMove: PropTypes.func.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n};\n\n// need dirent file Path\nclass MoveDirent extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      repo: { repo_id: this.props.repoID },\n      selectedPath: this.props.path,\n      errMessage: ''\n    };\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    if (this.state.errMessage === nextState.errMessage) {\n      return false;\n    }\n    return true;\n  }\n\n  handleSubmit = () => {\n    if (this.props.isMutipleOperation) {\n      this.moveItems();\n    } else {\n      this.moveItem();\n    }\n  }\n\n  moveItems = () => {\n    let { repoID } = this.props;\n    let { repo, selectedPath } = this.state;\n    let message = gettext('Invalid destination path');\n\n    if (!repo || selectedPath === '') {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    let selectedDirentList = this.props.selectedDirentList;\n    let direntPaths = [];\n    selectedDirentList.forEach(dirent => {\n      let path = Utils.joinPath(this.props.path, dirent.name);\n      direntPaths.push(path);\n    });\n\n    // move dirents to one of them. eg: A/B, A/C -> A/B\n    if (direntPaths.some(direntPath => { return direntPath === selectedPath;})) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // move dirents to current path\n    if (selectedPath && selectedPath === this.props.path && (repo.repo_id === repoID)) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // move dirents to one of their child. eg: A/B, A/D -> A/B/C\n    let moveDirentPath = '';\n    let isChildPath = direntPaths.some(direntPath => {\n      let flag = selectedPath.length > direntPath.length && selectedPath.indexOf(direntPath) > -1;\n      if (flag) {\n        moveDirentPath = direntPath;\n      }\n      return flag;\n    });\n\n    if (isChildPath) {\n      message = gettext('Can not move directory %(src)s to its subdirectory %(des)s');\n      message = message.replace('%(src)s', moveDirentPath);\n      message = message.replace('%(des)s', selectedPath);\n      this.setState({errMessage: message});\n      return;\n    }\n\n    this.props.onItemsMove(repo, selectedPath);\n    this.toggle();\n  }\n\n  moveItem = () => {\n    let { repoID } = this.props;\n    let { repo, selectedPath } = this.state;\n    let direntPath = Utils.joinPath(this.props.path, this.props.dirent.name);\n    let message = gettext('Invalid destination path');\n\n    if (!repo || (repo.repo_id === repoID && selectedPath === '')) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // copy the dirent to itself. eg: A/B -> A/B\n    if (selectedPath && direntPath === selectedPath) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // copy the dirent to current path\n    if (selectedPath && this.props.path === selectedPath && repo.repo_id === repoID) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // copy the dirent to it's child. eg: A/B -> A/B/C\n    if ( selectedPath && selectedPath.length > direntPath.length && selectedPath.indexOf(direntPath) > -1) {\n      message = gettext('Can not move directory %(src)s to its subdirectory %(des)s');\n      message = message.replace('%(src)s', direntPath);\n      message = message.replace('%(des)s', selectedPath);\n      this.setState({errMessage: message});\n      return;\n    }\n\n    this.props.onItemMove(repo, this.props.dirent, selectedPath, this.props.path);\n    this.toggle();\n  }\n\n  toggle = () => {\n    this.props.onCancelMove();\n  }\n\n  onDirentItemClick = (repo, selectedPath) => {\n    this.setState({\n      repo: repo,\n      selectedPath: selectedPath,\n      errMessage: ''\n    });\n  }\n\n  onRepoItemClick = (repo) => {\n    this.setState({\n      repo: repo,\n      selectedPath: '/',\n      errMessage: ''\n    });\n  }\n\n  render() {\n    let title = gettext('Move {placeholder} to');\n    if (!this.props.isMutipleOperation) {\n      title = title.replace('{placeholder}', '<span class=\"op-target\">' + Utils.HTMLescape(this.props.dirent.name) + '</span>');\n    } else {\n      title = gettext('Move selected item(s) to:');\n    }\n    let mode = this.props.repoEncrypted ? 'only_current_library':'current_repo_and_other_repos';\n    const { dirent, selectedDirentList } = this.props;\n    const movedDirent = dirent ? dirent : selectedDirentList[0];\n    const { permission } = movedDirent;\n    const { isCustomPermission } = Utils.getUserPermission(permission);\n    if (isCustomPermission) {\n      mode = 'only_current_library';\n    }\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}><div dangerouslySetInnerHTML={{__html: title}}></div></ModalHeader>\n        <ModalBody>\n          <FileChooser\n            repoID={this.props.repoID}\n            currentPath={this.props.path}\n            onDirentItemClick={this.onDirentItemClick}\n            onRepoItemClick={this.onRepoItemClick}\n            mode={mode}\n          />\n          {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nMoveDirent.propTypes = propTypes;\n\nexport default MoveDirent;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalFooter, ModalBody, Alert } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport FileChooser from '../file-chooser/file-chooser';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  dirent: PropTypes.object,\n  selectedDirentList: PropTypes.array,\n  isMutipleOperation: PropTypes.bool.isRequired,\n  onItemCopy: PropTypes.func,\n  onItemsCopy: PropTypes.func,\n  onCancelCopy: PropTypes.func.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n};\n\n// need dirent file Path\nclass CopyDirent extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      repo: { repo_id: this.props.repoID },\n      selectedPath: this.props.path,\n      errMessage: ''\n    };\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    if (this.state.errMessage === nextState.errMessage) {\n      return false;\n    }\n    return true;\n  }\n\n  handleSubmit = () => {\n    if (this.props.isMutipleOperation) {\n      this.copyItems();\n    } else {\n      this.copyItem();\n    }\n  }\n\n  copyItems = () => {\n    let { repoID } = this.props;\n    let { repo, selectedPath } = this.state;\n    let message = gettext('Invalid destination path');\n\n    if (!repo || selectedPath === '') {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    let selectedDirentList = this.props.selectedDirentList;\n    let direntPaths = [];\n    selectedDirentList.forEach(dirent => {\n      let path = Utils.joinPath(this.props.path, dirent.name);\n      direntPaths.push(path);\n    });\n\n    // copy dirents to one of them. eg: A/B, A/C -> A/B\n    if (direntPaths.some(direntPath => { return direntPath === selectedPath;})) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // copy dirents to one of their child. eg: A/B, A/D -> A/B/C\n    let copyDirentPath = '';\n    let isChildPath = direntPaths.some(direntPath => {\n      let flag = selectedPath.length > direntPath.length && selectedPath.indexOf(direntPath) > -1;\n      if (flag) {\n        copyDirentPath = direntPath;\n      }\n      return flag;\n    });\n\n    if (isChildPath) {\n      message = gettext('Can not move directory %(src)s to its subdirectory %(des)s');\n      message = message.replace('%(src)s', copyDirentPath);\n      message = message.replace('%(des)s', selectedPath);\n      this.setState({errMessage: message});\n      return;\n    }\n\n    this.props.onItemsCopy(repo, selectedPath);\n    this.toggle();\n  }\n\n  copyItem = () => {\n    let { repo, repoID, selectedPath } = this.state;\n    let direntPath = Utils.joinPath(this.props.path, this.props.dirent.name);\n    let message = gettext('Invalid destination path');\n\n    if (!repo || (repo.repo_id === repoID && selectedPath === '')) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // copy the dirent to itself. eg: A/B -> A/B\n    if (selectedPath && direntPath === selectedPath) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // copy the dirent to it's child. eg: A/B -> A/B/C\n    if ( selectedPath && selectedPath.length > direntPath.length && selectedPath.indexOf(direntPath) > -1) {\n      message = gettext('Can not copy directory %(src)s to its subdirectory %(des)s');\n      message = message.replace('%(src)s', direntPath);\n      message = message.replace('%(des)s', selectedPath);\n      this.setState({errMessage: message});\n      return;\n    }\n\n    this.props.onItemCopy(repo, this.props.dirent, selectedPath, this.props.path);\n    this.toggle();\n  }\n\n  toggle = () => {\n    this.props.onCancelCopy();\n  }\n\n  onDirentItemClick = (repo, selectedPath) => {\n    this.setState({\n      repo: repo,\n      selectedPath: selectedPath,\n      errMessage: ''\n    });\n  }\n\n  onRepoItemClick = (repo) => {\n    this.setState({\n      repo: repo,\n      selectedPath: '/',\n      errMessage: ''\n    });\n  }\n\n  render() {\n    let title = gettext('Copy {placeholder} to');\n    if (!this.props.isMutipleOperation) {\n      title = title.replace('{placeholder}', '<span class=\"op-target\">' + Utils.HTMLescape(this.props.dirent.name) + '</span>');\n    } else {\n      title = gettext('Copy selected item(s) to:');\n    }\n    let mode = this.props.repoEncrypted ? 'only_current_library':'current_repo_and_other_repos';\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}><div dangerouslySetInnerHTML={{__html: title}}></div></ModalHeader>\n        <ModalBody>\n          <FileChooser\n            repoID={this.props.repoID}\n            currentPath={this.props.path}\n            onDirentItemClick={this.onDirentItemClick}\n            onRepoItemClick={this.onRepoItemClick}\n            mode={mode}\n          />\n          {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nCopyDirent.propTypes = propTypes;\n\nexport default CopyDirent;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Alert } from 'reactstrap';\n\nconst propTypes = {\n  onRename: PropTypes.func.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  checkDuplicatedName: PropTypes.func.isRequired,\n  dirent: PropTypes.object,\n};\n\nclass Rename extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      newName: '',\n      errMessage: '',\n      isSubmitBtnActive: false,\n    };\n    this.newInput = React.createRef();\n  }\n\n  componentWillMount() {\n    this.setState({newName: this.props.dirent.name});\n  }\n\n  componentDidMount() {\n    let { dirent } = this.props;\n    this.changeState(dirent);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.changeState(nextProps.dirent);\n  }\n\n  handleChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({newName: e.target.value});\n  }\n\n  handleSubmit = () => {\n    let { isValid, errMessage } = this.validateInput();\n    if (!isValid) {\n      this.setState({errMessage : errMessage});\n    } else {\n      let isDuplicated = this.checkDuplicatedName();\n      if (isDuplicated) {\n        let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n        errMessage = errMessage.replace('{name}', Utils.HTMLescape(this.state.newName));\n        this.setState({errMessage: errMessage});\n      } else {\n        this.props.onRename(this.state.newName);\n        this.props.toggleCancel();\n      }\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n    }\n  }\n\n  toggle = () => {\n    this.props.toggleCancel();\n  }\n\n  changeState = (dirent) => {\n    let name = dirent.name;\n    this.setState({newName: name});\n  }\n\n  validateInput = () => {\n    let newName = this.state.newName.trim();\n    let isValid = true;\n    let errMessage = '';\n    if (!newName) {\n      isValid = false;\n      errMessage = gettext('Name is required.');\n      return { isValid, errMessage };\n    }\n\n    if (newName.indexOf('/') > -1) {\n      isValid = false;\n      errMessage = gettext('Name should not include ' + '\\'/\\'' + '.');\n      return { isValid, errMessage };\n    }\n\n    return { isValid, errMessage };\n  }\n\n  checkDuplicatedName = () => {\n    let isDuplicated = this.props.checkDuplicatedName(this.state.newName);\n    return isDuplicated;\n  }\n\n  onAfterModelOpened = () => {\n    if (!this.newInput.current) return;\n    this.newInput.current.focus();\n\n    let { dirent } = this.props;\n    let type = dirent.type;\n    if (type === 'file') {\n      var endIndex = dirent.name.lastIndexOf('.md');\n      this.newInput.current.setSelectionRange(0, endIndex, 'forward');\n    } else {\n      this.newInput.current.setSelectionRange(0, -1);\n    }\n  }\n\n  render() {\n    let type = this.props.dirent.type;\n    return (\n      <Modal isOpen={true} toggle={this.toggle} onOpened={this.onAfterModelOpened}>\n        <ModalHeader toggle={this.toggle}>{type === 'file' ? gettext('Rename File') : gettext('Rename Folder') }</ModalHeader>\n        <ModalBody>\n          <p>{type === 'file' ? gettext('New file name'): gettext('New folder name')}</p>\n          <Input onKeyPress={this.handleKeyPress} innerRef={this.newInput} value={this.state.newName} onChange={this.handleChange} />\n          {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nRename.propTypes = propTypes;\n\nexport default Rename;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, ButtonGroup } from 'reactstrap';\nimport { gettext, siteRoot, name, fileServerRoot, useGoFileserver } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport URLDecorator from '../../utils/url-decorator';\nimport MoveDirentDialog from '../dialog/move-dirent-dialog';\nimport CopyDirentDialog from '../dialog/copy-dirent-dialog';\nimport ShareDialog from '../dialog/share-dialog';\nimport EditFileTagDialog from '../dialog/edit-filetag-dialog';\nimport ZipDownloadDialog from '../dialog/zip-download-dialog';\nimport Rename from '../dialog/rename-dirent';\nimport LibSubFolderPermissionDialog from '../dialog/lib-sub-folder-permission-dialog';\nimport ViewModeToolbar from './view-mode-toolbar';\n\nimport ModalPortal from '../modal-portal';\nimport ItemDropdownMenu from '../dropdown-menu/item-dropdown-menu';\nimport toaster from '../toast';\n\nimport '../../css/dirents-menu.css';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  userPerm: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onItemsCopy: PropTypes.func.isRequired,\n  onItemsDelete: PropTypes.func.isRequired,\n  isRepoOwner: PropTypes.bool.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  currentRepoInfo: PropTypes.object.isRequired,\n  onFilesTagChanged: PropTypes.func.isRequired,\n  unSelectDirent: PropTypes.func.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  currentMode: PropTypes.string.isRequired,\n  switchViewMode: PropTypes.func.isRequired,\n};\n\nclass MultipleDirOperationToolbar extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isZipDialogOpen: false,\n      isMoveDialogShow: false,\n      isCopyDialogShow: false,\n      isMutipleOperation: true,\n      showLibContentViewDialogs: false,\n      showShareDialog: false,\n      showEditFileTagDialog: false,\n      fileTagList: [],\n      multiFileTagList: [],\n      isRenameDialogOpen: false,\n      isPermissionDialogOpen: false\n    };\n  }\n\n  onMoveToggle = () => {\n    this.setState({isMoveDialogShow: !this.state.isMoveDialogShow});\n  }\n\n  onCopyToggle = () => {\n    this.setState({isCopyDialogShow: !this.state.isCopyDialogShow});\n  }\n\n  onItemsDelete = () => {\n    this.props.onItemsDelete();\n  }\n\n  onItemsDownload = () => {\n    let { path, repoID, selectedDirentList } = this.props;\n    if (selectedDirentList.length) {\n      if (selectedDirentList.length === 1 && !selectedDirentList[0].isDir()) {\n        let direntPath = Utils.joinPath(path, selectedDirentList[0].name);\n        let url = URLDecorator.getUrl({type: 'download_file_url', repoID: repoID, filePath: direntPath});\n        location.href= url;\n        return;\n      }\n      if (!useGoFileserver) {\n        this.setState({\n          isZipDialogOpen: true\n        });\n      } else {\n        const target = this.props.selectedDirentList.map(dirent => dirent.name);\n        seafileAPI.zipDownload(repoID, path, target).then((res) => {\n          const zipToken = res.data['zip_token'];\n          location.href = `${fileServerRoot}zip/${zipToken}`;\n        }).catch((error) => {\n          let errorMsg = Utils.getErrorMsg(error);\n          this.setState({\n            isLoading: false,\n            errorMsg: errorMsg\n          });\n        });\n      }\n    }\n  }\n\n  closeZipDialog = () => {\n    this.setState({\n      isZipDialogOpen: false\n    });\n  }\n\n  checkDuplicatedName = (newName) => {\n    return Utils.checkDuplicatedNameInList(this.props.direntList, newName);\n  }\n\n  onItemRename = (newName) => {\n    const dirent = this.props.selectedDirentList[0];\n    this.props.onItemRename(dirent, newName);\n  }\n\n  onPermissionItem = () => {\n    this.setState({\n      showLibContentViewDialogs: !this.state.showLibContentViewDialogs,\n      isPermissionDialogOpen: !this.state.isPermissionDialogOpen\n    });\n  }\n\n  onMarkAsDraft = (dirent) => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(dirent);\n    seafileAPI.sdocMarkAsDraft(repoID, filePath).then((res) => {\n      this.props.updateDirent(dirent, 'is_sdoc_draft', true);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onUnmarkAsDraft = (dirent) => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(dirent);\n    seafileAPI.sdocUnmarkAsDraft(repoID, filePath).then((res) => {\n      this.props.updateDirent(dirent, 'is_sdoc_draft', false);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onStartRevise = (dirent) => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(dirent);\n    seafileAPI.sdocStartRevise(repoID, filePath).then((res) => {\n      let url = siteRoot + 'lib/' + repoID + '/file' + Utils.encodePath(res.data.file_path);\n      window.open(url);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onCommentItem = () => {\n    this.props.showDirentDetail('comments');\n  }\n\n  getDirentMenuList = (dirent) => {\n    const isRepoOwner = this.props.isRepoOwner;\n    const currentRepoInfo = this.props.currentRepoInfo;\n    const isContextmenu = true;\n    let opList = Utils.getDirentOperationList(isRepoOwner, currentRepoInfo, dirent, isContextmenu);\n    const list = ['Move', 'Copy', 'Delete', 'Download'];\n    if (dirent.type == 'dir') {\n      opList = opList.filter((item, index) => {\n        return list.indexOf(item.key) == -1 && item != 'Divider';\n      });\n    } else {\n      opList = opList.filter((item, index) => {\n        return list.indexOf(item.key) == -1;\n      });\n    }\n    return opList;\n  }\n\n  onMenuItemClick = (operation) => {\n    const dirents = this.props.selectedDirentList;\n    const dirent = dirents[0];\n    switch (operation) {\n      case 'Share':\n        this.setState({\n          showLibContentViewDialogs: true,\n          showShareDialog: true,\n        });\n        break;\n      case 'Rename':\n        this.setState({\n          showLibContentViewDialogs: true,\n          isRenameDialogOpen: true\n        });\n        break;\n      case 'Permission':\n        this.onPermissionItem();\n        break;\n      case 'Tags':\n        this.listFileTags(dirent);\n        break;\n      case 'Lock':\n        this.lockFile(dirent);\n        break;\n      case 'Unlock':\n        this.unlockFile(dirent);\n        break;\n      case 'Mark as draft':\n        this.onMarkAsDraft(dirent);\n        break;\n      case 'Unmark as draft':\n        this.onUnmarkAsDraft(dirent);\n        break;\n      case 'Comment':\n        this.onCommentItem();\n        break;\n      case 'History':\n        this.onHistory(dirent);\n        break;\n      case 'Access Log':\n        this.onAccessLog(dirent);\n        break;\n      case 'Properties':\n        this.props.showDirentDetail('info');\n        break;\n      case 'Open via Client':\n        this.onOpenViaClient(dirent);\n        break;\n      default:\n        break;\n    }\n  }\n\n  lockFile = (dirent) => {\n    const filePath = this.getDirentPath(dirent);\n    seafileAPI.lockfile(this.props.repoID, filePath).then((res) => {\n      if (res.data.is_locked) {\n        this.props.updateDirent(dirent, 'is_locked', true);\n        this.props.updateDirent(dirent, 'locked_by_me', true);\n        this.props.updateDirent(dirent, 'lock_owner_name', name);\n        this.props.unSelectDirent();\n      }\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  unlockFile = (dirent) => {\n    const filePath = this.getDirentPath(dirent);\n    seafileAPI.unlockfile(this.props.repoID, filePath).then((res) => {\n      if (!res.data.is_locked) {\n        this.props.updateDirent(dirent, 'is_locked', false);\n        this.props.updateDirent(dirent, 'locked_by_me', false);\n        this.props.updateDirent(dirent, 'lock_owner_name', '');\n        this.props.unSelectDirent();\n      }\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onOpenViaClient = (dirent) => {\n    const filePath = this.getDirentPath(dirent);\n    let url = URLDecorator.getUrl({\n      type: 'open_via_client',\n      repoID: this.props.repoID,\n      filePath: filePath\n    });\n    location.href = url;\n  }\n\n  onHistory = (dirent) => {\n    let filePath = this.getDirentPath(dirent);\n    let url = URLDecorator.getUrl({\n      type: 'file_revisions',\n      repoID: this.props.repoID,\n      filePath: filePath\n    });\n    location.href = url;\n  }\n\n  onAccessLog = (dirent) => {\n    let filePath = this.getDirentPath(dirent);\n    let path = siteRoot + 'repo/file-access/' + this.props.repoID + '/?p=' + encodeURIComponent(filePath) ;\n    window.open(path);\n  }\n\n  toggleCancel = () => {\n    this.setState({\n      showLibContentViewDialogs: false,\n      showShareDialog: false,\n      showEditFileTagDialog: false,\n      isRenameDialogOpen: false,\n      isPermissionDialogOpen: false,\n    });\n  }\n\n  listFileTags = (dirent) => {\n    let filePath = this.getDirentPath(dirent);\n    seafileAPI.listFileTags(this.props.repoID, filePath).then(res => {\n      let fileTagList = res.data.file_tags;\n      for (let i = 0, length = fileTagList.length; i < length; i++) {\n        fileTagList[i].id = fileTagList[i].file_tag_id;\n      }\n      this.setState({\n        fileTagList: fileTagList,\n        showLibContentViewDialogs: true,\n        showEditFileTagDialog: true,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onMenuFileTagChanged = () => {\n    this.listFileTags(this.props.selectedDirentList[0]);\n    let length = this.props.selectedDirentList.length;\n    for (let i = 0; i < length; i++) {\n      const dirent = this.props.selectedDirentList[i];\n      const direntPath = this.getDirentPath(dirent);\n      this.props.onFilesTagChanged(dirent, direntPath);\n    }\n  }\n\n  getDirentPath = (dirent) => {\n    if (dirent) return Utils.joinPath(this.props.path, dirent.name);\n  }\n\n  render() {\n\n    const { repoID, userPerm } = this.props;\n    const dirent = this.props.selectedDirentList[0];\n    const direntPath = this.getDirentPath(dirent);\n\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    let canDelete = true;\n    let canDownload = true;\n    let canCopy = true;\n    let canModify = true;\n    if (isCustomPermission) {\n      const { permission } = customPermission;\n      canDelete = permission.delete;\n      canDownload = permission.download;\n      canCopy = permission.copy;\n      canModify = permission.modify;\n    }\n\n    return (\n      <Fragment>\n        <div className=\"dir-operation\">\n          <div className=\"d-flex\">\n            <ButtonGroup className=\"flex-row group-operations\">\n              {(userPerm === 'rw' || userPerm === 'admin' || isCustomPermission) && (\n                <Fragment>\n                  {canModify && <Button className=\"secondary group-op-item action-icon sf2-icon-move\" title={gettext('Move')} aria-label={gettext('Move')} onClick={this.onMoveToggle}></Button>}\n                  {canCopy && <Button className=\"secondary group-op-item action-icon sf2-icon-copy\" title={gettext('Copy')} aria-label={gettext('Copy')} onClick={this.onCopyToggle}></Button>}\n                  {canDelete && <Button className=\"secondary group-op-item action-icon sf2-icon-delete\" title={gettext('Delete')} aria-label={gettext('Delete')} onClick={this.onItemsDelete}></Button>}\n                  {canDownload && <Button className=\"secondary group-op-item action-icon sf2-icon-download\" title={gettext('Download')} aria-label={gettext('Download')} onClick={this.onItemsDownload}></Button>}\n                </Fragment>\n              )}\n              {userPerm === 'cloud-edit' && (\n                <Fragment>\n                  {canModify && <Button className=\"secondary group-op-item action-icon sf2-icon-move\" title={gettext('Move')} aria-label={gettext('Move')} onClick={this.onMoveToggle}></Button>}\n                  {canCopy && <Button className=\"secondary group-op-item action-icon sf2-icon-copy\" title={gettext('Copy')} aria-label={gettext('Copy')} onClick={this.onCopyToggle}></Button>}\n                  {canDelete && <Button className=\"secondary group-op-item action-icon sf2-icon-delete\" title={gettext('Delete')} aria-label={gettext('Delete')} onClick={this.onItemsDelete}></Button>}\n                </Fragment>\n              )}\n              {userPerm === 'r' && (\n                <Fragment>\n                  <Button className=\"secondary group-op-item action-icon sf2-icon-copy\" title={gettext('Copy')} aria-label={gettext('Copy')} onClick={this.onCopyToggle}></Button>\n                  <Button className=\"secondary group-op-item action-icon sf2-icon-download\" title={gettext('Download')} aria-label={gettext('Download')} onClick={this.onItemsDownload}></Button>\n                </Fragment>\n              )}\n              {this.props.selectedDirentList.length === 1 &&\n                <ItemDropdownMenu\n                  tagName={'button'}\n                  item={this.props.selectedDirentList[0]}\n                  toggleClass={'fas fa-ellipsis-v dirents-more-menu'}\n                  onMenuItemClick={this.onMenuItemClick}\n                  getMenuList={this.getDirentMenuList}\n                />\n              }\n            </ButtonGroup>\n          </div>\n        </div>\n        {Utils.isDesktop() && <ViewModeToolbar currentMode={this.props.currentMode} switchViewMode={this.props.switchViewMode} isCustomPermission={isCustomPermission} />}\n        {this.state.isMoveDialogShow &&\n          <MoveDirentDialog\n            path={this.props.path}\n            repoID={this.props.repoID}\n            repoEncrypted={this.props.repoEncrypted}\n            isMutipleOperation={this.state.isMutipleOperation}\n            selectedDirentList={this.props.selectedDirentList}\n            onItemsMove={this.props.onItemsMove}\n            onCancelMove={this.onMoveToggle}\n          />\n        }\n        {this.state.isCopyDialogShow &&\n          <CopyDirentDialog\n            path={this.props.path}\n            repoID={this.props.repoID}\n            repoEncrypted={this.props.repoEncrypted}\n            selectedDirentList={this.props.selectedDirentList}\n            isMutipleOperation={this.state.isMutipleOperation}\n            onItemsCopy={this.props.onItemsCopy}\n            onCancelCopy={this.onCopyToggle}\n          />\n        }\n        {this.state.isZipDialogOpen &&\n        <ModalPortal>\n          <ZipDownloadDialog\n            repoID={this.props.repoID}\n            path={this.props.path}\n            target={this.props.selectedDirentList.map(dirent => dirent.name)}\n            toggleDialog={this.closeZipDialog}\n          />\n        </ModalPortal>\n        }\n        {this.state.showLibContentViewDialogs && (\n          <Fragment>\n            {this.state.showShareDialog &&\n              <ModalPortal>\n                <ShareDialog\n                  itemType={dirent.type}\n                  itemName={dirent.name}\n                  itemPath={direntPath}\n                  userPerm={dirent.permission}\n                  repoID={repoID}\n                  repoEncrypted={this.props.repoEncrypted}\n                  enableDirPrivateShare={this.props.enableDirPrivateShare}\n                  isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n                  toggleDialog={this.toggleCancel}\n                />\n              </ModalPortal>\n            }\n            {this.state.isRenameDialogOpen &&\n              <ModalPortal>\n                <Rename\n                  dirent={dirent}\n                  onRename={this.onItemRename}\n                  checkDuplicatedName={this.checkDuplicatedName}\n                  toggleCancel={this.toggleCancel}\n                />\n              </ModalPortal>\n            }\n            {this.state.isPermissionDialogOpen &&\n              <ModalPortal>\n                <LibSubFolderPermissionDialog\n                  toggleDialog={this.toggleCancel}\n                  repoID={repoID}\n                  folderPath={direntPath}\n                  folderName={dirent.name}\n                  isDepartmentRepo={this.props.isGroupOwnedRepo}\n                />\n              </ModalPortal>\n            }\n            {this.state.showEditFileTagDialog &&\n              <ModalPortal>\n                <EditFileTagDialog\n                  repoID={repoID}\n                  filePath={direntPath}\n                  fileTagList={this.state.fileTagList}\n                  toggleCancel={this.toggleCancel}\n                  onFileTagChanged={this.onMenuFileTagChanged}\n                />\n              </ModalPortal>\n            }\n          </Fragment>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nMultipleDirOperationToolbar.propTypes = propTypes;\n\nexport default MultipleDirOperationToolbar;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { DropdownToggle, Dropdown, DropdownMenu, DropdownItem, Tooltip} from 'reactstrap';\nimport { gettext, siteRoot, canGenerateShareLink, isDocs } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport ModalPotal from '../modal-portal';\nimport ShareDialog from '../dialog/share-dialog';\nimport EditFileTagDialog from '../dialog/edit-filetag-dialog';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  userPerm: PropTypes.string.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  filePermission: PropTypes.string,\n  isDraft: PropTypes.bool.isRequired,\n  hasDraft: PropTypes.bool.isRequired,\n  fileTags: PropTypes.array.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n  showShareBtn: PropTypes.bool.isRequired,\n};\n\nclass ViewFileToolbar extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isDraftMessageShow: false,\n      isMoreMenuShow: false,\n      isShareDialogShow: false,\n      isEditTagDialogShow: false,\n    };\n  }\n\n  onEditClick = (e) => {\n    e.preventDefault();\n    let { path, repoID } = this.props;\n    let url = siteRoot + 'lib/' + repoID + '/file' + Utils.encodePath(path) + '?mode=edit';\n    window.open(url);\n  }\n\n  onNewDraft = (e) => {\n    e.preventDefault();\n    let { path, repoID } = this.props;\n    seafileAPI.createDraft(repoID, path).then(res => {\n      window.location.href = siteRoot + 'lib/' + res.data.origin_repo_id + '/file' + res.data.draft_file_path + '?mode=edit';\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onDraftHover = () => {\n    this.setState({isDraftMessageShow: !this.state.isDraftMessageShow});\n  }\n\n  toggleMore = () => {\n    this.setState({isMoreMenuShow: !this.state.isMoreMenuShow});\n  }\n\n  onShareToggle = () => {\n    this.setState({isShareDialogShow: !this.state.isShareDialogShow});\n  }\n\n  onEditFileTagToggle = () => {\n    this.setState({isEditTagDialogShow: !this.state.isEditTagDialogShow});\n  }\n\n  onHistoryClick = () => {\n    let historyUrl = siteRoot + 'repo/file_revisions/' + this.props.repoID + '/?p=' + Utils.encodePath(this.props.path);\n    location.href = historyUrl;\n  }\n\n  render() {\n    let { filePermission } = this.props;\n    let name = Utils.getFileName(this.props.path);\n    let dirent = { name: name };\n    return (\n      <Fragment>\n        <div className=\"dir-operation\">\n          {((filePermission === 'rw' || filePermission === 'cloud-edit') && !this.props.hasDraft) && (\n            <Fragment>\n              <button className=\"btn btn-secondary operation-item\" title={gettext('Edit File')} onClick={this.onEditClick}>{gettext('Edit')}</button>\n            </Fragment>\n          )}\n          {(filePermission === 'rw' && !this.props.isDraft && !this.props.hasDraft && isDocs) && (\n            <Fragment>\n              <button id=\"new-draft\" className=\"btn btn-secondary operation-item\" onClick={this.onNewDraft}>{gettext('New Draft')}</button>\n              <Tooltip target=\"new-draft\" placement=\"bottom\" isOpen={this.state.isDraftMessageShow} toggle={this.onDraftHover}>{gettext('Create a draft from this file, instead of editing it directly.')}</Tooltip>\n            </Fragment>\n          )}\n          {filePermission === 'rw' && (\n            <Dropdown isOpen={this.state.isMoreMenuShow} toggle={this.toggleMore}>\n              <DropdownToggle className='btn btn-secondary operation-item'>\n                {gettext('More')}\n              </DropdownToggle>\n              <DropdownMenu>\n                {this.props.showShareBtn &&\n                  <DropdownItem onClick={this.onShareToggle}>{gettext('Share')}</DropdownItem>\n                }\n                <DropdownItem onClick={this.onEditFileTagToggle}>{gettext('Tags')}</DropdownItem>\n                <DropdownItem onClick={this.onHistoryClick}>{gettext('History')}</DropdownItem>\n              </DropdownMenu>\n            </Dropdown>\n          )}\n        </div>\n        {this.state.isShareDialogShow && (\n          <ModalPotal>\n            <ShareDialog\n              itemType={'file'}\n              itemName={Utils.getFileName(this.props.path)}\n              itemPath={this.props.path}\n              repoID={this.props.repoID}\n              repoEncrypted={this.props.repoEncrypted}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              userPerm={this.props.userPerm}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              toggleDialog={this.onShareToggle}\n            />\n          </ModalPotal>\n        )}\n        {this.state.isEditTagDialogShow && (\n          <ModalPotal>\n            <EditFileTagDialog\n              filePath={this.props.path}\n              repoID={this.props.repoID}\n              fileTagList={this.props.fileTags}\n              toggleCancel={this.onEditFileTagToggle}\n              onFileTagChanged={this.props.onFileTagChanged}\n            />\n          </ModalPotal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nViewFileToolbar.propTypes = propTypes;\n\nexport default ViewFileToolbar;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport CommonToolbar from '../../components/toolbar/common-toolbar';\nimport ViewModeToolbar from '../../components/toolbar/view-mode-toolbar';\nimport DirOperationToolBar from '../../components/toolbar/dir-operation-toolbar';\nimport MultipleDirOperationToolbar from '../../components/toolbar/multiple-dir-operation-toolbar';\nimport ViewFileToolbar from '../../components/toolbar/view-file-toolbar';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  isViewFile: PropTypes.bool.isRequired,\n  filePermission: PropTypes.string,\n  isDraft: PropTypes.bool.isRequired,\n  hasDraft: PropTypes.bool.isRequired,\n  fileTags: PropTypes.array.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,  // for file-view-toolbar\n  // side-panel\n  onSideNavMenuClick: PropTypes.func.isRequired,\n  // mutiple-dir\n  isDirentSelected: PropTypes.bool.isRequired,\n  repoID: PropTypes.string.isRequired,\n  path: PropTypes.string.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onItemsCopy: PropTypes.func.isRequired,\n  onItemsDelete: PropTypes.func.isRequired,\n  // dir\n  direntList: PropTypes.array.isRequired,\n  repoName: PropTypes.string.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string.isRequired,\n  showShareBtn: PropTypes.bool.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onUploadFile: PropTypes.func.isRequired,\n  onUploadFolder: PropTypes.func.isRequired,\n  // view-mode\n  currentMode: PropTypes.string.isRequired,\n  switchViewMode: PropTypes.func.isRequired,\n  // search\n  onSearchedClick: PropTypes.func.isRequired,\n  isRepoOwner: PropTypes.bool.isRequired,\n  // selected menu\n  onFilesTagChanged: PropTypes.func.isRequired, // for mutiple select toolbar\n  updateDirent: PropTypes.func.isRequired,\n  unSelectDirent: PropTypes.func,\n  currentRepoInfo: PropTypes.object,\n};\n\nclass LibContentToolbar extends React.Component {\n\n  render() {\n\n    const { userPerm } = this.props;\n    const { isCustomPermission } = Utils.getUserPermission(userPerm);\n\n    if (this.props.isViewFile) {\n      return (\n        <Fragment>\n          <div className=\"cur-view-toolbar\">\n            <span className=\"sf2-icon-menu hidden-md-up d-md-none side-nav-toggle\" title={gettext('Side Nav Menu')} onClick={this.props.onSideNavMenuClick}></span>\n            <ViewFileToolbar\n              path={this.props.path}\n              repoID={this.props.repoID}\n              userPerm={this.props.userPerm}\n              repoEncrypted={this.props.repoEncrypted}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              filePermission={this.props.filePermission}\n              isDraft={this.props.isDraft}\n              hasDraft={this.props.hasDraft}\n              fileTags={this.props.fileTags}\n              onFileTagChanged={this.props.onFileTagChanged}\n              showShareBtn={this.props.showShareBtn}\n            />\n            <ViewModeToolbar currentMode={this.props.currentMode} switchViewMode={this.props.switchViewMode} isCustomPermission={isCustomPermission} />\n          </div>\n          <CommonToolbar isLibView={true} repoID={this.props.repoID} repoName={this.props.repoName} onSearchedClick={this.props.onSearchedClick} searchPlaceholder={gettext('Search files in this library')}/>\n        </Fragment>\n      );\n    }\n\n    return (\n      <Fragment>\n        <div className=\"cur-view-toolbar\">\n          <span className=\"sf2-icon-menu hidden-md-up d-md-none side-nav-toggle\" title={gettext('Side Nav Menu')} onClick={this.props.onSideNavMenuClick}></span>\n          {this.props.isDirentSelected ?\n            <MultipleDirOperationToolbar\n              repoID={this.props.repoID}\n              path={this.props.path}\n              userPerm={this.props.userPerm}\n              repoEncrypted={this.props.repoEncrypted}\n              selectedDirentList={this.props.selectedDirentList}\n              direntList={this.props.direntList}\n              onItemsMove={this.props.onItemsMove}\n              onItemsCopy={this.props.onItemsCopy}\n              onItemsDelete={this.props.onItemsDelete}\n              onItemRename={this.props.onItemRename}\n              isRepoOwner={this.props.isRepoOwner}\n              currentRepoInfo={this.props.currentRepoInfo}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              updateDirent={this.props.updateDirent}\n              unSelectDirent={this.props.unSelectDirent}\n              onFilesTagChanged={this.props.onFilesTagChanged}\n              showShareBtn={this.props.showShareBtn}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              showDirentDetail={this.props.showDirentDetail}\n              currentMode={this.props.currentMode}\n              switchViewMode={this.props.switchViewMode}\n            /> :\n            <DirOperationToolBar\n              path={this.props.path}\n              repoID={this.props.repoID}\n              repoName={this.props.repoName}\n              repoEncrypted={this.props.repoEncrypted}\n              direntList={this.props.direntList}\n              showShareBtn={this.props.showShareBtn}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              userPerm={this.props.userPerm}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              onAddFile={this.props.onAddFile}\n              onAddFolder={this.props.onAddFolder}\n              onUploadFile={this.props.onUploadFile}\n              onUploadFolder={this.props.onUploadFolder}\n              currentMode={this.props.currentMode}\n              switchViewMode={this.props.switchViewMode}\n            />\n          }\n        </div>\n        <CommonToolbar isLibView={true} repoID={this.props.repoID} repoName={this.props.repoName} onSearchedClick={this.props.onSearchedClick} searchPlaceholder={gettext('Search files in this library')}/>\n      </Fragment>\n    );\n  }\n}\n\nLibContentToolbar.propTypes = propTypes;\n\nexport default LibContentToolbar;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from '@gatsbyjs/reach-router';\nimport { UncontrolledTooltip } from 'reactstrap';\nimport { siteRoot, gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { InternalLinkOperation } from '../operations';\n\nconst propTypes = {\n  repoName: PropTypes.string.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  onPathClick: PropTypes.func.isRequired,\n  onTabNavClick: PropTypes.func,\n  pathPrefix: PropTypes.array,\n  repoID: PropTypes.string.isRequired,\n  isViewFile: PropTypes.bool,\n  fileTags: PropTypes.array.isRequired,\n};\n\nclass DirPath extends React.Component {\n\n  onPathClick = (e) => {\n    let path = Utils.getEventData(e, 'path');\n    this.props.onPathClick(path);\n  }\n\n  onTabNavClick = (e, tabName, id) => {\n    if (window.uploader &&\n      window.uploader.isUploadProgressDialogShow &&\n      window.uploader.totalProgress !== 100) {\n      if (!window.confirm(gettext('A file is being uploaded. Are you sure you want to leave this page?'))) {\n        e.preventDefault();\n        return false;\n      }\n      window.uploader.isUploadProgressDialogShow = false;\n    }\n    this.props.onTabNavClick(tabName, id);\n  }\n\n  turnPathToLink = (path) => {\n    path = path[path.length - 1] === '/' ? path.slice(0, path.length - 1) : path;\n    let pathList = path.split('/');\n    let nodePath = '';\n    let pathElem = pathList.map((item, index) => {\n      if (item === '') {\n        return;\n      }\n      if (index === (pathList.length - 1)) {\n        return (\n          <Fragment key={index}>\n            <span className=\"path-split\">/</span>\n            <span className=\"path-file-name\">{item}</span>\n          </Fragment>\n        );\n      } else {\n        nodePath += '/' + item;\n        return (\n          <Fragment key={index} >\n            <span className=\"path-split\">/</span>\n            <a className=\"path-link\" data-path={nodePath} onClick={this.onPathClick}>{item}</a>\n          </Fragment>\n        );\n      }\n    });\n    return pathElem;\n  }\n\n  render() {\n    let { currentPath, repoName, fileTags } = this.props;\n    let pathElem = this.turnPathToLink(currentPath);\n\n    let tagTitle = '';\n    if (fileTags.length > 0) {\n      fileTags.forEach(item => {\n        tagTitle += item.name + ' ';\n      });\n    }\n\n    return (\n      <div className=\"path-container\">\n        {this.props.pathPrefix && this.props.pathPrefix.map((item, index) => {\n          return (\n            <Fragment key={index}>\n              <Link to={item.url} className=\"normal\" onClick={(e) => this.onTabNavClick(e, item.name, item.id)}>{gettext(item.showName)}</Link>\n              <span className=\"path-split\">/</span>\n            </Fragment>\n          );\n        })}\n        {this.props.pathPrefix && this.props.pathPrefix.length === 0 && (\n          <Fragment>\n            <Link to={siteRoot + 'my-libs/'} className=\"normal\" onClick={(e) => this.onTabNavClick(e, 'my-libs')}>{gettext('Libraries')}</Link>\n            <span className=\"path-split\">/</span>\n          </Fragment>\n        )}\n        {!this.props.pathPrefix && (\n          <Fragment>\n            <Link href={siteRoot + 'my-libs/'} className=\"normal\" onClick={(e) => this.onTabNavClick(e, 'my-libs')}>{gettext('Libraries')}</Link>\n            <span className=\"path-split\">/</span>\n          </Fragment>\n        )}\n        {(currentPath === '/' || currentPath === '') ?\n          <span className=\"path-repo-name\">{repoName}</span>:\n          <a className=\"path-link\" data-path=\"/\" onClick={this.onPathClick}>{repoName}</a>\n        }\n        {pathElem}\n        {this.props.isViewFile && (\n          <InternalLinkOperation repoID={this.props.repoID} path={this.props.currentPath}/>\n        )}\n        {(this.props.isViewFile && fileTags.length !== 0) &&\n          <span id='column-mode-file-tags' className=\"tag-list tag-list-stacked align-middle ml-1 d-flex align-items-center\">\n            {fileTags.map((fileTag, index) => {\n              return (<span className=\"file-tag\" key={fileTag.id} style={{zIndex: index, backgroundColor: fileTag.color}}></span>);\n            })}\n            <UncontrolledTooltip target=\"column-mode-file-tags\" placement=\"bottom\">\n              {tagTitle}\n            </UncontrolledTooltip>\n          </span>\n        }\n      </div>\n    );\n  }\n}\n\nDirPath.propTypes = propTypes;\n\nexport default DirPath;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Popover, PopoverBody } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nimport '../../css/repo-tag.css';\n\nconst tagColorPropTypes = {\n  tag: PropTypes.object.isRequired,\n  repoID: PropTypes.string.isRequired\n};\n\nclass TagColor extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      tagColor: this.props.tag.color,\n      isPopoverOpen: false\n    };\n  }\n\n  togglePopover = () => {\n    this.setState({\n      isPopoverOpen: !this.state.isPopoverOpen\n    });\n  }\n\n  selectTagColor = (e) => {\n    const newColor = e.target.value;\n    const { repoID, tag } = this.props;\n    const { id, name } = tag;\n    seafileAPI.updateRepoTag(repoID, id, name, newColor).then(() => {\n      this.setState({\n        tagColor: newColor,\n        isPopoverOpen: !this.state.isPopoverOpen\n      });\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    const { isPopoverOpen, tagColor } = this.state;\n    const { tag } = this.props;\n    const { id, color } = tag;\n\n    let colorList = ['#FBD44A', '#EAA775', '#F4667C', '#DC82D2', '#9860E5', '#9F8CF1', '#59CB74', '#ADDF84', '#89D2EA', '#4ECCCB', '#46A1FD', '#C2C2C2'];\n    // for color from previous color options\n    if (colorList.indexOf(color) == -1) {\n      colorList.unshift(color);\n    }\n\n    return (\n      <div>\n        <span\n          id={`tag-${id}-color`}\n          className=\"tag-color cursor-pointer w-4 h-4 rounded-circle d-flex align-items-center justify-content-center\"\n          style={{backgroundColor: tagColor}}\n          onClick={this.togglePopover}\n        >\n          <i className=\"fas fa-caret-down text-white\"></i>\n        </span>\n        <Popover\n          target={`tag-${id}-color`}\n          isOpen={isPopoverOpen}\n          placement=\"bottom\"\n          toggle={this.togglePopover}\n          className=\"mw-100\"\n        >\n          <PopoverBody className=\"p-2\">\n            <div className=\"d-flex justify-content-between\">\n              {colorList.map((item, index)=>{\n                return (\n                  <div key={index} className=\"tag-color-option mx-1\">\n                    <label className=\"colorinput\">\n                      <input name=\"color\" type=\"radio\" value={item} className=\"colorinput-input\" defaultChecked={item == tagColor} onClick={this.selectTagColor} />\n                      <span className=\"colorinput-color rounded-circle d-flex align-items-center justify-content-center\" style={{backgroundColor: item}}>\n                        <i className=\"fas fa-check color-selected\"></i>\n                      </span>\n                    </label>\n                  </div>\n                );\n              })\n              }\n            </div>\n          </PopoverBody>\n        </Popover>\n      </div>\n    );\n  }\n}\n\nTagColor.propTypes = tagColorPropTypes;\n\nexport default TagColor;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nimport '../../css/repo-tag.css';\n\nconst tagNamePropTypes = {\n  tag: PropTypes.object.isRequired,\n  repoID: PropTypes.string.isRequired\n};\n\nclass TagName extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      tagName: this.props.tag.name,\n      isEditing: false\n    };\n    this.input = React.createRef();\n  }\n\n  toggleMode = () => {\n    this.setState({\n      isEditing: !this.state.isEditing\n    }, () => {\n      if (this.state.isEditing) {\n        this.input.current.focus();\n      }\n    });\n  }\n\n  updateTagName = (e) => {\n    const newName = e.target.value;\n    const { repoID, tag } = this.props;\n    const { id, color } = tag;\n    seafileAPI.updateRepoTag(repoID, id, newName, color).then(() => {\n      this.setState({\n        tagName: newName\n      });\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onInputKeyDown = (e) => {\n    if (e.key == 'Enter') {\n      this.toggleMode();\n      this.updateTagName(e);\n    }\n  }\n\n  onInputBlur = (e) => {\n    this.toggleMode();\n    this.updateTagName(e);\n  }\n\n  render() {\n    const { isEditing, tagName } = this.state;\n    return (\n      <div className=\"mx-2 flex-fill d-flex\">\n        {isEditing ?\n          <input\n            type=\"text\"\n            ref={this.input}\n            defaultValue={tagName}\n            onBlur={this.onInputBlur}\n            onKeyDown={this.onInputKeyDown}\n            className=\"flex-fill form-control-sm form-control\"\n          /> :\n          <span\n            onClick={this.toggleMode}\n            className=\"cursor-pointer flex-fill\"\n          >{tagName}</span>\n        }\n      </div>\n    );\n  }\n}\n\nTagName.propTypes = tagNamePropTypes;\n\nexport default TagName;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport RepoTag from '../../models/repo-tag';\nimport TagColor from './tag-color';\nimport TagName from './tag-name';\n\nimport '../../css/repo-tag.css';\n\nconst tagListItemPropTypes = {\n  item: PropTypes.object.isRequired,\n  repoID: PropTypes.string.isRequired,\n  onDeleteTag : PropTypes.func.isRequired\n};\n\nclass TagListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isTagHighlighted: false\n    };\n  }\n\n  onMouseOver = () => {\n    this.setState({\n      isTagHighlighted: true\n    });\n  }\n\n  onMouseOut = () => {\n    this.setState({\n      isTagHighlighted: false\n    });\n  }\n\n  deleteTag = () => {\n    this.props.onDeleteTag(this.props.item);\n  }\n\n  render() {\n    const { isTagHighlighted } = this.state;\n    const { item, repoID } = this.props;\n    return (\n      <li\n        className={`tag-list-item px-4 d-flex justify-content-between align-items-center ${isTagHighlighted ? 'hl' : ''}`}\n        onMouseOver={this.onMouseOver}\n        onMouseOut={this.onMouseOut}\n      >\n        <TagColor repoID={repoID} tag={item} />\n        <TagName repoID={repoID} tag={item} />\n        <button\n          className={`tag-delete-icon sf2-icon-delete border-0 px-0 bg-transparent cursor-pointer ${isTagHighlighted ? '' : 'invisible'}`}\n          onClick={this.deleteTag}\n          aria-label={gettext('Delete')}\n          title={gettext('Delete')}\n        ></button>\n      </li>\n    );\n  }\n}\n\nTagListItem.propTypes = tagListItemPropTypes;\n\nconst listTagPropTypes = {\n  repoID: PropTypes.string.isRequired,\n  onListTagCancel: PropTypes.func.isRequired,\n  onCreateRepoTag: PropTypes.func.isRequired\n};\n\nclass ListTagDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      repotagList: []\n    };\n  }\n\n  componentDidMount() {\n    let repoID = this.props.repoID;\n    seafileAPI.listRepoTags(repoID).then(res => {\n      let repotagList = [];\n      res.data.repo_tags.forEach(item => {\n        let repo_tag = new RepoTag(item);\n        repotagList.push(repo_tag);\n      });\n      this.setState({\n        repotagList: repotagList\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  toggle = () => {\n    this.props.onListTagCancel();\n  }\n\n  createNewTag = (e) => {\n    e.preventDefault();\n    this.props.onCreateRepoTag();\n  }\n\n  onDeleteTag = (tag) => {\n    const { repoID } = this.props;\n    const { id: targetTagID } = tag;\n    seafileAPI.deleteRepoTag(repoID, targetTagID).then((res) => {\n      this.setState({\n        repotagList: this.state.repotagList.filter(tag => tag.id != targetTagID)\n      });\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <ModalHeader toggle={this.toggle}>{gettext('Tags')}</ModalHeader>\n        <ModalBody className=\"px-0\">\n          <ul className=\"tag-list tag-list-container\">\n            {this.state.repotagList.map((repoTag, index) => {\n              return (\n                <TagListItem\n                  key={index}\n                  item={repoTag}\n                  repoID={this.props.repoID}\n                  onDeleteTag={this.onDeleteTag}\n                />\n              );\n            })}\n          </ul>\n          <a\n            href=\"#\"\n            className=\"add-tag-link px-4 py-2 d-flex align-items-center\"\n            onClick={this.createNewTag}\n          >\n            <span className=\"sf2-icon-plus mr-2\"></span>\n            {gettext('Create a new tag')}\n          </a>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Fragment>\n    );\n  }\n}\n\nListTagDialog.propTypes = listTagPropTypes;\n\nexport default ListTagDialog;\n","import React, { Fragment } from 'react';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport PropTypes from 'prop-types';\nimport ModalPortal from '../modal-portal';\nimport { Modal } from 'reactstrap';\nimport ListTagDialog from '../dialog/list-tag-dialog';\nimport CreateTagDialog from '../dialog/create-tag-dialog';\nimport ListTaggedFilesDialog from '../dialog/list-taggedfiles-dialog';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  userPerm: PropTypes.string,\n  currentPath: PropTypes.string.isRequired,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  onDeleteRepoTag: PropTypes.func.isRequired,\n};\n\nclass DirTool extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isRepoTagDialogShow: false,\n      currentTag: null,\n      isListRepoTagShow: false,\n      isCreateRepoTagShow: false,\n      isListTaggedFileShow: false,\n    };\n  }\n\n  onShowListRepoTag = (e) => {\n    e.preventDefault();\n    this.setState({\n      isRepoTagDialogShow: true,\n      isListRepoTagShow: true,\n      isCreateRepoTagShow: false,\n      isListTaggedFileShow: false\n    });\n  }\n\n  onCloseRepoTagDialog = () => {\n    this.setState({\n      isRepoTagDialogShow: false,\n      isListRepoTagShow: false,\n      isCreateRepoTagShow: false,\n      isListTaggedFileShow: false\n    });\n  }\n\n  onCreateRepoTagToggle = () => {\n    this.setState({\n      isCreateRepoTagShow: !this.state.isCreateRepoTagShow,\n      isListRepoTagShow: !this.state.isListRepoTagShow,\n    });\n  }\n\n  onListTaggedFileToggle = (currentTag) => {\n    this.setState({\n      currentTag: currentTag,\n      isListRepoTagShow: !this.state.isListRepoTagShow,\n      isListTaggedFileShow: !this.state.isListTaggedFileShow,\n    });\n  }\n\n  isMarkdownFile(filePath) {\n    let name = Utils.getFileName(filePath);\n    return name.indexOf('.md') > -1 ? true : false;\n  }\n\n  render() {\n    let { repoID, userPerm, currentPath } = this.props;\n    let isFile = this.isMarkdownFile(currentPath);\n    let name = Utils.getFileName(currentPath);\n    let trashUrl = siteRoot + 'repo/' + repoID + '/trash/';\n    let historyUrl = siteRoot + 'repo/history/' + repoID + '/';\n    if (userPerm === 'rw') {\n      if (!isFile) {\n        if (name) { // name not '' is not root path\n          trashUrl = siteRoot + 'repo/' + repoID + '/trash/?path=' + encodeURIComponent(currentPath);\n          return (\n            <ul className=\"path-toolbar\">\n              <li className=\"toolbar-item\"><a className=\"op-link sf2-icon-recycle\" href={trashUrl} title={gettext('Trash')} aria-label={gettext('Trash')}></a></li>\n            </ul>\n          );\n        } else { // currentPath === '/' is root path\n          return (\n            <Fragment>\n              <ul className=\"path-toolbar\">\n                <li className=\"toolbar-item\"><a className=\"op-link sf2-icon-tag\" href=\"#\" role=\"button\" onClick={this.onShowListRepoTag} title={gettext('Tags')} aria-label={gettext('Tags')}></a></li>\n                <li className=\"toolbar-item\"><a className=\"op-link sf2-icon-recycle\" href={trashUrl} title={gettext('Trash')} aria-label={gettext('Trash')}></a></li>\n                <li className=\"toolbar-item\"><a className=\"op-link sf2-icon-history\" href={historyUrl} title={gettext('History')} aria-label={gettext('History')}></a></li>\n              </ul>\n\n              {this.state.isRepoTagDialogShow && (\n                <ModalPortal>\n                  <Modal isOpen={true} autoFocus={false}>\n                    {this.state.isListRepoTagShow && (\n                      <ListTagDialog\n                        repoID={repoID}\n                        onListTagCancel={this.onCloseRepoTagDialog}\n                        onCreateRepoTag={this.onCreateRepoTagToggle}\n                      />\n                    )}\n                    {this.state.isCreateRepoTagShow && (\n                      <CreateTagDialog\n                        repoID={repoID}\n                        onClose={this.onCloseRepoTagDialog}\n                        toggleCancel={this.onCreateRepoTagToggle}\n                      />\n                    )}\n                    {this.state.isListTaggedFileShow && (\n                      <ListTaggedFilesDialog\n                        repoID={this.props.repoID}\n                        currentTag={this.state.currentTag}\n                        onClose={this.onCloseRepoTagDialog}\n                        toggleCancel={this.onListTaggedFileToggle}\n                        updateUsedRepoTags={this.props.updateUsedRepoTags}\n                      />\n                    )}\n                  </Modal>\n                </ModalPortal>\n              )}\n            </Fragment>\n          );\n        }\n      }\n    }\n    return '';\n  }\n}\n\nDirTool.propTypes = propTypes;\n\nexport default DirTool;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Utils } from '../../utils/utils';\nimport SortOptionsDialog from '../../components/dialog/sort-options';\nimport DirPath from './dir-path';\nimport DirTool from './dir-tool';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  repoName: PropTypes.string.isRequired,\n  userPerm: PropTypes.string,\n  currentPath: PropTypes.string.isRequired,\n  onPathClick: PropTypes.func.isRequired,\n  onTabNavClick: PropTypes.func,\n  pathPrefix: PropTypes.array,\n  isViewFile: PropTypes.bool,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  fileTags: PropTypes.array.isRequired,\n  onDeleteRepoTag: PropTypes.func.isRequired,\n};\n\nclass CurDirPath extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isSortOptionsDialogOpen: false\n    };\n  }\n\n  toggleSortOptionsDialog = () => {\n    this.setState({\n      isSortOptionsDialogOpen: !this.state.isSortOptionsDialogOpen\n    });\n  }\n\n  render() {\n    const isDesktop = Utils.isDesktop();\n    return (\n      <Fragment>\n        <DirPath\n          repoName={this.props.repoName}\n          pathPrefix={this.props.pathPrefix}\n          currentPath={this.props.currentPath}\n          onPathClick={this.props.onPathClick}\n          onTabNavClick={this.props.onTabNavClick}\n          repoID={this.props.repoID}\n          isViewFile={this.props.isViewFile}\n          fileTags={this.props.fileTags}\n        />\n        {isDesktop &&\n        <DirTool\n          repoID={this.props.repoID}\n          repoName={this.props.repoName}\n          userPerm={this.props.userPerm}\n          currentPath={this.props.currentPath}\n          updateUsedRepoTags={this.props.updateUsedRepoTags}\n          onDeleteRepoTag={this.props.onDeleteRepoTag}\n        />}\n        {!isDesktop && this.props.direntList.length > 0 &&\n        <span className=\"sf3-font sf3-font-sort action-icon\" onClick={this.toggleSortOptionsDialog}></span>}\n        {this.state.isSortOptionsDialogOpen &&\n        <SortOptionsDialog\n          toggleDialog={this.toggleSortOptionsDialog}\n          sortBy={this.props.sortBy}\n          sortOrder={this.props.sortOrder}\n          sortItems={this.props.sortItems}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nCurDirPath.propTypes = propTypes;\n\nexport default CurDirPath;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { processor } from '@seafile/seafile-editor';\nimport { Button, Dropdown, DropdownToggle, DropdownMenu, DropdownItem } from 'reactstrap';\nimport { gettext, username, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport { MentionsInput, Mention } from 'react-mentions';\nimport { defaultStyle, defaultMentionStyle } from '../../css/react-mentions-default-style';\nimport '../../css/comments-list.css';\n\nconst DetailCommentListPropTypes = {\n  repoID: PropTypes.string.isRequired,\n  filePath: PropTypes.string.isRequired,\n  onParticipantsChange: PropTypes.func.isRequired,\n  fileParticipantList: PropTypes.array.isRequired,\n};\n\nclass DetailCommentList extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      commentsList: [],\n      relatedUsers: null,\n      comment: '',\n    };\n    this.toBeAddedParticipant = [];\n  }\n\n  componentDidMount() {\n    this.listComments();\n    this.checkParticipant();\n    this.listRepoRelatedUsers();\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.filePath !== this.props.filePath) {\n      this.listComments(nextProps.filePath);\n    }\n  }\n\n  handleCommentChange = (event) => {\n    this.setState({ comment: event.target.value });\n  }\n\n  listComments = (filePath) => {\n    seafileAPI.listComments(this.props.repoID, (filePath || this.props.filePath)).then((res) => {\n      this.setState({ commentsList: res.data.comments });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  addComment = () => {\n    const { repoID, filePath } = this.props;\n    if (!this.state.comment.trim()) return;\n    seafileAPI.postComment(repoID, filePath, this.state.comment.trim()).then(() => {\n      this.listComments();\n    }).catch(err => {\n      toaster.danger(Utils.getErrorMsg(err));\n    });\n    this.setState({ comment: '' });\n  }\n\n  onSubmit = () => {\n    this.addParticipant(username);\n    if (this.toBeAddedParticipant.length === 0) {\n      this.addComment();\n    } else {\n      const { repoID, filePath } = this.props;\n      seafileAPI.addFileParticipants(repoID, filePath, this.toBeAddedParticipant).then((res) => {\n        this.props.onParticipantsChange(repoID, filePath);\n        this.toBeAddedParticipant = [];\n        this.addComment();\n      }).catch((err) => {\n        toaster.danger(Utils.getErrorMsg(err));\n      });\n    }\n  }\n\n  resolveComment = (event) => {\n    const { repoID } = this.props;\n    seafileAPI.updateComment(repoID, event.target.id, 'true').then(() => {\n      this.listComments();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  deleteComment = (event) => {\n    const { repoID } = this.props;\n    seafileAPI.deleteComment(repoID, event.target.id).then(() => {\n      this.listComments();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  editComment = (commentID, newComment) => {\n    const { repoID } = this.props;\n    seafileAPI.updateComment(repoID, commentID, null, null, newComment).then(() => {\n      this.listComments();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  listRepoRelatedUsers = () => {\n    const { repoID } = this.props;\n    seafileAPI.listRepoRelatedUsers(repoID).then((res) => {\n      let users = res.data.user_list.map((item) => {\n        return { id: item.email, display: item.name};\n      });\n      this.setState({ relatedUsers: users });\n    });\n  }\n\n  checkParticipant = (email) => {\n    return this.props.fileParticipantList.map((participant) => {return participant.email;}).includes(email);\n  }\n\n  addParticipant = (email) => {\n    if (this.checkParticipant(email)) return;\n    this.toBeAddedParticipant.push(email);\n  }\n\n  renderUserSuggestion = (entry, search, highlightedDisplay, index, focused) => {\n    return <div className={`user ${focused ? 'focused' : ''}`}>{highlightedDisplay}</div>;\n  }\n\n  render() {\n    const { repoID, filePath } = this.props;\n    const { commentsList } = this.state;\n    return (\n      <div className=\"seafile-comment detail-comments h-100\">\n        <div className=\"flex-fill o-auto\">\n          {commentsList.length > 0 ? (\n            <ul className=\"seafile-comment-list\">\n              {commentsList.map((item, index = 0, arr) => {\n                let oldTime = (new Date(item.created_at)).getTime();\n                let time = moment(oldTime).format('YYYY-MM-DD HH:mm');\n                return (\n                  <CommentItem\n                    key={item.id}\n                    item={item}\n                    time={time}\n                    deleteComment={this.deleteComment}\n                    resolveComment={this.resolveComment}\n                    editComment={this.editComment}\n                  />\n                );\n              })\n              }\n            </ul>) :\n            <p className=\"text-center my-4\">{gettext('No comment yet.')}</p>\n          }\n        </div>\n        <div className=\"seafile-comment-footer flex-shrink-0\">\n          <MentionsInput\n            value={this.state.comment}\n            onChange={this.handleCommentChange}\n            placeholder={gettext('Add a comment...')}\n            style={defaultStyle}\n          >\n            <Mention\n              trigger=\"@\"\n              displayTransform={(username, display) => `@${display}`}\n              data={this.state.relatedUsers}\n              renderSuggestion={this.renderUserSuggestion}\n              style={defaultMentionStyle}\n              onAdd={(id, display) => {this.addParticipant(id);}}\n              appendSpaceOnAdd={true}\n            />\n          </MentionsInput>\n          <div className=\"comment-submit-container\">\n            <Button className=\"submit-comment\" color=\"primary\" size=\"sm\" onClick={this.onSubmit}>{gettext('Submit')}</Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nDetailCommentList.propTypes = DetailCommentListPropTypes;\n\nconst commentItemPropTypes = {\n  time: PropTypes.string.isRequired,\n  item: PropTypes.object.isRequired,\n  deleteComment: PropTypes.func.isRequired,\n  resolveComment: PropTypes.func.isRequired,\n  editComment: PropTypes.func.isRequired,\n};\n\nclass CommentItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      dropdownOpen: false,\n      html: '',\n      newComment: this.props.item.comment,\n      editable: false,\n    };\n  }\n\n  componentWillMount() {\n    this.convertComment(this.props.item.comment);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.convertComment(nextProps.item.comment);\n  }\n\n  convertComment = (mdFile) => {\n    processor.process(mdFile).then((result) => {\n      let html = String(result);\n      this.setState({ html: html });\n    });\n  }\n\n  toggleDropDownMenu = () => {\n    this.setState({ dropdownOpen: !this.state.dropdownOpen });\n  }\n\n  toggleEditComment = () => {\n    this.setState({ editable: !this.state.editable });\n  }\n\n  updateComment = (event) => {\n    const newComment = this.state.newComment;\n    if (this.props.item.comment !== newComment) {\n      this.props.editComment(event.target.id, newComment);\n    }\n    this.toggleEditComment();\n  }\n\n  handleCommentChange = (event) => {\n    this.setState({ newComment: event.target.value });\n  }\n\n  onCommentClick = (e) => {\n    // click participant link, page shouldn't jump\n    if (e.target.nodeName !== 'A') return;\n    const preNode = e.target.previousSibling;\n    if (preNode && preNode.nodeType === 3 && preNode.nodeValue.slice(-1) === '@') {\n      e.preventDefault();\n    }\n  }\n\n  renderInfo = (item) => {\n    return (\n      <Fragment>\n        <img className=\"avatar\" src={item.avatar_url} alt=\"\"/>\n        <div className=\"reviewer-info\">\n          <div className=\"reviewer-name ellipsis\">{item.user_name}</div>\n          <div className=\"review-time\">{this.props.time}</div>\n        </div>\n      </Fragment>\n    );\n  }\n\n  render() {\n    const item = this.props.item;\n    if (this.state.editable) {\n      return(\n        <li className=\"seafile-comment-item\" id={item.id}>\n          <div className=\"seafile-comment-info\">\n            {this.renderInfo(item)}\n          </div>\n          <div className=\"seafile-edit-comment\">\n            <textarea className=\"edit-comment-input\" value={this.state.newComment}\n              onChange={this.handleCommentChange} clos=\"100\" rows=\"3\" warp=\"virtual\"\n            ></textarea>\n            <Button className=\"comment-btn\" color=\"primary\" size=\"sm\" onClick={this.updateComment} id={item.id}>{gettext('Update')}</Button>{' '}\n            <Button className=\"comment-btn\" color=\"secondary\" size=\"sm\" onClick={this.toggleEditComment}> {gettext('Cancel')}</Button>\n          </div>\n        </li>\n      );\n    }\n    return (\n      <li className={item.resolved ? 'seafile-comment-item seafile-comment-item-resolved' : 'seafile-comment-item'} id={item.id}>\n        <div className=\"seafile-comment-info\">\n          {this.renderInfo(item)}\n          <Dropdown isOpen={this.state.dropdownOpen} size=\"sm\" className=\"seafile-comment-dropdown\" toggle={this.toggleDropDownMenu}>\n            <DropdownToggle className=\"seafile-comment-dropdown-btn\"><i className=\"fas fa-ellipsis-v\"></i></DropdownToggle>\n            <DropdownMenu>\n              {item.user_email === username &&\n                <DropdownItem onClick={this.props.deleteComment} className=\"delete-comment\" id={item.id}>{gettext('Delete')}</DropdownItem>\n              }\n              {item.user_email === username &&\n                <DropdownItem onClick={this.toggleEditComment} className=\"edit-comment\" id={item.id}>{gettext('Edit')}</DropdownItem>\n              }\n              {!item.resolved &&\n                <DropdownItem onClick={this.props.resolveComment} className=\"seafile-comment-resolved\"\n                  id={item.id}>{gettext('Mark as resolved')}</DropdownItem>\n              }\n            </DropdownMenu>\n          </Dropdown>\n        </div>\n        <div\n          className=\"seafile-comment-content\"\n          dangerouslySetInnerHTML={{ __html: this.state.html }}\n          onClick={e => this.onCommentClick(e)}\n        ></div>\n      </li>\n    );\n  }\n}\n\nCommentItem.propTypes = commentItemPropTypes;\n\nexport default DetailCommentList;\n","export const EXTRA_ATTRIBUTES_DIALOG_MODAL = 1048;\n","const KeyCodes = {\n  Backspace: 8,\n  Tab: 9,\n  Enter: 13,\n  Shift: 16,\n  Ctrl: 17,\n  Alt: 18,\n  PauseBreak: 19,\n  CapsLock: 20,\n  Escape: 27,\n  Esc: 27,\n  Space: 32,\n  PageUp: 33,\n  PageDown: 34,\n  End: 35,\n  Home: 36,\n  LeftArrow: 37,\n  UpArrow: 38,\n  RightArrow: 39,\n  DownArrow: 40,\n  Insert: 45,\n  Delete: 46,\n  0: 48,\n  1: 49,\n  2: 50,\n  3: 51,\n  4: 52,\n  5: 53,\n  6: 54,\n  7: 55,\n  8: 56,\n  9: 57,\n  a: 65,\n  b: 66,\n  c: 67,\n  d: 68,\n  e: 69,\n  f: 70,\n  g: 71,\n  h: 72,\n  i: 73,\n  j: 74,\n  k: 75,\n  l: 76,\n  m: 77,\n  n: 78,\n  o: 79,\n  p: 80,\n  q: 81,\n  r: 82,\n  s: 83,\n  t: 84,\n  u: 85,\n  v: 86,\n  w: 87,\n  x: 88,\n  y: 89,\n  z: 90,\n  LeftWindowKey: 91,\n  RightWindowKey: 92,\n  SelectKey: 93,\n  NumPad0: 96,\n  NumPad1: 97,\n  NumPad2: 98,\n  NumPad3: 99,\n  NumPad4: 100,\n  NumPad5: 101,\n  NumPad6: 102,\n  NumPad7: 103,\n  NumPad8: 104,\n  NumPad9: 105,\n  Multiply: 106,\n  Add: 107,\n  Subtract: 109,\n  DecimalPoint: 110,\n  Divide: 111,\n  F1: 112,\n  F2: 113,\n  F3: 114,\n  F4: 115,\n  F5: 116,\n  F6: 117,\n  F7: 118,\n  F8: 119,\n  F9: 120,\n  F10: 121,\n  F12: 123,\n  NumLock: 144,\n  ScrollLock: 145,\n  SemiColon: 186,\n  EqualSign: 187,\n  Comma: 188,\n  Dash: 189,\n  Period: 190,\n  ForwardSlash: 191,\n  GraveAccent: 192,\n  OpenBracket: 219,\n  BackSlash: 220,\n  CloseBracket: 221,\n  SingleQuote: 222,\n  ChineseInputMethod: 229,\n};\n\nexport default KeyCodes;\n","import * as zIndexes from './zIndexes';\nimport KeyCodes from './keyCodes';\n\nexport const DIALOG_MAX_HEIGHT = window.innerHeight - 56; // Dialog margin is 3.5rem (56px)\n\nexport const EXTRA_ATTRIBUTES_COLUMN_TYPE = {\n  TEXT: 'text',\n  NUMBER: 'number',\n  DATE: 'date',\n  FORMULA: 'formula',\n  SINGLE_SELECT: 'single-select',\n  CTIME: 'ctime',\n  MTIME: 'mtime'\n};\n\nexport const EXTRA_ATTRIBUTES_NOT_DISPLAY_COLUMN_KEY = [\n  '_id',\n  '_locked',\n  '_locked_by',\n  '_archived',\n  '_creator',\n  '_last_modifier',\n  '_ctime',\n  '_mtime',\n];\n\nexport const EXTRA_ATTRIBUTES_NOT_DISPLAY_COLUMN_NAME = [\n  'Repo ID',\n  'UUID',\n];\n\nexport const FORMULA_RESULT_TYPE = {\n  NUMBER: 'number',\n  STRING: 'string',\n  DATE: 'date',\n  BOOL: 'bool',\n  ARRAY: 'array',\n};\n\nexport const DELETED_OPTION_BACKGROUND_COLOR = '#eaeaea';\n\nexport const DELETED_OPTION_TIPS = 'Deleted option';\n\nexport const DEFAULT_NUMBER_FORMAT = 'number';\n\nexport const ERROR = 'ERROR';\nexport const ERROR_DIV_ZERO = 'DIV/0';\nexport const ERROR_NAME = 'NAME';\nexport const ERROR_NOT_AVAILABLE = 'N/A';\nexport const ERROR_NULL = 'NULL';\nexport const ERROR_NUM = 'NUM';\nexport const ERROR_REF = 'REF';\nexport const ERROR_VALUE = 'VALUE';\nexport const GETTING_DATA = 'GETTING_DATA';\n\nconst errors = {\n  [ERROR]: '#ERROR!',\n  [ERROR_DIV_ZERO]: '#DIV/0!',\n  [ERROR_NAME]: '#NAME?',\n  [ERROR_NOT_AVAILABLE]: '#N/A',\n  [ERROR_NULL]: '#NULL!',\n  [ERROR_NUM]: '#NUM!',\n  [ERROR_REF]: '#REF!',\n  [ERROR_VALUE]: '#VALUE!',\n  [GETTING_DATA]: '#GETTING_DATA',\n};\n\nexport const DISPLAY_INTERNAL_ERRORS = [\n  errors[ERROR],\n  errors[ERROR_DIV_ZERO],\n  errors[ERROR_NAME],\n  errors[ERROR_NOT_AVAILABLE],\n  errors[ERROR_NULL],\n  errors[ERROR_NUM],\n  errors[ERROR_REF],\n  errors[ERROR_VALUE],\n  errors[GETTING_DATA],\n];\n\nexport const DURATION_FORMATS_MAP = {\n  H_MM: 'h:mm',\n  H_MM_SS: 'h:mm:ss',\n  H_MM_SS_S: 'h:mm:ss.s',\n  H_MM_SS_SS: 'h:mm:ss.ss',\n  H_MM_SS_SSS: 'h:mm:ss.sss'\n};\n\nexport const DURATION_FORMATS = [\n  { name: DURATION_FORMATS_MAP.H_MM, type: DURATION_FORMATS_MAP.H_MM },\n  { name: DURATION_FORMATS_MAP.H_MM_SS, type: DURATION_FORMATS_MAP.H_MM_SS }\n];\n\nexport const DURATION_ZERO_DISPLAY = {\n  [DURATION_FORMATS_MAP.H_MM]: '0:00',\n  [DURATION_FORMATS_MAP.H_MM_SS]: '0:00',\n  [DURATION_FORMATS_MAP.H_MM_SS_S]: '0:00.0',\n  [DURATION_FORMATS_MAP.H_MM_SS_SS]: '0:00.00',\n  [DURATION_FORMATS_MAP.H_MM_SS_SSS]: '0:00.000',\n};\n\nexport const DURATION_DECIMAL_DIGITS = {\n  [DURATION_FORMATS_MAP.H_MM]: 0,\n  [DURATION_FORMATS_MAP.H_MM_SS]: 0,\n  [DURATION_FORMATS_MAP.H_MM_SS_S]: 1,\n  [DURATION_FORMATS_MAP.H_MM_SS_SS]: 2,\n  [DURATION_FORMATS_MAP.H_MM_SS_SSS]: 3,\n};\n\nexport {\n  KeyCodes,\n  zIndexes,\n};\n","/**\n * @desc Solve the problem of floating calculation, avoid multiple digits after the decimal point and loss of calculation accuracy.\n * example: 3 + 2.4 = 4.6999999999999991.0 - 0.9 = 0.09999999999999998\n */\n\n/**\n * Correct wrong data\n * strip(0.09999999999999998)=0.1\n */\nfunction strip(num, precision = 12) {\n  return +parseFloat(num.toPrecision(precision));\n}\n\n/**\n * Return digits length of a number\n * @param {*number} num Input number\n */\nfunction digitLength(num) {\n  // Get digit length of e\n  const eSplit = num.toString().split(/[eE]/);\n  const len = (eSplit[0].split('.')[1] || '').length - (+(eSplit[1] || 0));\n  return len > 0 ? len : 0;\n}\n\n/**\n * Convert decimals to integers and support scientific notation. If it is a decimal, it is enlarged to an integer\n * @param {*number} num Number of inputs\n */\nfunction float2Fixed(num) {\n  if (num.toString().indexOf('e') === -1) {\n    return Number(num.toString().replace('.', ''));\n  }\n  const dLen = digitLength(num);\n  return dLen > 0 ? strip(num * Math.pow(10, dLen)) : num;\n}\n\n/**\n * Check whether the number is out of range, and give a prompt if it is out of range\n * @param {*number} num Number of inputs\n */\nfunction checkBoundary(num) {\n  if (_boundaryCheckingState) {\n    if (num > Number.MAX_SAFE_INTEGER || num < Number.MIN_SAFE_INTEGER) {\n      // eslint-disable-next-line no-console\n      console.warn(`${num} is beyond boundary when transfer to integer, the results may not be accurate`);\n    }\n  }\n}\n\n/**\n * Exact multiplication\n */\nfunction times(num1, num2, ...others) {\n  if (others.length > 0) {\n    return times(times(num1, num2), others[0], ...others.slice(1));\n  }\n  const num1Changed = float2Fixed(num1);\n  const num2Changed = float2Fixed(num2);\n  const baseNum = digitLength(num1) + digitLength(num2);\n  const leftValue = num1Changed * num2Changed;\n\n  checkBoundary(leftValue);\n\n  return leftValue / Math.pow(10, baseNum);\n}\n\n/**\n * Exact addition\n */\nfunction plus(num1, num2, ...others) {\n  if (others.length > 0) {\n    return plus(plus(num1, num2), others[0], ...others.slice(1));\n  }\n  const baseNum = Math.pow(10, Math.max(digitLength(num1), digitLength(num2)));\n  return (times(num1, baseNum) + times(num2, baseNum)) / baseNum;\n}\n\n/**\n * Exact subtraction\n */\nfunction minus(num1, num2, ...others) {\n  if (others.length > 0) {\n    return minus(minus(num1, num2), others[0], ...others.slice(1));\n  }\n  const baseNum = Math.pow(10, Math.max(digitLength(num1), digitLength(num2)));\n  return (times(num1, baseNum) - times(num2, baseNum)) / baseNum;\n}\n\n/**\n * Exact division\n */\nfunction divide(num1, num2, ...others) {\n  if (others.length > 0) {\n    return divide(divide(num1, num2), others[0], ...others.slice(1));\n  }\n  const num1Changed = float2Fixed(num1);\n  const num2Changed = float2Fixed(num2);\n  checkBoundary(num1Changed);\n  checkBoundary(num2Changed);\n  // fix: Similar to 10 ** -4 is 0.00009999999999999999, strip correction\n  return times((num1Changed / num2Changed), strip(Math.pow(10, digitLength(num2) - digitLength(num1))));\n}\n\n/**\n * rounding\n */\nfunction round(num, ratio) {\n  const base = Math.pow(10, ratio);\n  return divide(Math.round(times(num, base)), base);\n}\n\nlet _boundaryCheckingState = true;\n/**\n * Whether to perform boundary check, default true\n * @param flag Mark switch, true is on, false is off, default is true\n */\nfunction enableBoundaryChecking(flag = true) {\n  _boundaryCheckingState = flag;\n}\nexport { strip, plus, minus, times, divide, round, digitLength, float2Fixed, enableBoundaryChecking };\nexport default { strip, plus, minus, times, divide, round, digitLength, float2Fixed, enableBoundaryChecking };\n\n","import moment from 'moment';\nimport { EXTRA_ATTRIBUTES_NOT_DISPLAY_COLUMN_KEY, DEFAULT_NUMBER_FORMAT, DISPLAY_INTERNAL_ERRORS, DURATION_FORMATS_MAP,\n  DURATION_FORMATS, DURATION_ZERO_DISPLAY, DURATION_DECIMAL_DIGITS, EXTRA_ATTRIBUTES_NOT_DISPLAY_COLUMN_NAME } from '../constants';\nimport NP from './number-precision';\n\nNP.enableBoundaryChecking(false);\n\nexport const getValidColumns = (columns, editableColumns = [], isEmptyFile = false) => {\n  if (!Array.isArray(columns) || columns.length === 0) return [];\n  return columns\n    .map(column => {\n      let validColumn = column;\n      const canEdit = isEmptyFile ? false : editableColumns.includes(column.name);\n      if (column.type === 'single-select') {\n        if (!(column.data && column.data.options)) {\n          validColumn.data = { options: [] };\n        }\n      }\n      validColumn.editable = canEdit;\n      return validColumn;\n    })\n    .filter(column => !EXTRA_ATTRIBUTES_NOT_DISPLAY_COLUMN_KEY.includes(column.key))\n    .filter(column => !EXTRA_ATTRIBUTES_NOT_DISPLAY_COLUMN_NAME.includes(column.name));\n};\n\nexport const getDateDisplayString = (value, format) => {\n  if (value === '' || !value || typeof value !== 'string') {\n    return '';\n  }\n  // Compatible with older versions: if format is null, use defaultFormat\n  const validValue = value.replace(/-/g, '/').replace('T', ' ').replace('Z', '');\n  const date = moment(validValue);\n\n  if (!date.isValid()) return value;\n  switch(format) {\n    case 'D/M/YYYY':\n    case 'DD/MM/YYYY': {\n      const formatValue = date.format('YYYY-MM-DD');\n      const formatValueList = formatValue.split('-');\n      return `${formatValueList[2]}/${formatValueList[1]}/${formatValueList[0]}`;\n    }\n    case 'D/M/YYYY HH:mm':\n    case 'DD/MM/YYYY HH:mm': {\n      const formatValues = date.format('YYYY-MM-DD HH:mm');\n      const formatValuesList = formatValues.split(' ');\n      const formatDateList = formatValuesList[0].split('-');\n      return `${formatDateList[2]}/${formatDateList[1]}/${formatDateList[0]} ${formatValuesList[1]}`;\n    }\n    case 'M/D/YYYY':\n      return date.format('M/D/YYYY');\n    case 'M/D/YYYY HH:mm':\n      return date.format('M/D/YYYY HH:mm');\n    case 'YYYY-MM-DD':\n      return date.format('YYYY-MM-DD');\n    case 'YYYY-MM-DD HH:mm':\n      return date.format('YYYY-MM-DD HH:mm');\n    case 'YYYY-MM-DD HH:mm:ss': {\n      return date.format('YYYY-MM-DD HH:mm:ss');\n    }\n    case 'DD.MM.YYYY':\n      return date.format('DD.MM.YYYY');\n    case 'DD.MM.YYYY HH:mm':\n      return date.format('DD.MM.YYYY HH:mm');\n    default:\n      return date.format('YYYY-MM-DD');\n  }\n};\n\nexport const getSelectColumnOptions = (column) => {\n  if (!column || !column.data || !Array.isArray(column.data.options)) {\n    return [];\n  }\n  return column.data.options;\n};\n\nconst _getMathRoundedDuration = (num, duration_format) => {\n  const decimalDigits = DURATION_DECIMAL_DIGITS[duration_format];\n  if (decimalDigits < 1) {\n    return num;\n  }\n  const ratio = Math.pow(10, decimalDigits);\n  return Math.round(num * ratio) / ratio;\n};\n\nconst _getDurationDecimalSuffix = (duration_format, decimal) => {\n  if (duration_format === DURATION_FORMATS_MAP.H_MM_SS_S) {\n    return decimal === 0 ? '.0' : '';\n  } else if (duration_format === DURATION_FORMATS_MAP.H_MM_SS_SS) {\n    if (decimal === 0) {\n      return '.00';\n    } else if (decimal < 10) {\n      return '0';\n    }\n  } else if (duration_format === DURATION_FORMATS_MAP.H_MM_SS_SSS) {\n    if (decimal === 0) {\n      return '.000';\n    } else if (decimal < 10) {\n      return '00';\n    } else if (decimal < 100) {\n      return '0';\n    }\n  }\n  return '';\n};\n\nexport const getDurationDisplayString = (value, data) => {\n  if (!value && value !== 0) return '';\n  let { duration_format } = data || {};\n  duration_format = duration_format || DURATION_FORMATS_MAP.H_MM;\n  if (DURATION_FORMATS.findIndex((format) => format.type === duration_format) < 0) {\n    return '';\n  }\n  if (value === 0) {\n    return DURATION_ZERO_DISPLAY[duration_format];\n  }\n  const includeDecimal = duration_format.indexOf('.') > -1;\n  let positiveValue = Math.abs(value);\n  if (!includeDecimal) {\n    positiveValue = Math.round(positiveValue);\n  }\n\n  positiveValue = _getMathRoundedDuration(positiveValue, duration_format);\n  const decimalParts = (positiveValue + '').split('.');\n  const decimalPartsLen = decimalParts.length;\n  let decimal = 0;\n  if (decimalPartsLen > 1) {\n    decimal = decimalParts[decimalPartsLen - 1];\n    decimal = decimal ? decimal - 0 : 0;\n  }\n  const decimalDigits = DURATION_DECIMAL_DIGITS[duration_format];\n  const decimalSuffix = _getDurationDecimalSuffix(duration_format, decimal);\n  let displayString = value < 0 ? '-' : '';\n  let hours = parseInt(positiveValue / 3600);\n  let minutes = parseInt((positiveValue - hours * 3600) / 60);\n  if (duration_format === DURATION_FORMATS_MAP.H_MM) {\n    displayString += `${hours}:${minutes > 9 ? minutes : '0' + minutes}`;\n    return displayString;\n  }\n  let seconds = Number.parseFloat((positiveValue - hours * 3600 - minutes * 60).toFixed(decimalDigits));\n  minutes = minutes > 9 ? minutes : `0${minutes}`;\n  seconds = seconds > 9 ? seconds : `0${seconds}`;\n  displayString += `${hours}:${minutes}:${seconds}${decimalSuffix}`;\n  return displayString;\n};\n\nconst _separatorMap = {\n  'comma': ',',\n  'dot': '.',\n  'no': '',\n  'space': ' ',\n};\n\nconst _toThousands = (num, isCurrency, formatData) => {\n  let { decimal = 'dot', thousands = 'no', precision = 2, enable_precision = false } = formatData || {};\n  const decimalString = _separatorMap[decimal];\n  const thousandsString = _separatorMap[thousands];\n  if ((num + '').indexOf('e') > -1) {\n    if (num < 1 && num > -1) {\n      // 1.convert to non-scientific number\n      let numericString = num.toFixed(enable_precision ? precision : 8);\n\n      // 2.remove 0 from end of the number which not set precision. e.g. 0.100000\n      if (!enable_precision) {\n        numericString = removeZerosFromEnd(numericString);\n      }\n\n      // 3.remove minus from number which equal to 0. e.g. '-0.00'\n      if (parseFloat(numericString) === 0) {\n        return numericString.startsWith('-') ? numericString.substring(1) : numericString;\n      }\n      return numericString;\n    }\n    return num;\n  }\n  const decimalDigits = enable_precision ? precision : _getDecimalDigits(num);\n  let value = parseFloat(num.toFixed(decimalDigits));\n  const isMinus = value < 0;\n  let integer = Math.trunc(value);\n  // format decimal value\n  let decimalValue = String(Math.abs(NP.minus(value, integer)).toFixed(decimalDigits)).slice(1);\n  if (!enable_precision) {\n    decimalValue = removeZerosFromEnd(decimalValue);\n  }\n  if (isCurrency) {\n    if (!enable_precision) {\n      if (decimalValue.length === 2) {\n        decimalValue = decimalValue.padEnd(3, '0');\n      } else {\n        decimalValue = (decimalValue.substring(0, 3) || '.').padEnd(3, '0');\n      }\n    }\n  }\n  decimalValue = decimalValue.replace(/./, decimalString);\n  // format integer value\n  let result = [], counter = 0;\n  integer = Math.abs(integer).toString();\n  for (var i = integer.length - 1; i >= 0; i--) {\n    counter++;\n    result.unshift(integer[i]);\n    if (!(counter % 3) && i !== 0) {\n      result.unshift(thousandsString);\n    }\n  }\n  return (isMinus ? '-' : '') + result.join('') + decimalValue;\n};\n\nconst _getDecimalDigits = (num) => {\n  if (Number.isInteger(num)) {\n    return 0;\n  }\n  let valueArr = (num + '').split('.');\n  let digitsLength = valueArr[1] ? valueArr[1].length : 8;\n  return digitsLength > 8 ? 8 : digitsLength;\n};\n\n/**\n * @param {string} value\n * e.g. removeZerosFromEnd('0.0100') // '0.01'\n */\nconst removeZerosFromEnd = (value) => {\n  if (value.endsWith('0')) {\n    return value.replace(/(?:\\.0*|(\\.\\d+?)0+)$/, '$1');\n  }\n  return value;\n};\n\nexport const getPrecisionNumber = (num, formatData) => {\n  let { precision = 2, enable_precision = false } = formatData || {};\n  let type = Object.prototype.toString.call(num);\n  if (type !== '[object Number]') {\n    if (type === '[object String]' && DISPLAY_INTERNAL_ERRORS.includes(num)) {\n      return num;\n    }\n    return null;\n  }\n  let decimalDigits = enable_precision ? precision : _getDecimalDigits(num);\n  return num.toFixed(decimalDigits);\n};\n\nexport const getNumberDisplayString = (value, formatData) => {\n  // formatData: old version maybe 'null'\n  const type = Object.prototype.toString.call(value);\n  if (type !== '[object Number]') {\n    // return formula internal errors directly.\n    if (type === '[object String]' && value.startsWith('#')) {\n      return value;\n    }\n    return '';\n  }\n  if (isNaN(value) || value === Infinity || value === -Infinity) return value + '';\n  const { format = DEFAULT_NUMBER_FORMAT } = formatData || {};\n  switch(format) {\n    case 'number': {\n      return _toThousands(value, false, formatData);\n    }\n    case 'percent': {\n      return `${_toThousands(Number.parseFloat((value * 100).toFixed(8)), false, formatData)}%`;\n    }\n    case 'yuan': {\n      return `${_toThousands(value, true, formatData)}`;\n    }\n    case 'dollar': {\n      return `$${_toThousands(value, true, formatData)}`;\n    }\n    case 'euro': {\n      return `${_toThousands(value, true, formatData)}`;\n    }\n    case 'duration': {\n      return getDurationDisplayString(value, formatData);\n    }\n    case 'custom_currency': {\n      if (formatData.currency_symbol_position === 'after') {\n        return `${_toThousands(value, true, formatData)}${formatData.currency_symbol || ''}`;\n      } else {\n        return `${formatData.currency_symbol || ''}${_toThousands(value, true, formatData)}`;\n      }\n    }\n    default:\n      return '' + value;\n  }\n};\n\nexport const replaceNumberNotAllowInput = (value, format = DEFAULT_NUMBER_FORMAT, currency_symbol = null) => {\n  if (!value) {\n    return '';\n  }\n  value = value.replace(//g, '.');\n  switch(format) {\n    case 'number': {\n      return value.replace(/[^.-\\d,]/g,'');\n    }\n    case 'percent': {\n      return value.replace(/[^.-\\d,%]/g, '');\n    }\n    case 'yuan': {\n      return value.replace(/[^.-\\d,]/g, '');\n    }\n    case 'dollar': {\n      return value.replace(/[^.-\\d$,]/g, '');\n    }\n    case 'euro': {\n      return value.replace(/[^.-\\d,]/g, '');\n    }\n    case 'custom_currency': {\n      // eslint-disable-next-line\n      const reg = new RegExp('[^.-\\d' + currency_symbol + ',]', 'g');\n      return value.replace(reg, '');\n    }\n    default:\n      return value.replace(/[^.-\\d,]/g, '');\n  }\n};\n\nexport const getFloatNumber = (data, format) =>  {\n  if (!data && data !== 0) {\n    return null;\n  }\n  let newData = parseFloat(data.replace(/[^.-\\d]/g, ''));\n  if (format === 'percent' && !isNaN(newData)) {\n    return NP.divide(newData, 100);\n  }\n  return isNaN(newData) ? null : newData;\n};\n\nexport const formatStringToNumber = (numberString, formatData) => {\n  let { format, decimal, thousands, enable_precision, precision } = formatData || {};\n  let value = numberString;\n  if (decimal && thousands && decimal === 'comma') {\n    if (thousands === 'dot') {\n      value = value.replace(/,/, '@');\n      value = value.replace(/\\./g, ',');\n      value = value.replace(/@/, '.');\n    } else {\n      value = value.replace(/\\./g, '');\n      value = value.replace(/,/, '.');\n    }\n  }\n  value = getFloatNumber(value, format);\n  if (enable_precision && value) {\n    if (format === 'percent') {\n      precision += 2;\n    }\n    value = Number(parseFloat(value).toFixed(precision));\n  }\n  return value;\n};\n\nexport const isMac = () => {\n  const platform = navigator.platform;\n  return (platform == 'Mac68K') || (platform == 'MacPPC') || (platform == 'Macintosh') || (platform == 'MacIntel');\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Col } from 'reactstrap';\n\nfunction ColumnName(props) {\n  const { column } = props;\n  const { name } = column;\n\n  return (\n    <Col md={3} className=\"d-flex column-name\">\n      <div className=\"w-100 text-truncate\">\n        {name || ''}\n      </div>\n    </Col>\n  );\n}\n\nColumnName.propTypes = {\n  column: PropTypes.object.isRequired,\n};\n\nexport default ColumnName;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { KeyCodes } from '../../../../constants';\n\nclass SimpleText extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      value: props.row[props.column.key] || '',\n    };\n    this.inputRef = React.createRef();\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    const nextValue = nextProps.row[nextProps.column.key];\n    if (nextValue !== this.state.value) {\n      this.setState({ value: nextValue });\n    }\n  }\n\n  blurInput = () => {\n    setTimeout(() => {\n      this.inputRef.current && this.inputRef.current.blur();\n    }, 1);\n  }\n\n  onBlur = () => {\n    let { column, onCommit } = this.props;\n    const updated = {};\n    updated[column.key] = this.state.value.trim();\n    onCommit(updated, column);\n  }\n\n  onChange = (e) => {\n    let value = e.target.value;\n    if (value === this.state.value) return;\n    this.setState({value});\n  }\n\n  onCut = (e) => {\n    e.stopPropagation();\n  }\n\n  onPaste = (e) => {\n    e.stopPropagation();\n  }\n\n  onKeyDown = (e) => {\n    if (e.keyCode === KeyCodes.Esc) {\n      e.stopPropagation();\n      this.blurInput();\n      return;\n    }\n    let { selectionStart, selectionEnd, value } = e.currentTarget;\n    if (\n      (e.keyCode === KeyCodes.ChineseInputMethod) ||\n      (e.keyCode === KeyCodes.LeftArrow && selectionStart === 0) ||\n      (e.keyCode === KeyCodes.RightArrow && selectionEnd === value.length)\n    ) {\n      e.stopPropagation();\n    }\n  }\n\n  render() {\n    const { column } = this.props;\n    const { value } = this.state;\n\n    return (\n      <input\n        type=\"text\"\n        onBlur={this.onBlur}\n        onCut={this.onCut}\n        onPaste={this.onPaste}\n        onChange={this.onChange}\n        className=\"form-control\"\n        value={value || ''}\n        onKeyDown={this.onKeyDown}\n        disabled={!column.editable}\n        ref={this.inputRef}\n      />\n    );\n  }\n}\n\nSimpleText.propTypes = {\n  column: PropTypes.object,\n  row: PropTypes.object,\n  onCommit: PropTypes.func.isRequired,\n};\n\nexport default SimpleText;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { FORMULA_RESULT_TYPE } from '../../../../constants';\nimport { getDateDisplayString } from '../../../../utils/extra-attributes';\n\nfunction FormulaFormatter(props) {\n  const { column, row } = props;\n  const value = row[column.key];\n\n  const { data } = column;\n  const { result_type, format } = data || {};\n  if (result_type === FORMULA_RESULT_TYPE.DATE) {\n    return (\n      <div className=\"form-control disabled\">{getDateDisplayString(value, format)}</div>\n    );\n  }\n  if (result_type === FORMULA_RESULT_TYPE.STRING) {\n    return value;\n  }\n  if (typeof value === 'object') {\n    return null;\n  }\n  return <></>;\n}\n\nFormulaFormatter.propTypes = {\n  column: PropTypes.object,\n  row: PropTypes.object,\n};\n\nexport default FormulaFormatter;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\n\nclass SearchInput extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      searchValue: props.value,\n    };\n    this.isInputtingChinese = false;\n    this.timer = null;\n    this.inputRef = null;\n  }\n\n  componentDidMount() {\n    if (this.props.autoFocus && this.inputRef && this.inputRef !== document.activeElement) {\n      setTimeout(() => {\n        this.inputRef.focus();\n      }, 0);\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.value !== this.props.value) {\n      this.setState({searchValue: nextProps.value});\n    }\n  }\n\n  componentWillUnmount() {\n    this.timer && clearTimeout(this.timer);\n    this.timer = null;\n    this.inputRef = null;\n  }\n\n  onCompositionStart = () => {\n    this.isInputtingChinese = true;\n  }\n\n  onChange = (e) => {\n    this.timer && clearTimeout(this.timer);\n    const { onChange, wait } = this.props;\n    let text = e.target.value;\n    this.setState({searchValue: text || ''}, () => {\n      if (this.isInputtingChinese) return;\n      this.timer = setTimeout(() => {\n        onChange && onChange(this.state.searchValue.trim());\n      }, wait);\n    });\n  }\n\n  onCompositionEnd = (e) => {\n    this.isInputtingChinese = false;\n    this.onChange(e);\n  }\n\n  setFocus = (isSelectAllText) => {\n    if (this.inputRef === document.activeElement) return;\n    this.inputRef.focus();\n    if (isSelectAllText) {\n      const txtLength = this.state.searchValue.length;\n      this.inputRef.setSelectionRange(0, txtLength);\n    }\n  }\n\n  render() {\n    const { placeholder, autoFocus, className, onKeyDown, disabled, style } = this.props;\n    const { searchValue } = this.state;\n\n    return (\n      <input\n        type=\"text\"\n        value={searchValue}\n        className={classnames('form-control', className)}\n        onChange={this.onChange}\n        autoFocus={autoFocus}\n        placeholder={placeholder}\n        onCompositionStart={this.onCompositionStart}\n        onCompositionEnd={this.onCompositionEnd}\n        onKeyDown={onKeyDown}\n        disabled={disabled}\n        style={style}\n        ref={ref => this.inputRef = ref}\n      />\n    );\n  }\n}\n\nSearchInput.propTypes = {\n  placeholder: PropTypes.string,\n  autoFocus: PropTypes.bool,\n  className: PropTypes.string,\n  onChange: PropTypes.func.isRequired,\n  onKeyDown: PropTypes.func,\n  wait: PropTypes.number,\n  disabled: PropTypes.bool,\n  style: PropTypes.object,\n  value: PropTypes.string,\n};\n\nSearchInput.defaultProps = {\n  wait: 100,\n  disabled: false,\n  value: '',\n};\n\nexport default SearchInput;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { UncontrolledPopover } from 'reactstrap';\nimport { gettext } from '../../../../../utils/constants';\nimport SearchInput from '../search-input';\nimport { getSelectColumnOptions } from '../../../../../utils/extra-attributes';\n\nclass SingleSelectEditor extends Component {\n\n  constructor(props) {\n    super(props);\n    const options = this.getSelectColumnOptions(props);\n    this.state = {\n      value: props.row[props.column.key],\n      searchVal: '',\n      highlightIndex: -1,\n      maxItemNum: 0,\n      itemHeight: 0,\n      filteredOptions: options,\n    };\n    this.options = options;\n    this.timer = null;\n    this.editorKey = `single-select-editor-${props.column.key}`;\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    const currentCascadeColumnValue = this.getCascadeColumnValue(this.props);\n    const nextCascadeColumnValue = this.getCascadeColumnValue(nextProps);\n    if (currentCascadeColumnValue !== nextCascadeColumnValue) {\n      this.options = this.getSelectColumnOptions(nextProps);\n      this.setState({ filteredOptions: this.options });\n    }\n  }\n\n  getCascadeColumnValue = (props) => {\n    const { column, row, columns } = props;\n    const { data } = column;\n    const { cascade_column_key } = data || {};\n    if (!cascade_column_key) return '';\n    const cascadeColumn = columns.find(item => item.key === cascade_column_key);\n    if (!cascadeColumn) return '';\n    return row[cascade_column_key];\n  }\n\n  getSelectColumnOptions = (props) => {\n    const { column, row, columns } = props;\n    let options = getSelectColumnOptions(column);\n    const { data } = column;\n    const { cascade_column_key, cascade_settings } = data || {};\n    if (cascade_column_key) {\n      const cascadeColumn = columns.find(item => item.key === cascade_column_key);\n      if (cascadeColumn) {\n        const cascadeColumnValue = row[cascade_column_key];\n        if (!cascadeColumnValue) return [];\n        const cascadeSetting = cascade_settings[cascadeColumnValue];\n        if (!cascadeSetting || !Array.isArray(cascadeSetting) || cascadeSetting.length === 0) return [];\n        return options.filter(option => cascadeSetting.includes(option.id));\n      }\n    }\n    return options;\n  }\n\n  toggle = () => {\n    this.ref.toggle();\n    this.props.onUpdateState();\n  }\n\n  onChangeSearch = (searchVal) => {\n    const { searchVal: oldSearchVal } = this.state;\n    if (oldSearchVal === searchVal) return;\n    const val = searchVal.toLowerCase();\n    const filteredOptions = val ?\n      this.options.filter((item) => item.name && item.name.toLowerCase().indexOf(val) > -1) : this.options;\n    this.setState({ searchVal, filteredOptions });\n  }\n\n  onSelectOption = (optionID) => {\n    const { column } = this.props;\n    this.setState({ value: optionID }, () => {\n      this.props.onCommit({ [column.key]: optionID }, column);\n      this.toggle();\n    });\n  }\n\n  render() {\n    const { value, filteredOptions } = this.state;\n    const { column } = this.props;\n\n    return (\n      <UncontrolledPopover\n        target={this.editorKey}\n        className=\"single-select-editor-popover\"\n        trigger=\"legacy\"\n        placement=\"bottom-start\"\n        hideArrow={true}\n        toggle={this.toggle}\n        ref={ref => this.ref = ref}\n      >\n        <div className=\"single-select-editor-container\">\n          <div className=\"search-single-selects\">\n            <SearchInput\n              placeholder={gettext('Find an option')}\n              onKeyDown={this.onKeyDown}\n              onChange={this.onChangeSearch}\n              autoFocus={true}\n            />\n          </div>\n          <div className=\"single-select-editor-content\">\n            {filteredOptions.map(option => {\n              const isSelected = value === option.id;\n              const style = {\n                backgroundColor: option.color,\n                color: option.textColor || null,\n                maxWidth: Math.max(200 - 62,  column.width ? column.width  -62 : 0)\n              };\n              return (\n                <div className=\"single-select-option-container\" key={option.id} onClick={this.onSelectOption.bind(this, isSelected ? null : option.id)}>\n                  <div className=\"single-select-option\" style={style}>{option.name}</div>\n                  <div className=\"single-select-option-selected\">\n                    {isSelected && (<i ></i>)}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      </UncontrolledPopover>\n    );\n  }\n}\n\nSingleSelectEditor.propTypes = {\n  value: PropTypes.string,\n  row: PropTypes.object,\n  column: PropTypes.object,\n  columns: PropTypes.array,\n  onUpdateState: PropTypes.func,\n  onCommit: PropTypes.func,\n};\n\nexport default SingleSelectEditor;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport { DELETED_OPTION_BACKGROUND_COLOR, DELETED_OPTION_TIPS } from '../../../../../constants';\nimport { gettext } from '../../../../../utils/constants';\nimport SingleSelectEditor from './single-select-editor';\nimport { getSelectColumnOptions } from '../../../../../utils/extra-attributes';\n\nimport './index.css';\n\nclass SingleSelect extends Component {\n\n  constructor(props) {\n    super(props);\n    const { column } = props;\n    this.options = getSelectColumnOptions(column);\n    this.state = {\n      isShowSingleSelect: false,\n    };\n    this.editorKey = `single-select-editor-${column.key}`;\n  }\n\n  updateState = () => {\n    this.setState({ isShowSingleSelect: !this.state.isShowSingleSelect });\n  }\n\n  onCommit = (value, column) => {\n    this.props.onCommit(value, column);\n  }\n\n  render() {\n    const { isShowSingleSelect } = this.state;\n    const { column, row } = this.props;\n    const currentOptionID = row[column.key];\n    const option = this.options.find(option => option.id === currentOptionID);\n    const optionStyle = option ?\n      { backgroundColor: option.color, color: option.textColor || null } :\n      { backgroundColor: DELETED_OPTION_BACKGROUND_COLOR };\n    const optionName = option ? option.name : gettext(DELETED_OPTION_TIPS);\n\n    return (\n      <>\n        <div\n          id={this.editorKey}\n          className={classnames('selected-single-select-container', { 'disable': !column.editable, 'focus': isShowSingleSelect })}\n        >\n          <div className=\"single-select-inner w-100 h-100 d-flex align-items-center justify-content-between\">\n            <div>\n              {currentOptionID && (\n                <div\n                  className=\"single-select-option\"\n                  style={optionStyle}\n                  title={optionName}\n                >{optionName}</div>\n              )}\n            </div>\n            {column.editable && (\n              <i className=\"fas fa-caret-down\"></i>\n            )}\n          </div>\n        </div>\n        {column.editable && (\n          <SingleSelectEditor\n            column={column}\n            row={this.props.row}\n            columns={this.props.columns}\n            onCommit={this.onCommit}\n            onUpdateState={this.updateState}\n          />\n        )}\n      </>\n    );\n  }\n}\n\nSingleSelect.propTypes = {\n  column: PropTypes.object,\n  row: PropTypes.object,\n  columns: PropTypes.array,\n  onCommit: PropTypes.func,\n};\n\nexport default SingleSelect;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { getNumberDisplayString, replaceNumberNotAllowInput, formatStringToNumber, isMac } from '../../../../utils/extra-attributes';\nimport { KeyCodes, DEFAULT_NUMBER_FORMAT } from '../../../../constants';\n\nclass NumberEditor extends React.Component {\n\n  constructor(props) {\n    super(props);\n    const { row, column } = props;\n    const value = row[column.key];\n    this.state = {\n      value: getNumberDisplayString(value, column.data),\n    };\n  }\n\n  onChange = (event) => {\n    const { data } = this.props.column; // data maybe 'null'\n    const format = (data && data.format) ? data.format : DEFAULT_NUMBER_FORMAT;\n    let currency_symbol = null;\n    if (data && data.format === 'custom_currency') {\n      currency_symbol = data['currency_symbol'];\n    }\n    const initValue = event.target.value.trim();\n\n    //Prevent the repetition of periods bug in the Chinese input method of the Windows system\n    if (!isMac() && initValue.indexOf('.') > -1) return;\n    let value = replaceNumberNotAllowInput(initValue, format, currency_symbol);\n    if (value === this.state.value) return;\n    this.setState({ value });\n  }\n\n  onKeyDown = (event) => {\n    let { selectionStart, selectionEnd, value } = event.currentTarget;\n    if (event.keyCode === KeyCodes.Enter || event.keyCode === KeyCodes.Esc) {\n      event.preventDefault();\n      this.input.blur();\n    } else if ((event.keyCode === KeyCodes.LeftArrow && selectionStart === 0) ||\n      (event.keyCode === KeyCodes.RightArrow && selectionEnd === value.length)\n    ) {\n      event.stopPropagation();\n    }\n  }\n\n  onBlur = () => {\n    const { value } = this.state;\n    const { column } = this.props;\n    this.props.onCommit({ [column.key]: formatStringToNumber(value, column.data) }, column);\n  }\n\n  setInputRef = (input) => {\n    this.input = input;\n    return this.input;\n  };\n\n  onPaste = (e) => {\n    e.stopPropagation();\n  }\n\n  onCut = (e) => {\n    e.stopPropagation();\n  }\n\n  render() {\n    const { column } = this.props;\n\n    return (\n      <input\n        ref={this.setInputRef}\n        type=\"text\"\n        className=\"form-control\"\n        value={this.state.value}\n        onBlur={this.onBlur}\n        onPaste={this.onPaste}\n        onCut={this.onCut}\n        onKeyDown={this.onKeyDown}\n        onChange={this.onChange}\n        disabled={!column.editable}\n      />\n    );\n  }\n}\n\nNumberEditor.propTypes = {\n  column: PropTypes.object,\n  row: PropTypes.object,\n  onCommit: PropTypes.func,\n};\n\nexport default NumberEditor;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { getDateDisplayString } from '../../../../utils/extra-attributes';\n\n\nclass DateEditor extends Component {\n  render() {\n    const { column, row } = this.props;\n    const { data, key } = column;\n    const value = getDateDisplayString(row[key], data ? data.format : '');\n\n    return (\n      <input\n        type=\"text\"\n        className=\"form-control\"\n        value={value}\n        disabled={true}\n      />\n    );\n  }\n}\n\nDateEditor.propTypes = {\n  column: PropTypes.object,\n  row: PropTypes.object,\n};\n\nexport default DateEditor;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { getDateDisplayString } from '../../../../utils/extra-attributes';\n\nclass CtimeFormatter extends Component {\n  render() {\n    const { column, row } = this.props;\n    const { key } = column;\n    const value = getDateDisplayString(row[key], 'YYYY-MM-DD HH:mm:ss') || '';\n\n    return (\n      <div className=\"form-control\" style={{ width: 320 }}>{value}</div>\n    );\n  }\n}\n\nCtimeFormatter.propTypes = {\n  column: PropTypes.object,\n  row: PropTypes.object,\n};\n\nexport default CtimeFormatter;\n","import SimpleText from './simple-text';\nimport FormulaFormatter from './formula-formatter';\nimport SingleSelect from './single-select';\nimport NumberEditor from './number-editor';\nimport DateEditor from './date-editor';\nimport CtimeFormatter from './ctime-formatter';\nimport { EXTRA_ATTRIBUTES_COLUMN_TYPE } from '../../../../constants';\n\n\nconst CONFIG = {\n  [EXTRA_ATTRIBUTES_COLUMN_TYPE.TEXT]: SimpleText,\n  [EXTRA_ATTRIBUTES_COLUMN_TYPE.FORMULA]: FormulaFormatter,\n  [EXTRA_ATTRIBUTES_COLUMN_TYPE.SINGLE_SELECT]: SingleSelect,\n  [EXTRA_ATTRIBUTES_COLUMN_TYPE.NUMBER]: NumberEditor,\n  [EXTRA_ATTRIBUTES_COLUMN_TYPE.DATE]: DateEditor,\n  [EXTRA_ATTRIBUTES_COLUMN_TYPE.CTIME]: CtimeFormatter,\n  [EXTRA_ATTRIBUTES_COLUMN_TYPE.MTIME]: CtimeFormatter,\n};\n\nexport default CONFIG;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { Col } from 'reactstrap';\nimport ColumnName from './column-name';\nimport CONFIG from '../editor';\n\nimport './index.css';\n\nclass Column extends Component {\n  render() {\n    const { column, row, columns } = this.props;\n    const Editor = CONFIG[column.type] || CONFIG['text'];\n\n    return (\n      <div className=\"pb-4 row column-item\">\n        <ColumnName column={column} />\n        <Col md={9} className='d-flex align-items-center extra-attribute-item-info'>\n          <Editor\n            column={column}\n            row={row}\n            columns={columns}\n            onCommit={this.props.onCommit}\n          />\n        </Col>\n      </div>\n    );\n  }\n}\n\nColumn.propTypes = {\n  column: PropTypes.object,\n  row: PropTypes.object,\n  columns: PropTypes.array,\n  onCommit: PropTypes.func,\n};\n\nexport default Column;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody } from 'reactstrap';\nimport isHotkey from 'is-hotkey';\nimport { zIndexes, DIALOG_MAX_HEIGHT, EXTRA_ATTRIBUTES_COLUMN_TYPE } from '../../../constants';\nimport { gettext } from '../../../utils/constants';\nimport { seafileAPI } from '../../../utils/seafile-api';\nimport { Utils } from '../../../utils/utils';\nimport { getSelectColumnOptions, getValidColumns } from '../../../utils/extra-attributes';\nimport Column from './column';\nimport Loading from '../../loading';\nimport toaster from '../../toast';\n\nimport './index.css';\n\nclass ExtraAttributesDialog extends Component {\n\n  constructor(props) {\n    super(props);\n    const { direntDetail } = props;\n    this.state = {\n      animationEnd: false,\n      isLoading: true,\n      update: {},\n      row: {},\n      columns: [],\n      errorMsg: '',\n    };\n    const direntDetailId = direntDetail.id;\n    this.isEmptyFile = direntDetailId === '0'.repeat(direntDetailId.length);\n    this.isExist = false;\n    this.modalRef = React.createRef();\n  }\n\n  componentDidMount() {\n    this.startAnimation(this.getData);\n    window.addEventListener('keydown', this.onHotKey);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('keydown', this.onHotKey);\n  }\n\n  startAnimation = (callback) => {\n    if (this.state.animationEnd === true) {\n      callback && callback();\n    }\n\n    // use setTimeout to make sure real dom rendered\n    setTimeout(() => {\n      let dom = this.modalRef.current.firstChild;\n      const { width, maxWidth, marginLeft, height } = this.getDialogStyle();\n      dom.style.width = `${width}px`;\n      dom.style.maxWidth = `${maxWidth}px`;\n      dom.style.marginLeft = `${marginLeft}px`;\n      dom.style.height = `${height}px`;\n      dom.style.marginRight = 'unset';\n      dom.style.marginTop = '28px';\n\n      // after animation, change style and run callback\n      setTimeout(() => {\n        this.setState({ animationEnd: true }, () => {\n          dom.style.transition = 'none';\n          callback && callback();\n        });\n      }, 280);\n    }, 1);\n  }\n\n  getFormatUpdateData = (update = {}) => {\n    const { columns } = this.state;\n    const updateData = {};\n    for (let key in update) {\n      const column = columns.find(column => column.key === key);\n      if (column && column.editable) {\n        const { type, name } = column;\n        const value = update[key];\n        if (type === EXTRA_ATTRIBUTES_COLUMN_TYPE.SINGLE_SELECT) {\n          const options = getSelectColumnOptions(column);\n          const option = options.find(item => item.id === value);\n          updateData[name] = option ? option.name : '';\n        } else {\n          updateData[column.name] = update[key];\n        }\n      }\n    }\n    return updateData;\n  }\n\n  getData = () => {\n    const { repoID, filePath } = this.props;\n    seafileAPI.getFileExtendedProperties(repoID, filePath).then(res => {\n      const { row, metadata, editable_columns } = res.data;\n      this.isExist = Boolean(row._id);\n      this.setState({ row: row, columns: getValidColumns(metadata, editable_columns, this.isEmptyFile), isLoading: false, errorMsg: '' });\n    }).catch(error => {\n      const errorMsg =Utils.getErrorMsg(error);\n      this.setState({ isLoading: false, errorMsg });\n    });\n  }\n\n  createData = (data) => {\n    const { repoID, filePath } = this.props;\n    seafileAPI.newFileExtendedProperties(repoID, filePath, data).then(res => {\n      this.isExist = true;\n      const { row } = res.data;\n      this.setState({ row: row, isLoading: false, errorMsg: '' });\n    }).catch(error => {\n      const errorMsg =Utils.getErrorMsg(error);\n      toaster.danger(gettext(errorMsg));\n    });\n  };\n\n  updateData = (update, column) => {\n    const newRow = { ...this.state.row, ...update };\n    this.setState({ row: newRow }, () => {\n      const data = this.getFormatUpdateData(update);\n      const { repoID, filePath } = this.props;\n      if (this.isExist) {\n        seafileAPI.updateFileExtendedProperties(repoID, filePath, data).then(res => {\n          this.setState({ update: {}, row: res.data.row });\n        }).catch(error => {\n          const errorMsg = Utils.getErrorMsg(error);\n          toaster.danger(gettext(errorMsg));\n        });\n      } else {\n        this.createData(data);\n      }\n    });\n  }\n\n  onHotKey = (event) => {\n    if (isHotkey('esc', event)) {\n      this.onToggle();\n      return;\n    }\n  }\n\n  onToggle = () => {\n    this.props.onToggle();\n  }\n\n  getDialogStyle = () => {\n    const width = 800;\n    return {\n      width,\n      maxWidth: width,\n      marginLeft: (window.innerWidth - width) / 2,\n      height: DIALOG_MAX_HEIGHT,\n    };\n  }\n\n  getInitStyle = () => {\n    const transition = 'all .3s';\n    const defaultMargin = 80; // sequence cell width\n    const defaultHeight = 100;\n    const marginTop = '30%';\n    const width = window.innerWidth;\n    return {\n      width: `${width - defaultMargin}px`,\n      maxWidth: `${width - defaultMargin}px`,\n      marginLeft: `${defaultMargin}px`,\n      height: `${defaultHeight}px`,\n      marginRight: `${defaultMargin}px`,\n      marginTop,\n      transition,\n    };\n  }\n\n  renderColumns = () => {\n    const { isLoading, errorMsg, columns, row, update } = this.state;\n    if (isLoading) {\n      return (\n        <div className=\"w-100 h-100 d-flex align-items-center justify-content-center\">\n          <Loading />\n        </div>\n      );\n    }\n\n    if (errorMsg) {\n      return (\n        <div className=\"w-100 h-100 d-flex align-items-center justify-content-center error-message\">\n          {gettext(errorMsg)}\n        </div>\n      );\n    }\n\n    const newRow = { ...row, ...update };\n\n    return (\n      <>\n        {columns.map(column => {\n          return (\n            <Column\n              key={column.key}\n              column={column}\n              row={newRow}\n              columns={columns}\n              onCommit={this.updateData}\n            />\n          );\n        })}\n      </>\n    );\n\n  }\n\n  renderContent = () => {\n    if (!this.state.animationEnd) return null;\n\n    return (\n      <>\n        <ModalHeader toggle={this.onToggle}>{gettext('Edit extra attributes')}</ModalHeader>\n        <ModalBody>\n          {this.renderColumns()}\n        </ModalBody>\n      </>\n    );\n  }\n\n  render() {\n    const { animationEnd } = this.state;\n\n    return (\n      <Modal\n        isOpen={true}\n        className=\"extra-attributes-dialog\"\n        style={animationEnd ? this.getDialogStyle() : this.getInitStyle()}\n        zIndex={zIndexes.EXTRA_ATTRIBUTES_DIALOG_MODAL}\n        contentClassName=\"extra-attributes-content-container\"\n        modalClassName=\"extra-attributes-modal\"\n        wrapClassName=\"extra-attributes\"\n        fade={false}\n        innerRef={this.modalRef}\n        toggle={this.onToggle}\n      >\n        {this.renderContent()}\n      </Modal>\n    );\n  }\n}\n\nExtraAttributesDialog.propTypes = {\n  repoID: PropTypes.string,\n  filePath: PropTypes.string,\n  direntDetail: PropTypes.object,\n  onToggle: PropTypes.func,\n};\n\nexport default ExtraAttributesDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport EditFileTagDialog from '../dialog/edit-filetag-dialog';\nimport ModalPortal from '../modal-portal';\nimport ExtraAttributesDialog from '../dialog/extra-attributes-dialog';\n\nconst propTypes = {\n  repoInfo: PropTypes.object.isRequired,\n  repoID: PropTypes.string.isRequired,\n  dirent: PropTypes.object.isRequired,\n  direntType: PropTypes.string.isRequired,\n  direntDetail: PropTypes.object.isRequired,\n  path: PropTypes.string.isRequired,\n  fileTagList: PropTypes.array.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n};\n\nclass DetailListView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isEditFileTagShow: false,\n      isShowExtraAttributes: false,\n    };\n  }\n\n  getDirentPosition = () => {\n    let { repoInfo } = this.props;\n    let direntPath = this.getDirentPath();\n    let position = repoInfo.repo_name;\n    if (direntPath !== '/') {\n      let index = direntPath.lastIndexOf('/');\n      let path = direntPath.slice(0, index);\n      position = position + path;\n    }\n    return position;\n  }\n\n  onEditFileTagToggle = () => {\n    this.setState({\n      isEditFileTagShow: !this.state.isEditFileTagShow\n    });\n  }\n\n  onFileTagChanged = () => {\n    let direntPath = this.getDirentPath();\n    this.props.onFileTagChanged(this.props.dirent, direntPath);\n  }\n\n  getDirentPath = () => {\n    if (Utils.isMarkdownFile(this.props.path)) {\n      return this.props.path; // column mode: view file\n    }\n    let { dirent, path } = this.props;\n    return Utils.joinPath(path, dirent.name);\n  }\n\n  toggleExtraAttributesDialog = () => {\n    this.setState({ isShowExtraAttributes: !this.state.isShowExtraAttributes });\n  }\n\n  render() {\n    let { direntType, direntDetail, fileTagList } = this.props;\n    let position = this.getDirentPosition();\n    let direntPath = this.getDirentPath();\n    if (direntType === 'dir') {\n      return (\n        <table className=\"table-thead-hidden\">\n          <thead>\n            <tr><th width=\"35%\"></th><th width=\"65%\"></th></tr>\n          </thead>\n          <tbody>\n            <tr><th>{gettext('Location')}</th><td>{position}</td></tr>\n            <tr><th>{gettext('Last Update')}</th><td>{moment(direntDetail.mtime).format('YYYY-MM-DD')}</td></tr>\n          </tbody>\n        </table>\n      );\n    } else {\n      return (\n        <Fragment>\n          <table className=\"table-thead-hidden\">\n            <thead>\n              <tr><th width=\"35%\"></th><th width=\"65%\"></th></tr>\n            </thead>\n            <tbody>\n              <tr><th>{gettext('Size')}</th><td>{Utils.bytesToSize(direntDetail.size)}</td></tr>\n              <tr><th>{gettext('Location')}</th><td>{position}</td></tr>\n              <tr><th>{gettext('Last Update')}</th><td>{moment(direntDetail.last_modified).fromNow()}</td></tr>\n              <tr className=\"file-tag-container\">\n                <th>{gettext('Tags')}</th>\n                <td>\n                  <ul className=\"file-tag-list\">\n                    {fileTagList.map((fileTag) => {\n                      return (\n                        <li key={fileTag.id} className=\"file-tag-item\">\n                          <span className=\"file-tag\" style={{backgroundColor:fileTag.color}}></span>\n                          <span className=\"tag-name\" title={fileTag.name}>{fileTag.name}</span>\n                        </li>\n                      );\n                    })}\n                  </ul>\n                  <i className='fa fa-pencil-alt attr-action-icon' onClick={this.onEditFileTagToggle}></i>\n                </td>\n              </tr>\n              {direntDetail.permission === 'rw' && (\n                <tr className=\"file-extra-attributes\">\n                  <th colSpan={2}>\n                    <div className=\"edit-file-extra-attributes-btn\" onClick={this.toggleExtraAttributesDialog}>\n                      {gettext('Edit extra attributes')}\n                    </div>\n                  </th>\n                </tr>\n              )}\n            </tbody>\n          </table>\n          {this.state.isEditFileTagShow &&\n            <ModalPortal>\n              <EditFileTagDialog\n                repoID={this.props.repoID}\n                fileTagList={fileTagList}\n                filePath={direntPath}\n                toggleCancel={this.onEditFileTagToggle}\n                onFileTagChanged={this.onFileTagChanged}\n              />\n            </ModalPortal>\n          }\n          {this.state.isShowExtraAttributes && (\n            <ExtraAttributesDialog\n              repoID={this.props.repoID}\n              filePath={direntPath}\n              direntDetail={direntDetail}\n              onToggle={this.toggleExtraAttributesDialog}\n            />\n          )}\n        </Fragment>\n      );\n    }\n  }\n}\n\nDetailListView.propTypes = propTypes;\n\nexport default DetailListView;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport { Nav, NavItem, NavLink, TabContent, TabPane } from 'reactstrap';\nimport DetailCommentList from './detail-comments-list';\nimport { siteRoot, enableVideoThumbnail } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport Dirent from '../../models/dirent';\nimport DetailListView from './detail-list-view';\n\nimport '../../css/dirent-detail.css';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  dirent: PropTypes.object,\n  path: PropTypes.string.isRequired,\n  currentRepoInfo: PropTypes.object.isRequired,\n  onItemDetailsClose: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n  direntDetailPanelTab: PropTypes.string,\n};\n\nclass DirentDetail extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      direntType: '',\n      direntDetail: '',\n      folderDirent: null,\n      activeTab: 'info',\n      fileParticipantList: [],\n    };\n  }\n\n  componentWillMount() {\n    if (this.props.direntDetailPanelTab) {\n      this.tabItemClick(this.props.direntDetailPanelTab);\n    }\n  }\n\n  componentDidMount() {\n    let { dirent, path, repoID } = this.props;\n    this.loadDirentInfo(dirent, path, repoID);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    let { dirent, path, repoID } = nextProps;\n    if (this.props.dirent !== nextProps.dirent) {\n      this.loadDirentInfo(dirent, path, repoID);\n    }\n    if (this.props.direntDetailPanelTab) {\n      this.tabItemClick(this.props.direntDetailPanelTab);\n    }\n  }\n\n  loadDirentInfo = (dirent, path, repoID) => {\n    if (dirent) {\n      let direntPath = Utils.joinPath(path, dirent.name);\n      this.updateDetailView(dirent, direntPath);\n    } else {\n      let dirPath = Utils.getDirName(path);\n      seafileAPI.listDir(repoID, dirPath).then(res => {\n        let direntList = res.data.dirent_list;\n        let folderDirent = null;\n        for (let i = 0; i < direntList.length; i++) {\n          let dirent = direntList[i];\n          if (dirent.parent_dir + dirent.name === path) {\n            folderDirent = new Dirent(dirent);\n            break;\n          }\n        }\n        this.setState({folderDirent: folderDirent});\n        this.updateDetailView(folderDirent, path);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  updateDetailView = (dirent, direntPath) => {\n    let repoID = this.props.repoID;\n    if (dirent.type === 'file') {\n      seafileAPI.getFileInfo(repoID, direntPath).then(res => {\n        this.setState({\n          direntType: 'file',\n          direntDetail: res.data,\n        });\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n      this.listParticipants(repoID, direntPath);\n    } else {\n      seafileAPI.getDirInfo(repoID, direntPath).then(res => {\n        this.setState({\n          direntType: 'dir',\n          direntDetail: res.data\n        });\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  listParticipants = (repoID, filePath) => {\n    seafileAPI.listFileParticipants(repoID, filePath).then((res) => {\n      this.setState({ fileParticipantList: res.data.participant_list });\n    });\n  }\n\n  onParticipantsChange = (repoID, filePath) => {\n    this.listParticipants(repoID, filePath);\n  }\n\n  tabItemClick = (tab) => {\n    if (this.state.activeTab !== tab) {\n      this.setState({ activeTab: tab });\n    }\n  }\n\n  renderNavItem = (showTab) => {\n    switch(showTab) {\n      case 'info':\n        return (\n          <NavItem className=\"nav-item w-50\">\n            <NavLink className={classnames({ active: this.state.activeTab === 'info' })} onClick={() => { this.tabItemClick('info');}}>\n              <i className=\"fas fa-info-circle\"></i>\n            </NavLink>\n          </NavItem>\n        );\n      case 'comments':\n        return (\n          <NavItem className=\"nav-item w-50\">\n            <NavLink className={classnames({ active: this.state.activeTab === 'comments' })} onClick={() => {this.tabItemClick('comments');}}>\n              <i className=\"fa fa-comments\"></i>\n            </NavLink>\n          </NavItem>\n        );\n    }\n  }\n\n  renderHeader = (smallIconUrl, direntName) => {\n    return (\n      <div className=\"detail-header\">\n        <div className=\"detail-control sf2-icon-x1\" onClick={this.props.onItemDetailsClose}></div>\n        <div className=\"detail-title dirent-title\">\n          <img src={smallIconUrl} width=\"24\" height=\"24\" alt=\"\" />{' '}\n          <span className=\"name ellipsis\" title={direntName}>{direntName}</span>\n        </div>\n      </div>\n    );\n  }\n\n  renderDetailBody = (bigIconUrl, folderDirent) => {\n    const { dirent, fileTags } = this.props;\n    return (\n      <Fragment>\n        <div className=\"detail-body dirent-info\">\n          <div className=\"img\"><img src={bigIconUrl} className=\"thumbnail\" alt=\"\" /></div>\n          {this.state.direntDetail &&\n            <div className=\"dirent-table-container\">\n              <DetailListView\n                repoInfo={this.props.currentRepoInfo}\n                path={this.props.path}\n                repoID={this.props.repoID}\n                dirent={this.props.dirent || folderDirent}\n                direntType={this.state.direntType}\n                direntDetail={this.state.direntDetail}\n                fileTagList={dirent ? dirent.file_tags : fileTags}\n                onFileTagChanged={this.props.onFileTagChanged}\n              />\n            </div>\n          }\n        </div>\n      </Fragment>\n    );\n  }\n\n  render() {\n    let { dirent, repoID, path } = this.props;\n    let { folderDirent } = this.state;\n    if (!dirent && !folderDirent) {\n      return '';\n    }\n    let smallIconUrl = dirent ? Utils.getDirentIcon(dirent) : Utils.getDirentIcon(folderDirent);\n    let bigIconUrl = dirent ? Utils.getDirentIcon(dirent, true) : Utils.getDirentIcon(folderDirent, true);\n    const isImg = dirent ? Utils.imageCheck(dirent.name) : Utils.imageCheck(folderDirent.name);\n    const isVideo = dirent ? Utils.videoCheck(dirent.name) : Utils.videoCheck(folderDirent.name);\n    if (isImg || (enableVideoThumbnail && isVideo)) {\n      bigIconUrl = `${siteRoot}thumbnail/${repoID}/1024` + Utils.encodePath(`${path === '/' ? '' : path}/${dirent.name}`);\n    }\n    let direntName = dirent ? dirent.name : folderDirent.name;\n\n    if ((dirent && dirent.type === 'file') || path.lastIndexOf('.') > -1) {\n      return (\n        <div className=\"detail-container\">\n          {this.renderHeader(smallIconUrl, direntName)}\n          <Nav tabs className=\"mx-0\">{this.renderNavItem('info')}{this.renderNavItem('comments')}</Nav>\n          <TabContent activeTab={this.state.activeTab} className=\"flex-fill o-auto\">\n            <TabPane tabId=\"info\">{this.renderDetailBody(bigIconUrl, folderDirent)}</TabPane>\n            <TabPane tabId=\"comments\" className=\"comments h-100\">\n              <DetailCommentList\n                repoID={this.props.repoID}\n                filePath={(dirent && dirent.type === 'file') ? Utils.joinPath(path, dirent.name) : path}\n                fileParticipantList={this.state.fileParticipantList}\n                onParticipantsChange={this.onParticipantsChange}\n              />\n            </TabPane>\n          </TabContent>\n        </div>\n      );\n    } else {\n      return (\n        <div className=\"detail-container\">\n          {this.renderHeader(smallIconUrl, direntName)}\n          {this.renderDetailBody(bigIconUrl, folderDirent)}\n        </div>\n      );\n    }\n  }\n}\n\nDirentDetail.propTypes = propTypes;\n\nexport default DirentDetail;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { enableSeadoc, gettext } from '../../utils/constants';\nimport Loading from '../loading';\nimport ModalPortal from '../modal-portal';\nimport CreateFile from '../../components/dialog/create-file-dialog';\n\nimport '../../css/tip-for-new-file.css';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  isDirentListLoading: PropTypes.bool.isRequired,\n  onAddFile: PropTypes.func.isRequired\n};\n\nclass DirentNodeView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      fileType: '',\n      isCreateFileDialogShow: false,\n    };\n  }\n\n  onCreateNewFile = (type) => {\n    this.setState({\n      fileType: type,\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n    });\n  }\n\n  onCreateFileToggle = () => {\n    this.setState({\n      fileType: '',\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n    });\n  }\n\n  checkDuplicatedName = () => {\n    return false; // current repo is null, and unnecessary to check duplicated name\n  }\n\n  render() {\n    if (this.props.isDirentListLoading) {\n      return (<Loading />);\n    }\n\n    return (\n      <Fragment>\n        <div className=\"tip-for-new-file\">\n          <p className=\"text-secondary text-center\">{gettext('This folder has no content at this time.')}</p>\n          <p className=\"text-secondary text-center\">{gettext('You can create files quickly')}{' +'}</p>\n          <button className=\"big-new-file-button\" onClick={this.onCreateNewFile.bind(this, '.md')}>\n            {'+ Markdown'}</button>\n          <button className=\"big-new-file-button\" onClick={this.onCreateNewFile.bind(this, '.pptx')}>\n            {'+ PPT'}</button>\n          <br />\n          <button className=\"big-new-file-button\" onClick={this.onCreateNewFile.bind(this, '.docx')}>\n            {'+ Word'}</button>\n          <button className=\"big-new-file-button\" onClick={this.onCreateNewFile.bind(this, '.xlsx')}>\n            {'+ Excel'}</button>\n          <br />\n          {enableSeadoc && <button className=\"big-new-file-button\" onClick={this.onCreateNewFile.bind(this, '.sdoc')}>\n            {'+ SeaDoc'}</button>}\n        </div>\n        {this.state.isCreateFileDialogShow && (\n          <ModalPortal>\n            <CreateFile\n              parentPath={this.props.path}\n              fileType={this.state.fileType}\n              onAddFile={this.props.onAddFile}\n              toggleDialog={this.onCreateFileToggle}\n              checkDuplicatedName={this.checkDuplicatedName}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nDirentNodeView.propTypes = propTypes;\n\nexport default DirentNodeView;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport MD5 from 'MD5';\nimport moment from 'moment';\nimport { UncontrolledTooltip } from 'reactstrap';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { gettext, siteRoot, mediaUrl, username, useGoFileserver, fileServerRoot } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport URLDecorator from '../../utils/url-decorator';\nimport ItemDropdownMenu from '../dropdown-menu/item-dropdown-menu';\nimport Rename from '../rename';\nimport ModalPortal from '../modal-portal';\nimport MoveDirentDialog from '../dialog/move-dirent-dialog';\nimport CopyDirentDialog from '../dialog/copy-dirent-dialog';\nimport ShareDialog from '../dialog/share-dialog';\nimport ZipDownloadDialog from '../dialog/zip-download-dialog';\nimport EditFileTagDialog from '../dialog/edit-filetag-dialog';\nimport LibSubFolderPermissionDialog from '../dialog/lib-sub-folder-permission-dialog';\n\nimport '../../css/dirent-list-item.css';\nimport toaster from '../toast';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  dirent: PropTypes.object.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  freezeItem: PropTypes.func.isRequired,\n  unfreezeItem: PropTypes.func.isRequired,\n  onItemRenameToggle: PropTypes.func.isRequired,\n  onItemSelected: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func.isRequired,\n  onItemRename: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  onDirentClick: PropTypes.func.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  showImagePopup: PropTypes.func.isRequired,\n  currentRepoInfo: PropTypes.object,\n  isRepoOwner: PropTypes.bool,\n  isAdmin: PropTypes.bool.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  onItemMouseDown: PropTypes.func.isRequired,\n  onItemContextMenu: PropTypes.func.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  activeDirent: PropTypes.object,\n  getDirentItemMenuList: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  showDirentDetail: PropTypes.func.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onShowDirentsDraggablePreview: PropTypes.func,\n};\n\nclass DirentListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    const { dirent } = this.props;\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(dirent.permission);\n    this.isCustomPermission = isCustomPermission;\n    this.customPermission = customPermission;\n    this.canPreview = true;\n    this.canDrag = dirent.permission === 'rw';\n    if (isCustomPermission) {\n      const { preview, modify } = customPermission.permission;\n      this.canPreview = preview || modify;\n      this.canDrag = modify;\n    }\n\n    this.state = {\n      isOperationShow: false,\n      highlight: false,\n      isZipDialogOpen: false,\n      isMoveDialogShow: false,\n      isCopyDialogShow: false,\n      isShareDialogShow: false,\n      isMutipleOperation: false,\n      canDrag: this.canDrag,\n      isShowTagTooltip: false,\n      isDragTipShow: false,\n      isDropTipshow: false,\n      isEditFileTagShow: false,\n      isPermissionDialogOpen: false,\n      isOpMenuOpen: false // for mobile\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.isItemFreezed !== this.props.isItemFreezed && !nextProps.isItemFreezed) {\n      this.setState({\n        highlight: false,\n        isOperationShow: false,\n      }, () => {\n        if (nextProps.activeDirent && nextProps.activeDirent.name === nextProps.dirent.name) {\n          this.setState({isOperationShow: true});\n        }\n      });\n    }\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  //UI Interactive\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: true,\n        isOperationShow: true,\n      });\n    }\n    if (this.state.canDrag) {\n      this.setState({isDragTipShow: true});\n    }\n  }\n\n  onMouseOver = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: true,\n        isOperationShow: true,\n      });\n    }\n    if (this.state.canDrag) {\n      this.setState({isDragTipShow: true});\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: false,\n        isOperationShow: false,\n      });\n    }\n    this.setState({isDragTipShow: false});\n  }\n\n  unfreezeItem = () => {\n    this.setState({\n      highlight: false,\n      isOperationShow: false,\n    });\n    this.props.unfreezeItem();\n  }\n\n  //buiness handler\n  onItemSelected = () => {\n    this.props.onItemSelected(this.props.dirent);\n  }\n\n  onItemStarred = (e) => {\n    let dirent = this.props.dirent;\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(dirent);\n\n    e.preventDefault();\n\n    if (dirent.starred) {\n      seafileAPI.unstarItem(repoID, filePath).then(() => {\n        this.props.updateDirent(this.props.dirent, 'starred', false);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      seafileAPI.starItem(repoID, filePath).then(() => {\n        this.props.updateDirent(this.props.dirent, 'starred', true);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  // on '<tr>'\n  onDirentClick = (e) => {\n    // '<td>' is clicked\n    e.stopPropagation();\n    if (e.target.tagName == 'TD') {\n      this.props.onDirentClick(this.props.dirent);\n    }\n  }\n\n  onItemClick = (e) => {\n    e.preventDefault();\n    const dirent = this.props.dirent;\n    if (this.state.isRenameing) {\n      return;\n    }\n\n    if (dirent.isDir()) {\n      this.props.onItemClick(dirent);\n      return;\n    }\n\n    if (!this.canPreview) {\n      return;\n    }\n\n    if (Utils.imageCheck(dirent.name)) {\n      this.props.showImagePopup(dirent);\n    } else {\n      this.props.onItemClick(dirent);\n    }\n  }\n\n  onItemDelete = (e) => {\n    e.preventDefault();\n    e.nativeEvent.stopImmediatePropagation(); //for document event\n    this.props.onItemDelete(this.props.dirent);\n  }\n\n  onItemShare = (e) => {\n    e.preventDefault();\n    e.nativeEvent.stopImmediatePropagation(); //for document event\n    this.setState({isShareDialogShow: !this.state.isShareDialogShow});\n  }\n\n  closeSharedDialog = () => {\n    this.setState({isShareDialogShow: !this.state.isShareDialogShow});\n  }\n\n  onMobileMenuItemClick = (e) => {\n    const operation = e.target.getAttribute('data-op');\n    this.onMenuItemClick(operation, e);\n  }\n\n  onMenuItemClick = (operation, event) => {\n    switch(operation) {\n      case 'Download':\n        this.onItemDownload(event);\n        break;\n      case 'Share':\n        this.onItemShare(event);\n        break;\n      case 'Delete':\n        this.onItemDelete(event);\n        break;\n      case 'Rename':\n        this.onItemRenameToggle();\n        break;\n      case 'Move':\n        this.onItemMoveToggle();\n        break;\n      case 'Copy':\n        this.onItemCopyToggle();\n        break;\n      case 'Tags':\n        this.onEditFileTagToggle();\n        break;\n      case 'Permission':\n        this.onPermissionItem();\n        break;\n      case 'Unlock':\n        this.onUnlockItem();\n        break;\n      case 'Lock':\n        this.onLockItem();\n        break;\n      case 'Mark as draft':\n        this.onMarkAsDraft();\n        break;\n      case 'Unmark as draft':\n        this.onUnmarkAsDraft();\n        break;\n      case 'List revisions':\n        this.openRevisionsPage();\n        break;\n      case 'Comment':\n        this.props.onDirentClick(this.props.dirent);\n        this.props.showDirentDetail('comments');\n        break;\n      case 'History':\n        this.onHistory();\n        break;\n      case 'Access Log':\n        this.onAccessLog();\n        break;\n      case 'Properties':\n        this.props.onDirentClick(this.props.dirent);\n        this.props.showDirentDetail('info');\n        break;\n      case 'Open via Client':\n        this.onOpenViaClient();\n        break;\n      case 'Convert with ONLYOFFICE':\n        this.onConvertWithONLYOFFICE();\n        break;\n      default:\n        break;\n    }\n  }\n\n  onEditFileTagToggle = () => {\n    this.setState({\n      isEditFileTagShow: !this.state.isEditFileTagShow\n    });\n  }\n\n  onFileTagChanged = () => {\n    let direntPath = this.getDirentPath(this.props.dirent);\n    this.props.onFileTagChanged(this.props.dirent, direntPath);\n  }\n\n  onItemRenameToggle = () => {\n    this.props.onItemRenameToggle(this.props.dirent);\n    this.setState({\n      isOperationShow: false,\n      isRenameing: true,\n      canDrag: false\n    });\n  }\n\n  onRenameConfirm = (newName) => {\n    this.props.onItemRename(this.props.dirent, newName);\n    this.onRenameCancel();\n  }\n\n  onRenameCancel = () => {\n    this.setState({\n      isRenameing: false,\n      canDrag: this.canDrag // set it back to the initial value\n    });\n    this.unfreezeItem();\n  }\n\n  onItemMoveToggle = () => {\n    this.setState({isMoveDialogShow: !this.state.isMoveDialogShow});\n  }\n\n  onItemCopyToggle = () => {\n    this.setState({isCopyDialogShow: !this.state.isCopyDialogShow});\n  }\n\n  onPermissionItem = () => {\n    this.setState({isPermissionDialogOpen: !this.state.isPermissionDialogOpen});\n  }\n\n  onLockItem = () => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(this.props.dirent);\n    seafileAPI.lockfile(repoID, filePath).then(() => {\n      this.props.updateDirent(this.props.dirent, 'is_locked', true);\n      this.props.updateDirent(this.props.dirent, 'locked_by_me', true);\n      let lockName = username.split('@');\n      this.props.updateDirent(this.props.dirent, 'lock_owner_name', lockName[0]);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onUnlockItem = () => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(this.props.dirent);\n    seafileAPI.unlockfile(repoID, filePath).then(() => {\n      this.props.updateDirent(this.props.dirent, 'is_locked', false);\n      this.props.updateDirent(this.props.dirent, 'locked_by_me', false);\n      this.props.updateDirent(this.props.dirent, 'lock_owner_name', '');\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onMarkAsDraft = () => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(this.props.dirent);\n    seafileAPI.sdocMarkAsDraft(repoID, filePath).then((res) => {\n      this.props.updateDirent(this.props.dirent, 'is_sdoc_draft', true);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onUnmarkAsDraft = () => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(this.props.dirent);\n    seafileAPI.sdocUnmarkAsDraft(repoID, filePath).then((res) => {\n      this.props.updateDirent(this.props.dirent, 'is_sdoc_draft', false);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  openRevisionsPage = () => {\n    const repoID = this.props.repoID;\n    const filePath = this.getDirentPath(this.props.dirent);\n    const url = Utils.generateRevisionsURL(siteRoot, repoID, filePath);\n    if (!url) return;\n    window.open(url);\n  }\n\n  onHistory = () => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(this.props.dirent);\n    let url = URLDecorator.getUrl({type: 'file_revisions', repoID: repoID, filePath: filePath});\n    location.href = url;\n  }\n\n  onAccessLog = () => {\n    let filePath = this.getDirentPath(this.props.dirent);\n    let path = siteRoot + 'repo/file-access/' + this.props.repoID + '/?p=' + encodeURIComponent(filePath) ;\n    window.open(path);\n  }\n\n  onOpenViaClient = () => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(this.props.dirent);\n    let url = URLDecorator.getUrl({type: 'open_via_client', repoID: repoID, filePath: filePath});\n    location.href = url;\n  }\n\n  onConvertWithONLYOFFICE = ()=> {\n\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(this.props.dirent)\n\n    seafileAPI.onlyofficeConvert(repoID, filePath).then(res => {\n      this.props.loadDirentList(res.data.parent_dir)\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onItemDownload = (e) => {\n    e.preventDefault();\n    e.nativeEvent.stopImmediatePropagation();\n    let dirent = this.props.dirent;\n    let repoID = this.props.repoID;\n    let direntPath = this.getDirentPath(dirent);\n    if (dirent.type === 'dir') {\n      if (!useGoFileserver) {\n        this.setState({\n          isZipDialogOpen: true\n        });\n      } else {\n        seafileAPI.zipDownload(repoID, this.props.path, this.props.dirent.name).then((res) => {\n          const zipToken = res.data['zip_token'];\n          location.href = `${fileServerRoot}zip/${zipToken}`;\n        }).catch((error) => {\n          let errorMsg = Utils.getErrorMsg(error);\n          this.setState({\n            isLoading: false,\n            errorMsg: errorMsg\n          });\n        });\n      }\n    } else {\n      let url = URLDecorator.getUrl({type: 'download_file_url', repoID: repoID, filePath: direntPath});\n      location.href = url;\n    }\n  }\n\n  closeZipDialog = () => {\n    this.setState({\n      isZipDialogOpen: false\n    });\n  }\n\n  getDirentPath = (dirent) => {\n    let path = this.props.path;\n    return path === '/' ? path + dirent.name : path + '/' + dirent.name;\n  }\n\n  onTagTooltipToggle = (e) => {\n    e.stopPropagation();\n    this.setState({isShowTagTooltip: !this.state.isShowTagTooltip});\n  }\n\n  onItemMove = (destRepo, dirent, selectedPath, currentPath) => {\n    this.props.onItemMove(destRepo, dirent, selectedPath, currentPath);\n  }\n\n  onItemDragStart = (e) => {\n    if (Utils.isIEBrower() || !this.state.canDrag) {\n      return false;\n    }\n    e.dataTransfer.effectAllowed = 'move';\n    let { selectedDirentList } = this.props;\n    if (selectedDirentList.length > 0 && selectedDirentList.includes(this.props.dirent)) { // drag items and selectedDirentList include item\n      this.props.onShowDirentsDraggablePreview();\n      e.dataTransfer.setDragImage(this.refs.empty_content, 0, 0); // Show an empty content\n      let selectedList =  selectedDirentList.map(item => {\n        let nodeRootPath = this.getDirentPath(item);\n        let dragStartItemData = {nodeDirent: item, nodeParentPath: this.props.path, nodeRootPath: nodeRootPath};\n        return dragStartItemData;\n      });\n      selectedList = JSON.stringify(selectedList);\n      e.dataTransfer.setData('applicaiton/drag-item-info', selectedList);\n      return ;\n    }\n\n    if (e.dataTransfer && e.dataTransfer.setDragImage) {\n      e.dataTransfer.setDragImage(this.refs.drag_icon, 15, 15);\n    }\n\n    let nodeRootPath = this.getDirentPath(this.props.dirent);\n    let dragStartItemData = {nodeDirent: this.props.dirent, nodeParentPath: this.props.path, nodeRootPath: nodeRootPath};\n    dragStartItemData = JSON.stringify(dragStartItemData);\n\n    e.dataTransfer.setData('applicaiton/drag-item-info', dragStartItemData);\n  }\n\n  onItemDragEnter = (e) => {\n    if (Utils.isIEBrower() || !this.state.canDrag) {\n      return false;\n    }\n    if (this.props.dirent.type === 'dir') {\n      e.stopPropagation();\n      this.setState({isDropTipshow: true});\n    }\n  }\n\n  onItemDragOver = (e) => {\n    if (Utils.isIEBrower() || !this.state.canDrag) {\n      return false;\n    }\n    if (e.dataTransfer.dropEffect === 'copy') {\n      return;\n    }\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  }\n\n  onItemDragLeave = (e) => {\n    if (Utils.isIEBrower() || !this.state.canDrag) {\n      return false;\n    }\n\n    if (this.props.dirent.type === 'dir') {\n      e.stopPropagation();\n    }\n    this.setState({isDropTipshow: false});\n  }\n\n  onItemDragDrop = (e) => {\n    if (Utils.isIEBrower() || !this.state.canDrag) {\n      return false;\n    }\n    this.setState({isDropTipshow: false});\n    if (e.dataTransfer.files.length) { // uploaded files\n      return;\n    }\n    if (this.props.dirent.type === 'dir') {\n      e.stopPropagation();\n    } else {\n      return;\n    }\n    let dragStartItemData = e.dataTransfer.getData('applicaiton/drag-item-info');\n    dragStartItemData = JSON.parse(dragStartItemData);\n    if (Array.isArray(dragStartItemData)) { //move items\n      let direntPaths =  dragStartItemData.map(draggedItem => {\n        return draggedItem.nodeRootPath;\n      });\n\n      let selectedPath = Utils.joinPath(this.props.path, this.props.dirent.name);\n\n      if (direntPaths.some(direntPath => { return direntPath === selectedPath;})) { //eg; A/B, A/C --> A/B\n        return;\n      }\n\n      this.props.onItemsMove(this.props.currentRepoInfo, selectedPath);\n      return ;\n    }\n\n    let { nodeDirent, nodeParentPath, nodeRootPath } = dragStartItemData;\n    let dropItemData = this.props.dirent;\n\n    if (nodeDirent.name === dropItemData.name) {\n      return;\n    }\n\n    //  copy the dirent to it's child. eg: A/B -> A/B/C\n    if (dropItemData.type === 'dir' && nodeDirent.type === 'dir') {\n      if (nodeParentPath !== this.props.path) {\n        if (this.props.path.indexOf(nodeRootPath) !== -1) {\n          return;\n        }\n      }\n    }\n\n    let selectedPath = Utils.joinPath(this.props.path, this.props.dirent.name);\n    this.onItemMove(this.props.currentRepoInfo, nodeDirent, selectedPath, nodeParentPath);\n  }\n\n  onItemMouseDown = (event) => {\n    this.props.onItemMouseDown(event);\n  }\n\n  onItemContextMenu = (event) => {\n    let dirent = this.props.dirent;\n    this.props.onItemContextMenu(event, dirent);\n  }\n\n  renderItemOperation = () => {\n    let { dirent, currentRepoInfo, selectedDirentList } = this.props;\n    let canDownload = true;\n    let canDelete = true;\n    const { isCustomPermission, customPermission } = this;\n    if (isCustomPermission) {\n      const { permission } = customPermission;\n      canDownload = permission.download;\n      canDelete = permission.delete;\n    }\n\n    // https://dev.seafile.com/seahub/lib/d6f300e7-bb2b-4722-b83e-cf45e370bfbc/file/seaf-server%20%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/%E6%9D%83%E9%99%90%E7%9B%B8%E5%85%B3/%E8%B5%84%E6%96%99%E5%BA%93%E6%9D%83%E9%99%90%E8%A7%84%E8%8C%83.md\n    let showShareBtn = Utils.isHasPermissionToShare(currentRepoInfo, dirent.permission, dirent);\n\n    return (\n      <Fragment>\n        {selectedDirentList.length > 1 ?\n          <Fragment>\n            {this.state.isOperationShow && !dirent.isSelected &&\n              <div className=\"operations\">\n                {(dirent.permission === 'rw' || dirent.permission === 'r' || (isCustomPermission && canDownload)) && (\n                  <a href=\"#\" className=\"op-icon sf2-icon-download\" title={gettext('Download')} role=\"button\" aria-label={gettext('Download')} onClick={this.onItemDownload}></a>\n                )}\n                {showShareBtn && (\n                  <a href=\"#\" className=\"op-icon sf2-icon-share\" title={gettext('Share')} role=\"button\" aria-label={gettext('Share')} onClick={this.onItemShare}></a>\n                )}\n                {(dirent.permission === 'rw' || dirent.permission === 'cloud-edit' || (isCustomPermission && canDelete)) && (\n                  <a href=\"#\" className=\"op-icon sf2-icon-delete\" title={gettext('Delete')} role=\"button\" aria-label={gettext('Delete')} onClick={this.onItemDelete}></a>\n                )}\n                <ItemDropdownMenu\n                  item={this.props.dirent}\n                  toggleClass={'sf2-icon-caret-down'}\n                  isHandleContextMenuEvent={true}\n                  getMenuList={this.props.getDirentItemMenuList}\n                  onMenuItemClick={this.onMenuItemClick}\n                  unfreezeItem={this.unfreezeItem}\n                  freezeItem={this.props.freezeItem}\n                />\n              </div>\n            }\n          </Fragment> :\n          <Fragment>\n            {this.state.isOperationShow &&\n              <div className=\"operations\">\n                {(dirent.permission === 'rw' || dirent.permission === 'r' || (isCustomPermission && canDownload)) && (\n                  <a href=\"#\" className=\"op-icon sf2-icon-download\" title={gettext('Download')} role=\"button\" aria-label={gettext('Download')} onClick={this.onItemDownload}></a>\n                )}\n                {showShareBtn && (\n                  <a href=\"#\" className=\"op-icon sf2-icon-share\" title={gettext('Share')} role=\"button\" aria-label={gettext('Share')} onClick={this.onItemShare}></a>\n                )}\n                {(dirent.permission === 'rw' || dirent.permission === 'cloud-edit' || (isCustomPermission && canDelete)) && (\n                  <a href=\"#\" className=\"op-icon sf2-icon-delete\" title={gettext('Delete')} role=\"button\" aria-label={gettext('Delete')} onClick={this.onItemDelete}></a>\n                )}\n                <ItemDropdownMenu\n                  item={this.props.dirent}\n                  toggleClass={'sf2-icon-caret-down'}\n                  isHandleContextMenuEvent={true}\n                  getMenuList={this.props.getDirentItemMenuList}\n                  onMenuItemClick={this.onMenuItemClick}\n                  unfreezeItem={this.unfreezeItem}\n                  freezeItem={this.props.freezeItem}\n                />\n              </div>\n            }\n          </Fragment>\n        }\n      </Fragment>\n    );\n  }\n\n  render() {\n    let { path, dirent, activeDirent } = this.props;\n    let direntPath = Utils.joinPath(path, dirent.name);\n    let dirHref = '';\n    if (this.props.currentRepoInfo) {\n      dirHref = siteRoot + 'library/' + this.props.repoID + '/' + this.props.currentRepoInfo.repo_name + Utils.encodePath(direntPath);\n    }\n    let fileHref = siteRoot + 'lib/' + this.props.repoID + '/file' + Utils.encodePath(direntPath);\n    if (dirent.is_sdoc_revision && dirent.revision_id) {\n      fileHref = siteRoot + 'lib/' + this.props.repoID + '/revisions/' + dirent.revision_id + '/';\n    }\n\n    let toolTipID = '';\n    let tagTitle = '';\n    if (dirent.file_tags && dirent.file_tags.length > 0) {\n      toolTipID = MD5(dirent.name).slice(0, 7);\n      tagTitle = dirent.file_tags.map(item => item.name).join(' ');\n    }\n\n    let iconUrl = Utils.getDirentIcon(dirent);\n\n    let trClass = this.state.highlight ? 'tr-highlight ' : '';\n    trClass += this.state.isDropTipshow ? 'tr-drop-effect' : '';\n    trClass += (activeDirent && activeDirent.name === dirent.name)  ? 'tr-active' : '';\n    trClass += dirent.isSelected? 'tr-active' : '';\n\n    let lockedInfo = gettext('locked by {name}').replace('{name}', dirent.lock_owner_name);\n\n    const isDesktop = Utils.isDesktop();\n    const { canDrag } = this.state;\n    const desktopItem = (\n      <tr\n        className={trClass}\n        draggable={canDrag}\n        onFocus={this.onMouseEnter}\n        onMouseEnter={this.onMouseEnter}\n        onMouseOver={this.onMouseOver}\n        onMouseLeave={this.onMouseLeave}\n        onClick={this.onDirentClick}\n        onDragStart={this.onItemDragStart}\n        onDragEnter={this.onItemDragEnter}\n        onDragOver={this.onItemDragOver}\n        onDragLeave={this.onItemDragLeave}\n        onDrop={this.onItemDragDrop}\n        onMouseDown={this.onItemMouseDown}\n        onContextMenu={this.onItemContextMenu}\n      >\n        <td className={`pl10 ${this.state.isDragTipShow ? 'tr-drag-effect' : ''}`}>\n          <input type=\"checkbox\" className=\"vam\" onChange={this.onItemSelected} checked={dirent.isSelected}/>\n        </td>\n        <td className=\"pl10\">\n          {dirent.starred !== undefined &&\n          <a href=\"#\" role=\"button\" aria-label={dirent.starred ? gettext('Unstar') : gettext('Star')} onClick={this.onItemStarred}>\n            <i className={`fa-star ${dirent.starred ? 'fas' : 'far star-empty'}`}></i>\n          </a>\n          }\n        </td>\n        <td className=\"pl10\">\n          <div className=\"dir-icon\">\n            {(this.canPreview && dirent.encoded_thumbnail_src) ?\n              <img ref='drag_icon' src={`${siteRoot}${dirent.encoded_thumbnail_src}`} className=\"thumbnail cursor-pointer\" onClick={this.onItemClick} alt=\"\" /> :\n              <img ref='drag_icon' src={iconUrl} width=\"24\" alt='' />\n            }\n            {dirent.is_locked && <img className=\"locked\" src={mediaUrl + 'img/file-locked-32.png'} alt={gettext('locked')} title={lockedInfo}/>}\n            <div ref=\"empty_content\" style={{position: 'absolute', width: '1px', height: '1px'}}></div>\n          </div>\n        </td>\n        <td className=\"name\">\n          {this.state.isRenameing && <Rename hasSuffix={dirent.type !== 'dir'} name={dirent.name} onRenameConfirm={this.onRenameConfirm} onRenameCancel={this.onRenameCancel} />}\n          {!this.state.isRenameing && (\n            <Fragment>\n              {(!dirent.isDir() && !this.canPreview) ? \n                <a className=\"sf-link\" onClick={this.onItemClick}>{dirent.name}</a> :\n                <a href={dirent.type === 'dir' ? dirHref : fileHref} onClick={this.onItemClick}>{dirent.name}</a>\n              }\n              {(Utils.isSdocFile(dirent.name) && dirent.is_sdoc_draft) &&\n                <span className=\"dirent-sdoc-draft-identifier\">{gettext('Draft')}</span>\n              }\n            </Fragment>\n          )}\n        </td>\n        <td className=\"tag-list-title\">\n          {(dirent.type !== 'dir' && dirent.file_tags && dirent.file_tags.length > 0) && (\n            <Fragment>\n              <div id={`tag-list-title-${toolTipID}`} className=\"dirent-item tag-list tag-list-stacked\">\n                {dirent.file_tags.map((fileTag, index) => {\n                  let length = dirent.file_tags.length;\n                  return (\n                    <span className=\"file-tag\" key={fileTag.id} style={{zIndex:length - index, backgroundColor:fileTag.color}}></span>\n                  );\n                })}\n              </div>\n              <UncontrolledTooltip target={`tag-list-title-${toolTipID}`} placement=\"bottom\">\n                {tagTitle}\n              </UncontrolledTooltip>\n            </Fragment>\n          )}\n        </td>\n        <td className=\"operation\">{this.renderItemOperation()}</td>\n        <td className=\"file-size\">{dirent.size && dirent.size}</td>\n        <td className=\"last-update\" title={moment.unix(dirent.mtime).format('llll')}>{dirent.mtime_relative}</td>\n      </tr>\n    );\n    const mobileItem = (\n      <tr>\n        <td onClick={this.onItemClick}>\n          <div className=\"dir-icon\">\n            {(this.canPreview && dirent.encoded_thumbnail_src) ?\n              <img src={`${siteRoot}${dirent.encoded_thumbnail_src}`} className=\"thumbnail cursor-pointer\" alt=\"\" /> :\n              <img src={iconUrl} width=\"24\" alt=\"\" />\n            }\n            {dirent.is_locked && <img className=\"locked\" src={mediaUrl + 'img/file-locked-32.png'} alt={gettext('locked')} title={lockedInfo}/>}\n          </div>\n        </td>\n        <td onClick={this.onItemClick}>\n          {this.state.isRenameing && <Rename hasSuffix={dirent.type !== 'dir'} name={dirent.name} onRenameConfirm={this.onRenameConfirm} onRenameCancel={this.onRenameCancel} /> }\n          {!this.state.isRenameing && (\n            <Fragment>\n              {(!dirent.isDir() && !this.canPreview) ?\n                <a className=\"sf-link\">{dirent.name}</a> :\n                <a href={dirent.type === 'dir' ? dirHref : fileHref}>{dirent.name}</a>\n              }\n            </Fragment>\n          )}\n          <br />\n          {dirent.size && <span className=\"item-meta-info\">{dirent.size}</span>}\n          <span className=\"item-meta-info\">{dirent.mtime_relative}</span>\n        </td>\n        <td>\n          <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n            <DropdownToggle\n              tag=\"i\"\n              className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isOpMenuOpen}\n            />\n            <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n              <div className=\"mobile-operation-menu-bg-layer\"></div>\n              <div className=\"mobile-operation-menu\">\n                {dirent.starred !== undefined &&\n                <DropdownItem className=\"mobile-menu-item\" onClick={this.onItemStarred}>{dirent.starred ? gettext('Unstar') : gettext('Star')}</DropdownItem>}\n                {this.props.getDirentItemMenuList(dirent, true).map((item, index) => {\n                  if (item != 'Divider' && item.key != 'Open via Client') {\n                    return (\n                      <DropdownItem className=\"mobile-menu-item\" key={index} data-op={item.key} onClick={this.onMobileMenuItemClick}>{item.value}</DropdownItem>\n                    );\n                  } else {\n                    return null;\n                  }\n                })}\n              </div>\n            </div>\n          </Dropdown>\n        </td>\n      </tr>\n    );\n\n    return (\n      <Fragment>\n        {isDesktop ? desktopItem : mobileItem}\n        {this.state.isMoveDialogShow &&\n          <ModalPortal>\n            <MoveDirentDialog\n              path={this.props.path}\n              repoID={this.props.repoID}\n              dirent={this.props.dirent}\n              isMutipleOperation={this.state.isMutipleOperation}\n              onItemMove={this.props.onItemMove}\n              onCancelMove={this.onItemMoveToggle}\n              repoEncrypted={this.props.repoEncrypted}\n            />\n          </ModalPortal>\n        }\n        {this.state.isCopyDialogShow &&\n          <ModalPortal>\n            <CopyDirentDialog\n              path={this.props.path}\n              repoID={this.props.repoID}\n              dirent={this.props.dirent}\n              isMutipleOperation={this.state.isMutipleOperation}\n              onItemCopy={this.props.onItemCopy}\n              onCancelCopy={this.onItemCopyToggle}\n              repoEncrypted={this.props.repoEncrypted}\n            />\n          </ModalPortal>\n        }\n        {this.state.isEditFileTagShow &&\n          <EditFileTagDialog\n            repoID={this.props.repoID}\n            fileTagList={dirent.file_tags}\n            filePath={direntPath}\n            toggleCancel={this.onEditFileTagToggle}\n            onFileTagChanged={this.onFileTagChanged}\n          />\n        }\n        {this.state.isZipDialogOpen &&\n          <ModalPortal>\n            <ZipDownloadDialog\n              repoID={this.props.repoID}\n              path={this.props.path}\n              target={this.props.dirent.name}\n              toggleDialog={this.closeZipDialog}\n            />\n          </ModalPortal>\n        }\n        {this.state.isShareDialogShow &&\n          <ModalPortal>\n            <ShareDialog\n              itemType={dirent.type}\n              itemName={dirent.name}\n              itemPath={direntPath}\n              userPerm={dirent.permission}\n              repoID={this.props.repoID}\n              repoEncrypted={this.props.repoEncrypted}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              toggleDialog={this.closeSharedDialog}\n            />\n          </ModalPortal>\n        }\n        {this.state.isPermissionDialogOpen &&\n          <ModalPortal>\n            <LibSubFolderPermissionDialog\n              toggleDialog={this.onPermissionItem}\n              repoID={this.props.repoID}\n              folderPath={direntPath}\n              folderName={dirent.name}\n              isDepartmentRepo={this.props.isGroupOwnedRepo}\n            />\n          </ModalPortal>\n        }\n      </Fragment>\n    );\n  }\n}\n\nDirentListItem.propTypes = propTypes;\n\nexport default DirentListItem;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { siteRoot } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  selectedDirentList: PropTypes.array,\n  onHideDirentsDraggablePreview: PropTypes.func\n};\n\nclass DirentsDraggedPreview extends React.Component {\n\n  componentDidMount() {\n    document.addEventListener('dragover', this.handleDragOver);\n    document.addEventListener('drop', this.handleDrop);\n    document.addEventListener('dragend', this.handleDragEnd);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('dragover', this.handleDragOver);\n    document.removeEventListener('drop', this.handleDrop);\n    document.removeEventListener('dragend', this.handleDragEnd);\n  }\n\n  handleDragEnd = () => {\n    this.element.style.opacity = 0;\n    this.props.onHideDirentsDraggablePreview();\n  }\n\n  handleDragOver = (event) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    event.preventDefault();\n    event.dataTransfer.dropEffect = 'move';\n\n    this.element.style.top = event.clientY + 'px';\n    this.element.style.left = event.clientX + 'px';\n  }\n\n  handleDrop = (event) => {\n    this.element.style.opacity = 0;\n    this.props.onHideDirentsDraggablePreview();\n  }\n\n  render() {\n    let{ selectedDirentList } = this.props;\n    const inlineStyle = {\n      position: 'absolute',\n      opacity: 1,\n      pointerEvents: 'none',\n      display: 'block',\n      left: '-9999px',\n      top: '-9999px',\n      zIndex: 101,\n      maxHeight: document.documentElement.clientHeight,\n      overflow: 'hidden'\n    };\n    return (\n      <div style={inlineStyle} ref={element => this.element = element}>\n        {selectedDirentList.map((dirent, index) => {\n          let iconUrl = Utils.getDirentIcon(dirent);\n          return (\n            <div key={index}>\n              {dirent.encoded_thumbnail_src ?\n                <img src={`${siteRoot}${dirent.encoded_thumbnail_src}`} className=\"thumbnail cursor-pointer\" alt=\"\" /> :\n                <img src={iconUrl} width=\"24\" alt='' />\n              }\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n}\n\nDirentsDraggedPreview.propTypes = propTypes;\n\nexport default DirentsDraggedPreview;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { siteRoot, gettext, thumbnailSizeForOriginal, username } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport TextTranslation from '../../utils/text-translation';\nimport URLDecorator from '../../utils/url-decorator';\nimport Loading from '../loading';\nimport toaster from '../toast';\nimport ModalPortal from '../modal-portal';\nimport CreateFile from '../dialog/create-file-dialog';\nimport CreateFolder from '../dialog/create-folder-dialog';\nimport ImageDialog from '../dialog/image-dialog';\nimport ZipDownloadDialog from '../dialog/zip-download-dialog';\nimport MoveDirentDialog from '../dialog/move-dirent-dialog';\nimport CopyDirentDialog from '../dialog/copy-dirent-dialog';\nimport DirentListItem from './dirent-list-item';\nimport ContextMenu from '../context-menu/context-menu';\nimport { hideMenu, showMenu } from '../context-menu/actions';\nimport DirentsDraggedPreview from '../draggable/dirents-dragged-preview';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  currentRepoInfo: PropTypes.object,\n  isAllItemSelected: PropTypes.bool.isRequired,\n  isDirentListLoading: PropTypes.bool.isRequired,\n  direntList: PropTypes.array.isRequired,\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  sortItems: PropTypes.func.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func.isRequired,\n  onAllItemSelected: PropTypes.func.isRequired,\n  onItemSelected: PropTypes.func.isRequired,\n  onItemRename: PropTypes.func.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  onDirentClick: PropTypes.func.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onItemsCopy: PropTypes.func.isRequired,\n  onItemsDelete: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string,\n  showDirentDetail: PropTypes.func.isRequired,\n  loadDirentList: PropTypes.func,\n};\n\nclass DirentListView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n      isImagePopupOpen: false,\n      imageItems: [],\n      imageIndex: 0,\n      fileType: '',\n      isCreateFileDialogShow: false,\n      isCreateFolderDialogShow: false,\n      isMoveDialogShow: false,\n      isCopyDialogShow: false,\n      isProgressDialogShow: false,\n      downloadItems: [],\n      isMutipleOperation: true,\n      activeDirent: null,\n      isListDropTipShow: false,\n      isShowDirentsDraggablePreview: false,\n    };\n\n    this.enteredCounter = 0; // Determine whether to enter the child element to avoid dragging bubbling bugs\n    this.isRepoOwner = props.currentRepoInfo.owner_email === username;\n    this.isAdmin = props.currentRepoInfo.is_admin;\n    this.repoEncrypted = props.currentRepoInfo.encrypted;\n\n    this.clickedDirent = null;\n    this.direntItems = [];\n    this.currentItemRef = null;\n\n    this.zipToken = null;\n\n    const { userPerm } = props;\n    this.canDrop = userPerm === 'rw';\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    if (isCustomPermission) {\n      const { modify } = customPermission.permission;\n      this.canDrop = modify;\n    }\n  }\n\n  freezeItem = () => {\n    this.setState({isItemFreezed: true});\n  }\n\n  unfreezeItem = () => {\n    this.setState({isItemFreezed: false});\n  }\n\n  onItemRename = (dirent, newName) => {\n    let isDuplicated = this.props.direntList.some(item => {\n      return item.name === newName;\n    });\n    if (isDuplicated) {\n      let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n      errMessage = errMessage.replace('{name}', Utils.HTMLescape(newName));\n      toaster.danger(errMessage);\n      return false;\n    }\n    this.props.onItemRename(dirent, newName);\n  }\n\n  onItemRenameToggle = () => {\n    this.freezeItem();\n  }\n\n  onItemSelected = (dirent) => {\n    this.setState({activeDirent: null});\n    this.props.onItemSelected(dirent);\n  }\n\n  onDirentClick = (dirent) => {\n    hideMenu();\n    if (this.props.selectedDirentList.length > 0 && !this.state.activeDirent ) {\n      return;\n    }\n    this.setState({activeDirent: dirent});\n    this.props.onDirentClick(dirent);\n  }\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortByTime = (e) => {\n    e.preventDefault();\n    const sortBy = 'time';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortBySize = (e) => {\n    e.preventDefault();\n    const sortBy = 'size';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  // for image popup\n  prepareImageItem = (item) => {\n    const useThumbnail = !this.repoEncrypted;\n    const name = item.name;\n\n    const fileExt = name.substr(name.lastIndexOf('.') + 1).toLowerCase();\n    const isGIF = fileExt == 'gif';\n\n    const path = Utils.encodePath(Utils.joinPath(this.props.path, name));\n    const repoID = this.props.repoID;\n    let src;\n    if (useThumbnail && !isGIF) {\n      src = `${siteRoot}thumbnail/${repoID}/${thumbnailSizeForOriginal}${path}`;\n    } else {\n      src = `${siteRoot}repo/${repoID}/raw${path}`;\n    }\n\n    return {\n      'name': name,\n      'url': `${siteRoot}lib/${repoID}/file${path}`,\n      'src': src\n    };\n  }\n\n  showImagePopup = (curItem) => {\n    let items = this.props.fullDirentList.filter((item) => {\n      return Utils.imageCheck(item.name);\n    });\n\n    const imageItems = items.map((item) => {\n      return this.prepareImageItem(item);\n    });\n\n    this.setState({\n      isImagePopupOpen: true,\n      imageItems: imageItems,\n      imageIndex: items.indexOf(curItem)\n    });\n  }\n\n  moveToPrevImage = () => {\n    const imageItemsLength = this.state.imageItems.length;\n    this.setState((prevState) => ({\n      imageIndex: (prevState.imageIndex + imageItemsLength - 1) % imageItemsLength\n    }));\n  }\n\n  moveToNextImage = () => {\n    const imageItemsLength = this.state.imageItems.length;\n    this.setState((prevState) => ({\n      imageIndex: (prevState.imageIndex + 1) % imageItemsLength\n    }));\n  }\n\n  closeImagePopup = () => {\n    this.setState({isImagePopupOpen: false});\n  }\n\n  onCreateFileToggle = () => {\n    this.setState({isCreateFileDialogShow: !this.state.isCreateFileDialogShow});\n  }\n\n  onCreateFolderToggle = () => {\n    this.setState({isCreateFolderDialogShow: !this.state.isCreateFolderDialogShow});\n  }\n\n  onAddFolder = (dirPath) => {\n    this.setState({isCreateFolderDialogShow: false});\n    this.props.onAddFolder(dirPath);\n  }\n\n  checkDuplicatedName = (newName) => {\n    let direntList = this.props.direntList;\n    let isDuplicated = direntList.some(object => {\n      return object.name === newName;\n    });\n    return isDuplicated;\n  }\n\n  onMoveToggle = () => {\n    this.setState({isMoveDialogShow: !this.state.isMoveDialogShow});\n  }\n\n  onCopyToggle = () => {\n    this.setState({isCopyDialogShow: !this.state.isCopyDialogShow});\n  }\n\n  onItemsDownload = () => {\n    let { path, repoID, selectedDirentList } = this.props;\n    if (selectedDirentList.length) {\n      if (selectedDirentList.length === 1 && !selectedDirentList[0].isDir()) {\n        let direntPath = Utils.joinPath(path, selectedDirentList[0].name);\n        let url = URLDecorator.getUrl({type: 'download_file_url', repoID: repoID, filePath: direntPath});\n        location.href= url;\n        return;\n      }\n\n      let selectedDirentNames = selectedDirentList.map(dirent => {\n        return dirent.name;\n      });\n\n      this.setState({\n        isProgressDialogShow: true,\n        downloadItems: selectedDirentNames\n      });\n    }\n  }\n\n  onCloseZipDownloadDialog = () => {\n    this.setState({isProgressDialogShow: false});\n  }\n\n  // common contextmenu handle\n  onMouseDown = (event) => {\n    event.stopPropagation();\n    if (event.button === 2) {\n      return;\n    }\n  }\n\n  handleContextClick = (event, id, menuList, currentObject = null) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    let x = event.clientX || (event.touches && event.touches[0].pageX);\n    let y = event.clientY || (event.touches && event.touches[0].pageY);\n\n    if (this.props.posX) {\n      x -= this.props.posX;\n    }\n    if (this.props.posY) {\n      y -= this.props.posY;\n    }\n\n    hideMenu();\n\n    let showMenuConfig = {\n      id: id,\n      position: { x, y },\n      target: event.target,\n      currentObject: currentObject,\n      menuList: menuList,\n    };\n\n    if (menuList.length === 0) {\n      return;\n    }\n\n    showMenu(showMenuConfig);\n  }\n\n  // table-container contextmenu handle\n  onContainerClick = () => {\n    hideMenu();\n    if (this.state.activeDirent) {\n      this.onDirentClick(null);\n    }\n  }\n\n  onContainerMouseDown = (event) => {\n    this.onMouseDown(event);\n  }\n\n  onContainerContextMenu = (event) => {\n    event.preventDefault();\n    // Display menu items based on the permissions of the current path\n    let permission = this.props.userPerm;\n\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(this.props.userPerm);\n    if (permission !== 'admin' && permission !== 'rw' && !isCustomPermission) {\n      return;\n    }\n\n    if (this.props.selectedDirentList.length === 0) {\n      let id = 'dirent-container-menu';\n\n      // custom permission judgement\n      if (isCustomPermission) {\n        const { create: canCreate } = customPermission.permission;\n        if (!canCreate) return;\n      }\n\n      let menuList = [TextTranslation.NEW_FOLDER, TextTranslation.NEW_FILE];\n      this.handleContextClick(event, id, menuList);\n    } else {\n      if (this.props.selectedDirentList.length === 1) {\n        if (!this.state.activeDirent) {\n          let id = 'dirent-item-menu';\n          let dirent = this.props.selectedDirentList[0];\n          let menuList = this.getDirentItemMenuList(dirent, true);\n          this.handleContextClick(event, id, menuList, dirent);\n        } else {\n          this.onDirentClick(null);\n          event.preventDefault();\n          event.persist();\n\n          // custom permission judgement\n          if (isCustomPermission) {\n            const { modify } = customPermission.permission;\n            if (!modify) return;\n          }\n\n          setTimeout(() => {\n            let id = 'dirent-container-menu';\n            let menuList = [TextTranslation.NEW_FOLDER, TextTranslation.NEW_FILE];\n            this.handleContextClick(event, id, menuList);\n          }, 0);\n        }\n      } else {\n        let id = 'dirents-menu';\n        let menuList = [];\n        if (isCustomPermission) {\n          const { modify: canModify, copy: canCopy, download: canDownload, delete: canDelete } = customPermission.permission;\n          canModify && menuList.push(TextTranslation.MOVE);\n          canCopy && menuList.push(TextTranslation.COPY);\n          canDownload && menuList.push(TextTranslation.DOWNLOAD);\n          canDelete && menuList.push(TextTranslation.DELETE);\n        } else {\n          menuList = [TextTranslation.MOVE, TextTranslation.COPY, TextTranslation.DOWNLOAD, TextTranslation.DELETE];\n        }\n\n        this.handleContextClick(event, id, menuList);\n      }\n    }\n  }\n\n  onContainerMenuItemClick = (operation) => {\n    switch(operation) {\n      case 'New Folder':\n        this.onCreateFolderToggle();\n        break;\n      case 'New File':\n        this.onCreateFileToggle();\n        break;\n      default:\n        break;\n    }\n\n    hideMenu();\n  }\n\n  onDirentsMenuItemClick = (operation) => {\n    switch(operation) {\n      case 'Move':\n        this.onMoveToggle();\n        break;\n      case 'Copy':\n        this.onCopyToggle();\n        break;\n      case 'Download':\n        this.onItemsDownload();\n        break;\n      case 'Delete':\n        this.props.onItemsDelete();\n        break;\n      default:\n        break;\n    }\n\n    hideMenu();\n  }\n\n  // table-thread contextmenu handle -- Shield event\n  onThreadMouseDown = (event) => {\n    this.onMouseDown(event);\n  }\n\n  onThreadContextMenu = (event) => {\n    event.stopPropagation();\n  }\n\n  // table-dirent-item contextmenu handle\n  onItemMouseDown = (event) => {\n    this.onMouseDown(event);\n  }\n\n  onItemContextMenu = (event, dirent) => {\n    // Display menu items according to the current dirent permission\n    if (this.props.selectedDirentList.length > 1) {\n      return;\n    }\n    this.onDirentClick(dirent);\n    let id = 'dirent-item-menu';\n    let menuList = this.getDirentItemMenuList(dirent, true);\n    this.handleContextClick(event, id, menuList, dirent);\n  }\n\n  setDirentItemRef = (index) => item => {\n    this.direntItems[index] = item;\n  }\n\n  onMenuItemClick = (operation, currentObject, event) => {\n    let index = this.getDirentIndex(currentObject);\n    this.direntItems[index].onMenuItemClick(operation, event);\n\n    hideMenu();\n  }\n\n  onShowMenu = (e) => {\n    this.freezeItem();\n  }\n\n  onHideMenu = (e) => {\n    this.unfreezeItem();\n  }\n\n  // contextmenu utils\n  getDirentIndex = (dirent) => {\n    let direntList = this.props.direntList;\n    let index = 0;\n    for (let i = 0; i < direntList.length; i++) {\n      if (direntList[i].name === dirent.name) {\n        index = i;\n        break;\n      }\n    }\n    return index;\n  }\n\n  getDirentItemMenuList = (dirent, isContextmenu) => {\n    const isRepoOwner = this.isRepoOwner;\n    const currentRepoInfo = this.props.currentRepoInfo;\n    return Utils.getDirentOperationList(isRepoOwner, currentRepoInfo, dirent, isContextmenu);\n  }\n\n  onTableDragEnter = (e) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    this.enteredCounter++;\n    if (this.enteredCounter !== 0) {\n      if (this.state.isListDropTipShow) {\n        return ;\n      }\n      this.setState({isListDropTipShow: true});\n    }\n  }\n\n  onTableDragOver = (e) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    if (e.dataTransfer.dropEffect === 'copy') {\n      return;\n    }\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  }\n\n  onTableDragLeave = (e) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    this.enteredCounter--;\n    if (this.enteredCounter === 0) {\n      this.setState({isListDropTipShow: false});\n    }\n  }\n\n  tableDrop = (e) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    e.persist();\n    this.enteredCounter = 0;\n    this.setState({isListDropTipShow: false});\n    if (e.dataTransfer.files.length) { // uploaded files\n      return;\n    }\n    let dragStartItemData = e.dataTransfer.getData('applicaiton/drag-item-info');\n    dragStartItemData = JSON.parse(dragStartItemData);\n\n    let {nodeDirent, nodeParentPath, nodeRootPath} = dragStartItemData;\n\n    if (Array.isArray(dragStartItemData)) { //selected items\n      return;\n    }\n\n    if (nodeRootPath === this.props.path || nodeParentPath === this.props.path) {\n      return;\n    }\n\n    if (this.props.path.indexOf(nodeRootPath) !== -1) {\n      return;\n    }\n\n    this.props.onItemMove(this.props.currentRepoInfo, nodeDirent, this.props.path, nodeParentPath);\n  }\n\n  onShowDirentsDraggablePreview = () => {\n    this.setState({\n      isShowDirentsDraggablePreview: true,\n    });\n  }\n\n  onHideDirentsDraggablePreview = () => {\n    this.setState({\n      isShowDirentsDraggablePreview: false\n    });\n  }\n\n  render() {\n    const { direntList, sortBy, sortOrder } = this.props;\n\n    if (this.props.isDirentListLoading) {\n      return (<Loading />);\n    }\n\n    // sort\n    const sortByName = sortBy == 'name';\n    const sortByTime = sortBy == 'time';\n    const sortBySize = sortBy == 'size';\n    const sortIcon = sortOrder == 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>;\n\n    const isDesktop = Utils.isDesktop();\n\n    return (\n      <div\n        className={`table-container ${(this.state.isListDropTipShow && this.canDrop) ? 'table-drop-active' : ''}`}\n        onMouseDown={this.onContainerMouseDown}\n        onContextMenu={this.onContainerContextMenu}\n        onClick={this.onContainerClick}\n        onDragEnter={this.onTableDragEnter}\n        onDragOver={this.onTableDragOver}\n        onDragLeave={this.onTableDragLeave}\n        onDrop={this.tableDrop}\n      >\n        <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n          {isDesktop ? (\n            <thead onMouseDown={this.onThreadMouseDown} onContextMenu={this.onThreadContextMenu}>\n              <tr>\n                <th width=\"3%\" className=\"pl10\">\n                  <input type=\"checkbox\" className=\"vam\" onChange={this.props.onAllItemSelected} checked={this.props.isAllItemSelected} />\n                </th>\n                <th width=\"3%\" className=\"pl10\">{/*icon */}</th>\n                <th width=\"5%\" className=\"pl10\">{/*star */}</th>\n                <th width=\"39%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {sortByName && sortIcon}</a></th>\n                <th width=\"6%\">{/*tag */}</th>\n                <th width=\"18%\">{/*operation */}</th>\n                <th width=\"11%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortBySize}>{gettext('Size')} {sortBySize && sortIcon}</a></th>\n                <th width=\"15%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByTime}>{gettext('Last Update')} {sortByTime && sortIcon}</a></th>\n              </tr>\n            </thead>\n          ) : (\n            <thead>\n              <tr>\n                <th width=\"12%\"></th>\n                <th width=\"80%\"></th>\n                <th width=\"8%\"></th>\n              </tr>\n            </thead>\n          )}\n          <tbody>\n            {direntList.map((dirent, index) => {\n              return (\n                <DirentListItem\n                  ref={this.setDirentItemRef(index)}\n                  key={index}\n                  dirent={dirent}\n                  path={this.props.path}\n                  repoID={this.props.repoID}\n                  currentRepoInfo={this.props.currentRepoInfo}\n                  isAdmin={this.isAdmin}\n                  isRepoOwner={this.isRepoOwner}\n                  repoEncrypted={this.repoEncrypted}\n                  enableDirPrivateShare={this.props.enableDirPrivateShare}\n                  isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n                  onItemClick={this.props.onItemClick}\n                  onItemRenameToggle={this.onItemRenameToggle}\n                  onItemSelected={this.onItemSelected}\n                  onItemDelete={this.props.onItemDelete}\n                  onItemRename={this.onItemRename}\n                  onItemMove={this.props.onItemMove}\n                  onItemCopy={this.props.onItemCopy}\n                  updateDirent={this.props.updateDirent}\n                  isItemFreezed={this.state.isItemFreezed}\n                  freezeItem={this.freezeItem}\n                  unfreezeItem={this.unfreezeItem}\n                  onDirentClick={this.onDirentClick}\n                  showImagePopup={this.showImagePopup}\n                  onItemMouseDown={this.onItemMouseDown}\n                  onItemContextMenu={this.onItemContextMenu}\n                  selectedDirentList={this.props.selectedDirentList}\n                  activeDirent={this.state.activeDirent}\n                  onFileTagChanged={this.props.onFileTagChanged}\n                  getDirentItemMenuList={this.getDirentItemMenuList}\n                  showDirentDetail={this.props.showDirentDetail}\n                  onItemsMove={this.props.onItemsMove}\n                  onShowDirentsDraggablePreview={this.onShowDirentsDraggablePreview}\n                  loadDirentList={this.props.loadDirentList}\n                />\n              );\n            })}\n          </tbody>\n        </table>\n        <Fragment>\n          <ContextMenu\n            id={'dirent-container-menu'}\n            onMenuItemClick={this.onContainerMenuItemClick}\n          />\n          <ContextMenu\n            id={'dirent-item-menu'}\n            onMenuItemClick={this.onMenuItemClick}\n            onShowMenu={this.onShowMenu}\n            onHideMenu={this.onHideMenu}\n          />\n          <ContextMenu\n            id={'dirents-menu'}\n            onMenuItemClick={this.onDirentsMenuItemClick}\n          />\n          {this.state.isShowDirentsDraggablePreview &&\n            <ModalPortal>\n              <DirentsDraggedPreview\n                selectedDirentList={this.props.selectedDirentList}\n                onHideDirentsDraggablePreview={this.onHideDirentsDraggablePreview}\n                dragStartPosition={this.state.dragStartPosition}\n              />\n            </ModalPortal>\n          }\n          {this.state.isImagePopupOpen && (\n            <ModalPortal>\n              <ImageDialog\n                imageItems={this.state.imageItems}\n                imageIndex={this.state.imageIndex}\n                closeImagePopup={this.closeImagePopup}\n                moveToPrevImage={this.moveToPrevImage}\n                moveToNextImage={this.moveToNextImage}\n              />\n            </ModalPortal>\n          )}\n          {this.state.isCreateFolderDialogShow && (\n            <ModalPortal>\n              <CreateFolder\n                parentPath={this.props.path}\n                onAddFolder={this.onAddFolder}\n                checkDuplicatedName={this.checkDuplicatedName}\n                addFolderCancel={this.onCreateFolderToggle}\n              />\n            </ModalPortal>\n          )}\n          {this.state.isCreateFileDialogShow && (\n            <ModalPortal>\n              <CreateFile\n                parentPath={this.props.path}\n                fileType={this.state.fileType}\n                onAddFile={this.props.onAddFile}\n                checkDuplicatedName={this.checkDuplicatedName}\n                toggleDialog={this.onCreateFileToggle}\n              />\n            </ModalPortal>\n          )}\n          {this.state.isMoveDialogShow &&\n            <MoveDirentDialog\n              path={this.props.path}\n              repoID={this.props.repoID}\n              repoEncrypted={this.props.currentRepoInfo.encrypted}\n              isMutipleOperation={this.state.isMutipleOperation}\n              selectedDirentList={this.props.selectedDirentList}\n              onItemsMove={this.props.onItemsMove}\n              onCancelMove={this.onMoveToggle}\n            />\n          }\n          {this.state.isCopyDialogShow &&\n            <CopyDirentDialog\n              path={this.props.path}\n              repoID={this.props.repoID}\n              repoEncrypted={this.props.currentRepoInfo.encrypted}\n              selectedDirentList={this.props.selectedDirentList}\n              isMutipleOperation={this.state.isMutipleOperation}\n              onItemsCopy={this.props.onItemsCopy}\n              onCancelCopy={this.onCopyToggle}\n            />\n          }\n          {this.state.isProgressDialogShow &&\n            <ZipDownloadDialog\n              repoID={this.props.repoID}\n              path={this.props.path}\n              target={this.state.downloadItems}\n              toggleDialog={this.onCloseZipDownloadDialog}\n            />\n          }\n        </Fragment>\n      </div>\n    );\n  }\n}\n\nDirentListView.propTypes = propTypes;\n\nexport default DirentListView;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport DirentNoneView from '../../components/dirent-list-view/dirent-none-view';\nimport RepoInfoBar from '../../components/repo-info-bar';\nimport DirentListView from '../../components/dirent-list-view/dirent-list-view';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  currentRepoInfo: PropTypes.object.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  isRepoInfoBarShow: PropTypes.bool.isRequired,\n  usedRepoTags: PropTypes.array.isRequired,\n  readmeMarkdown: PropTypes.object,\n  draftCounts: PropTypes.number,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  isDirentListLoading: PropTypes.bool.isRequired,\n  direntList: PropTypes.array.isRequired,\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  sortItems: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  onItemSelected: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func.isRequired,\n  onItemRename: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  onDirentClick: PropTypes.func.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  isAllItemSelected: PropTypes.bool.isRequired,\n  onAllItemSelected: PropTypes.func.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onItemsCopy: PropTypes.func.isRequired,\n  onItemsDelete: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func,\n  showDirentDetail: PropTypes.func.isRequired,\n  loadDirentList: PropTypes.func,\n};\n\nclass DirListView extends React.Component {\n\n  render() {\n\n    if (this.props.path === '/' && this.props.direntList.length === 0) {\n      return (\n        <DirentNoneView\n          path={this.props.path}\n          isDirentListLoading={this.props.isDirentListLoading}\n          onAddFile={this.props.onAddFile}\n        />\n      );\n    }\n\n    return (\n      <Fragment>\n        {this.props.isRepoInfoBarShow && (\n          <RepoInfoBar\n            repoID={this.props.repoID}\n            currentPath={this.props.path}\n            readmeMarkdown={this.props.readmeMarkdown}\n            draftCounts={this.props.draftCounts}\n            usedRepoTags={this.props.usedRepoTags}\n            updateUsedRepoTags={this.props.updateUsedRepoTags}\n            onFileTagChanged={this.props.onFileTagChanged}\n          />\n        )}\n        <DirentListView\n          path={this.props.path}\n          currentRepoInfo={this.props.currentRepoInfo}\n          repoID={this.props.repoID}\n          isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n          userPerm={this.props.userPerm}\n          enableDirPrivateShare={this.props.enableDirPrivateShare}\n          direntList={this.props.direntList}\n          fullDirentList={this.props.fullDirentList}\n          sortBy={this.props.sortBy}\n          sortOrder={this.props.sortOrder}\n          sortItems={this.props.sortItems}\n          onItemClick={this.props.onItemClick}\n          onItemSelected={this.props.onItemSelected}\n          onItemDelete={this.props.onItemDelete}\n          onItemRename={this.props.onItemRename}\n          onItemMove={this.props.onItemMove}\n          onItemCopy={this.props.onItemCopy}\n          onDirentClick={this.props.onDirentClick}\n          isDirentListLoading={this.props.isDirentListLoading}\n          updateDirent={this.props.updateDirent}\n          isAllItemSelected={this.props.isAllItemSelected}\n          onAllItemSelected={this.props.onAllItemSelected}\n          selectedDirentList={this.props.selectedDirentList}\n          onItemsMove={this.props.onItemsMove}\n          onItemsCopy={this.props.onItemsCopy}\n          onItemsDelete={this.props.onItemsDelete}\n          onAddFile={this.props.onAddFile}\n          onAddFolder={this.props.onAddFolder}\n          onFileTagChanged={this.props.onFileTagChanged}\n          showDirentDetail={this.props.showDirentDetail}\n          loadDirentList={this.props.loadDirentList}\n        />\n      </Fragment>\n    );\n  }\n}\n\nDirListView.propTypes = propTypes;\n\nexport default DirListView;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport MD5 from 'MD5';\nimport { UncontrolledTooltip } from 'reactstrap';\nimport { gettext, siteRoot, mediaUrl } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  dirent: PropTypes.object.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  showImagePopup: PropTypes.func.isRequired,\n  onGridItemContextMenu: PropTypes.func.isRequired,\n  onGridItemClick: PropTypes.func.isRequired,\n  activeDirent: PropTypes.object,\n  onGridItemMouseDown: PropTypes.func,\n  currentRepoInfo: PropTypes.object,\n  onItemMove: PropTypes.func.isRequired,\n};\n\nclass DirentGridItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isGridSelected: false,\n      isGridDropTipShow: false,\n    };\n\n    const { dirent } = this.props;\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(dirent.permission);\n    this.isCustomPermission = isCustomPermission;\n    this.customPermission = customPermission;\n    this.canPreview = true;\n    this.canDrag = dirent.permission === 'rw';\n    if (isCustomPermission) {\n      const { preview, modify } = customPermission.permission;\n      this.canPreview = preview || modify;\n      this.canDrag = modify;\n    }\n\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({isGridSelected: false}, () => {\n      if (nextProps.activeDirent && nextProps.activeDirent.name === nextProps.dirent.name) {\n        this.setState({isGridSelected: true});\n      }\n    });\n  }\n\n  onItemMove = (destRepo, dirent, selectedPath, currentPath) => {\n    this.props.onItemMove(destRepo, dirent, selectedPath, currentPath);\n  }\n\n  onItemClick = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    const { dirent, activeDirent } = this.props;\n    if (dirent.isDir()) {\n      this.props.onItemClick(dirent);\n      return;\n    }\n\n    // is have preview permission\n    if (!this.canPreview) {\n      return;\n    }\n\n    if (dirent === activeDirent) {\n      this.setState({isGridSelected: false});\n      if (Utils.imageCheck(dirent.name)) {\n        this.props.showImagePopup(dirent);\n      } else {\n        this.props.onItemClick(dirent);\n      }\n    } else {\n      this.setState({isGridSelected: false});\n      this.props.onGridItemClick(this.props.dirent);\n    }\n  }\n\n  onItemLinkClick = (e) => {\n    e.preventDefault();\n    const dirent = this.props.dirent;\n\n    if (dirent.isDir()) {\n      this.props.onItemClick(dirent);\n      return;\n    }\n\n    // is have preview permission\n    if (!this.canPreview) {\n      return;\n    }\n\n    if (Utils.imageCheck(dirent.name)) {\n      this.props.showImagePopup(dirent);\n    } else {\n      this.props.onItemClick(dirent);\n    }\n  }\n\n  onGridItemDragStart = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    let dragStartItemData = {nodeDirent: this.props.dirent, nodeParentPath: this.props.path};\n    dragStartItemData = JSON.stringify(dragStartItemData);\n\n    e.dataTransfer.effectAllowed = 'move';\n    e.dataTransfer.setData('applicaiton/drag-item-info', dragStartItemData);\n  }\n\n  onGridItemDragEnter = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    if (this.props.dirent.type === 'dir') {\n      this.setState({isGridDropTipShow: true});\n    }\n  }\n\n  onGridItemDragOver = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  }\n\n  onGridItemDragLeave = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    this.setState({isGridDropTipShow: false});\n  }\n\n  onGridItemDragDrop = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    this.setState({isGridDropTipShow: false});\n    if (e.dataTransfer.files.length) { // uploaded files\n      return;\n    }\n    let dragStartItemData = e.dataTransfer.getData('applicaiton/drag-item-info');\n    dragStartItemData = JSON.parse(dragStartItemData);\n    let {nodeDirent, nodeParentPath} = dragStartItemData;\n    let dropItemData = this.props.dirent;\n\n    if (nodeDirent.name === dropItemData.name) {\n      return;\n    }\n\n    if (dropItemData.type !== 'dir') {\n      return;\n    }\n\n    let selectedPath = Utils.joinPath(this.props.path, this.props.dirent.name);\n    this.onItemMove(this.props.currentRepoInfo, nodeDirent, selectedPath, nodeParentPath);\n  }\n\n  onGridItemMouseDown = (event) =>{\n    this.props.onGridItemMouseDown(event);\n  }\n\n  getFileUrl = (url) => {\n    let fileUrlArr = url.split('/');\n    if (fileUrlArr.indexOf('48') !== -1) {\n      fileUrlArr.splice(fileUrlArr.indexOf('48'), 1, '192');\n    }\n    let fileUrl = fileUrlArr.join('/');\n    return fileUrl;\n  }\n\n  onGridItemContextMenu = (event) => {\n    let dirent = this.props.dirent;\n    this.props.onGridItemContextMenu(event, dirent);\n  }\n\n  render() {\n    let { dirent, path } = this.props;\n    let direntPath = Utils.joinPath(path, dirent.name);\n    let iconUrl = Utils.getDirentIcon(dirent, true);\n    let fileUrl = dirent.encoded_thumbnail_src ? this.getFileUrl(dirent.encoded_thumbnail_src) : '';\n\n    let toolTipID = '';\n    let tagTitle = '';\n    if (dirent.file_tags && dirent.file_tags.length > 0) {\n      toolTipID = MD5(dirent.name).slice(0, 7);\n      tagTitle = dirent.file_tags.map(item => item.name).join(' ');\n    }\n\n    let dirHref = '';\n    if (this.props.currentRepoInfo) {\n      dirHref = siteRoot + 'library/' + this.props.repoID + '/' + this.props.currentRepoInfo.repo_name + Utils.encodePath(direntPath);\n    }\n    let fileHref = siteRoot + 'lib/' + this.props.repoID + '/file' + Utils.encodePath(direntPath);\n    if (dirent.is_sdoc_revision && dirent.revision_id) {\n      fileHref = siteRoot + 'lib/' + this.props.repoID + '/revisions/' + dirent.revision_id + '/';\n    }\n\n    let gridClass = 'grid-file-img-link cursor-pointer';\n    gridClass += this.state.isGridSelected ? ' grid-selected-active' : ' ';\n    gridClass += this.state.isGridDropTipShow ? ' grid-drop-show' : ' ';\n\n    let lockedInfo = gettext('locked by {name}');\n    lockedInfo = lockedInfo.replace('{name}', dirent.lock_owner_name);\n\n    return (\n      <Fragment>\n        <li className=\"grid-item\" onContextMenu={this.onGridItemContextMenu} onMouseDown={this.onGridItemMouseDown}>\n          <div\n            className={gridClass}\n            draggable={this.canDrag}\n            onClick={this.onItemClick}\n            onDragStart={this.onGridItemDragStart}\n            onDragEnter={this.onGridItemDragEnter}\n            onDragOver={this.onGridItemDragOver}\n            onDragLeave={this.onGridItemDragLeave}\n            onDrop={this.onGridItemDragDrop}\n          >\n            {(this.canPreview && dirent.encoded_thumbnail_src) ?\n              <img src={`${siteRoot}${fileUrl}`} ref={this.gridIcon} className=\"thumbnail\" onClick={this.onItemClick} alt=\"\"/> :\n              <img src={iconUrl} ref={this.gridIcon} width=\"96\" alt='' />\n            }\n            {dirent.is_locked && <img className=\"grid-file-locked-icon\" src={mediaUrl + 'img/file-locked-32.png'} alt={gettext('locked')} title={lockedInfo}/>}\n          </div>\n          <div className=\"grid-file-name\" onDragStart={this.onGridItemDragStart} draggable={this.canDrag} >\n            {(dirent.type !== 'dir' && dirent.file_tags && dirent.file_tags.length > 0) && (\n              <Fragment>\n                <div id={`tag-list-title-${toolTipID}`} className=\"dirent-item tag-list tag-list-stacked d-inline-block align-middle\">\n                  {dirent.file_tags.map((fileTag, index) => {\n                    let length = dirent.file_tags.length;\n                    return (\n                      <span className=\"file-tag\" key={fileTag.id} style={{zIndex:length - index, backgroundColor:fileTag.color}}></span>\n                    );\n                  })}\n                </div>\n                <UncontrolledTooltip target={`tag-list-title-${toolTipID}`} placement=\"bottom\">\n                  {tagTitle}\n                </UncontrolledTooltip>\n              </Fragment>\n            )}\n            {(!dirent.isDir() && !this.canPreview) ? \n              <a className={`sf-link grid-file-name-link ${this.state.isGridSelected ? 'grid-link-selected-active' : ''}`} onClick={this.onItemLinkClick}>{dirent.name}</a> :\n              <a className={`grid-file-name-link ${this.state.isGridSelected ? 'grid-link-selected-active' : ''}`} href={dirent.type === 'dir' ? dirHref : fileHref} onClick={this.onItemLinkClick}>{dirent.name}</a>\n            }\n          </div>\n        </li>\n      </Fragment>\n    );\n  }\n}\n\nDirentGridItem.propTypes = propTypes;\nexport default DirentGridItem;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { siteRoot, thumbnailSizeForOriginal, username } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport URLDecorator from '../../utils/url-decorator';\nimport Loading from '../loading';\nimport ModalPortal from '../modal-portal';\nimport ImageDialog from '../../components/dialog/image-dialog';\nimport DirentGridItem from '../../components/dirent-grid-view/dirent-grid-item';\nimport ContextMenu from '../context-menu/context-menu';\nimport { hideMenu, showMenu } from '../context-menu/actions';\nimport TextTranslation from '../../utils/text-translation';\nimport MoveDirentDialog from '../dialog/move-dirent-dialog';\nimport CopyDirentDialog from '../dialog/copy-dirent-dialog';\nimport ShareDialog from '../dialog/share-dialog';\nimport ZipDownloadDialog from '../dialog/zip-download-dialog';\nimport EditFileTagDialog from '../dialog/edit-filetag-dialog';\nimport Rename from '../../components/dialog/rename-dirent';\nimport CreateFile from '../dialog/create-file-dialog';\nimport CreateFolder from '../dialog/create-folder-dialog';\nimport LibSubFolderPermissionDialog from '../dialog/lib-sub-folder-permission-dialog';\nimport toaster from '../toast';\n\nimport '../../css/grid-view.css';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  currentRepoInfo: PropTypes.object,\n  direntList: PropTypes.array.isRequired,\n  fullDirentList: PropTypes.array,\n  onAddFile: PropTypes.func,\n  onItemDelete: PropTypes.func,\n  onItemCopy: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onRenameNode: PropTypes.func.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  isDirentListLoading: PropTypes.bool.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string, // current path's user permission\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  isDirentDetailShow: PropTypes.bool.isRequired,\n  onGridItemClick: PropTypes.func,\n  onFileTagChanged: PropTypes.func,\n  onAddFolder: PropTypes.func.isRequired,\n  showDirentDetail: PropTypes.func.isRequired,\n  onItemRename: PropTypes.func.isRequired,\n};\n\nclass DirentGridView extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isImagePopupOpen: false,\n      imageItems: [],\n      imageIndex: 0,\n      // onmenuClick\n      isShareDialogShow: false,\n      isMoveDialogShow: false,\n      isCopyDialogShow: false,\n      isEditFileTagShow: false,\n      isZipDialogOpen: false,\n      isRenameDialogShow: false,\n      isCreateFolderDialogShow: false,\n      isCreateFileDialogShow: false,\n      isPermissionDialogOpen: false,\n\n      isMutipleOperation: false,\n      isGridItemFreezed: false,\n      activeDirent: null,\n    };\n    this.isRepoOwner = props.currentRepoInfo.owner_email === username;\n  }\n\n  onCreateFileToggle = () => {\n    this.setState({\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n    });\n  }\n\n  onGridItemClick = (dirent) => {\n    hideMenu();\n    this.setState({activeDirent: dirent});\n    this.props.onGridItemClick(dirent);\n  }\n\n  onMoveToggle = () => {\n    this.setState({isMoveDialogShow: !this.state.isMoveDialogShow});\n  }\n\n  onCopyToggle = () => {\n    this.setState({isCopyDialogShow: !this.state.isCopyDialogShow});\n  }\n\n  onAddFolder = (dirPath) => {\n    this.setState({isCreateFolderDialogShow: false});\n    this.props.onAddFolder(dirPath);\n  }\n\n  onItemShare = (e) => {\n    e.nativeEvent.stopImmediatePropagation(); //for document event\n    this.setState({isShareDialogShow: !this.state.isShareDialogShow});\n  }\n\n  closeSharedDialog = () => {\n    this.setState({isShareDialogShow: !this.state.isShareDialogShow});\n  }\n\n  onItemDelete = (currentObject, e) => {\n    e.nativeEvent.stopImmediatePropagation(); //for document event\n    this.props.onItemDelete(currentObject);\n  }\n\n  onMenuItemClick = (operation, currentObject, event) => {\n    hideMenu();\n    switch(operation) {\n      case 'Download':\n        this.onItemDownload(currentObject, event);\n        break;\n      case 'Share':\n        this.onItemShare(event);\n        break;\n      case 'Delete':\n        this.onItemDelete(currentObject, event);\n        break;\n      case 'Rename':\n        this.onItemRenameToggle();\n        break;\n      case 'Move':\n        this.onItemMoveToggle();\n        break;\n      case 'Copy':\n        this.onItemCopyToggle();\n        break;\n      case 'Tags':\n        this.onEditFileTagToggle();\n        break;\n      case 'Permission':\n        this.onPermissionItem();\n        break;\n      case 'Unlock':\n        this.onUnlockItem(currentObject);\n        break;\n      case 'Lock':\n        this.onLockItem(currentObject);\n        break;\n      case 'Mark as draft':\n        this.onMarkAsDraft(currentObject);\n        break;\n      case 'Unmark as draft':\n        this.onUnmarkAsDraft(currentObject);\n        break;\n      case 'List revisions':\n        this.openRevisionsPage(currentObject);\n        break;\n      case 'Comment':\n        this.onCommentItem();\n        break;\n      case 'History':\n        this.onHistory(currentObject);\n        break;\n      case 'New Folder':\n        this.onCreateFolderToggle(currentObject);\n        break;\n      case 'New File':\n        this.onCreateFileToggle();\n        break;\n      case 'Access Log':\n        this.onAccessLog(currentObject);\n        break;\n      case 'Properties':\n        this.props.showDirentDetail('info');\n        break;\n      case 'Open via Client':\n        this.onOpenViaClient(currentObject);\n        break;\n      default:\n        break;\n    }\n  }\n\n  onEditFileTagToggle = () => {\n    this.setState({\n      isEditFileTagShow: !this.state.isEditFileTagShow\n    });\n  }\n\n  onFileTagChanged = () => {\n    let dirent = this.state.activeDirent ? this.state.activeDirent : '';\n    let direntPath = Utils.joinPath(this.props.path, dirent.name);\n    this.props.onFileTagChanged(dirent, direntPath);\n  }\n\n  getDirentPath = (dirent) => {\n    let path = this.props.path;\n    return path === '/' ? path + dirent.name : path + '/' + dirent.name;\n  }\n\n  closeZipDialog = () => {\n    this.setState({\n      isZipDialogOpen: false\n    });\n  }\n\n  onItemDownload = (currentObject, e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    let dirent = currentObject;\n    let repoID = this.props.repoID;\n    let direntPath = this.getDirentPath(dirent);\n    if (dirent.type === 'dir') {\n      this.setState({\n        isZipDialogOpen: true\n      });\n    } else {\n      let url = URLDecorator.getUrl({type: 'download_file_url', repoID: repoID, filePath: direntPath});\n      location.href = url;\n    }\n  }\n\n  onCreateFolderToggle = () => {\n    this.setState({\n      isCreateFolderDialogShow: !this.state.isCreateFolderDialogShow,\n    });\n  }\n\n  onItemRenameToggle = () => {\n    this.setState({\n      isRenameDialogShow: !this.state.isRenameDialogShow,\n    });\n  }\n\n  onItemMoveToggle = () => {\n    this.setState({isMoveDialogShow: !this.state.isMoveDialogShow});\n  }\n\n  onItemCopyToggle = () => {\n    this.setState({isCopyDialogShow: !this.state.isCopyDialogShow});\n  }\n\n  onPermissionItem = () => {\n    this.setState({isPermissionDialogOpen: !this.state.isPermissionDialogOpen});\n  }\n\n  onLockItem = (currentObject) => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(currentObject);\n    seafileAPI.lockfile(repoID, filePath).then(() => {\n      this.props.updateDirent(currentObject, 'is_locked', true);\n      this.props.updateDirent(currentObject, 'locked_by_me', true);\n      let lockName = username.split('@');\n      this.props.updateDirent(currentObject, 'lock_owner_name', lockName[0]);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onUnlockItem = (currentObject) => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(currentObject);\n    seafileAPI.unlockfile(repoID, filePath).then(() => {\n      this.props.updateDirent(currentObject, 'is_locked', false);\n      this.props.updateDirent(currentObject, 'locked_by_me', false);\n      this.props.updateDirent(currentObject, 'lock_owner_name', '');\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onMarkAsDraft = (currentObject) => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(currentObject);\n    seafileAPI.sdocMarkAsDraft(repoID, filePath).then((res) => {\n      this.props.updateDirent(currentObject, 'is_sdoc_draft', true);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onUnmarkAsDraft = (currentObject) => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(currentObject);\n    seafileAPI.sdocUnmarkAsDraft(repoID, filePath).then((res) => {\n      this.props.updateDirent(currentObject, 'is_sdoc_draft', false);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  openRevisionsPage = (currentObject) => {\n    const repoID = this.props.repoID;\n    const filePath = this.getDirentPath(currentObject);\n    const url = Utils.generateRevisionsURL(siteRoot, repoID, filePath);\n    if (!url) return;\n    window.open(url);\n  }\n\n  onCommentItem = () => {\n    this.props.showDirentDetail('comments');\n  }\n\n  onHistory = (currentObject) => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(currentObject);\n    let url = URLDecorator.getUrl({type: 'file_revisions', repoID: repoID, filePath: filePath});\n    location.href = url;\n  }\n\n  onAccessLog = (currentObject) => {\n    let filePath = this.getDirentPath(currentObject);\n    let path = siteRoot + 'repo/file-access/' + this.props.repoID + '/?p=' + encodeURIComponent(filePath) ;\n    window.open(path);\n  }\n\n  onOpenViaClient = (currentObject) => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(currentObject);\n    let url = URLDecorator.getUrl({type: 'open_via_client', repoID: repoID, filePath: filePath});\n    location.href = url;\n  }\n\n  onItemRename = (newName) => {\n    this.props.onItemRename(this.state.activeDirent, newName);\n  }\n\n  prepareImageItem = (item) => {\n    const useThumbnail = !this.repoEncrypted;\n    const name = item.name;\n\n    const fileExt = name.substr(name.lastIndexOf('.') + 1).toLowerCase();\n    const isGIF = fileExt == 'gif';\n\n    const path = Utils.encodePath(Utils.joinPath(this.props.path, name));\n    const repoID = this.props.repoID;\n    let src;\n    if (useThumbnail && !isGIF) {\n      src = `${siteRoot}thumbnail/${repoID}/${thumbnailSizeForOriginal}${path}`;\n    } else {\n      src = `${siteRoot}repo/${repoID}/raw${path}`;\n    }\n\n    return {\n      'name': name,\n      'url': `${siteRoot}lib/${repoID}/file${path}`,\n      'src': src\n    };\n  }\n\n  showImagePopup = (curItem) => {\n    let items = this.props.fullDirentList.filter((item) => {\n      return Utils.imageCheck(item.name);\n    });\n\n    const imageItems = items.map((item) => {\n      return this.prepareImageItem(item);\n    });\n\n    this.setState({\n      isImagePopupOpen: true,\n      imageItems: imageItems,\n      imageIndex: items.indexOf(curItem)\n    });\n  }\n\n  closeImagePopup = () => {\n    this.setState({isImagePopupOpen: false});\n  }\n\n  moveToPrevImage = () => {\n    const imageItemsLength = this.state.imageItems.length;\n    this.setState((prevState) => ({\n      imageIndex: (prevState.imageIndex + imageItemsLength - 1) % imageItemsLength\n    }));\n  }\n\n  moveToNextImage = () => {\n    const imageItemsLength = this.state.imageItems.length;\n    this.setState((prevState) => ({\n      imageIndex: (prevState.imageIndex + 1) % imageItemsLength\n    }));\n  }\n\n  checkDuplicatedName = (newName) => {\n    return Utils.checkDuplicatedNameInList(this.props.direntList, newName);\n  }\n\n  // common contextmenu handle\n  onMouseDown = (event) => {\n    event.stopPropagation();\n    if (event.button === 2) {\n      return;\n    }\n  }\n\n  onGridContainerMouseDown = (event) => {\n    this.onMouseDown(event);\n  }\n\n  onGridItemMouseDown = (event) => {\n    this.onMouseDown(event);\n  }\n\n  gridContainerClick = () => {\n    hideMenu();\n    if (!this.props.isDirentDetailShow) {\n      this.onGridItemClick(null);\n    }\n  }\n\n  onGridContainerContextMenu = (event) => {\n    event.preventDefault();\n    // Display menu items based on the permissions of the current path\n    let permission = this.props.userPerm;\n    if (permission !== 'admin' && permission !== 'rw') {\n      return;\n    }\n    let id = 'dirent-grid-container-menu';\n    let menuList = [TextTranslation.NEW_FOLDER, TextTranslation.NEW_FILE];\n    this.handleContextClick(event, id, menuList);\n  }\n\n  onGridItemContextMenu = (event, dirent) => {\n    // Display menu items according to the current dirent permission\n    let id = 'grid-item-contextmenu';\n    let menuList = this.getDirentItemMenuList(dirent, true);\n    this.handleContextClick(event, id, menuList, dirent);\n    this.props.onGridItemClick && this.props.onGridItemClick(dirent);\n  }\n\n  handleContextClick = (event, id, menuList, currentObject = null) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    let x = event.clientX || (event.touches && event.touches[0].pageX);\n    let y = event.clientY || (event.touches && event.touches[0].pageY);\n\n    if (this.props.posX) {\n      x -= this.props.posX;\n    }\n    if (this.props.posY) {\n      y -= this.props.posY;\n    }\n\n    hideMenu();\n\n    this.setState({activeDirent: currentObject});\n\n    let showMenuConfig = {\n      id: id,\n      position: { x, y },\n      target: event.target,\n      currentObject: currentObject,\n      menuList: menuList,\n    };\n\n    if (menuList.length === 0) {\n      return;\n    }\n\n    showMenu(showMenuConfig);\n  }\n\n  getDirentItemMenuList = (dirent, isContextmenu) => {\n    const isRepoOwner = this.isRepoOwner;\n    const currentRepoInfo = this.props.currentRepoInfo;\n    return Utils.getDirentOperationList(isRepoOwner, currentRepoInfo, dirent, isContextmenu);\n  }\n\n  render() {\n    let {direntList, path} = this.props;\n    let dirent = this.state.activeDirent ? this.state.activeDirent : '';\n    let direntPath = Utils.joinPath(path, dirent.name);\n\n    if (this.props.isDirentListLoading) {\n      return (<Loading />);\n    }\n\n    return (\n      <Fragment>\n        <ul className=\"grid-view\" onClick={this.gridContainerClick} onContextMenu={this.onGridContainerContextMenu} onMouseDown={this.onGridContainerMouseDown}>\n          {\n            direntList.length !== 0 && direntList.map((dirent, index) => {\n              return (\n                <DirentGridItem\n                  key={index}\n                  dirent={dirent}\n                  repoID={this.props.repoID}\n                  path={this.props.path}\n                  onItemClick={this.props.onItemClick}\n                  currentRepoInfo={this.props.currentRepoInfo}\n                  showImagePopup={this.showImagePopup}\n                  onGridItemContextMenu={this.onGridItemContextMenu}\n                  onItemMove={this.props.onItemMove}\n                  onGridItemMouseDown={this.onGridItemMouseDown}\n                  onGridItemClick={this.onGridItemClick}\n                  activeDirent={this.state.activeDirent}\n                />\n              );\n            })\n          }\n        </ul>\n        <ContextMenu\n          id={'grid-item-contextmenu'}\n          onMenuItemClick={this.onMenuItemClick}\n        />\n        <ContextMenu\n          id={'dirent-grid-container-menu'}\n          onMenuItemClick={this.onMenuItemClick}\n        />\n        {this.state.isCreateFolderDialogShow && (\n          <ModalPortal>\n            <CreateFolder\n              parentPath={this.props.path}\n              onAddFolder={this.onAddFolder}\n              checkDuplicatedName={this.checkDuplicatedName}\n              addFolderCancel={this.onCreateFolderToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isCreateFileDialogShow && (\n          <ModalPortal>\n            <CreateFile\n              parentPath={this.props.path}\n              onAddFile={this.props.onAddFile}\n              checkDuplicatedName={this.checkDuplicatedName}\n              toggleDialog={this.onCreateFileToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isMoveDialogShow &&\n          <MoveDirentDialog\n            path={this.props.path}\n            repoID={this.props.repoID}\n            repoEncrypted={this.props.currentRepoInfo.encrypted}\n            isMutipleOperation={this.state.isMutipleOperation}\n            onItemMove={this.props.onItemMove}\n            onCancelMove={this.onMoveToggle}\n            dirent={this.state.activeDirent}\n          />\n        }\n        {this.state.isZipDialogOpen &&\n          <ModalPortal>\n            <ZipDownloadDialog\n              repoID={this.props.repoID}\n              path={this.props.path}\n              target={dirent.name}\n              toggleDialog={this.closeZipDialog}\n            />\n          </ModalPortal>\n        }\n        {this.state.isCopyDialogShow &&\n          <CopyDirentDialog\n            path={this.props.path}\n            repoID={this.props.repoID}\n            repoEncrypted={this.props.currentRepoInfo.encrypted}\n            isMutipleOperation={this.state.isMutipleOperation}\n            onItemCopy={this.props.onItemCopy}\n            onCancelCopy={this.onCopyToggle}\n            dirent={this.state.activeDirent}\n          />\n        }\n        {this.state.isEditFileTagShow &&\n          <EditFileTagDialog\n            repoID={this.props.repoID}\n            fileTagList={dirent.file_tags}\n            filePath={direntPath}\n            toggleCancel={this.onEditFileTagToggle}\n            onFileTagChanged={this.onFileTagChanged}\n          />\n        }\n        {this.state.isShareDialogShow &&\n          <ModalPortal>\n            <ShareDialog\n              itemType={dirent.type}\n              itemName={dirent.name}\n              itemPath={direntPath}\n              userPerm={dirent.permission}\n              repoID={this.props.repoID}\n              repoEncrypted={false}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              toggleDialog={this.closeSharedDialog}\n            />\n          </ModalPortal>\n        }\n        {this.state.isRenameDialogShow && (\n          <ModalPortal>\n            <Rename\n              dirent={this.state.activeDirent}\n              onRename={this.onItemRename}\n              checkDuplicatedName={this.checkDuplicatedName}\n              toggleCancel={this.onItemRenameToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isPermissionDialogOpen &&\n          <ModalPortal>\n            <LibSubFolderPermissionDialog\n              toggleDialog={this.onPermissionItem}\n              repoID={this.props.repoID}\n              folderPath={direntPath}\n              folderName={dirent.name}\n              isDepartmentRepo={this.props.isGroupOwnedRepo}\n            />\n          </ModalPortal>\n        }\n        {this.state.isImagePopupOpen && (\n          <ModalPortal>\n            <ImageDialog\n              imageItems={this.state.imageItems}\n              imageIndex={this.state.imageIndex}\n              closeImagePopup={this.closeImagePopup}\n              moveToPrevImage={this.moveToPrevImage}\n              moveToNextImage={this.moveToNextImage}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nDirentGridView.propTypes = propTypes;\n\nexport default DirentGridView;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport RepoInfoBar from '../../components/repo-info-bar';\nimport DirentGridView from '../../components/dirent-grid-view/dirent-grid-view';\nimport DirentNoneView from '../../components/dirent-list-view/dirent-none-view';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  currentRepoInfo: PropTypes.object.isRequired,\n  readmeMarkdown: PropTypes.object,\n  draftCounts: PropTypes.number,\n  usedRepoTags: PropTypes.array.isRequired,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  direntList: PropTypes.array.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  onGridItemClick: PropTypes.func,\n  onAddFile: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  onRenameNode: PropTypes.func.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string,\n  isRepoInfoBarShow: PropTypes.bool.isRequired,\n  isDirentListLoading: PropTypes.bool.isRequired,\n  isDirentDetailShow: PropTypes.bool.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  showDirentDetail: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func,\n  onItemRename: PropTypes.func.isRequired,\n};\n\nclass DirGridView extends React.Component {\n\n  render() {\n    if (this.props.path === '/' && this.props.direntList.length === 0) {\n      return (\n        <DirentNoneView\n          path={this.props.path}\n          isDirentListLoading={this.props.isDirentListLoading}\n          onAddFile={this.props.onAddFile}\n        />\n      );\n    }\n    return (\n      <Fragment>\n        {this.props.isRepoInfoBarShow && (\n          <RepoInfoBar\n            repoID={this.props.repoID}\n            currentPath={this.props.path}\n            readmeMarkdown={this.props.readmeMarkdown}\n            draftCounts={this.props.draftCounts}\n            usedRepoTags={this.props.usedRepoTags}\n            updateUsedRepoTags={this.props.updateUsedRepoTags}\n            onFileTagChanged={this.props.onFileTagChanged}\n          />\n        )}\n        <DirentGridView\n          path={this.props.path}\n          repoID={this.props.repoID}\n          currentRepoInfo={this.props.currentRepoInfo}\n          isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n          userPerm={this.props.userPerm}\n          enableDirPrivateShare={this.props.enableDirPrivateShare}\n          direntList={this.props.direntList}\n          fullDirentList={this.props.fullDirentList}\n          onAddFile={this.props.onAddFile}\n          onItemClick={this.props.onItemClick}\n          onItemDelete={this.props.onItemDelete}\n          onItemMove={this.props.onItemMove}\n          onItemCopy={this.props.onItemCopy}\n          isDirentListLoading={this.props.isDirentListLoading}\n          updateDirent={this.props.updateDirent}\n          onRenameNode={this.props.onRenameNode}\n          showDirentDetail={this.props.showDirentDetail}\n          onGridItemClick={this.props.onGridItemClick}\n          isDirentDetailShow={this.props.isDirentDetailShow}\n          onItemRename={this.props.onItemRename}\n          onAddFolder={this.props.onAddFolder}\n          onFileTagChanged={this.props.onFileTagChanged}\n        />\n      </Fragment>\n    );\n  }\n}\n\nDirGridView.propTypes = propTypes;\n\nexport default DirGridView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Alert } from 'reactstrap';\n\nconst propTypes = {\n  currentNode: PropTypes.object,\n  onRename: PropTypes.func.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  checkDuplicatedName: PropTypes.func.isRequired,\n};\n\nclass Rename extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      newName: '',\n      errMessage: '',\n      isSubmitBtnActive: false,\n    };\n    this.newInput = React.createRef();\n  }\n\n  componentWillMount() {\n    this.setState({newName: this.props.currentNode.object.name});\n  }\n\n  componentDidMount() {\n    const { currentNode } = this.props;\n    this.changeState(currentNode);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.changeState(nextProps.currentNode);\n  }\n\n  handleChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({newName: e.target.value});\n  }\n\n  handleSubmit = () => {\n    let { isValid, errMessage } = this.validateInput();\n    if (!isValid) {\n      this.setState({errMessage : errMessage});\n    } else {\n      let isDuplicated = this.checkDuplicatedName();\n      if (isDuplicated) {\n        let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n        errMessage = errMessage.replace('{name}', Utils.HTMLescape(this.state.newName));\n        this.setState({errMessage: errMessage});\n      } else {\n        this.props.onRename(this.state.newName);\n      }\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n    }\n  }\n\n  toggle = () => {\n    this.props.toggleCancel();\n  }\n\n  changeState = (currentNode) => {\n    let name = currentNode.object.name;\n    this.setState({newName: name});\n  }\n\n  validateInput = () => {\n    let newName = this.state.newName.trim();\n    let isValid = true;\n    let errMessage = '';\n    if (!newName) {\n      isValid = false;\n      errMessage = gettext('Name is required.');\n      return { isValid, errMessage };\n    }\n\n    if (newName.indexOf('/') > -1) {\n      isValid = false;\n      errMessage = gettext('Name should not include ' + '\\'/\\'' + '.');\n      return { isValid, errMessage };\n    }\n\n    return { isValid, errMessage };\n  }\n\n  checkDuplicatedName = () => {\n    let isDuplicated = this.props.checkDuplicatedName(this.state.newName);\n    return isDuplicated;\n  }\n\n  onAfterModelOpened = () => {\n    if (!this.newInput.current) return;\n    const { currentNode } = this.props;\n    let type = currentNode.object.type;\n    this.newInput.current.focus();\n    if (type === 'file') {\n      var endIndex = currentNode.object.name.lastIndexOf('.md');\n      this.newInput.current.setSelectionRange(0, endIndex, 'forward');\n    } else {\n      this.newInput.current.setSelectionRange(0, -1);\n    }\n  }\n\n  render() {\n    let type = this.props.currentNode.object.type;\n    return (\n      <Modal isOpen={true} toggle={this.toggle} onOpened={this.onAfterModelOpened}>\n        <ModalHeader toggle={this.toggle}>{type === 'file' ? gettext('Rename File') : gettext('Rename Folder') }</ModalHeader>\n        <ModalBody>\n          <p>{type === 'file' ? gettext('New file name'): gettext('New folder name')}</p>\n          <Input onKeyPress={this.handleKeyPress} innerRef={this.newInput} placeholder=\"newName\" value={this.state.newName} onChange={this.handleChange} />\n          {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nRename.propTypes = propTypes;\n\nexport default Rename;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport TreeView from '../../components/tree-view/tree-view';\nimport Loading from '../../components/loading';\nimport ModalPortal from '../../components/modal-portal';\nimport Rename from '../../components/dialog/rename-dialog';\nimport Copy from '../../components/dialog/copy-dirent-dialog';\nimport Move from '../../components/dialog/move-dirent-dialog';\nimport CreateFolder from '../../components/dialog/create-folder-dialog';\nimport CreateFile from '../../components/dialog/create-file-dialog';\nimport ImageDialog from '../../components/dialog/image-dialog';\nimport { siteRoot, thumbnailSizeForOriginal } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  currentPath: PropTypes.string.isRequired,\n  userPerm: PropTypes.string.isRequired,\n  isTreeDataLoading: PropTypes.bool.isRequired,\n  treeData: PropTypes.object.isRequired,\n  currentNode: PropTypes.object,\n  onNodeClick: PropTypes.func.isRequired,\n  onNodeCollapse: PropTypes.func.isRequired,\n  onNodeExpanded: PropTypes.func.isRequired,\n  onRenameNode: PropTypes.func.isRequired,\n  onDeleteNode: PropTypes.func.isRequired,\n  onAddFileNode: PropTypes.func.isRequired,\n  onAddFolderNode: PropTypes.func.isRequired,\n  repoID: PropTypes.string.isRequired,\n  navRate: PropTypes.number,\n  inResizing: PropTypes.bool.isRequired,\n  currentRepoInfo: PropTypes.object.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n};\n\nclass DirColumnNav extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      opNode: null,\n      isAddFileDialogShow: false,\n      isAddFolderDialogShow: false,\n      isRenameDialogShow: false,\n      isNodeImagePopupOpen: false,\n      imageNodeItems: [],\n      imageIndex: 0,\n      isCopyDialogShow: false,\n      isMoveDialogShow: false,\n      isMutipleOperation: false,\n    };\n    this.isNodeMenuShow = true;\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({opNode: nextProps.currentNode});\n  }\n\n  onNodeClick = (node) => {\n    this.setState({opNode: node});\n    if (Utils.imageCheck(node.object.name)) {\n      this.showNodeImagePopup(node);\n      return;\n    }\n    this.props.onNodeClick(node);\n  }\n\n  onMenuItemClick = (operation, node) => {\n    this.setState({opNode: node});\n    switch (operation) {\n      case 'New Folder':\n        if (!node) {\n          this.onAddFolderToggle('root');\n        } else {\n          this.onAddFolderToggle();\n        }\n        break;\n      case 'New File':\n        if (!node) {\n          this.onAddFileToggle('root');\n        } else {\n          this.onAddFileToggle();\n        }\n        break;\n      case 'Rename':\n        this.onRenameToggle();\n        break;\n      case 'Delete':\n        this.onDeleteNode(node);\n        break;\n      case 'Copy':\n        this.onCopyToggle();\n        break;\n      case 'Move':\n        this.onMoveToggle();\n        break;\n      case 'Open in New Tab':\n        this.onOpenFile(node);\n        break;\n    }\n  }\n\n  onAddFileToggle = (type) => {\n    if (type === 'root') {\n      let root = this.props.treeData.root;\n      this.setState({\n        isAddFileDialogShow: !this.state.isAddFileDialogShow,\n        opNode: root,\n      });\n    } else {\n      this.setState({isAddFileDialogShow: !this.state.isAddFileDialogShow});\n    }\n  }\n\n  onAddFolderToggle = (type) => {\n    if (type === 'root') {\n      let root = this.props.treeData.root;\n      this.setState({\n        isAddFolderDialogShow: !this.state.isAddFolderDialogShow,\n        opNode: root,\n      });\n    } else {\n      this.setState({isAddFolderDialogShow: !this.state.isAddFolderDialogShow});\n    }\n  }\n\n  onRenameToggle = () => {\n    this.setState({isRenameDialogShow: !this.state.isRenameDialogShow});\n  }\n\n  onCopyToggle = () => {\n    this.setState({isCopyDialogShow: !this.state.isCopyDialogShow});\n  }\n\n  onMoveToggle = () => {\n    this.setState({isMoveDialogShow: !this.state.isMoveDialogShow});\n  }\n\n  onAddFolderNode = (dirPath) => {\n    this.setState({isAddFolderDialogShow: !this.state.isAddFolderDialogShow});\n    this.props.onAddFolderNode(dirPath);\n  }\n\n  onRenameNode = (newName) => {\n    this.setState({isRenameDialogShow: !this.state.isRenameDialogShow});\n    let node = this.state.opNode;\n    this.props.onRenameNode(node, newName);\n  }\n\n  onDeleteNode = (node) => {\n    this.props.onDeleteNode(node);\n  }\n\n  onOpenFile = (node) => {\n    let newUrl = siteRoot + 'lib/' + this.props.repoID + '/file' + Utils.encodePath(node.path);\n    window.open(newUrl, '_blank');\n  }\n\n  checkDuplicatedName = (newName) => {\n    let node = this.state.opNode;\n    // root node to new node conditions: parentNode is null,\n    let parentNode = node.parentNode ? node.parentNode : node;\n    let childrenObject = parentNode.children.map(item => {\n      return item.object;\n    });\n    let isDuplicated = childrenObject.some(object => {\n      return object.name === newName;\n    });\n    return isDuplicated;\n  }\n\n  showNodeImagePopup = (node) => {\n    let childrenNode = node.parentNode.children;\n    let items = childrenNode.filter((item) => {\n      return Utils.imageCheck(item.object.name);\n    });\n    let imageNames = items.map((item) => {\n      return item.object.name;\n    });\n    this.setState({\n      isNodeImagePopupOpen: true,\n      imageNodeItems: this.prepareImageItems(node),\n      imageIndex: imageNames.indexOf(node.object.name)\n    });\n  }\n\n  prepareImageItems = (node) => {\n    let childrenNode = node.parentNode.children;\n    let items = childrenNode.filter((item) => {\n      return Utils.imageCheck(item.object.name);\n    });\n\n    const useThumbnail = !this.props.currentRepoInfo.encrypted;\n    let prepareItem = (item) => {\n      const name = item.object.name;\n\n      const path = Utils.encodePath(Utils.joinPath(node.parentNode.path, name));\n      const fileExt = name.substr(name.lastIndexOf('.') + 1).toLowerCase();\n      const isGIF = fileExt === 'gif';\n\n      const repoID = this.props.repoID;\n      let src = '';\n      if (useThumbnail && !isGIF) {\n        src = `${siteRoot}thumbnail/${repoID}/${thumbnailSizeForOriginal}${path}`;\n      } else {\n        src = `${siteRoot}repo/${repoID}/raw${path}`;\n      }\n\n      return {\n        'name': name,\n        'url': `${siteRoot}lib/${repoID}/file${path}`,\n        'src': src\n      };\n    };\n\n    return items.map((item) => { return prepareItem(item); });\n  }\n\n  closeNodeImagePopup = () => {\n    this.setState({\n      isNodeImagePopupOpen: false\n    });\n  }\n\n  moveToPrevImage = () => {\n    const imageItemsLength = this.state.imageNodeItems.length;\n    this.setState((prevState) => ({\n      imageIndex: (prevState.imageIndex + imageItemsLength - 1) % imageItemsLength\n    }));\n  }\n\n  moveToNextImage = () => {\n    const imageItemsLength = this.state.imageNodeItems.length;\n    this.setState((prevState) => ({\n      imageIndex: (prevState.imageIndex + 1) % imageItemsLength\n    }));\n  }\n\n  stopTreeScrollPropagation = (e) => {\n    e.stopPropagation();\n  }\n\n  render() {\n    let flex = this.props.navRate ? '0 0 ' + this.props.navRate * 100 + '%' : '0 0 25%';\n    const select = this.props.inResizing ? 'none' : '';\n    return (\n      <Fragment>\n        <div className=\"dir-content-nav\" role=\"navigation\" style={{flex: (flex), userSelect: select}} onScroll={this.stopTreeScrollPropagation}>\n          {this.props.isTreeDataLoading ?\n            (<Loading/>) :\n            (<TreeView\n              userPerm={this.props.userPerm}\n              isNodeMenuShow={this.isNodeMenuShow}\n              treeData={this.props.treeData}\n              currentPath={this.props.currentPath}\n              onNodeClick={this.onNodeClick}\n              onNodeExpanded={this.props.onNodeExpanded}\n              onNodeCollapse={this.props.onNodeCollapse}\n              onMenuItemClick={this.onMenuItemClick}\n              onFreezedItem={this.onFreezedItem}\n              onUnFreezedItem={this.onUnFreezedItem}\n              onItemMove={this.props.onItemMove}\n              currentRepoInfo={this.props.currentRepoInfo}\n              selectedDirentList={this.props.selectedDirentList}\n              onItemsMove={this.props.onItemsMove}\n            />)\n          }\n        </div>\n        {this.state.isAddFolderDialogShow && (\n          <ModalPortal>\n            <CreateFolder\n              parentPath={this.state.opNode.path}\n              onAddFolder={this.onAddFolderNode}\n              checkDuplicatedName={this.checkDuplicatedName}\n              addFolderCancel={this.onAddFolderToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isAddFileDialogShow && (\n          <ModalPortal>\n            <CreateFile\n              parentPath={this.state.opNode.path}\n              onAddFile={this.props.onAddFileNode}\n              checkDuplicatedName={this.checkDuplicatedName}\n              toggleDialog={this.onAddFileToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isRenameDialogShow && (\n          <ModalPortal>\n            <Rename\n              currentNode={this.state.opNode}\n              onRename={this.onRenameNode}\n              checkDuplicatedName={this.checkDuplicatedName}\n              toggleCancel={this.onRenameToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isCopyDialogShow && (\n          <ModalPortal>\n            <Copy\n              path={this.state.opNode.parentNode.path}\n              repoID={this.props.repoID}\n              dirent={this.state.opNode.object}\n              onItemCopy={this.props.onItemCopy}\n              repoEncrypted={this.props.currentRepoInfo.encrypted}\n              onCancelCopy={this.onCopyToggle}\n              isMutipleOperation={this.state.isMutipleOperation}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isMoveDialogShow && (\n          <ModalPortal>\n            <Move\n              path={this.state.opNode.parentNode.path}\n              repoID={this.props.repoID}\n              dirent={this.state.opNode.object}\n              onItemMove={this.props.onItemMove}\n              repoEncrypted={this.props.currentRepoInfo.encrypted}\n              onCancelMove={this.onMoveToggle}\n              isMutipleOperation={this.state.isMutipleOperation}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isNodeImagePopupOpen && (\n          <ModalPortal>\n            <ImageDialog\n              imageItems={this.state.imageNodeItems}\n              imageIndex={this.state.imageIndex}\n              closeImagePopup={this.closeNodeImagePopup}\n              moveToPrevImage={this.moveToPrevImage}\n              moveToNextImage={this.moveToNextImage}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nDirColumnNav.defaultProps={\n  navRate: 0.25\n};\n\nDirColumnNav.propTypes = propTypes;\n\nexport default DirColumnNav;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Utils } from '../../utils/utils';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport toaster from '../toast';\nimport WikiMarkdownViewer from '../wiki-markdown-viewer';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  hash: PropTypes.string,\n  isDraft: PropTypes.bool,\n  hasDraft: PropTypes.bool,\n  goDraftPage: PropTypes.func.isRequired,\n  isFileLoading: PropTypes.bool.isRequired,\n  isFileLoadedErr: PropTypes.bool.isRequired,\n  filePermission: PropTypes.string,\n  content: PropTypes.string,\n  lastModified: PropTypes.string,\n  latestContributor: PropTypes.string,\n  onLinkClick: PropTypes.func.isRequired,\n};\n\nclass DirColumnFile extends React.Component {\n\n  componentDidMount() {\n    if (this.props.hash) {\n      let hash = this.props.hash;\n      setTimeout(function() {\n        window.location.hash = hash;\n      }, 500);\n    }\n  }\n\n  onEditClick = (e) => {\n    e.preventDefault();\n    let { path, repoID } = this.props;\n    let url = siteRoot + 'lib/' + repoID + '/file' + Utils.encodePath(path) + '?mode=edit';\n    window.open(url);\n  }\n\n  onNewDraft = (e) => {\n    e.preventDefault();\n    let { path, repoID } = this.props;\n    seafileAPI.createDraft(repoID, path).then(res => {\n      window.location.href = siteRoot + 'lib/' + res.data.origin_repo_id + '/file' + res.data.draft_file_path + '?mode=edit';\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onOpenFile = (e) => {\n    e.preventDefault();\n    let { path, repoID } = this.props;\n    let newUrl = siteRoot + 'lib/' + repoID + '/file' + Utils.encodePath(path);\n    window.open(newUrl, '_blank');\n  }\n\n  goDraftPage = (e) => {\n    e.preventDefault();\n    this.props.goDraftPage();\n  }\n\n  render() {\n    if (this.props.isFileLoadedErr) {\n      return (\n        <div className=\"message err-tip\">{gettext('File does not exist.')}</div>\n      );\n    }\n    return (\n      <WikiMarkdownViewer\n        isTOCShow={false}\n        isFileLoading={this.props.isFileLoading}\n        markdownContent={this.props.content}\n        lastModified = {this.props.lastModified}\n        latestContributor={this.props.latestContributor}\n        onLinkClick={this.props.onLinkClick}\n        repoID={this.props.repoID}\n        path={this.props.path}\n      >\n        <Fragment>\n          <span className='wiki-open-file position-fixed' onClick={this.onOpenFile}>\n            <i className=\"fas fa-expand-arrows-alt\"></i>\n          </span>\n          {(!this.props.isDraft && this.props.hasDraft) &&\n            <div className='seafile-btn-view-review text-center mt-2'>\n              <div className='tag tag-green'>\n                {gettext('This file is in draft stage.')}\n                <span className=\"ml-2\" onClick={this.goDraftPage}>{gettext('View Draft')}</span>\n              </div>\n            </div>\n          }\n        </Fragment>\n      </WikiMarkdownViewer>\n    );\n  }\n}\n\nDirColumnFile.propTypes = propTypes;\n\nexport default DirColumnFile;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport DirColumnNav from './dir-column-nav';\nimport DirColumnFile from './dir-column-file';\nimport DirListView from './dir-list-view';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  // repoinfo\n  currentRepoInfo: PropTypes.object.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  // tree\n  isTreeDataLoading: PropTypes.bool.isRequired,\n  treeData: PropTypes.object.isRequired,\n  currentNode: PropTypes.object,\n  onNodeClick: PropTypes.func.isRequired,\n  onNodeCollapse: PropTypes.func.isRequired,\n  onNodeExpanded: PropTypes.func.isRequired,\n  onRenameNode: PropTypes.func.isRequired,\n  onDeleteNode: PropTypes.func.isRequired,\n  onAddFileNode: PropTypes.func.isRequired,\n  onAddFolderNode: PropTypes.func.isRequired,\n  // file\n  isViewFile: PropTypes.bool.isRequired,\n  isFileLoading: PropTypes.bool.isRequired,\n  isFileLoadedErr: PropTypes.bool.isRequired,\n  hash: PropTypes.string,\n  isDraft: PropTypes.bool.isRequired,\n  hasDraft: PropTypes.bool.isRequired,\n  goDraftPage: PropTypes.func.isRequired,\n  filePermission: PropTypes.string,\n  content: PropTypes.string,\n  lastModified: PropTypes.string,\n  latestContributor: PropTypes.string,\n  onLinkClick: PropTypes.func.isRequired,\n  // repo content\n  isRepoInfoBarShow: PropTypes.bool.isRequired,\n  draftCounts: PropTypes.number.isRequired,\n  usedRepoTags: PropTypes.array.isRequired,\n  readmeMarkdown: PropTypes.object,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  // list\n  isDirentListLoading: PropTypes.bool.isRequired,\n  direntList: PropTypes.array.isRequired,\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  sortItems: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  onItemSelected: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func.isRequired,\n  onItemRename: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  onDirentClick: PropTypes.func.isRequired,\n  isAllItemSelected: PropTypes.bool.isRequired,\n  onAllItemSelected: PropTypes.func.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onItemsCopy: PropTypes.func.isRequired,\n  onItemsDelete: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func,\n  showDirentDetail: PropTypes.func.isRequired,\n};\n\nclass DirColumnView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      inResizing: false,\n      navRate: 0.25,\n    };\n    this.containerWidth = null;\n  }\n\n  onResizeMouseUp = () => {\n    if (this.state.inResizing) {\n      this.setState({\n        inResizing: false\n      });\n    }\n    this.setCookie('navRate', this.state.navRate);\n  }\n\n  onResizeMouseDown = () => {\n    this.containerWidth = this.refs.viewModeContainer.clientWidth;\n    this.setState({\n      inResizing: true\n    });\n  };\n\n  onResizeMouseMove = (e) => {\n    let sizeNavWidth = this.containerWidth / 0.78 * 0.22 + 3;\n    let rate = (e.nativeEvent.clientX - sizeNavWidth) / this.containerWidth;\n    if (rate < 0.1) {\n      this.setState({\n        inResizing: false,\n        navRate: 0.12,\n      });\n    }\n    else if (rate > 0.4) {\n      this.setState({\n        inResizing: false,\n        navRate: 0.38,\n      });\n    }\n    else {\n      this.setState({\n        navRate: rate\n      });\n    }\n  };\n\n  setCookie = (name, value) => {\n    let cookie = name + '=' + value + ';';\n    document.cookie = cookie;\n  }\n\n  getCookie = (cookiename) => {\n    let name = cookiename + '=';\n    let cookie = document.cookie.split(';');\n    for (let i = 0, len = cookie.length; i < len; i++) {\n      let c = cookie[i].trim();\n      if (c.indexOf(name) == 0) {\n        return c.substring(name.length, c.length) * 1;\n      }\n    }\n    return '';\n  }\n\n  componentWillMount() {\n    let rate = this.getCookie('navRate');\n    if (rate) {\n      this.setState({\n        navRate: rate,\n      });\n    }\n  }\n\n  render() {\n    const onResizeMove = this.state.inResizing ? this.onResizeMouseMove : null;\n    const select = this.state.inResizing ? 'none' : '';\n    const mainFlex = '1 0 ' + (1 - this.state.navRate - 0.05) * 100 + '%';\n    return (\n      <div className=\"dir-colunm-view\" onMouseMove={onResizeMove} onMouseUp={this.onResizeMouseUp} ref=\"viewModeContainer\">\n        <DirColumnNav\n          currentPath={this.props.path}\n          userPerm={this.props.userPerm}\n          isTreeDataLoading={this.props.isTreeDataLoading}\n          treeData={this.props.treeData}\n          currentNode={this.props.currentNode}\n          onNodeClick={this.props.onNodeClick}\n          onNodeCollapse={this.props.onNodeCollapse}\n          onNodeExpanded={this.props.onNodeExpanded}\n          onAddFolderNode={this.props.onAddFolderNode}\n          onAddFileNode={this.props.onAddFileNode}\n          onRenameNode={this.props.onRenameNode}\n          onDeleteNode={this.props.onDeleteNode}\n          repoID={this.props.repoID}\n          navRate={this.state.navRate}\n          inResizing={this.state.inResizing}\n          currentRepoInfo={this.props.currentRepoInfo}\n          onItemMove={this.props.onItemMove}\n          onItemCopy={this.props.onItemCopy}\n          selectedDirentList={this.props.selectedDirentList}\n          onItemsMove={this.props.onItemsMove}\n        />\n        <div className=\"dir-content-resize\" onMouseDown={this.onResizeMouseDown}></div>\n        <div className=\"dir-content-main\" style={{userSelect: select, flex: mainFlex}}>\n          {this.props.isViewFile ? (\n            <DirColumnFile\n              path={this.props.path}\n              repoID={this.props.repoID}\n              hash={this.props.hash}\n              isDraft={this.props.isDraft}\n              hasDraft={this.props.hasDraft}\n              goDraftPage={this.props.goDraftPage}\n              isFileLoading={this.props.isFileLoading}\n              isFileLoadedErr={this.props.isFileLoadedErr}\n              filePermission={this.props.filePermission}\n              content={this.props.content}\n              lastModified={this.props.lastModified}\n              latestContributor={this.props.latestContributor}\n              onLinkClick={this.props.onLinkClick}\n            />\n          ) : (\n            <DirListView\n              path={this.props.path}\n              repoID={this.props.repoID}\n              currentRepoInfo={this.props.currentRepoInfo}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              userPerm={this.props.userPerm}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              isRepoInfoBarShow={this.props.isRepoInfoBarShow}\n              usedRepoTags={this.props.usedRepoTags}\n              readmeMarkdown={this.props.readmeMarkdown}\n              draftCounts={this.props.draftCounts}\n              updateUsedRepoTags={this.props.updateUsedRepoTags}\n              isDirentListLoading={this.props.isDirentListLoading}\n              direntList={this.props.direntList}\n              fullDirentList={this.props.fullDirentList}\n              sortBy={this.props.sortBy}\n              sortOrder={this.props.sortOrder}\n              sortItems={this.props.sortItems}\n              onAddFolder={this.props.onAddFolder}\n              onAddFile={this.props.onAddFile}\n              onItemClick={this.props.onItemClick}\n              onItemSelected={this.props.onItemSelected}\n              onItemDelete={this.props.onItemDelete}\n              onItemRename={this.props.onItemRename}\n              onItemMove={this.props.onItemMove}\n              onItemCopy={this.props.onItemCopy}\n              onDirentClick={this.props.onDirentClick}\n              updateDirent={this.props.updateDirent}\n              isAllItemSelected={this.props.isAllItemSelected}\n              onAllItemSelected={this.props.onAllItemSelected}\n              selectedDirentList={this.props.selectedDirentList}\n              onItemsMove={this.props.onItemsMove}\n              onItemsCopy={this.props.onItemsCopy}\n              onItemsDelete={this.props.onItemsDelete}\n              onFileTagChanged={this.props.onFileTagChanged}\n              showDirentDetail={this.props.showDirentDetail}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nDirColumnView.propTypes = propTypes;\n\nexport default DirColumnView;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport CurDirPath from '../../components/cur-dir-path';\nimport DirentDetail from '../../components/dirent-detail/dirent-details';\nimport LibDetail from '../../components/dirent-detail/lib-details';\nimport DirListView from '../../components/dir-view-mode/dir-list-view';\nimport DirGridView from '../../components/dir-view-mode/dir-grid-view';\nimport DirColumnView from '../../components/dir-view-mode/dir-column-view';\n\nimport '../../css/lib-content-view.css';\n\nconst propTypes = {\n  pathPrefix: PropTypes.array.isRequired,\n  currentMode: PropTypes.string.isRequired,\n  path: PropTypes.string.isRequired,\n  pathExist: PropTypes.bool.isRequired,\n  // repoinfo\n  currentRepoInfo: PropTypes.object.isRequired,\n  repoID: PropTypes.string.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string,\n  // path func\n  onTabNavClick: PropTypes.func.isRequired,\n  onMainNavBarClick: PropTypes.func.isRequired,\n  // file\n  isViewFile: PropTypes.bool.isRequired,\n  isFileLoadedErr: PropTypes.bool.isRequired,\n  hash: PropTypes.string,\n  isDraft: PropTypes.bool.isRequired,\n  hasDraft: PropTypes.bool.isRequired,\n  fileTags: PropTypes.array.isRequired,\n  goDraftPage: PropTypes.func.isRequired,\n  isFileLoading: PropTypes.bool.isRequired,\n  filePermission: PropTypes.string,\n  content: PropTypes.string,\n  lastModified: PropTypes.string,\n  latestContributor: PropTypes.string,\n  onLinkClick: PropTypes.func.isRequired,\n  // tree\n  isTreeDataLoading: PropTypes.bool.isRequired,\n  treeData: PropTypes.object.isRequired,\n  currentNode: PropTypes.object,\n  onNodeClick: PropTypes.func.isRequired,\n  onNodeCollapse: PropTypes.func.isRequired,\n  onNodeExpanded: PropTypes.func.isRequired,\n  onRenameNode: PropTypes.func.isRequired,\n  onDeleteNode: PropTypes.func.isRequired,\n  onAddFileNode: PropTypes.func.isRequired,\n  onAddFolderNode: PropTypes.func.isRequired,\n  // repo content\n  draftCounts: PropTypes.number,\n  usedRepoTags: PropTypes.array.isRequired,\n  readmeMarkdown: PropTypes.object,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  // list\n  isDirentListLoading: PropTypes.bool.isRequired,\n  direntList: PropTypes.array.isRequired,\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  sortItems: PropTypes.func.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  onItemSelected: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func.isRequired,\n  onItemRename: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n  isDirentSelected: PropTypes.bool.isRequired,\n  isAllDirentSelected: PropTypes.bool.isRequired,\n  onAllDirentSelected: PropTypes.func.isRequired,\n  isDirentDetailShow: PropTypes.bool.isRequired,\n  selectedDirent: PropTypes.object,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onItemsCopy: PropTypes.func.isRequired,\n  onItemsDelete: PropTypes.func.isRequired,\n  closeDirentDetail: PropTypes.func.isRequired,\n  showDirentDetail: PropTypes.func.isRequired,\n  onDeleteRepoTag: PropTypes.func.isRequired,\n  updateDetail: PropTypes.bool.isRequired,\n  onListContainerScroll: PropTypes.func.isRequired,\n  onDirentClick: PropTypes.func.isRequired,\n  direntDetailPanelTab: PropTypes.string,\n  loadDirentList: PropTypes.func.isRequired,\n};\n\nclass LibContentContainer extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentDirent: null,\n    };\n\n    this.errMessage = (<div className=\"message err-tip\">{gettext('Folder does not exist.')}</div>);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.path !== this.props.path || nextProps.updateDetail !== this.props.updateDetail) {\n      this.setState({currentDirent: null});\n    }\n  }\n\n  onPathClick = (path) => {\n    this.props.onMainNavBarClick(path);\n    this.props.closeDirentDetail();\n  }\n\n  onItemClick = (dirent) => {\n    this.props.onItemClick(dirent);\n    this.props.closeDirentDetail();\n  }\n\n  onGridItemClick = (dirent) => {\n    this.setState({currentDirent: dirent});\n    this.props.onDirentClick(dirent);\n  }\n\n  // on '<tr>'\n  onDirentClick = (dirent) => {\n    this.setState({currentDirent: dirent});\n    this.props.onDirentClick(dirent);\n  }\n\n  onItemSelected = (dirent) => {\n    this.setState({currentDirent: dirent});\n    this.props.onItemSelected(dirent);\n  }\n\n  onItemDelete = (dirent) => {\n    this.checkCurrentDirent(dirent);\n    this.props.onItemDelete(dirent);\n  }\n\n  onItemMove = (destRepo, dirent, selectedPath, currentPath) => {\n    this.checkCurrentDirent(dirent);\n    this.props.onItemMove(destRepo, dirent, selectedPath, currentPath);\n  }\n\n  checkCurrentDirent = (deletedDirent) => {\n    let { currentDirent } = this.state;\n    if (currentDirent && deletedDirent.name === currentDirent.name) {\n      this.setState({currentDirent: null});\n    }\n  }\n\n  onItemsScroll = (e) => {\n    let target = e.target;\n\n    if (target.scrollTop === 0) {\n      return;\n    }\n\n    if (target.scrollTop + target.clientHeight + 1 >= target.scrollHeight) {\n      this.props.onListContainerScroll();\n    }\n  }\n\n  render() {\n    let { path, repoID, usedRepoTags, readmeMarkdown, draftCounts } = this.props;\n    let isRepoInfoBarShow = false;\n    if (path === '/') {\n      if (usedRepoTags.length !== 0 || readmeMarkdown !== null || draftCounts !== 0) {\n        isRepoInfoBarShow = true;\n      }\n    }\n\n    return (\n      <Fragment>\n        <div className=\"cur-view-container\">\n          {this.props.currentRepoInfo.status === 'read-only' &&\n            <div className=\"readonly-tip-message\">\n              {gettext('This library has been set to read-only by admin and cannot be updated.')}\n            </div>\n          }\n          <div className=\"cur-view-path\">\n            <CurDirPath\n              repoID={repoID}\n              repoName={this.props.currentRepoInfo.repo_name}\n              pathPrefix={this.props.pathPrefix}\n              currentPath={this.props.path}\n              userPerm={this.props.userPerm}\n              isViewFile={this.props.isViewFile}\n              onTabNavClick={this.props.onTabNavClick}\n              onPathClick={this.onPathClick}\n              updateUsedRepoTags={this.props.updateUsedRepoTags}\n              fileTags={this.props.fileTags}\n              onDeleteRepoTag={this.props.onDeleteRepoTag}\n              direntList={this.props.direntList}\n              sortBy={this.props.sortBy}\n              sortOrder={this.props.sortOrder}\n              sortItems={this.props.sortItems}\n            />\n          </div>\n          <div className={`cur-view-content lib-content-container ${this.props.currentMode === 'column' ? 'view-mode-container' : ''}`} onScroll={this.onItemsScroll}>\n            {!this.props.pathExist && this.errMessage}\n            {this.props.pathExist && (\n              <Fragment>\n                {this.props.currentMode === 'list' && (\n                  <DirListView\n                    path={this.props.path}\n                    repoID={repoID}\n                    currentRepoInfo={this.props.currentRepoInfo}\n                    isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n                    userPerm={this.props.userPerm}\n                    enableDirPrivateShare={this.props.enableDirPrivateShare}\n                    isRepoInfoBarShow={isRepoInfoBarShow}\n                    usedRepoTags={this.props.usedRepoTags}\n                    readmeMarkdown={this.props.readmeMarkdown}\n                    draftCounts={this.props.draftCounts}\n                    updateUsedRepoTags={this.props.updateUsedRepoTags}\n                    isDirentListLoading={this.props.isDirentListLoading}\n                    direntList={this.props.direntList}\n                    fullDirentList={this.props.fullDirentList}\n                    sortBy={this.props.sortBy}\n                    sortOrder={this.props.sortOrder}\n                    sortItems={this.props.sortItems}\n                    onAddFolder={this.props.onAddFolder}\n                    onAddFile={this.props.onAddFile}\n                    onItemClick={this.onItemClick}\n                    onItemSelected={this.onItemSelected}\n                    onItemDelete={this.onItemDelete}\n                    onItemRename={this.props.onItemRename}\n                    onItemMove={this.onItemMove}\n                    onItemCopy={this.props.onItemCopy}\n                    onDirentClick={this.onDirentClick}\n                    updateDirent={this.props.updateDirent}\n                    isAllItemSelected={this.props.isAllDirentSelected}\n                    onAllItemSelected={this.props.onAllDirentSelected}\n                    selectedDirentList={this.props.selectedDirentList}\n                    onItemsMove={this.props.onItemsMove}\n                    onItemsCopy={this.props.onItemsCopy}\n                    onItemsDelete={this.props.onItemsDelete}\n                    onFileTagChanged={this.props.onFileTagChanged}\n                    showDirentDetail={this.props.showDirentDetail}\n                    loadDirentList={this.props.loadDirentList}\n                  />\n                )}\n                {this.props.currentMode === 'grid' && (\n                  <DirGridView\n                    path={this.props.path}\n                    repoID={repoID}\n                    currentRepoInfo={this.props.currentRepoInfo}\n                    isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n                    userPerm={this.props.userPerm}\n                    enableDirPrivateShare={this.props.enableDirPrivateShare}\n                    onRenameNode={this.props.onRenameNode}\n                    isRepoInfoBarShow={isRepoInfoBarShow}\n                    usedRepoTags={this.props.usedRepoTags}\n                    readmeMarkdown={this.props.readmeMarkdown}\n                    draftCounts={this.props.draftCounts}\n                    updateUsedRepoTags={this.props.updateUsedRepoTags}\n                    isDirentListLoading={this.props.isDirentListLoading}\n                    direntList={this.props.direntList}\n                    fullDirentList={this.props.fullDirentList}\n                    onAddFile={this.props.onAddFile}\n                    onItemClick={this.onItemClick}\n                    onItemDelete={this.props.onItemDelete}\n                    onItemMove={this.onItemMove}\n                    onItemCopy={this.props.onItemCopy}\n                    updateDirent={this.props.updateDirent}\n                    onAddFolder={this.props.onAddFolder}\n                    showDirentDetail={this.props.showDirentDetail}\n                    onGridItemClick={this.onGridItemClick}\n                    isDirentDetailShow={this.props.isDirentDetailShow}\n                    onItemRename={this.props.onItemRename}\n                    onFileTagChanged={this.props.onFileTagChanged}\n                  />\n                )}\n                {this.props.currentMode === 'column' && (\n                  <DirColumnView\n                    path={this.props.path}\n                    repoID={repoID}\n                    currentRepoInfo={this.props.currentRepoInfo}\n                    isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n                    userPerm={this.props.userPerm}\n                    enableDirPrivateShare={this.props.enableDirPrivateShare}\n                    isTreeDataLoading={this.props.isTreeDataLoading}\n                    treeData={this.props.treeData}\n                    currentNode={this.props.currentNode}\n                    onNodeClick={this.props.onNodeClick}\n                    onNodeCollapse={this.props.onNodeCollapse}\n                    onNodeExpanded={this.props.onNodeExpanded}\n                    onAddFolderNode={this.props.onAddFolder}\n                    onAddFileNode={this.props.onAddFile}\n                    onRenameNode={this.props.onRenameNode}\n                    onDeleteNode={this.props.onDeleteNode}\n                    isViewFile={this.props.isViewFile}\n                    isFileLoading={this.props.isFileLoading}\n                    isFileLoadedErr={this.props.isFileLoadedErr}\n                    hash={this.props.hash}\n                    isDraft={this.props.isDraft}\n                    hasDraft={this.props.hasDraft}\n                    goDraftPage={this.props.goDraftPage}\n                    filePermission={this.props.filePermission}\n                    content={this.props.content}\n                    lastModified={this.props.lastModified}\n                    latestContributor={this.props.latestContributor}\n                    onLinkClick={this.props.onLinkClick}\n                    isRepoInfoBarShow={isRepoInfoBarShow}\n                    usedRepoTags={this.props.usedRepoTags}\n                    readmeMarkdown={this.props.readmeMarkdown}\n                    draftCounts={this.props.draftCounts}\n                    updateUsedRepoTags={this.props.updateUsedRepoTags}\n                    isDirentListLoading={this.props.isDirentListLoading}\n                    direntList={this.props.direntList}\n                    fullDirentList={this.props.fullDirentList}\n                    sortBy={this.props.sortBy}\n                    sortOrder={this.props.sortOrder}\n                    sortItems={this.props.sortItems}\n                    onAddFolder={this.props.onAddFolder}\n                    onAddFile={this.props.onAddFile}\n                    onItemClick={this.onItemClick}\n                    onItemSelected={this.onItemSelected}\n                    onItemDelete={this.onItemDelete}\n                    onItemRename={this.props.onItemRename}\n                    onItemMove={this.onItemMove}\n                    onItemCopy={this.props.onItemCopy}\n                    onDirentClick={this.onDirentClick}\n                    updateDirent={this.props.updateDirent}\n                    isAllItemSelected={this.props.isAllDirentSelected}\n                    onAllItemSelected={this.props.onAllDirentSelected}\n                    selectedDirentList={this.props.selectedDirentList}\n                    onItemsMove={this.props.onItemsMove}\n                    onItemsCopy={this.props.onItemsCopy}\n                    onItemsDelete={this.props.onItemsDelete}\n                    onFileTagChanged={this.props.onFileTagChanged}\n                    showDirentDetail={this.props.showDirentDetail}\n                  />\n                )}\n              </Fragment>\n            )}\n          </div>\n        </div>\n        {this.props.isDirentDetailShow &&\n          <Fragment>\n            <div className=\"cur-view-detail\">\n              {(this.props.path === '/' && !this.state.currentDirent) ?\n                <LibDetail\n                  currentRepo={this.props.currentRepoInfo}\n                  closeDetails={this.props.closeDirentDetail}\n                /> :\n                <DirentDetail\n                  repoID={repoID}\n                  path={this.props.path}\n                  dirent={this.state.currentDirent}\n                  currentRepoInfo={this.props.currentRepoInfo}\n                  fileTags={this.props.isViewFile ? this.props.fileTags : []}\n                  onFileTagChanged={this.props.onFileTagChanged}\n                  onItemDetailsClose={this.props.closeDirentDetail}\n                  direntDetailPanelTab={this.props.direntDetailPanelTab}\n                />\n              }\n            </div>\n          </Fragment>\n        }\n      </Fragment>\n    );\n  }\n}\n\nLibContentContainer.propTypes = propTypes;\n\nexport default LibContentContainer;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  resumableFile: PropTypes.object.isRequired,\n  onUploadCancel: PropTypes.func.isRequired,\n  onUploadRetry: PropTypes.func.isRequired,\n};\n\nconst UPLOAD_UPLOADING = 'uploading';\nconst UPLOAD_ERROR = 'error';\nconst UPLOAD_ISSAVING = 'isSaving';\nconst UPLOAD_UPLOADED = 'uploaded';\n\nclass UploadListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      uploadState: UPLOAD_UPLOADING\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    let { resumableFile } = nextProps;\n    let uploadState = UPLOAD_UPLOADING;\n\n    if (resumableFile.error) {\n      uploadState = UPLOAD_ERROR;\n    } else {\n      if (resumableFile.remainingTime === 0 && !resumableFile.isSaved) {\n        uploadState = UPLOAD_ISSAVING;\n      }\n\n      if (resumableFile.isSaved) {\n        uploadState = UPLOAD_UPLOADED;\n      }\n    }\n\n    this.setState({uploadState: uploadState});\n  }\n\n  onUploadCancel = (e) => {\n    e.preventDefault();\n    this.props.onUploadCancel(this.props.resumableFile);\n  }\n\n  onUploadRetry = (e) => {\n    e.preventDefault();\n    this.props.onUploadRetry(this.props.resumableFile);\n  }\n\n  formatFileSize = (size) => {\n    if (typeof size !== 'number') {\n      return '';\n    }\n    if (size >= 1000 * 1000 * 1000) {\n      return (size / (1000 * 1000 * 1000)).toFixed(1) + ' G';\n    }\n    if (size >= 1000 * 1000) {\n      return (size / (1000 * 1000)).toFixed(1) + ' M';\n    }\n    if (size >= 1000) {\n      return (size / 1000).toFixed(1) + ' K';\n    }\n    return size.toFixed(1) + ' B';\n  }\n\n  render() {\n    let { resumableFile } = this.props;\n    let progress = Math.round(resumableFile.progress() * 100);\n    let error = resumableFile.error;\n\n    const fileName = resumableFile.newFileName;\n    const size = this.formatFileSize(resumableFile.size);\n\n    return (\n      <tr className=\"file-upload-item\">\n        <td className=\"upload-name\">\n          <div className=\"ellipsis\" title={fileName}>{fileName}</div>\n        </td>\n        <td className=\"ellipsis\">\n          <span className=\"file-size\" title={size}>{size}</span>\n        </td>\n        <td className=\"upload-progress ellipsis\">\n          {(this.state.uploadState === UPLOAD_UPLOADING || this.state.uploadState === UPLOAD_ISSAVING) &&\n            <Fragment>\n              {resumableFile.size >= (100 * 1000 * 1000) &&\n                <Fragment>\n                  {resumableFile.isUploading() && (\n                    <div className=\"progress-container\">\n                      <div className=\"progress\">\n                        <div className=\"progress-bar\" role=\"progressbar\" style={{width: `${progress}%`}} aria-valuenow={progress} aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\n                      </div>\n                      {(resumableFile.remainingTime === -1) && <div className=\"progress-text\">{gettext('Preparing to upload...')}</div>}\n                      {(resumableFile.remainingTime > 0) && <div className=\"progress-text\">{gettext('Remaining')}{' '}{Utils.formatTime(resumableFile.remainingTime)}</div>}\n                      {(resumableFile.remainingTime === 0) && <div className=\"progress-text\">{gettext('Indexing...')}</div>}\n                    </div>\n                  )}\n                  {!resumableFile.isUploading() && (\n                    <div className=\"progress-container d-flex align-items-center\">\n                      <div className=\"progress\">\n                        <div className=\"progress-bar\" role=\"progressbar\" style={{width: `${progress}%`}} aria-valuenow={progress} aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\n                      </div>\n                    </div>\n                  )}\n                </Fragment>\n              }\n              {(resumableFile.size < (100 * 1000 * 1000)) &&\n                <div className=\"progress-container d-flex align-items-center\">\n                  <div className=\"progress\">\n                    <div className=\"progress-bar\" role=\"progressbar\" style={{width: `${progress}%`}} aria-valuenow={progress} aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\n                  </div>\n                </div>\n              }\n            </Fragment>\n          }\n          {this.state.uploadState === UPLOAD_ERROR && (\n            <div className=\"message err-message ml-0\" dangerouslySetInnerHTML={{__html: error}}></div>\n          )}\n        </td>\n        <td className=\"upload-operation ellipsis\">\n          <Fragment>\n            {this.state.uploadState === UPLOAD_UPLOADING && (\n              <a href=\"#\" onClick={this.onUploadCancel}>{gettext('Cancel')}</a>\n            )}\n            {this.state.uploadState === UPLOAD_ERROR && (\n              <a href=\"#\" onClick={this.onUploadRetry}>{gettext('Retry')}</a>\n            )}\n            {this.state.uploadState === UPLOAD_ISSAVING && (\n              <span className=\"saving\">{gettext('Saving...')}</span>\n            )}\n            {this.state.uploadState === UPLOAD_UPLOADED && (\n              <span className=\"uploaded\">{gettext('Uploaded')}</span>\n            )}\n          </Fragment>\n        </td>\n      </tr>\n    );\n  }\n}\n\nUploadListItem.propTypes = propTypes;\n\nexport default UploadListItem;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext, maxUploadFileSize } from '../../utils/constants';\n\nconst propTypes = {\n  file: PropTypes.object,\n};\n\nclass ForbidUploadListItem extends React.Component {\n\n  render() {\n    let { file } = this.props;\n    let msg = gettext('Please upload files less than {placeholder}M').replace('{placeholder}', maxUploadFileSize);\n    return (\n      <tr className=\"file-upload-item\">\n        <td className=\"upload-name\">\n          <div className=\"ellipsis\" title={file.name}>{file.name}</div>\n        </td>\n\n        <td colSpan={3} className=\"error\">{msg}</td>\n      </tr>\n    );\n  }\n}\n\nForbidUploadListItem.propTypes = propTypes;\n\nexport default ForbidUploadListItem;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport UploadListItem from './upload-list-item';\nimport ForbidUploadListItem from './forbid-upload-list-item';\n\nconst propTypes = {\n  uploadBitrate: PropTypes.number.isRequired,\n  totalProgress: PropTypes.number.isRequired,\n  retryFileList: PropTypes.array.isRequired,\n  uploadFileList: PropTypes.array.isRequired,\n  forbidUploadFileList: PropTypes.array.isRequired,\n  onCloseUploadDialog: PropTypes.func.isRequired,\n  onCancelAllUploading: PropTypes.func.isRequired,\n  onUploadCancel: PropTypes.func.isRequired,\n  onUploadRetry: PropTypes.func.isRequired,\n  onUploadRetryAll: PropTypes.func.isRequired,\n  allFilesUploaded: PropTypes.bool.isRequired,\n};\n\nclass UploadProgressDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isMinimized: false\n    };\n  }\n\n  onCancelAllUploading = () => {\n    this.props.onCancelAllUploading();\n  }\n\n  onMinimizeUpload = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.setState({isMinimized: !this.state.isMinimized});\n  }\n\n  onCloseUpload = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.props.onCloseUploadDialog();\n  }\n\n  render() {\n\n    let uploadBitrate = Utils.formatBitRate(this.props.uploadBitrate);\n    let uploadedMessage = gettext('File Upload');\n    let uploadingMessage = gettext('File Uploading...') + ' ' + this.props.totalProgress + '% (' + uploadBitrate + ')';\n\n    let uploadingOptions = (<span className=\"sf2-icon-minus\" onClick={this.onMinimizeUpload}></span>);\n\n    let uploadedOptions = (\n      <Fragment>\n        <span className=\"sf2-icon-minus\" onClick={this.onMinimizeUpload}></span>\n        <span className=\"sf2-icon-x1\" onClick={this.onCloseUpload}></span>\n      </Fragment>\n    );\n\n    let { totalProgress, allFilesUploaded, retryFileList } = this.props;\n\n    return (\n      <div className=\"uploader-list-view mw-100\" style={{height: this.state.isMinimized ? '2.25rem' : '20rem'}}>\n        <div className=\"uploader-list-header\">\n          <div className=\"title\">\n            {totalProgress === 100 ? uploadedMessage : uploadingMessage}\n          </div>\n          <div className=\"uploader-options\">\n            {totalProgress === 100 ||  allFilesUploaded ? uploadedOptions : uploadingOptions}\n          </div>\n        </div>\n        <div className=\"uploader-list-content\">\n          <div className=\"text-right mt-2\">\n            {retryFileList.length > 0 ?\n              <span className=\"cursor-pointer\" onClick={this.props.onUploadRetryAll}>{gettext('Retry All')}</span>\n              :\n              <span className=\"cursor-pointer disabled-link\">{gettext('Retry All')}</span>\n            }\n            {!allFilesUploaded ?\n              <span className=\"cursor-pointer ml-3\" onClick={this.onCancelAllUploading}>{gettext('Cancel All')}</span>\n              :\n              <span className=\"cursor-pointer ml-3 disabled-link\" >{gettext('Cancel All')}</span>\n            }\n          </div>\n          <table className=\"table-thead-hidden\">\n            <thead>\n              <tr>\n                <th width=\"30%\">{gettext('name')}</th>\n                <th width=\"20%\">{gettext('size')}</th>\n                <th width=\"30%\">{gettext('progress')}</th>\n                <th width=\"20%\">{gettext('state')}</th>\n              </tr>\n            </thead>\n            <tbody>\n              {\n                this.props.forbidUploadFileList.map((file, index) => {\n                  return (<ForbidUploadListItem key={index} file={file} />);\n                })\n              }\n              {\n                this.props.uploadFileList.map((resumableFile, index) => {\n                  return (\n                    <UploadListItem\n                      key={index}\n                      resumableFile={resumableFile}\n                      onUploadCancel={this.props.onUploadCancel}\n                      onUploadRetry={this.props.onUploadRetry}\n                    />\n                  );\n                })\n              }\n            </tbody>\n          </table>\n        </div>\n      </div>\n    );\n  }\n}\n\nUploadProgressDialog.propTypes = propTypes;\n\nexport default UploadProgressDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button } from 'reactstrap';\n\nconst propTypes = {\n  currentResumableFile: PropTypes.object.isRequired,\n  replaceRepetitionFile: PropTypes.func.isRequired,\n  uploadFile: PropTypes.func.isRequired,\n  cancelFileUpload: PropTypes.func.isRequired,\n};\n\nclass UploadRemindDialog extends React.Component {\n\n  toggle = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.props.cancelFileUpload();\n  }\n\n  replaceRepetitionFile = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.props.replaceRepetitionFile();\n  }\n\n  uploadFile = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.props.uploadFile();\n  }\n\n  render() {\n    const { fileName } = this.props.currentResumableFile;\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>\n          <span>{gettext('Replace file {filename}?').replace('{filename}', fileName)}</span>\n        </ModalHeader>\n        <ModalBody>\n          <p>{gettext('A file with the same name already exists in this folder.')}</p>\n          <p>{gettext('Replacing it will overwrite its content.')}</p>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"primary\" onClick={this.replaceRepetitionFile}>{gettext('Replace')}</Button>\n          <Button color=\"primary\" onClick={this.uploadFile}>{gettext('Don\\'t replace')}</Button>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nUploadRemindDialog.propTypes = propTypes;\n\nexport default UploadRemindDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport Resumablejs from '@seafile/resumablejs';\nimport MD5 from 'MD5';\nimport { resumableUploadFileBlockSize, maxUploadFileSize, maxNumberOfFilesForFileupload } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport { gettext } from '../../utils/constants';\nimport UploadProgressDialog from './upload-progress-dialog';\nimport UploadRemindDialog from '../dialog/upload-remind-dialog';\nimport toaster from '../toast';\nimport '../../css/file-uploader.css';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  direntList: PropTypes.array.isRequired,\n  filetypes: PropTypes.array,\n  chunkSize: PropTypes.number,\n  withCredentials: PropTypes.bool,\n  testMethod: PropTypes.string,\n  testChunks: PropTypes.number,\n  simultaneousUploads: PropTypes.number,\n  fileParameterName: PropTypes.string,\n  minFileSizeErrorCallback: PropTypes.func,\n  fileTypeErrorCallback: PropTypes.func,\n  dragAndDrop: PropTypes.bool.isRequired,\n  path: PropTypes.string.isRequired,\n  onFileUploadSuccess: PropTypes.func.isRequired,\n  isCustomPermission: PropTypes.bool,\n};\n\nclass FileUploader extends React.Component {\n\n  static defaultProps = {\n    isCustomPermission: false\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      retryFileList: [],\n      uploadFileList: [],\n      forbidUploadFileList: [],\n      totalProgress: 0,\n      isUploadProgressDialogShow: false,\n      isUploadRemindDialogShow: false,\n      currentResumableFile: null,\n      uploadBitrate: 0,\n      allFilesUploaded: false,\n    };\n\n    this.uploadInput = React.createRef();\n\n    this.notifiedFolders = [];\n\n    this.timestamp = null;\n    this.loaded = 0;\n    this.bitrateInterval = 500; // Interval in milliseconds to calculate the bitrate\n    window.onbeforeunload = this.onbeforeunload;\n    this.isUploadLinkLoaded = false;\n  }\n\n  componentDidMount() {\n    this.resumable = new Resumablejs({\n      target: '',\n      query: this.setQuery || {},\n      fileType: this.props.filetypes,\n      maxFiles: maxNumberOfFilesForFileupload || undefined,\n      maxFileSize: maxUploadFileSize * 1000 * 1000 || undefined,\n      testMethod: this.props.testMethod || 'post',\n      testChunks: this.props.testChunks || false,\n      headers: this.setHeaders || {},\n      withCredentials: this.props.withCredentials || false,\n      chunkSize: parseInt(resumableUploadFileBlockSize) * 1024 * 1024 || 1 * 1024 * 1024,\n      simultaneousUploads: this.props.simultaneousUploads || 1,\n      fileParameterName: this.props.fileParameterName,\n      generateUniqueIdentifier: this.generateUniqueIdentifier,\n      forceChunkSize: true,\n      maxChunkRetries: 3,\n      minFileSize: 0,\n    });\n\n    this.resumable.assignBrowse(this.uploadInput.current, true);\n\n    //Enable or Disable DragAnd Drop\n    if (this.props.dragAndDrop === true) {\n      this.resumable.enableDropOnDocument();\n    }\n\n    this.bindCallbackHandler();\n    this.bindEventHandler();\n  }\n\n  componentWillUnmount = () => {\n    window.onbeforeunload = null;\n    if (this.props.dragAndDrop === true) {\n      this.resumable.disableDropOnDocument();\n    }\n  }\n\n  onbeforeunload = () => {\n    if (window.uploader &&\n        window.uploader.isUploadProgressDialogShow &&\n        window.uploader.totalProgress !== 100) {\n      return '';\n    }\n  }\n\n  bindCallbackHandler = () => {\n    let { minFileSizeErrorCallback, fileTypeErrorCallback } = this.props;\n\n    if (this.maxFilesErrorCallback) {\n      this.resumable.opts.maxFilesErrorCallback = this.maxFilesErrorCallback;\n    }\n\n    if (minFileSizeErrorCallback) {\n      this.resumable.opts.minFileSizeErrorCallback = this.props.minFileSizeErrorCallback;\n    }\n\n    if (this.maxFileSizeErrorCallback) {\n      this.resumable.opts.maxFileSizeErrorCallback = this.maxFileSizeErrorCallback;\n    }\n\n    if (fileTypeErrorCallback) {\n      this.resumable.opts.fileTypeErrorCallback = this.props.fileTypeErrorCallback;\n    }\n\n  }\n\n  bindEventHandler = () => {\n    this.resumable.on('chunkingComplete', this.onChunkingComplete.bind(this));\n    this.resumable.on('fileAdded', this.onFileAdded.bind(this));\n    this.resumable.on('filesAddedComplete', this.filesAddedComplete.bind(this));\n    this.resumable.on('fileProgress', this.onFileProgress.bind(this));\n    this.resumable.on('fileSuccess', this.onFileUploadSuccess.bind(this));\n    this.resumable.on('progress', this.onProgress.bind(this));\n    this.resumable.on('complete', this.onComplete.bind(this));\n    this.resumable.on('pause', this.onPause.bind(this));\n    this.resumable.on('fileRetry', this.onFileRetry.bind(this));\n    this.resumable.on('fileError', this.onFileError.bind(this));\n    this.resumable.on('error', this.onError.bind(this));\n    this.resumable.on('beforeCancel', this.onBeforeCancel.bind(this));\n    this.resumable.on('cancel', this.onCancel.bind(this));\n    this.resumable.on('dragstart', this.onDragStart.bind(this));\n  }\n\n  maxFilesErrorCallback = (files, errorCount) => {\n    let maxFiles = maxNumberOfFilesForFileupload;\n    let message = gettext('Please upload no more than {maxFiles} files at a time.');\n    message = message.replace('{maxFiles}', maxFiles);\n    toaster.danger(message);\n  }\n\n  maxFileSizeErrorCallback = (file) => {\n    let { forbidUploadFileList } = this.state;\n    forbidUploadFileList.push(file);\n    this.setState({forbidUploadFileList: forbidUploadFileList});\n  }\n\n  onChunkingComplete = (resumableFile) => {\n\n    let allFilesUploaded = this.state.allFilesUploaded;\n    if (allFilesUploaded === true) {\n      this.setState({allFilesUploaded: false});\n    }\n\n    //get parent_dir relative_path\n    let path = this.props.path === '/' ? '/' : this.props.path + '/';\n    let fileName = resumableFile.fileName;\n    let relativePath = resumableFile.relativePath;\n    let isFile = fileName === relativePath;\n\n    //update formdata\n    resumableFile.formData = {};\n    if (isFile) { // upload file\n      resumableFile.formData  = {\n        parent_dir: path,\n      };\n    } else { // upload folder\n      let relative_path = relativePath.slice(0, relativePath.lastIndexOf('/') + 1);\n      resumableFile.formData  = {\n        parent_dir: path,\n        relative_path: relative_path\n      };\n    }\n  }\n\n  onFileAdded = (resumableFile, files) => {\n    const { isCustomPermission } = this.props;\n    let isFile = resumableFile.fileName === resumableFile.relativePath;\n    // uploading is file and only upload one file\n    if (isFile && files.length === 1) {\n      let hasRepetition = false;\n      if (!isCustomPermission) {\n        let direntList = this.props.direntList;\n        for (let i = 0; i < direntList.length; i++) {\n          if (direntList[i].type === 'file' && direntList[i].name === resumableFile.fileName) {\n            hasRepetition = true;\n            break;\n          }\n        }\n      }\n      if (hasRepetition) {\n        this.setState({\n          isUploadRemindDialogShow: true,\n          currentResumableFile: resumableFile,\n        });\n      } else {\n        this.setUploadFileList(this.resumable.files);\n        let { repoID, path } = this.props;\n        seafileAPI.getFileServerUploadLink(repoID, path).then(res => {\n          this.resumable.opts.target = res.data + '?ret-json=1';\n          this.resumableUpload(resumableFile);\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n    } else {\n      this.setUploadFileList(this.resumable.files);\n      if (!this.isUploadLinkLoaded) {\n        this.isUploadLinkLoaded = true;\n        let { repoID, path } = this.props;\n        seafileAPI.getFileServerUploadLink(repoID, path).then(res => {\n          this.resumable.opts.target = res.data + '?ret-json=1';\n          this.resumable.upload();\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n    }\n  }\n\n  resumableUpload = (resumableFile) => {\n    let { repoID, path } = this.props;\n    seafileAPI.getFileUploadedBytes(repoID, path, resumableFile.fileName).then(res => {\n      let uploadedBytes = res.data.uploadedBytes;\n      let blockSize = parseInt(resumableUploadFileBlockSize) * 1024 * 1024 || 1024 * 1024;\n      let offset = Math.floor(uploadedBytes / blockSize);\n      resumableFile.markChunksCompleted(offset);\n      this.resumable.upload();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  filesAddedComplete = (resumable, files) => {\n    let { forbidUploadFileList } = this.state;\n    if (forbidUploadFileList.length > 0 && files.length === 0) {\n      this.setState({\n        isUploadProgressDialogShow: true,\n        totalProgress: 100\n      });\n    }\n  }\n\n  setUploadFileList = () => {\n    let uploadFileList = this.resumable.files;\n    this.setState({\n      uploadFileList: uploadFileList,\n      isUploadProgressDialogShow: true,\n    });\n    Utils.registerGlobalVariable('uploader', 'isUploadProgressDialogShow', true);\n  }\n\n  onFileProgress = (resumableFile) => {\n    let uploadBitrate = this.getBitrate();\n    let uploadFileList = this.state.uploadFileList.map(item => {\n      if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n        if (uploadBitrate) {\n          let lastSize = (item.size - (item.size * item.progress())) * 8;\n          let time = Math.floor(lastSize / uploadBitrate);\n          item.remainingTime = time;\n        }\n      }\n      return item;\n    });\n\n    this.setState({\n      uploadBitrate: uploadBitrate,\n      uploadFileList: uploadFileList\n    });\n  }\n\n  getBitrate = () => {\n    let loaded = 0;\n    let uploadBitrate = 0;\n    let now = new Date().getTime();\n\n    this.resumable.files.forEach(file => {\n      loaded += file.progress() * file.size;\n    });\n\n    if (this.timestamp) {\n      let timeDiff = (now - this.timestamp);\n      if (timeDiff < this.bitrateInterval) {\n        return this.state.uploadBitrate;\n      }\n\n      // 1. Cancel will produce loaded greater than this.loaded\n      // 2. reset can make this.loaded to be 0\n      if (loaded < this.loaded || this.loaded === 0) {\n        this.loaded = loaded; //\n      }\n\n      uploadBitrate = (loaded - this.loaded) * (1000 / timeDiff) * 8;\n    }\n\n    this.timestamp = now;\n    this.loaded = loaded;\n\n    return uploadBitrate;\n  }\n\n  onProgress = () => {\n    let progress = Math.round(this.resumable.progress() * 100);\n    this.setState({totalProgress: progress});\n    Utils.registerGlobalVariable('uploader', 'totalProgress', progress);\n  }\n\n  onFileUploadSuccess = (resumableFile, message) => {\n    let formData = resumableFile.formData;\n    let currentTime = new Date().getTime()/1000;\n    message = formData.replace ? message : JSON.parse(message)[0];\n    if (formData.relative_path) { // upload folder\n      let relative_path = formData.relative_path;\n      let dir_name = relative_path.slice(0, relative_path.indexOf('/'));\n      let dirent = {\n        id: message.id,\n        name: dir_name,\n        type: 'dir',\n        mtime: currentTime,\n      };\n\n      // update folders cache\n      let isExist = this.notifiedFolders.some(item => {return item.name === dirent.name;});\n      if (!isExist) {\n        this.notifiedFolders.push(dirent);\n        this.props.onFileUploadSuccess(dirent);\n      }\n\n      // update uploadFileList\n      let uploadFileList = this.state.uploadFileList.map(item => {\n        if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n          item.newFileName = relative_path + message.name;\n          item.isSaved = true;\n        }\n        return item;\n      });\n      this.setState({uploadFileList: uploadFileList});\n\n      return;\n    }\n\n    if (formData.replace) { // upload file -- replace exist file\n      let fileName = resumableFile.fileName;\n      let dirent = {\n        id: message,\n        name: fileName,\n        type: 'file',\n        mtime: currentTime\n      };\n      this.props.onFileUploadSuccess(dirent); // this contance: just one file\n\n      let uploadFileList = this.state.uploadFileList.map(item => {\n        if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n          item.newFileName = fileName;\n          item.isSaved = true;\n        }\n        return item;\n      });\n      this.setState({uploadFileList: uploadFileList});\n\n      return;\n    }\n\n    // upload file -- add files\n    let dirent = {\n      id: message.id,\n      type: 'file',\n      name: message.name,\n      size: message.size,\n      mtime: currentTime,\n    };\n    this.props.onFileUploadSuccess(dirent); // this contance:  no repetition file\n\n    let uploadFileList = this.state.uploadFileList.map(item => {\n      if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n        item.newFileName = message.name;\n        item.isSaved = true;\n      }\n      return item;\n    });\n    this.setState({uploadFileList: uploadFileList});\n  }\n\n  getFileServerErrorMessage = (key) => {\n    const errorMessage = {\n      'File locked by others.': gettext('File is locked by others.'),       // 403\n      'Invalid filename.': gettext('Invalid filename.'),                    // 440\n      'File already exists.': gettext('File already exists.'),              // 441\n      'File size is too large.': gettext('File size is too large.'),        // 442\n      'Out of quota.': gettext('Out of quota.'),                            // 443\n      'Internal error.': gettext('Internal Server Error'),                  // 500\n    };\n    return errorMessage[key] || key;\n  }\n\n  onFileError = (resumableFile, message) => {\n    let error = '';\n    if (!message) {\n      error = gettext('Network error');\n    } else {\n      // eg: '{\"error\": \"Internal error\" \\n }'\n      let errorMessage = message.replace(/\\n/g, '');\n      errorMessage  = JSON.parse(errorMessage);\n      error = this.getFileServerErrorMessage(errorMessage.error);\n    }\n\n    let uploadFileList = this.state.uploadFileList.map(item => {\n      if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n        this.state.retryFileList.push(item);\n        item.error = error;\n      }\n      return item;\n    });\n\n    this.loaded = 0;  // reset loaded data;\n    this.setState({\n      retryFileList: this.state.retryFileList,\n      uploadFileList: uploadFileList\n    });\n\n  }\n\n  onComplete = () => {\n    this.notifiedFolders = [];\n    // reset upload link loaded\n    this.isUploadLinkLoaded = false;\n    this.setState({allFilesUploaded: true});\n  }\n\n  onPause = () => {\n\n  }\n\n  onError = (message) => {\n    // reset upload link loaded\n    this.isUploadLinkLoaded = false;\n    // After the error, the user can switch windows\n    Utils.registerGlobalVariable('uploader', 'totalProgress', 100);\n  }\n\n  onFileRetry = () => {\n    // todo, cancel upload file, uploded again;\n  }\n\n  onBeforeCancel = () => {\n    // todo, giving a pop message ?\n  }\n\n  onCancel = () => {\n\n  }\n\n  setHeaders = (resumableFile, resumable) => {\n    let offset = resumable.offset;\n    let chunkSize = resumable.getOpt('chunkSize');\n    let fileSize = resumableFile.size === 0 ? 1 : resumableFile.size;\n    let startByte = offset !== 0 ? offset * chunkSize : 0;\n    let endByte = Math.min(fileSize, (offset + 1) * chunkSize) - 1;\n\n    if (fileSize - resumable.endByte < chunkSize && !resumable.getOpt('forceChunkSize')) {\n      endByte = fileSize;\n    }\n\n    let headers = {\n      'Accept': 'application/json; text/javascript, */*; q=0.01',\n      'Content-Disposition': 'attachment; filename=\"' + encodeURI(resumableFile.fileName) + '\"',\n      'Content-Range': 'bytes ' + startByte + '-' + endByte + '/' + fileSize,\n    };\n\n    return headers;\n  }\n\n  setQuery = (resumableFile) => {\n    let formData = resumableFile.formData;\n    return formData;\n  }\n\n  generateUniqueIdentifier = (file) => {\n    let relativePath = file.webkitRelativePath||file.relativePath||file.fileName||file.name;\n    return MD5(relativePath + new Date()) + relativePath;\n  }\n\n  onClick = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    e.stopPropagation();\n  }\n\n  onFileUpload = () => {\n    this.uploadInput.current.removeAttribute('webkitdirectory');\n\n    this.uploadInput.current.click();\n  }\n\n  onFolderUpload = () => {\n    this.uploadInput.current.setAttribute('webkitdirectory', 'webkitdirectory');\n    this.uploadInput.current.click();\n  }\n\n  onDragStart = () => {\n    this.uploadInput.current.setAttribute('webkitdirectory', 'webkitdirectory');\n  }\n\n  onCloseUploadDialog = () => {\n    this.loaded = 0;\n    this.resumable.files = [];\n    // reset upload link loaded\n    this.isUploadLinkLoaded = false;\n    this.setState({isUploadProgressDialogShow: false, uploadFileList: [], forbidUploadFileList: []});\n    Utils.registerGlobalVariable('uploader', 'isUploadProgressDialogShow', false);\n  }\n\n  onUploadCancel = (uploadingItem) => {\n\n    let uploadFileList = this.state.uploadFileList.filter(item => {\n      if (item.uniqueIdentifier === uploadingItem.uniqueIdentifier) {\n        item.cancel(); // execute cancel function will delete the file at the same time\n        return false;\n      }\n      return true;\n    });\n\n    if (!this.resumable.isUploading()) {\n      this.setState({\n        totalProgress: '100',\n        allFilesUploaded: true,\n      });\n      this.loaded = 0;\n    }\n\n    this.setState({uploadFileList: uploadFileList});\n  }\n\n  onCancelAllUploading = () => {\n    let uploadFileList = this.state.uploadFileList.filter(item => {\n      if (Math.round(item.progress() !== 1)) {\n        item.cancel();\n        return false;\n      }\n      return true;\n    });\n\n    this.loaded = 0;\n\n    this.setState({\n      allFilesUploaded: true,\n      totalProgress: '100',\n      uploadFileList: uploadFileList\n    });\n    // reset upload link loaded\n    this.isUploadLinkLoaded = false;\n  }\n\n  onUploadRetry = (resumableFile) => {\n\n    seafileAPI.getFileServerUploadLink(this.props.repoID, this.props.path).then(res => {\n      this.resumable.opts.target = res.data + '?ret-json=1';\n\n      let retryFileList = this.state.retryFileList.filter(item => {\n        return item.uniqueIdentifier !== resumableFile.uniqueIdentifier;\n      });\n      let uploadFileList = this.state.uploadFileList.map(item => {\n        if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n          item.error = null;\n          this.retryUploadFile(item);\n        }\n        return item;\n      });\n\n      this.setState({\n        retryFileList: retryFileList,\n        uploadFileList: uploadFileList\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onUploadRetryAll = () => {\n\n    seafileAPI.getFileServerUploadLink(this.props.repoID, this.props.path).then(res => {\n      this.resumable.opts.target = res.data + '?ret-json=1';\n      this.state.retryFileList.forEach(item => {\n        item.error = false;\n        this.retryUploadFile(item);\n      });\n\n      let uploadFileList = this.state.uploadFileList.slice(0);\n      this.setState({\n        retryFileList: [],\n        uploadFileList: uploadFileList\n      });\n\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  retryUploadFile = (resumableFile) => {\n    let { repoID, path } = this.props;\n    let fileName = resumableFile.fileName;\n    let isFile = resumableFile.fileName === resumableFile.relativePath;\n    if (!isFile) {\n      let relative_path = resumableFile.formData.relative_path;\n      let prefix = path === '/' ? (path + relative_path) : (path + '/' + relative_path);\n      fileName = prefix + fileName;\n    }\n\n    resumableFile.bootstrap();\n    var firedRetry = false;\n    resumableFile.resumableObj.on('chunkingComplete', () => {\n      if(!firedRetry) {\n        seafileAPI.getFileUploadedBytes(repoID, path, fileName).then(res => {\n          let uploadedBytes = res.data.uploadedBytes;\n          let blockSize = parseInt(resumableUploadFileBlockSize) * 1024 * 1024 || 1024 * 1024;\n          let offset = Math.floor(uploadedBytes / blockSize);\n          resumableFile.markChunksCompleted(offset);\n\n          resumableFile.resumableObj.upload();\n\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n      firedRetry = true;\n    });\n\n  }\n\n  replaceRepetitionFile = () => {\n    let { repoID, path } = this.props;\n    seafileAPI.getUpdateLink(repoID, path).then(res => {\n      this.resumable.opts.target = res.data;\n\n      let resumableFile = this.resumable.files[this.resumable.files.length - 1];\n      resumableFile.formData['replace'] = 1;\n      resumableFile.formData['target_file'] = resumableFile.formData.parent_dir + resumableFile.fileName;\n      this.setState({isUploadRemindDialogShow: false});\n      this.setUploadFileList(this.resumable.files);\n      this.resumable.upload();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  uploadFile = () => {\n    let resumableFile = this.resumable.files[this.resumable.files.length - 1];\n    let { repoID, path } = this.props;\n    seafileAPI.getFileServerUploadLink(repoID, path).then((res) => {  // get upload link\n      this.resumable.opts.target = res.data + '?ret-json=1';\n      this.setState({\n        isUploadRemindDialogShow: false,\n        isUploadProgressDialogShow: true,\n        uploadFileList: [...this.state.uploadFileList, resumableFile]\n      }, () => {\n        this.resumable.upload();\n      });\n      Utils.registerGlobalVariable('uploader', 'isUploadProgressDialogShow', true);\n\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  cancelFileUpload = () => {\n    this.resumable.files.pop(); //delete latest file\n    this.setState({isUploadRemindDialogShow: false});\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"file-uploader-container\">\n          <div className=\"file-uploader\">\n            <input className=\"upload-input\" type=\"file\" ref={this.uploadInput} onClick={this.onClick}/>\n          </div>\n        </div>\n        {this.state.isUploadRemindDialogShow &&\n          <UploadRemindDialog\n            currentResumableFile={this.state.currentResumableFile}\n            replaceRepetitionFile={this.replaceRepetitionFile}\n            uploadFile={this.uploadFile}\n            cancelFileUpload={this.cancelFileUpload}\n          />\n        }\n        {this.state.isUploadProgressDialogShow &&\n          <UploadProgressDialog\n            retryFileList={this.state.retryFileList}\n            uploadFileList={this.state.uploadFileList}\n            forbidUploadFileList={this.state.forbidUploadFileList}\n            totalProgress={this.state.totalProgress}\n            uploadBitrate={this.state.uploadBitrate}\n            allFilesUploaded={this.state.allFilesUploaded}\n            onCloseUploadDialog={this.onCloseUploadDialog}\n            onCancelAllUploading={this.onCancelAllUploading}\n            onUploadCancel={this.onUploadCancel}\n            onUploadRetry={this.onUploadRetry}\n            onUploadRetryAll={this.onUploadRetryAll}\n          />\n        }\n      </Fragment>\n    );\n  }\n}\n\nFileUploader.propTypes = propTypes;\n\nexport default FileUploader;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  path: PropTypes.string.isRequired,\n  deleteFolder: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass DeleteFolderDialog extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      sharedToUserCount: 0,\n      sharedToGroupCount: 0\n    };\n  }\n\n  componentDidMount() {\n    const { repoID, path } = this.props;\n    seafileAPI.getRepoFolderShareInfo(repoID, path).then((res) => {\n      this.setState({\n        sharedToUserCount: res.data['shared_user_emails'].length,\n        sharedToGroupCount: res.data['shared_group_ids'].length\n      });\n    });\n  }\n\n  deleteFolder = () => {\n    this.props.deleteFolder();\n    this.props.toggleDialog();\n  }\n\n  render() {\n    const { sharedToUserCount, sharedToGroupCount } = this.state;\n    const { path, toggleDialog } = this.props;\n    const folderName = Utils.getFileName(path);\n    const opTarget = '<span class=\"op-target\">' + Utils.HTMLescape(folderName) + '</span>';\n    const message = gettext('Are you sure you want to delete %s ?').replace('%s', opTarget);\n\n    let alert_message = '';\n    if (sharedToUserCount > 0 || sharedToGroupCount > 0) {\n      alert_message = gettext('This folder has been shared to {user_amount} user(s) and {group_amount} group(s).')\n        .replace('{user_amount}', sharedToUserCount)\n        .replace('{group_amount}', sharedToGroupCount);\n    }\n\n    return (\n      <Modal isOpen={true} toggle={toggleDialog}>\n        <ModalHeader toggle={toggleDialog}>{gettext('Delete Folder')}</ModalHeader>\n        <ModalBody>\n          <p dangerouslySetInnerHTML={{__html: message}}></p>\n          {alert_message && <p className=\"error\">{alert_message}</p>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={toggleDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.deleteFolder}>{gettext('Delete')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nDeleteFolderDialog.propTypes = propTypes;\n\nexport default DeleteFolderDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport cookie from 'react-cookies';\nimport moment from 'moment';\nimport { navigate } from '@gatsbyjs/reach-router';\nimport { gettext, siteRoot, username, isDocs, enableVideoThumbnail } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport collabServer from '../../utils/collab-server';\nimport Dirent from '../../models/dirent';\nimport FileTag from '../../models/file-tag';\nimport RepoTag from '../../models/repo-tag';\nimport RepoInfo from '../../models/repo-info';\nimport TreeNode from '../../components/tree-view/tree-node';\nimport treeHelper from '../../components/tree-view/tree-helper';\nimport toaster from '../../components/toast';\nimport ModalPortal from '../../components/modal-portal';\nimport LibDecryptDialog from '../../components/dialog/lib-decrypt-dialog';\nimport LibContentToolbar from './lib-content-toolbar';\nimport LibContentContainer from './lib-content-container';\nimport FileUploader from '../../components/file-uploader/file-uploader';\nimport CopyMoveDirentProgressDialog from '../../components/dialog/copy-move-dirent-progress-dialog';\nimport DeleteFolderDialog from '../../components/dialog/delete-folder-dialog';\n\nconst propTypes = {\n  pathPrefix: PropTypes.array.isRequired,\n  onTabNavClick: PropTypes.func.isRequired,\n  onMenuClick: PropTypes.func.isRequired,\n  repoID: PropTypes.string,\n};\n\nclass LibContentView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentMode: cookie.load('seafile_view_mode') || 'list',\n      path: '',\n      pathExist: true,\n      isViewFile: false,\n      hash: '',\n      currentRepoInfo: null,\n      repoName: '',\n      repoEncrypted: false,\n      libNeedDecrypt: false,\n      isGroupOwnedRepo: false,\n      userPerm: '',\n      selectedDirentList: [],\n      isDraft: false,\n      hasDraft: false,\n      fileTags: [],\n      draftID: '',\n      draftCounts: 0,\n      usedRepoTags: [],\n      readmeMarkdown: null,\n      isTreeDataLoading: true,\n      treeData: treeHelper.buildTree(),\n      currentNode: null,\n      isFileLoading: true,\n      isFileLoadedErr: false,\n      filePermission: '',\n      content: '',\n      lastModified: '',\n      latestContributor: '',\n      isDirentListLoading: true,\n      direntList: [],\n      isDirentSelected: false,\n      sortBy: cookie.load('seafile-repo-dir-sort-by') || 'name', // 'name' or 'time' or 'size'\n      sortOrder: cookie.load('seafile-repo-dir-sort-order') || 'asc', // 'asc' or 'desc'\n      isAllDirentSelected: false,\n      dirID: '',  // for update dir list\n      errorMsg: '',\n      isDirentDetailShow: false,\n      direntDetailPanelTab: '',\n      updateDetail: false,\n      itemsShowLength: 100,\n      isSessionExpired: false,\n      isCopyMoveProgressDialogShow: false,\n      isDeleteFolderDialogOpen: false,\n      asyncCopyMoveTaskId: '',\n      asyncOperationType: 'move',\n      asyncOperationProgress: 0,\n      asyncOperatedFilesLength: 0,\n    };\n\n    this.oldonpopstate = window.onpopstate;\n    window.onpopstate = this.onpopstate;\n    this.lastModifyTime = new Date();\n    this.isNeedUpdateHistoryState = true; // Load, refresh page, switch mode for the first time, no need to set historyState\n    this.currentMoveItemName = '';\n    this.currentMoveItemPath = '';\n  }\n\n  showDirentDetail = (direntDetailPanelTab) => {\n    if (direntDetailPanelTab) {\n      this.setState({ direntDetailPanelTab: direntDetailPanelTab }, () => {\n        this.setState({ isDirentDetailShow: true });\n      });\n    } else {\n      this.setState({\n        direntDetailPanelTab: '',\n        isDirentDetailShow: true\n      });\n    }\n  }\n\n  toggleDirentDetail = () => {\n    this.setState({\n      direntDetailPanelTab: '',\n      isDirentDetailShow: !this.state.isDirentDetailShow\n    });\n  }\n\n  closeDirentDetail = () => {\n    this.setState({\n      isDirentDetailShow: false,\n      direntDetailPanelTab: '',\n    });\n  }\n\n  componentWillMount() {\n    const hash = window.location.hash;\n    if (hash.slice(0, 1) === '#') {\n      this.setState({hash: hash});\n    }\n  }\n\n  async componentDidMount() {\n    // eg: http://127.0.0.1:8000/library/repo_id/repo_name/**/**/\\\n    let repoID = this.props.repoID;\n    let location = window.location.href.split('#')[0];\n    location = decodeURIComponent(location);\n    let path = location.slice(location.indexOf(repoID) + repoID.length + 1); // get the string after repoID\n    path = path.slice(path.indexOf('/')); // get current path\n\n    try {\n      const repoRes = await seafileAPI.getRepoInfo(repoID);\n      const repoInfo = new RepoInfo(repoRes.data);\n      const isGroupOwnedRepo = repoInfo.owner_email.indexOf('@seafile_group') > -1;\n\n      this.setState({\n        currentRepoInfo: repoInfo,\n      });\n\n      if (repoInfo.permission.startsWith('custom-')) {\n        const permissionID = repoInfo.permission.split('-')[1];\n        const permissionRes = await seafileAPI.getCustomPermission(repoID, permissionID);\n        window.custom_permission = permissionRes.data.permission;\n      }\n\n      this.isNeedUpdateHistoryState = false;\n      this.setState({\n        repoName: repoInfo.repo_name,\n        libNeedDecrypt: repoInfo.lib_need_decrypt,\n        repoEncrypted: repoInfo.encrypted,\n        isGroupOwnedRepo: isGroupOwnedRepo,\n        path: path\n      });\n\n      if (!repoInfo.lib_need_decrypt) {\n        this.loadDirData(path);\n      }\n    } catch (error) {\n      if (error.response) {\n        if (error.response.status == 403) {\n          this.setState({\n            isDirentListLoading: false,\n            errorMsg: gettext('Permission denied')\n          });\n\n          let errorMsg = gettext('Permission denied');\n          toaster.danger(errorMsg);\n        } else if (error.response.status == 404) {\n          this.setState({\n            isDirentListLoading: false,\n            errorMsg: gettext('Library share permission not found.')\n          });\n        } else {\n          this.setState({\n            isDirentListLoading: false,\n            errorMsg: gettext('Error')\n          });\n        }\n      } else {\n        this.setState({\n          isDirentListLoading: false,\n          errorMsg: gettext('Please check the network.')\n        });\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    window.onpopstate = this.oldonpopstate;\n    collabServer.unwatchRepo(this.props.repoID, this.onRepoUpdateEvent);\n  }\n\n  componentDidUpdate() {\n    this.lastModifyTime = new Date();\n  }\n\n  onpopstate = (event) => {\n    if (event.state && event.state.key) { // root path\n      if (this.state.path === '/') {\n        return;\n      } else {\n        let path = '/';\n        this.loadDirentList(path);\n        this.setState({\n          path: path,\n          isViewFile: false\n        });\n      }\n    } else if (event.state && event.state.path) { // file path\n      let path = event.state.path;\n      if (this.state.currentMode === 'column') {\n        if (Utils.isMarkdownFile(path)) { // Judging not strict\n          this.showFile(path);\n          return;\n        }\n      }\n      this.loadDirentList(path);\n      this.setState({\n        path: path,\n        isViewFile: false\n      });\n    }\n  }\n\n  onRepoUpdateEvent = () => {\n    let currentTime = new Date();\n    if ((parseFloat(currentTime - this.lastModifyTime)/1000) <= 5) {\n      return;\n    }\n    let repoID = this.props.repoID;\n    let { path, dirID } = this.state;\n\n    if (this.state.currentMode === 'column') {\n      if (this.state.isViewFile) {\n        this.updateColumnMarkdownData(path);\n      } else {\n        seafileAPI.dirMetaData(repoID, path).then((res) => {\n          if (res.data.id !== dirID) {\n            this.loadDirentList(path);\n          }\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n    } else {\n      seafileAPI.dirMetaData(repoID, path).then((res) => {\n        if (res.data.id !== dirID) {\n          this.loadDirentList(path);\n        }\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  updateUsedRepoTags = () => {\n    let repoID = this.props.repoID;\n    seafileAPI.listRepoTags(repoID).then(res => {\n      let usedRepoTags = [];\n      res.data.repo_tags.forEach(item => {\n        let usedRepoTag = new RepoTag(item);\n        if (usedRepoTag.fileCount > 0) {\n          usedRepoTags.push(usedRepoTag);\n        }\n      });\n      this.setState({usedRepoTags: usedRepoTags});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  updateReadmeMarkdown = (direntList) => {\n    this.setState({readmeMarkdown: null});\n    direntList.some(item => {\n      let fileName = item.name.toLowerCase();\n      if (fileName === 'readme.md' || fileName === 'readme.markdown') {\n        this.setState({readmeMarkdown: item});\n        return true;\n      }\n    });\n  }\n\n  updateColumnMarkdownData = (filePath) => {\n    let repoID = this.props.repoID;\n    // update state\n    this.setState({\n      path: filePath,\n      isViewFile: true\n    });\n\n    // update data\n    seafileAPI.getFileInfo(repoID, filePath).then((res) => {\n      let { mtime, permission, last_modifier_name, is_draft, has_draft, draft_id } = res.data;\n      seafileAPI.getFileDownloadLink(repoID, filePath).then((res) => {\n        seafileAPI.getFileContent(res.data).then((res) => {\n          if (this.state.content !== res.data) {\n            this.setState({isFileLoading: true});\n          }\n          this.setState({\n            content: res.data,\n            filePermission: permission,\n            latestContributor: last_modifier_name,\n            lastModified: moment.unix(mtime).fromNow(),\n            isFileLoading: false,\n            isFileLoadedErr: false,\n            isDraft: is_draft,\n            hasDraft: has_draft,\n            draftID: draft_id\n          });\n        });\n      });\n    }).catch(() => {\n      this.setState({\n        isFileLoading: false,\n        isFileLoadedErr: true,\n      });\n    });\n  }\n\n  // load data\n  loadDirData = (path) => {\n    let repoID = this.props.repoID;\n\n    // listen current repo\n    collabServer.watchRepo(repoID, this.onRepoUpdateEvent);\n\n    // list used FileTags\n    this.updateUsedRepoTags();\n\n    // list draft counts and review counts\n    if (isDocs) {\n      seafileAPI.getRepoDraftCounts(repoID).then(res => {\n        this.setState({\n          draftCounts: res.data.draft_counts,\n        });\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n\n    if (Utils.isMarkdownFile(path)) {\n      seafileAPI.getFileInfo(this.props.repoID, path).then(() => {\n        if (this.state.currentMode !== 'column') {\n          cookie.save('seafile_view_mode', 'column');\n          this.setState({currentMode: 'column'});\n        }\n        this.loadSidePanel(path);\n        this.showFile(path);\n      }).catch(() => {\n        if (this.state.currentMode === 'column') { // After an error occurs, follow dir\n          this.loadSidePanel(path);\n          this.showDir(path);\n        } else {\n          this.showDir(path);\n        }\n      });\n    } else {\n      if (this.state.currentMode === 'column') {\n        this.loadSidePanel(path);\n        this.showDir(path);\n      } else {\n        this.showDir(path);\n      }\n    }\n  }\n\n  loadSidePanel = (path) => {\n    let repoID = this.props.repoID;\n    if (path === '/') {\n      seafileAPI.listDir(repoID, '/').then(res => {\n        const { dirent_list, user_perm } = res.data;\n        let tree = this.state.treeData;\n        this.addResponseListToNode(dirent_list, tree.root);\n        this.setState({\n          isTreeDataLoading: false,\n          treeData: tree,\n          userPerm: user_perm,\n        });\n      }).catch(() => {\n        this.setState({isTreeDataLoading: false});\n      });\n    } else {\n      this.loadNodeAndParentsByPath(path);\n    }\n  }\n\n  showDir = (path) => {\n    let repoID = this.props.repoID;\n\n    if (!this.state.isSessionExpired) {\n      // update stste\n      this.setState({\n        isDirentListLoading: true,\n        isViewFile: false,\n        selectedDirentList: [],\n      });\n    }\n\n    // update data\n    this.loadDirentList(path);\n    this.resetShowLength();\n\n    if (!this.isNeedUpdateHistoryState) {\n      this.isNeedUpdateHistoryState = true;\n      return;\n    }\n    // update location\n    let repoInfo = this.state.currentRepoInfo;\n    let url = siteRoot + 'library/' + repoID + '/' + encodeURIComponent(repoInfo.repo_name) + Utils.encodePath(path);\n    window.history.pushState({url: url, path: path}, path, url);\n  }\n\n  showFile = (filePath) => {\n    let repoID = this.props.repoID;\n\n    if (this.state.currentMode === 'column') {\n      seafileAPI.listFileTags(repoID, filePath).then(res => {\n        let fileTags = res.data.file_tags.map(item => {\n          return new FileTag(item);\n        });\n        this.setState({fileTags: fileTags});\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n\n    // update state\n    this.setState({\n      isFileLoading: true,\n      path: filePath,\n      isViewFile: true\n    });\n\n    // update data\n    seafileAPI.getFileInfo(repoID, filePath).then((res) => {\n      let { mtime, permission, last_modifier_name, is_draft, has_draft, draft_id } = res.data;\n      seafileAPI.getFileDownloadLink(repoID, filePath).then((res) => {\n        seafileAPI.getFileContent(res.data).then((res) => {\n          this.setState({\n            content: res.data,\n            filePermission: permission,\n            latestContributor: last_modifier_name,\n            lastModified: moment.unix(mtime).fromNow(),\n            isFileLoading: false,\n            isFileLoadedErr: false,\n            isDraft: is_draft,\n            hasDraft: has_draft,\n            draftID: draft_id\n          });\n        });\n      });\n    }).catch((err) => {\n      let errMsg = Utils.getErrorMsg(err, true);\n      if (!err.response || err.response.status !== 403) {\n        toaster.danger(errMsg);\n      }\n      this.setState({\n        isFileLoading: false,\n        isFileLoadedErr: true,\n      });\n    });\n\n    // update location\n    let repoInfo = this.state.currentRepoInfo;\n    let url = siteRoot + 'library/' + repoID + '/' + encodeURIComponent(repoInfo.repo_name) + Utils.encodePath(filePath);\n    window.history.pushState({url: url, path: filePath}, filePath, url);\n  }\n\n  loadDirentList = (path) => {\n    let repoID = this.props.repoID;\n    seafileAPI.listDir(repoID, path, {'with_thumbnail': true}).then(res => {\n      let direntList = [];\n      let markdownItem = null;\n      res.data.dirent_list.forEach(item => {\n        let fileName = item.name.toLowerCase();\n        if (fileName === 'readme.md' || fileName === 'readme.markdown') {\n          markdownItem = item;\n        }\n        let dirent = new Dirent(item);\n        direntList.push(dirent);\n      });\n\n      this.setState({\n        pathExist: true,\n        userPerm: res.data.user_perm,\n        isDirentListLoading: false,\n        direntList: Utils.sortDirents(direntList, this.state.sortBy, this.state.sortOrder),\n        dirID: res.data.dir_id,\n        readmeMarkdown: markdownItem,\n        path: path,\n        isSessionExpired: false,\n      });\n\n      if (!this.state.repoEncrypted && direntList.length) {\n        this.getThumbnails(repoID, path, this.state.direntList);\n      }\n    }).catch((err) => {\n      Utils.getErrorMsg(err, true);\n      if (err.response && err.response.status === 403) {\n        this.setState({isDirentListLoading: false});\n        return;\n      }\n      this.setState({\n        isDirentListLoading: false,\n        pathExist: false,\n      });\n    });\n  }\n\n  onListContainerScroll = () => {\n    let itemsShowLength = this.state.itemsShowLength + 100;\n    this.setState({itemsShowLength: itemsShowLength});\n  }\n\n  resetShowLength = () => {\n    this.setState({itemsShowLength: 100});\n  }\n\n  getThumbnails = (repoID, path, direntList) => {\n    let items = direntList.filter((item) => {\n      return (Utils.imageCheck(item.name) || (enableVideoThumbnail && Utils.videoCheck(item.name))) && !item.encoded_thumbnail_src;\n    });\n    if (items.length == 0) {\n      return ;\n    }\n\n    const _this = this;\n    const len = items.length;\n    const thumbnailSize = 48;\n    let getThumbnail = (i) => {\n      const curItem = items[i];\n      const curItemPath = [path, curItem.name].join('/');\n      seafileAPI.createThumbnail(repoID, curItemPath, thumbnailSize).then((res) => {\n        curItem.encoded_thumbnail_src = res.data.encoded_thumbnail_src;\n      }).catch((error) => {\n        // do nothing\n      }).then(() => {\n        if (i < len - 1) {\n          getThumbnail(++i);\n        } else {\n          _this.setState({\n            direntList: direntList\n          });\n        }\n      });\n    };\n    getThumbnail(0);\n  }\n\n  updateMoveCopyTreeNode = (path) => {\n    let repoID = this.props.repoID;\n\n    let tree = this.state.treeData.clone();\n    let node = tree.getNodeByPath(path);\n\n    let nodeChildren = node.children.map(item => item.object);\n    let nodeChildrenNames = nodeChildren.map(item => item.name);\n\n    seafileAPI.listDir(repoID, path).then(res => {\n      let newDirentList = res.data.dirent_list;\n      let newAddedDirents = newDirentList.filter(item => {\n        return !nodeChildrenNames.includes(item.name);\n      });\n      newAddedDirents.map(item => {\n        this.addNodeToTree(item.name, path, item.type);\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  async getAsyncCopyMoveProgress() {\n    let { asyncOperationType, asyncCopyMoveTaskId } = this.state;\n    try {\n      let res = await seafileAPI.queryAsyncOperationProgress(asyncCopyMoveTaskId);\n      let data = res.data;\n      if (data.failed) {\n        let message = gettext('Failed to move files to another library.');\n        if (asyncOperationType === 'copy') {\n          message = gettext('Failed to copy files to another library.');\n        }\n        toaster.danger(message);\n        this.setState({\n          asyncOperationProgress: 0,\n          isCopyMoveProgressDialogShow: false,\n        });\n        return;\n      }\n\n      if (data.successful) {\n        if (asyncOperationType === 'move') {\n          if (this.currentMoveItemName && this.currentMoveItemPath) {\n            if (this.state.currentMode === 'column') {\n              this.deleteTreeNode(this.currentMoveItemPath);\n            }\n            this.moveDirent(this.currentMoveItemName);\n            this.currentMoveItemName = '';\n            this.currentMoveItemPath = '';\n          } else {\n            if (this.state.currentMode === 'column') {\n              let direntPaths = this.getSelectedDirentPaths();\n              this.deleteTreeNodes(direntPaths);\n            }\n            let direntNames = this.getSelectedDirentNames();\n            this.moveDirents(direntNames);\n          }\n        }\n\n        this.setState({isCopyMoveProgressDialogShow: false});\n        let message = gettext('Successfully moved files to another library.');\n        if (asyncOperationType === 'copy') {\n          message = gettext('Successfully copied files to another library.');\n        }\n        toaster.success(message);\n        return;\n      }\n      // init state: total is 0\n      let asyncOperationProgress = !data.total ? 0 : parseInt((data.done/data.total * 100).toFixed(2));\n\n      this.getAsyncCopyMoveProgress();\n      this.setState({asyncOperationProgress: asyncOperationProgress});\n    } catch (error) {\n      this.setState({\n        asyncOperationProgress: 0,\n        isCopyMoveProgressDialogShow: false,\n      });\n    }\n  }\n\n  cancelCopyMoveDirent = () => {\n    let taskId = this.state.asyncCopyMoveTaskId;\n    seafileAPI.cancelCopyMoveOperation(taskId);\n\n    this.currentMoveItemName = '';\n    this.currentMoveItemPath = '';\n    let direntList = this.state.direntList;\n    this.setState({direntList: direntList.slice(0)});\n  }\n\n  onMoveProgressDialogToggle = () => {\n    let { asyncOperationProgress } = this.state;\n    if (asyncOperationProgress !== 100) {\n      this.cancelCopyMoveDirent();\n    }\n\n    this.setState({\n      asyncOperationProgress: 0,\n      isCopyMoveProgressDialogShow: false,\n    });\n  }\n\n  // toolbar operations\n  onMoveItems = (destRepo, destDirentPath) => {\n    let repoID = this.props.repoID;\n    let selectedDirentList = this.state.selectedDirentList;\n    if (repoID !== destRepo.repo_id) {\n      this.setState(() => ({\n        asyncOperatedFilesLength: selectedDirentList.length,\n        asyncOperationProgress: 0,\n        asyncOperationType: 'move',\n        isCopyMoveProgressDialogShow: true\n      }));\n    }\n\n    let dirNames = this.getSelectedDirentNames();\n    let direntPaths = this.getSelectedDirentPaths();\n    seafileAPI.moveDir(repoID, destRepo.repo_id, destDirentPath, this.state.path, dirNames).then(res => {\n      if (repoID !== destRepo.repo_id) {\n        this.setState({\n          asyncCopyMoveTaskId: res.data.task_id,\n        }, () => {\n          // After moving successfully, delete related files\n          this.getAsyncCopyMoveProgress();\n        });\n      }\n\n      if (repoID === destRepo.repo_id) {\n        if (this.state.currentMode === 'column') {\n          this.deleteTreeNodes(direntPaths);\n        }\n\n        this.moveDirents(dirNames);\n\n        // 2. tow columns mode need update left tree\n        if (this.state.currentMode === 'column') {\n          this.updateMoveCopyTreeNode(destDirentPath);\n        }\n\n        // show tip message if move to current repo\n        let message =  Utils.getMoveSuccessMessage(dirNames);\n        toaster.success(message);\n      }\n\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = Utils.getMoveFailedMessage(dirNames);\n      }\n      this.setState({\n        asyncOperationProgress: 0,\n        isCopyMoveProgressDialogShow: false,\n      });\n      toaster.danger(errMessage);\n    });\n  }\n\n  onCopyItems = (destRepo, destDirentPath) => {\n    let repoID = this.props.repoID;\n    let selectedDirentList = this.state.selectedDirentList;\n\n    if (repoID !== destRepo.repo_id) {\n      this.setState({\n        asyncOperatedFilesLength: selectedDirentList.length,\n        asyncOperationProgress: 0,\n        asyncOperationType: 'copy',\n        isCopyMoveProgressDialogShow: true\n      });\n    }\n\n    let dirNames = this.getSelectedDirentNames();\n    seafileAPI.copyDir(repoID, destRepo.repo_id, destDirentPath, this.state.path, dirNames).then(res => {\n      if (repoID !== destRepo.repo_id) {\n        this.setState({\n          asyncCopyMoveTaskId: res.data.task_id,\n        }, () => {\n          this.getAsyncCopyMoveProgress();\n        });\n      }\n\n      if (repoID === destRepo.repo_id) {\n        if (this.state.currentMode === 'column') {\n          this.updateMoveCopyTreeNode(destDirentPath);\n        }\n\n        if (destDirentPath === this.state.path) {\n          this.loadDirentList(this.state.path);\n        }\n\n        // show tip message if copy to current repo\n        let message =  Utils.getCopySuccessfulMessage(dirNames);\n        toaster.success(message);\n      }\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = Utils.getCopyFailedMessage(dirNames);\n      }\n      toaster.danger(errMessage);\n    });\n  }\n\n  restoreDeletedDirents = (commitID, paths, e) => {\n    const { repoID } = this.props;\n    e.preventDefault();\n    toaster.closeAll();\n    seafileAPI.restoreDirents(repoID, commitID, paths).then(res => {\n      const { success, failed } = res.data;\n      success.forEach(dirent => {\n        let name = Utils.getFileName(dirent.path);\n        let parentPath = Utils.getDirName(dirent.path);\n        if (!dirent.is_dir) {\n          if (this.state.currentMode === 'column') {\n            this.addNodeToTree(name, parentPath, 'file');\n          }\n          if (parentPath === this.state.path && !this.state.isViewFile) {\n            this.addDirent(name, 'file');\n          }\n        } else {\n          if (this.state.currentMode === 'column') {\n            this.addNodeToTree(name, parentPath, 'dir');\n          }\n          if (parentPath === this.state.path && !this.state.isViewFile) {\n            this.addDirent(name, 'dir');\n          }\n        }\n      });\n\n      if (success.length) {\n        let msg = success.length > 1 ? gettext('Restored {name} and {n} other items') :\n          gettext('Restored {name}');\n        msg = msg.replace('{name}', success[0].path.split('/').pop())\n          .replace('{n}', success.length - 1);\n        toaster.success(msg);\n      }\n\n      if (failed.length) {\n        let msg = failed.length > 1 ? gettext('Failed to restore {name} and {n} other items') :\n          gettext('Failed to restore {name}');\n        msg = msg.replace('{name}', failed[0].path.split('/').pop())\n          .replace('{n}', failed.length - 1);\n        toaster.danger(msg);\n      }\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onDeleteItems = () => {\n    let repoID = this.props.repoID;\n    let direntPaths = this.getSelectedDirentPaths();\n    let dirNames = this.getSelectedDirentNames();\n\n    this.setState({updateDetail: !this.state.updateDetail});\n    seafileAPI.deleteMutipleDirents(repoID, this.state.path, dirNames).then(res => {\n      if (this.state.currentMode === 'column') {\n        this.deleteTreeNodes(direntPaths);\n      }\n\n      this.deleteDirents(dirNames);\n\n      let msg = '';\n      if (direntPaths.length > 1) {\n        msg = gettext('Successfully deleted {name} and {n} other items.');\n        msg = msg.replace('{name}', dirNames[0]);\n        msg = msg.replace('{n}', dirNames.length - 1);\n      } else {\n        msg = gettext('Successfully deleted {name}.');\n        msg = msg.replace('{name}', dirNames[0]);\n      }\n      const successTipWithUndo = (\n        <>\n          <span>{msg}</span>\n          <a className=\"action-link p-0 ml-1\" href=\"#\" onClick={this.restoreDeletedDirents.bind(this, res.data.commit_id, direntPaths)}>{gettext('Undo')}</a>\n        </>\n      );\n      toaster.success(successTipWithUndo, {duration: 5});\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = gettext('Failed to delete {name} and {n} other items.');\n        errMessage = errMessage.replace('{name}', dirNames[0]);\n        errMessage = errMessage.replace('{n}', dirNames.length - 1);\n      }\n      toaster.danger(errMessage);\n    });\n  }\n\n  onAddFolder = (dirPath) => {\n    let repoID = this.props.repoID;\n    seafileAPI.createDir(repoID, dirPath).then(() => {\n      let name = Utils.getFileName(dirPath);\n      let parentPath = Utils.getDirName(dirPath);\n\n      if (this.state.currentMode === 'column') {\n        this.addNodeToTree(name, parentPath, 'dir');\n      }\n\n      if (parentPath === this.state.path && !this.state.isViewFile) {\n        this.addDirent(name, 'dir');\n      }\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onAddFile = (filePath, isMarkdownDraft, isSdocDraft) => {\n    let repoID = this.props.repoID;\n    seafileAPI.createFile(repoID, filePath, isMarkdownDraft).then(res => {\n      let name = Utils.getFileName(filePath);\n      let parentPath = Utils.getDirName(filePath);\n      if (this.state.currentMode === 'column') {\n        this.addNodeToTree(name, parentPath, 'file');\n      }\n      if (parentPath === this.state.path && !this.state.isViewFile) {\n        if (isSdocDraft) { // the new file is marked to be draft\n          seafileAPI.sdocMarkAsDraft(repoID, filePath).then((res) => {\n            this.addDirent(name, 'file', res.data.size, isSdocDraft);\n          }).catch(error => {\n            let errMessage = Utils.getErrorMsg(error);\n            toaster.danger(errMessage);\n            this.addDirent(name, 'file', res.data.size);\n          });\n          return;\n        }\n\n        this.addDirent(name, 'file', res.data.size);\n      }\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  switchViewMode = (mode) => {\n    if (mode === this.state.currentMode) {\n      return;\n    }\n    if (mode === 'detail') {\n      this.toggleDirentDetail();\n      return;\n    }\n    cookie.save('seafile_view_mode', mode);\n    let path = this.state.path;\n    if (this.state.currentMode === 'column' && this.state.isViewFile) {\n      path = Utils.getDirName(path);\n      this.setState({\n        path: path,\n        isViewFile: false,\n      });\n      let repoInfo = this.state.currentRepoInfo;\n\n      let url = siteRoot + 'library/' + repoInfo.repo_id + '/' + encodeURIComponent(repoInfo.repo_name) + Utils.encodePath(path);\n      window.history.pushState({url: url, path: path}, path, url);\n    }\n\n    if (mode === 'column') {\n      this.loadSidePanel(this.state.path);\n    }\n    this.isNeedUpdateHistoryState = false;\n    this.setState({currentMode: mode});\n    this.showDir(path);\n  }\n\n  onSearchedClick = (item) => {\n    let path = item.is_dir ? item.path.slice(0, item.path.length - 1) : item.path;\n    if (this.state.currentPath === path) {\n      return;\n    }\n    if (this.state.currentMode === 'column') {\n      // load sidePanel\n      let index = -1;\n      let paths = Utils.getPaths(path);\n      for (let i = 0; i < paths.length; i++) {\n        let node = this.state.treeData.getNodeByPath(node);\n        if (!node) {\n          index = i;\n          break;\n        }\n      }\n      if (index === -1) { // all the data has been loaded already.\n        let node = this.state.treeData.getNodeByPath(path);\n        this.setState({currentNode: node});\n      } else {\n        this.loadNodeAndParentsByPath(path);\n      }\n\n      // load mainPanel\n      if (item.is_dir) {\n        this.showDir(path);\n      } else {\n        if (Utils.isMarkdownFile(path)) {\n          this.showFile(path);\n        } else {\n          let url = siteRoot + 'lib/' + item.repo_id + '/file' + Utils.encodePath(path);\n          let isWeChat = Utils.isWeChat();\n          if (!isWeChat) {\n            let newWindow = window.open('about:blank');\n            newWindow.location.href = url;\n          } else {\n            location.href = url;\n          }\n        }\n      }\n    } else {\n      if (item.is_dir) {\n        this.showDir(path);\n      } else {\n        let url = siteRoot + 'lib/' + item.repo_id + '/file' + Utils.encodePath(path);\n        let isWeChat = Utils.isWeChat();\n        if (!isWeChat) {\n          let newWindow = window.open('about:blank');\n          newWindow.location.href = url;\n        } else {\n          location.href = url;\n        }\n      }\n    }\n  }\n\n  onMainNavBarClick = (nodePath) => {\n    //just for dir\n    this.resetSelected();\n    if (this.state.currentMode === 'column') {\n      let tree = this.state.treeData.clone();\n      let node = tree.getNodeByPath(nodePath);\n      tree.expandNode(node);\n      this.setState({treeData: tree, currentNode: node});\n    }\n\n    this.showDir(nodePath);\n  }\n\n  onLinkClick = (link) => {\n    const url = link;\n    let repoID = this.props.repoID;\n    if (Utils.isInternalMarkdownLink(url, repoID)) {\n      let path = Utils.getPathFromInternalMarkdownLink(url, repoID);\n      this.showFile(path);\n    } else if (Utils.isInternalDirLink(url, repoID)) {\n      let path = Utils.getPathFromInternalDirLink(url, repoID);\n      this.showDir(path);\n    } else {\n      window.open(url);\n    }\n  }\n\n  // list&tree operations\n  onMainPanelItemRename = (dirent, newName) => {\n    let path = Utils.joinPath(this.state.path, dirent.name);\n    this.renameItem(path, dirent.isDir(), newName);\n  }\n\n  onMainPanelItemDelete = (dirent) => {\n    let path = Utils.joinPath(this.state.path, dirent.name);\n    this.deleteItem(path, dirent.isDir());\n  }\n\n  onRenameTreeNode = (node, newName) => {\n    this.renameItem(node.path, node.object.isDir(), newName);\n  }\n\n  onDeleteTreeNode = (node) => {\n    this.deleteItem(node.path, node.object.isDir());\n  }\n\n  renameItem = (path, isDir, newName) => {\n    let repoID = this.props.repoID;\n    if (isDir) {\n      seafileAPI.renameDir(repoID, path, newName).then(() => {\n        this.renameItemAjaxCallback(path, newName);\n      }).catch((error) => {\n        let errMessage = Utils.getErrorMsg(error);\n        if (errMessage === gettext('Error')) {\n          let name = Utils.getFileName(path);\n          errMessage = gettext('Renaming {name} failed').replace('{name}', name);\n        }\n        toaster.danger(errMessage);\n      });\n    } else {\n      seafileAPI.renameFile(repoID, path, newName).then(() => {\n        this.renameItemAjaxCallback(path, newName);\n      }).catch((error) => {\n        let errMessage = Utils.getErrorMsg(error);\n        if (errMessage === gettext('Error')) {\n          let name = Utils.getFileName(path);\n          errMessage = gettext('Renaming {name} failed').replace('{name}', name);\n        }\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  renameItemAjaxCallback(path, newName) {\n    if (this.state.currentMode === 'column') {\n      this.renameTreeNode(path, newName);\n    }\n    this.renameDirent(path, newName);\n  }\n\n  toggleDeleteFolderDialog = () => {\n    this.setState({isDeleteFolderDialogOpen: !this.state.isDeleteFolderDialogOpen});\n  }\n\n  deleteFolder = () => {\n    const { repoID } = this.props;\n    const { folderToDelete: path } = this.state;\n    seafileAPI.deleteDir(repoID, path).then((res) => {\n      this.deleteItemAjaxCallback(path, true);\n      let name = Utils.getFileName(path);\n      var msg = gettext('Successfully deleted {name}').replace('{name}', name);\n      const successTipWithUndo = (\n        <>\n          <span>{msg}</span>\n          <a className=\"action-link p-0 ml-1\" href=\"#\" onClick={this.restoreDeletedDirents.bind(this, res.data.commit_id, [path])}>{gettext('Undo')}</a>\n        </>\n      );\n      toaster.success(successTipWithUndo, {duration: 5});\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        let name = Utils.getFileName(path);\n        errMessage = gettext('Failed to delete {name}').replace('{name}', name);\n      }\n      toaster.danger(errMessage);\n    });\n  }\n\n  deleteItem(path, isDir) {\n    let repoID = this.props.repoID;\n    if (isDir) {\n      this.setState({ folderToDelete: path }, () => {\n        this.toggleDeleteFolderDialog();\n      });\n    } else {\n      seafileAPI.deleteFile(repoID, path).then((res) => {\n        this.deleteItemAjaxCallback(path, isDir);\n        let name = Utils.getFileName(path);\n        var msg = gettext('Successfully deleted {name}').replace('{name}', name);\n        const successTipWithUndo = (\n          <>\n            <span>{msg}</span>\n            <a className=\"action-link p-0 ml-1\" href=\"#\" onClick={this.restoreDeletedDirents.bind(this, res.data.commit_id, [path])}>{gettext('Undo')}</a>\n          </>\n        );\n        toaster.success(successTipWithUndo, {duration: 5});\n      }).catch((error) => {\n        let errMessage = Utils.getErrorMsg(error);\n        if (errMessage === gettext('Error')) {\n          let name = Utils.getFileName(path);\n          errMessage = gettext('Failed to delete {name}').replace('{name}', name);\n        }\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  deleteItemAjaxCallback(path) {\n    if (this.state.currentMode === 'column') {\n      this.deleteTreeNode(path);\n    }\n    this.deleteDirent(path);\n  }\n\n  // list operations\n  onMoveItem = (destRepo, dirent, moveToDirentPath, nodeParentPath) => {\n    let repoID = this.props.repoID;\n    //just for view list state\n    let dirName = dirent.name;\n    if (!nodeParentPath) {\n      nodeParentPath = this.state.path;\n    }\n    let direntPath = Utils.joinPath(nodeParentPath, dirName);\n\n    if (repoID !== destRepo.repo_id) {\n      this.setState({\n        asyncOperatedFilesLength: 1,\n        asyncOperationProgress: 0,\n        asyncOperationType: 'move',\n        isCopyMoveProgressDialogShow: true,\n      });\n    }\n\n    seafileAPI.moveDir(repoID, destRepo.repo_id, moveToDirentPath, nodeParentPath, dirName).then(res => {\n      if (repoID !== destRepo.repo_id) {\n        this.setState({asyncCopyMoveTaskId: res.data.task_id}, () => {\n          this.currentMoveItemName = dirName;\n          this.currentMoveItemPath = direntPath;\n          this.getAsyncCopyMoveProgress(dirName, direntPath);\n        });\n      }\n\n      if (this.state.currentMode === 'column') {\n        this.deleteTreeNode(direntPath);\n      }\n\n      // 1. move to current repo\n      // 2. tow columns mode need update left tree\n      if (repoID === destRepo.repo_id && this.state.currentMode === 'column') {\n        this.updateMoveCopyTreeNode(moveToDirentPath);\n      }\n\n      this.moveDirent(direntPath, moveToDirentPath);\n\n      // show tip message if move to current repo\n      if (repoID === destRepo.repo_id) {\n        let message = gettext('Successfully moved {name}.');\n        message = message.replace('{name}', dirName);\n        toaster.success(message);\n      }\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = gettext('Failed to move {name}.');\n        errMessage = errMessage.replace('{name}', dirName);\n      }\n      toaster.danger(errMessage);\n    });\n  }\n\n  onCopyItem = (destRepo, dirent, copyToDirentPath, nodeParentPath) => {\n    let repoID = this.props.repoID;\n    //just for view list state\n    let dirName = dirent.name;\n    if (!nodeParentPath) {\n      nodeParentPath = this.state.path;\n    }\n\n    if (repoID !== destRepo.repo_id) {\n      this.setState({\n        asyncOperatedFilesLength: 1,\n        asyncOperationProgress: 0,\n        asyncOperationType: 'copy',\n        isCopyMoveProgressDialogShow: true\n      });\n    }\n\n    seafileAPI.copyDir(repoID, destRepo.repo_id, copyToDirentPath, nodeParentPath, dirName).then(res => {\n\n      if (repoID !== destRepo.repo_id) {\n        this.setState({\n          asyncCopyMoveTaskId: res.data.task_id,\n        }, () => {\n          this.getAsyncCopyMoveProgress();\n        });\n      }\n\n      if (repoID === destRepo.repo_id) {\n        if (this.state.currentMode === 'column') {\n          this.updateMoveCopyTreeNode(copyToDirentPath);\n        }\n\n        if (copyToDirentPath === nodeParentPath) {\n          this.loadDirentList(this.state.path);\n        }\n\n        let message = gettext('Successfully copied %(name)s.');\n        message = message.replace('%(name)s', dirName);\n        toaster.success(message);\n      }\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = gettext('Failed to copy %(name)s');\n        errMessage = errMessage.replace('%(name)s', dirName);\n      }\n      toaster.danger(errMessage);\n    });\n  }\n\n  onDirentClick = (dirent) => {\n    let direntList = this.state.direntList.map(dirent => {\n      dirent.isSelected = false;\n      return dirent;\n    });\n    if (dirent) {\n      // dirent.isSelected = true;\n      this.setState({\n        direntList: direntList,\n        isDirentSelected: true,\n        selectedDirentList: [dirent],\n      });\n    } else {\n      this.setState({\n        direntList: direntList,\n        isDirentSelected: false,\n        selectedDirentList: [],\n      });\n    }\n  }\n\n  onItemClick = (dirent) => {\n    this.resetSelected();\n    let repoID = this.props.repoID;\n    let direntPath = Utils.joinPath(this.state.path, dirent.name);\n    if (dirent.isDir()) {  // is dir\n      if (this.state.currentMode === 'column') {\n        this.loadTreeNodeByPath(direntPath);\n      }\n      this.showDir(direntPath);\n    } else {  // is file\n      if (this.state.currentMode === 'column' && Utils.isMarkdownFile(direntPath)) {\n        this.showColumnMarkdownFile(direntPath);\n      } else {\n        let url = siteRoot + 'lib/' + repoID + '/file' + Utils.encodePath(direntPath);\n        if (dirent.is_sdoc_revision && dirent.revision_id) {\n          url = siteRoot + 'lib/' + repoID + '/revisions/' + dirent.revision_id + '/';\n        }\n\n        let isWeChat = Utils.isWeChat();\n        if (!isWeChat) {\n          window.open(url);\n        } else {\n          location.href = url;\n        }\n      }\n    }\n  }\n\n  onDirentSelected = (dirent) => {\n    let direntList = this.state.direntList.map(item => {\n      if (item.name === dirent.name) {\n        item.isSelected = !item.isSelected;\n      }\n      return item;\n    });\n    let selectedDirentList = direntList.filter(item => {\n      return item.isSelected;\n    });\n\n    if (selectedDirentList.length) {\n      this.setState({isDirentSelected: true});\n      if (selectedDirentList.length === direntList.length) {\n        this.setState({\n          isAllDirentSelected: true,\n          direntList: direntList,\n          selectedDirentList: selectedDirentList,\n        });\n      } else {\n        this.setState({\n          isAllDirentSelected: false,\n          direntList: direntList,\n          selectedDirentList: selectedDirentList\n        });\n      }\n    } else {\n      this.setState({\n        isDirentSelected: false,\n        isAllDirentSelected: false,\n        direntList: direntList,\n        selectedDirentList: []\n      });\n    }\n  }\n\n  onAllDirentSelected = () => {\n    if (this.state.isAllDirentSelected) {\n      let direntList = this.state.direntList.map(item => {\n        item.isSelected = false;\n        return item;\n      });\n      this.setState({\n        isDirentSelected: false,\n        isAllDirentSelected: false,\n        direntList: direntList,\n        selectedDirentList: [],\n      });\n    } else {\n      let direntList = this.state.direntList.map(item => {\n        item.isSelected = true;\n        return item;\n      });\n      this.setState({\n        isDirentSelected: true,\n        isAllDirentSelected: true,\n        direntList: direntList,\n        selectedDirentList: direntList,\n      });\n    }\n  }\n\n  onFileTagChanged = (dirent, direntPath) => {\n    let repoID = this.props.repoID;\n    seafileAPI.listFileTags(repoID, direntPath).then(res => {\n      let fileTags = res.data.file_tags.map(item => {\n        return new FileTag(item);\n      });\n\n      if (this.state.isViewFile) {\n        this.setState({fileTags: fileTags});\n      } else {\n        this.updateDirent(dirent, 'file_tags', fileTags);\n      }\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n\n    this.updateUsedRepoTags();\n  }\n\n  onFileUploadSuccess = (direntObject) => {\n    let isExist = this.state.direntList.some(item => {\n      return item.name === direntObject.name && item.type === direntObject.type;\n    });\n    if (isExist) {\n      let direntList = this.state.direntList;\n      for (let i = 0; i < direntList.length; i++) {\n        let dirent = direntList[i];\n        if (dirent.name === direntObject.name && dirent.type === direntObject.type) {\n          let mtime = moment.unix(direntObject.mtime).fromNow();\n          this.updateDirent(dirent, 'mtime', mtime);  // todo file size is need update too, api is not return;\n          break;\n        }\n      }\n    } else {\n      // use current dirent parent's permission as it's permission\n      direntObject.permission = this.state.userPerm;\n      let dirent = new Dirent(direntObject);\n      if (this.state.currentMode === 'column') {\n        this.addNodeToTree(dirent.name, this.state.path, dirent.type);\n      }\n      if (direntObject.type === 'dir') {\n        this.setState({direntList: [dirent, ...this.state.direntList]});\n      } else {\n        this.setState({direntList: [...this.state.direntList, dirent]});\n        this.updateReadmeMarkdown(this.state.direntList);\n      }\n    }\n  }\n\n  addDirent = (name, type, size, isSdocDraft) => {\n    let item = this.createDirent(name, type, size, isSdocDraft);\n    let direntList = this.state.direntList;\n    if (type === 'dir') {\n      direntList.unshift(item);\n    } else {\n      // there will be there conditions;\n      // first: direntList.length === 0;\n      // second: all the direntList's items are dir;\n      // third: direntList has dir and file;\n      let length = direntList.length;\n      if (length === 0 || direntList[length - 1].type === 'dir') {\n        direntList.push(item);\n      } else {\n        let index = 0;\n        for (let i = 0; i <= length; i++) {\n          if (direntList[i].type === 'file') {\n            index = i;\n            break;\n          }\n        }\n        direntList.splice(index, 0, item);\n      }\n    }\n    this.setState({direntList: direntList});\n    this.updateReadmeMarkdown(direntList);\n  }\n\n  renameDirent = (direntPath, newName) => {\n    let repoID = this.props.repoID;\n    let parentPath = Utils.getDirName(direntPath);\n    let newDirentPath = Utils.joinPath(parentPath, newName);\n    if (direntPath === this.state.path) {\n      // the renamed item is current viewed item\n      // example: direntPath = /A/B/C, state.path = /A/B/C\n\n      this.setState({ path: newDirentPath });\n      let repoInfo = this.state.currentRepoInfo;\n      let url = siteRoot + 'library/' + repoID + '/' + encodeURIComponent(repoInfo.repo_name) + newDirentPath;\n      window.history.replaceState({ url: url, path: newDirentPath}, newDirentPath, url);\n    } else if (Utils.isChildPath(direntPath, this.state.path)) {\n      // example: direntPath = /A/B/C/D, state.path = /A/B/C\n      let oldName = Utils.getFileName(direntPath);\n      let direntList = this.state.direntList.map(item => {\n        if (item.name === oldName) {\n          item.name = newName;\n        }\n        return item;\n      });\n      this.setState({ direntList: direntList });\n      this.updateReadmeMarkdown(direntList);\n    } else if (Utils.isAncestorPath(direntPath, this.state.path)) {\n      // example: direntPath = /A/B, state.path = /A/B/C\n      let newPath = Utils.renameAncestorPath(this.state.path, direntPath, newDirentPath);\n      this.setState({ path: newPath });\n\n      let repoInfo = this.state.currentRepoInfo;\n      let url = siteRoot + 'library/' + repoID + '/' + encodeURIComponent(repoInfo.repo_name) + newPath;\n      window.history.replaceState({ url: url, path: newPath}, newPath, url);\n    }\n  }\n\n  deleteDirent(direntPath) {\n    if (direntPath === this.state.path) {\n      // The deleted item is current item\n      let parentPath = Utils.getDirName(direntPath);\n      this.showDir(parentPath);\n    } else if (Utils.isChildPath(direntPath, this.state.path)) {\n      // The deleted item is inside current path\n      let name = Utils.getFileName(direntPath);\n      let direntList = this.state.direntList.filter(item => {\n        return item.name !== name;\n      });\n\n      // Recalculate the state of the selection\n      this.recaculateSelectedStateAfterDirentDeleted(name, direntList);\n\n      this.setState({direntList: direntList});\n      this.updateReadmeMarkdown(direntList);\n    } else if (Utils.isAncestorPath(direntPath, this.state.path)) {\n      // the deleted item is ancester of the current item\n      let parentPath = Utils.getDirName(direntPath);\n      this.showDir(parentPath);\n    }\n    // else do nothing\n  }\n\n  // only one scence: The deleted items are inside current path\n  deleteDirents = (direntNames) => {\n    let direntList = this.state.direntList.filter(item => {\n      return direntNames.indexOf(item.name) === -1;\n    });\n\n    // Recalculate the state of the selection\n    this.recaculateSelectedStateAfterDirentDeleted(name, direntList);\n\n    this.setState({direntList: direntList});\n    this.updateReadmeMarkdown(direntList);\n  }\n\n  moveDirent = (direntPath, moveToDirentPath = null) => {\n    let name = Utils.getFileName(direntPath);\n    if (moveToDirentPath === this.state.path) {\n      this.loadDirentList(this.state.path);\n      return;\n    }\n    let direntList = this.state.direntList.filter(item => {\n      return item.name !== name;\n    });\n\n    // Recalculate the state of the selection\n    this.recaculateSelectedStateAfterDirentDeleted(name, direntList);\n\n    this.setState({direntList: direntList});\n    this.updateReadmeMarkdown(direntList);\n  }\n\n  // only one scence: The moved items are inside current path\n  moveDirents = (direntNames) => {\n    let direntList = this.state.direntList.filter(item => {\n      return direntNames.indexOf(item.name) === -1;\n    });\n\n    // Recalculate the state of the selection\n    this.recaculateSelectedStateAfterDirentDeleted(name, direntList);\n\n    this.setState({direntList: direntList});\n    this.updateReadmeMarkdown(direntList);\n  }\n\n  updateDirent = (dirent, paramKey, paramValue) => {\n    let newDirentList = this.state.direntList.map(item => {\n      if (item.name === dirent.name) {\n        item[paramKey] = paramValue;\n      }\n      return item;\n    });\n    this.setState({direntList: newDirentList});\n  }\n\n  // tree operations\n  loadTreeNodeByPath = (path) => {\n    let repoID = this.props.repoID;\n    let tree = this.state.treeData.clone();\n    let node = tree.getNodeByPath(path);\n    if (!node.isLoaded) {\n      seafileAPI.listDir(repoID, node.path).then(res => {\n        this.addResponseListToNode(res.data.dirent_list, node);\n        let parentNode = tree.getNodeByPath(node.parentNode.path);\n        parentNode.isExpanded = true;\n        this.setState({\n          treeData: tree,\n          currentNode: node\n        });\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      let parentNode = tree.getNodeByPath(node.parentNode.path);\n      parentNode.isExpanded = true;\n      this.setState({treeData: tree, currentNode: node}); //tree\n    }\n  }\n\n  loadNodeAndParentsByPath = (path) => {\n    let repoID = this.props.repoID;\n    let tree = this.state.treeData.clone();\n    if (Utils.isMarkdownFile(path)) {\n      path = Utils.getDirName(path);\n    }\n    seafileAPI.listDir(repoID, path, {with_parents: true}).then(res => {\n      const { dirent_list: direntList, user_perm } = res.data;\n      let results = {};\n      for (let i = 0; i < direntList.length; i++) {\n        let object = direntList[i];\n        let parentDir = object.parent_dir;\n        let key = parentDir === '/' ?  '/' : parentDir.slice(0, parentDir.length - 1);\n        if (!results[key]) {\n          results[key] = [];\n        }\n        results[key].push(object);\n      }\n      for (let key in results) {\n        let node = tree.getNodeByPath(key);\n        if (!node.isLoaded) {\n          this.addResponseListToNode(results[key], node);\n        }\n      }\n      this.setState({\n        isTreeDataLoading: false,\n        treeData: tree,\n        userPerm: user_perm,\n      });\n    }).catch(() => {\n      this.setState({isLoadFailed: true});\n    });\n  }\n\n  onTreeNodeClick = (node) => {\n    this.resetSelected();\n    let repoID = this.props.repoID;\n    if (!this.state.pathExist) {\n      this.setState({pathExist: true});\n    }\n\n    if (node.object.isDir()) {\n      let isLoaded = node.isLoaded;\n      if (!node.isLoaded) {\n        let tree = this.state.treeData.clone();\n        node = tree.getNodeByPath(node.path);\n        seafileAPI.listDir(repoID, node.path).then(res => {\n          this.addResponseListToNode(res.data.dirent_list, node);\n          tree.collapseNode(node);\n          this.setState({treeData: tree});\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n      if (isLoaded && node.path === this.state.path) {\n        if (node.isExpanded) {\n          let tree = treeHelper.collapseNode(this.state.treeData, node);\n          this.setState({treeData: tree});\n        } else {\n          let tree = this.state.treeData.clone();\n          node = tree.getNodeByPath(node.path);\n          tree.expandNode(node);\n          this.setState({treeData: tree});\n        }\n      }\n    }\n\n    if (node.path === this.state.path ) {\n      return;\n    }\n\n    if (node.object.isDir()) {  // isDir\n      this.showDir(node.path);\n    } else {\n      if (Utils.isMarkdownFile(node.path)) {\n        if (node.path !== this.state.path) {\n          this.showColumnMarkdownFile(node.path);\n        }\n      } else {\n        let url = siteRoot + 'lib/' + repoID + '/file' + Utils.encodePath(node.path);\n        let dirent = node.object;\n        if (dirent.is_sdoc_revision && dirent.revision_id) {\n          url = siteRoot + 'lib/' + repoID + '/revisions/' + dirent.revision_id + '/';\n        }\n        window.open(url);\n      }\n    }\n  }\n\n  showColumnMarkdownFile = (filePath) => {\n    let repoID = this.props.repoID;\n    seafileAPI.getFileInfo(repoID, filePath).then((res) => {\n      if (res.data.size === 0) {\n        // loading of asynchronously obtained data may be blocked\n        const w = window.open('about:blank');\n        const url = siteRoot + 'lib/' + repoID + '/file' + Utils.encodePath(filePath);\n        w.location.href = url;\n      } else {\n        this.showFile(filePath);\n      }\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onTreeNodeCollapse = (node) => {\n    let tree = treeHelper.collapseNode(this.state.treeData, node);\n    this.setState({treeData: tree});\n  }\n\n  onTreeNodeExpanded = (node) => {\n    let repoID = this.props.repoID;\n    let tree = this.state.treeData.clone();\n    node = tree.getNodeByPath(node.path);\n    if (!node.isLoaded) {\n      seafileAPI.listDir(repoID, node.path).then(res => {\n        this.addResponseListToNode(res.data.dirent_list, node);\n        this.setState({treeData: tree});\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      tree.expandNode(node);\n      this.setState({treeData: tree});\n    }\n  }\n\n  addNodeToTree = (name, parentPath, type) => {\n    let node = this.createTreeNode(name, type);\n    let tree = treeHelper.addNodeToParentByPath(this.state.treeData, node, parentPath);\n    this.setState({treeData: tree});\n  }\n\n  renameTreeNode = (path, newName) => {\n    let tree = treeHelper.renameNodeByPath(this.state.treeData, path, newName);\n    this.setState({treeData: tree});\n  }\n\n  deleteTreeNode = (path) => {\n    let tree = treeHelper.deleteNodeByPath(this.state.treeData, path);\n    this.setState({treeData: tree});\n  }\n\n  deleteTreeNodes = (paths) => {\n    let tree = treeHelper.deleteNodeListByPaths(this.state.treeData, paths);\n    this.setState({treeData: tree});\n  }\n\n  moveTreeNode = (nodePath, moveToPath, moveToRepo, nodeName) => {\n    let repoID = this.props.repoID;\n    if (repoID !== moveToRepo.repo_id) {\n      let tree = treeHelper.deleteNodeByPath(this.state.treeData, nodePath);\n      this.setState({treeData: tree});\n      return;\n    }\n    let tree = treeHelper.moveNodeByPath(this.state.treeData, nodePath, moveToPath, nodeName);\n    this.setState({treeData: tree});\n  }\n\n  copyTreeNode = (nodePath, copyToPath, destRepo, nodeName) => {\n    let repoID = this.props.repoID;\n    if (repoID !== destRepo.repo_id) {\n      return;\n    }\n    let tree = treeHelper.copyNodeByPath(this.state.treeData, nodePath, copyToPath, nodeName);\n    this.setState({treeData: tree});\n  }\n\n  createTreeNode(name, type) {\n    let object = this.createDirent(name, type);\n    return new TreeNode({object});\n  }\n\n  createDirent(name, type, size, isSdocDraft) {\n    // use current dirent parent's permission as it's permission\n    const { userPerm: permission } = this.state;\n    const mtime = new Date().getTime()/1000;\n    const obj = { name, type, mtime, size, permission };\n    if (isSdocDraft) {\n      obj.is_sdoc_draft = isSdocDraft;\n    }\n    const dirent = new Dirent(obj);\n    return dirent;\n  }\n\n  addResponseListToNode = (list, node) => {\n    node.isLoaded = true;\n    node.isExpanded = true;\n    let direntList = list.map(item => {\n      return new Dirent(item);\n    });\n    direntList = Utils.sortDirents(direntList, 'name', 'asc');\n\n    let nodeList = direntList.map(object => {\n      return new TreeNode({object});\n    });\n    node.addChildren(nodeList);\n  }\n\n  getSelectedDirentPaths = () => {\n    let paths = [];\n    this.state.selectedDirentList.forEach(selectedDirent => {\n      paths.push(Utils.joinPath(this.state.path, selectedDirent.name));\n    });\n    return paths;\n  }\n\n  getSelectedDirentNames = () => {\n    let names = [];\n    this.state.selectedDirentList.forEach(selectedDirent => {\n      names.push(selectedDirent.name);\n    });\n    return names;\n  }\n\n  resetSelected = () => {\n    this.setState({\n      isDirentSelected: false,\n      isAllDirentSelected: false,\n    });\n  }\n\n  recaculateSelectedStateAfterDirentDeleted = (name, newDirentList) => {\n    let selectedDirentList = this.state.selectedDirentList.slice(0);\n    if (selectedDirentList.length > 0) {\n      selectedDirentList = selectedDirentList.filter(item => {\n        return item.name !== name;\n      });\n    }\n    this.setState({\n      selectedDirentList: selectedDirentList,\n      isDirentSelected: selectedDirentList.length > 0,\n      isAllDirentSelected: selectedDirentList.length === newDirentList.length,\n    });\n  }\n\n  onLibDecryptDialog = () => {\n    this.setState({libNeedDecrypt: false});\n    this.loadDirData(this.state.path);\n  }\n\n  goDraftPage = () => {\n    window.open(siteRoot + 'drafts/' + this.state.draftID + '/');\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    cookie.save('seafile-repo-dir-sort-by', sortBy);\n    cookie.save('seafile-repo-dir-sort-order', sortOrder);\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      items: Utils.sortDirents(this.state.direntList, sortBy, sortOrder)\n    });\n  }\n\n  onUploadFile = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.uploader.onFileUpload();\n  }\n\n  onUploadFolder = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.uploader.onFolderUpload();\n  }\n\n  onToolbarFileTagChanged = () => {\n    let repoID = this.props.repoID;\n    let filePath = this.state.path;\n    seafileAPI.listFileTags(repoID, filePath).then(res => {\n      let fileTags = res.data.file_tags.map(item => {\n        return new FileTag(item);\n      });\n\n      this.setState({fileTags: fileTags});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  unSelectDirent = () => {\n    this.setState({\n      isDirentSelected: false,\n      selectedDirentList: []\n    });\n    const dirent = {};\n    this.onDirentSelected(dirent);\n  }\n\n  onDeleteRepoTag = (deletedTagID) => {\n    let direntList = this.state.direntList.map(dirent => {\n      if (dirent.file_tags) {\n        let fileTags = dirent.file_tags.filter(item => {\n          return item.repo_tag_id !== deletedTagID;\n        });\n        dirent.file_tags = fileTags;\n      }\n      return dirent;\n    });\n    this.setState({direntList: direntList});\n    this.updateUsedRepoTags();\n  }\n\n\n  handleSubmit = (e) => {\n    let options = {\n      'share_type': 'personal',\n      'from': this.state.currentRepoInfo.owner_email\n    };\n    seafileAPI.leaveShareRepo(this.props.repoID, options).then(res => {\n      navigate(siteRoot + 'shared-libs/');\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error, true);\n      toaster.danger(errorMsg);\n    });\n\n    e.preventDefault();\n  }\n\n  render() {\n    if (this.state.libNeedDecrypt) {\n      return (\n        <ModalPortal>\n          <LibDecryptDialog\n            repoID={this.props.repoID}\n            onLibDecryptDialog={this.onLibDecryptDialog}\n          />\n        </ModalPortal>\n      );\n    }\n\n    if (this.state.errorMsg) {\n      return (\n        <Fragment>\n          <p className=\"error mt-6 text-center\">{this.state.errorMsg}</p>\n          <button type=\"submit\" className=\"btn btn-primary submit\" onClick={this.handleSubmit}>{gettext('Leave Share')}</button>\n        </Fragment>\n      );\n    }\n\n    if (!this.state.currentRepoInfo) {\n      return '';\n    }\n\n    let enableDirPrivateShare = false;\n    let { currentRepoInfo, userPerm, isCopyMoveProgressDialogShow, isDeleteFolderDialogOpen } = this.state;\n    let showShareBtn = Utils.isHasPermissionToShare(currentRepoInfo, userPerm);\n    let isRepoOwner = currentRepoInfo.owner_email === username;\n    let isVirtual = currentRepoInfo.is_virtual;\n    let isAdmin = currentRepoInfo.is_admin;\n    if (!isVirtual && (isRepoOwner || isAdmin)) {\n      enableDirPrivateShare = true;\n    }\n    let direntItemsList = this.state.direntList.filter((item, index) => {\n      return index < this.state.itemsShowLength;\n    });\n\n    let canUpload = true;\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    if (isCustomPermission) {\n      const { upload } = customPermission.permission;\n      canUpload = upload;\n    }\n\n    return (\n      <Fragment>\n        <div className=\"main-panel-north border-left-show\">\n          <LibContentToolbar\n            isViewFile={this.state.isViewFile}\n            filePermission={this.state.filePermission}\n            isDraft={this.state.isDraft}\n            hasDraft={this.state.hasDraft}\n            fileTags={this.state.fileTags}\n            onFileTagChanged={this.onToolbarFileTagChanged}\n            onSideNavMenuClick={this.props.onMenuClick}\n            repoID={this.props.repoID}\n            path={this.state.path}\n            isDirentSelected={this.state.isDirentSelected}\n            selectedDirentList={this.state.selectedDirentList}\n            onItemsMove={this.onMoveItems}\n            onItemsCopy={this.onCopyItems}\n            onItemsDelete={this.onDeleteItems}\n            onItemRename={this.onMainPanelItemRename}\n            direntList={this.state.direntList}\n            repoName={this.state.repoName}\n            repoEncrypted={this.state.repoEncrypted}\n            isGroupOwnedRepo={this.state.isGroupOwnedRepo}\n            userPerm={this.state.userPerm}\n            showShareBtn={showShareBtn}\n            enableDirPrivateShare={enableDirPrivateShare}\n            onAddFile={this.onAddFile}\n            onAddFolder={this.onAddFolder}\n            onUploadFile={this.onUploadFile}\n            onUploadFolder={this.onUploadFolder}\n            currentMode={this.state.currentMode}\n            switchViewMode={this.switchViewMode}\n            onSearchedClick={this.onSearchedClick}\n            isRepoOwner={isRepoOwner}\n            currentRepoInfo={this.state.currentRepoInfo}\n            updateDirent={this.updateDirent}\n            onDirentSelected={this.onDirentSelected}\n            showDirentDetail={this.showDirentDetail}\n            unSelectDirent={this.unSelectDirent}\n            onFilesTagChanged={this.onFileTagChanged}\n          />\n        </div>\n        <div className=\"main-panel-center flex-row\">\n          <LibContentContainer\n            pathPrefix={this.props.pathPrefix}\n            currentMode={this.state.currentMode}\n            path={this.state.path}\n            pathExist={this.state.pathExist}\n            currentRepoInfo={this.state.currentRepoInfo}\n            repoID={this.props.repoID}\n            enableDirPrivateShare={enableDirPrivateShare}\n            userPerm={userPerm}\n            isGroupOwnedRepo={this.state.isGroupOwnedRepo}\n            onTabNavClick={this.props.onTabNavClick}\n            onMainNavBarClick={this.onMainNavBarClick}\n            isViewFile={this.state.isViewFile}\n            hash={this.state.hash}\n            isDraft={this.state.isDraft}\n            hasDraft={this.state.hasDraft}\n            fileTags={this.state.fileTags}\n            goDraftPage={this.goDraftPage}\n            isFileLoading={this.state.isFileLoading}\n            isFileLoadedErr={this.state.isFileLoadedErr}\n            filePermission={this.state.filePermission}\n            content={this.state.content}\n            lastModified={this.state.lastModified}\n            latestContributor={this.state.latestContributor}\n            onLinkClick={this.onLinkClick}\n            isTreeDataLoading={this.state.isTreeDataLoading}\n            treeData={this.state.treeData}\n            currentNode={this.state.currentNode}\n            onNodeClick={this.onTreeNodeClick}\n            onNodeCollapse={this.onTreeNodeCollapse}\n            onNodeExpanded={this.onTreeNodeExpanded}\n            onAddFolderNode={this.onAddFolder}\n            onAddFileNode={this.onAddFile}\n            onRenameNode={this.onRenameTreeNode}\n            onDeleteNode={this.onDeleteTreeNode}\n            draftCounts={this.state.draftCounts}\n            usedRepoTags={this.state.usedRepoTags}\n            readmeMarkdown={this.state.readmeMarkdown}\n            updateUsedRepoTags={this.updateUsedRepoTags}\n            isDirentListLoading={this.state.isDirentListLoading}\n            direntList={direntItemsList}\n            fullDirentList={this.state.direntList}\n            sortBy={this.state.sortBy}\n            sortOrder={this.state.sortOrder}\n            sortItems={this.sortItems}\n            updateDirent={this.updateDirent}\n            onDirentClick={this.onDirentClick}\n            onItemClick={this.onItemClick}\n            onItemSelected={this.onDirentSelected}\n            onItemDelete={this.onMainPanelItemDelete}\n            onItemRename={this.onMainPanelItemRename}\n            onItemMove={this.onMoveItem}\n            onItemCopy={this.onCopyItem}\n            onAddFolder={this.onAddFolder}\n            onAddFile={this.onAddFile}\n            onFileTagChanged={this.onFileTagChanged}\n            isDirentSelected={this.state.isDirentSelected}\n            isAllDirentSelected={this.state.isAllDirentSelected}\n            onAllDirentSelected={this.onAllDirentSelected}\n            isDirentDetailShow={this.state.isDirentDetailShow}\n            selectedDirent={this.state.selectedDirentList && this.state.selectedDirentList[0]}\n            selectedDirentList={this.state.selectedDirentList}\n            onItemsMove={this.onMoveItems}\n            onItemsCopy={this.onCopyItems}\n            onItemsDelete={this.onDeleteItems}\n            closeDirentDetail={this.closeDirentDetail}\n            showDirentDetail={this.showDirentDetail}\n            direntDetailPanelTab={this.state.direntDetailPanelTab}\n            onDeleteRepoTag={this.onDeleteRepoTag}\n            onToolbarFileTagChanged={this.onToolbarFileTagChanged}\n            updateDetail={this.state.updateDetail}\n            onListContainerScroll={this.onListContainerScroll}\n            loadDirentList={this.loadDirentList}\n          />\n          {canUpload && this.state.pathExist && !this.state.isViewFile && (\n            <FileUploader\n              ref={uploader => this.uploader = uploader}\n              dragAndDrop={true}\n              path={this.state.path}\n              repoID={this.props.repoID}\n              direntList={this.state.direntList}\n              onFileUploadSuccess={this.onFileUploadSuccess}\n              isCustomPermission={isCustomPermission}\n            />\n          )}\n        </div>\n        {isCopyMoveProgressDialogShow && (\n          <CopyMoveDirentProgressDialog\n            type={this.state.asyncOperationType}\n            asyncOperatedFilesLength={this.state.asyncOperatedFilesLength}\n            asyncOperationProgress={this.state.asyncOperationProgress}\n            toggleDialog={this.onMoveProgressDialogToggle}\n          />\n        )}\n        {isDeleteFolderDialogOpen && (\n          <DeleteFolderDialog\n            repoID={this.props.repoID}\n            path={this.state.folderToDelete}\n            deleteFolder={this.deleteFolder}\n            toggleDialog={this.toggleDeleteFolderDialog}\n          />\n        )}\n      </Fragment>\n    );\n  }\n}\n\nLibContentView.propTypes = propTypes;\n\nexport default LibContentView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nclass DismissGroupDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  dismissGroup = () => {\n    let that = this;\n    seafileAPI.deleteGroup(this.props.groupID).then((res)=> {\n      that.props.onGroupChanged();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return(\n      <Modal isOpen={this.props.showDismissGroupDialog} toggle={this.props.toggleDismissGroupDialog}>\n        <ModalHeader>{gettext('Delete Group')}</ModalHeader>\n        <ModalBody>\n          <span>{gettext('Really want to delete this group?')}</span>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleDismissGroupDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.dismissGroup}>{gettext('Delete')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nconst DismissGroupDialogPropTypes = {\n  showDismissGroupDialog: PropTypes.bool.isRequired,\n  toggleDismissGroupDialog: PropTypes.func.isRequired,\n  loadGroup: PropTypes.func.isRequired,\n  groupID: PropTypes.string.isRequired,\n  onGroupChanged: PropTypes.func.isRequired,\n};\n\nDismissGroupDialog.propTypes = DismissGroupDialogPropTypes;\n\nexport default DismissGroupDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Form, FormGroup, Label, Alert } from 'reactstrap';\nimport { gettext, maxFileName } from '../../utils/constants';\n\nconst propTypes = {\n  onCreateRepo: PropTypes.func.isRequired,\n  onCreateToggle: PropTypes.func.isRequired\n};\n\nclass CreateDepartmentRepoDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      repoName: '',\n      errMessage: '',\n      isSubmitBtnActive: false,\n    };\n  }\n\n  handleChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({\n      repoName: e.target.value,\n    });\n  }\n\n  handleSubmit = () => {\n    let isValid = this.validateRepoName();\n    if (isValid) {\n      let repo = this.createRepo(this.state.repoName);\n      this.props.onCreateRepo(repo, 'department');\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n      e.preventDefault();\n    }\n  }\n\n  toggle = () => {\n    this.props.onCreateToggle();\n  }\n\n  validateRepoName = () => {\n    let errMessage = '';\n    let repoName = this.state.repoName.trim();\n    if (!repoName.length) {\n      errMessage = gettext('Name is required');\n      this.setState({errMessage: errMessage});\n      return false;\n    }\n    if (repoName.indexOf('/') > -1) {\n      errMessage = gettext('Name should not include \\'/\\'.');\n      this.setState({errMessage: errMessage});\n      return false;\n    }\n\n    return true;\n  }\n\n  createRepo = (repoName) => {\n    let repo = { repo_name: repoName };\n    return repo;\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle} autoFocus={false}>\n        <ModalHeader toggle={this.toggle}>{gettext('New Department Library')}</ModalHeader>\n        <ModalBody>\n          <Form>\n            <FormGroup>\n              <Label for=\"repo-name\">{gettext('Name')}</Label>\n              <Input\n                id=\"repo-name\"\n                onKeyPress={this.handleKeyPress}\n                value={this.state.repoName}\n                onChange={this.handleChange}\n                maxLength={maxFileName}\n                autoFocus={true}\n              />\n            </FormGroup>\n          </Form>\n          {this.state.errMessage && <Alert color=\"danger\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nCreateDepartmentRepoDialog.propTypes = propTypes;\n\nexport default CreateDepartmentRepoDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Input, Button } from 'reactstrap';\nimport toaster from '../toast';\n\nclass RenameGroupDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      newGroupName: this.props.currentGroupName,\n      isSubmitBtnActive: false,\n    };\n  }\n\n  handleGroupNameChange = (event) => {\n    if (!event.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    let name = event.target.value;\n    this.setState({\n      newGroupName: name\n    });\n  }\n\n  renameGroup = () => {\n    let name = this.state.newGroupName.trim();\n    if (name) {\n      let that = this;\n      seafileAPI.renameGroup(this.props.groupID, name).then((res)=> {\n        that.props.loadGroup(this.props.groupID);\n        that.props.onGroupChanged(res.data.id);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n    this.setState({\n      newGroupName: '',\n    });\n    this.props.toggleRenameGroupDialog();\n  }\n\n  handleKeyDown = (event) => {\n    if (event.keyCode === 13) {\n      this.renameGroup();\n    }\n  }\n\n  render() {\n    return(\n      <Modal isOpen={this.props.showRenameGroupDialog} toggle={this.props.toggleRenameGroupDialog}>\n        <ModalHeader>{gettext('Rename Group')}</ModalHeader>\n        <ModalBody>\n          <label htmlFor=\"newGroupName\">{gettext('Rename group to')}</label>\n          <Input type=\"text\" id=\"newGroupName\" value={this.state.newGroupName}\n            onChange={this.handleGroupNameChange} onKeyDown={this.handleKeyDown}/>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleRenameGroupDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.renameGroup} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nconst RenameGroupDialogPropTypes = {\n  showRenameGroupDialog: PropTypes.bool.isRequired,\n  toggleRenameGroupDialog: PropTypes.func.isRequired,\n  loadGroup: PropTypes.func.isRequired,\n  groupID: PropTypes.string.isRequired,\n  onGroupChanged: PropTypes.func.isRequired,\n  currentGroupName: PropTypes.string.isRequired,\n};\n\nRenameGroupDialog.propTypes = RenameGroupDialogPropTypes;\n\nexport default RenameGroupDialog;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api.js';\nimport UserSelect from '../user-select';\nimport { Utils } from '../../utils/utils';\n\nimport '../../css/transfer-group-dialog.css';\n\nconst propTypes = {\n  groupID: PropTypes.string.isRequired,\n  toggleTransferGroupDialog: PropTypes.func.isRequired,\n  onGroupChanged: PropTypes.func.isRequired\n};\n\nclass TransferGroupDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      selectedOption: null,\n      errMessage: '',\n    };\n    this.options = [];\n  }\n\n  handleSelectChange = (option) => {\n    this.setState({\n      selectedOption: option,\n      errMessage: '',\n    });\n    this.options = [];\n  }\n\n  transferGroup = () => {\n    const email = this.state.selectedOption && this.state.selectedOption.email;\n    if (email) {\n      seafileAPI.transferGroup(this.props.groupID, email).then((res) => {\n        this.props.toggleTransferGroupDialog();\n      }).catch((error) => {\n        let errMessage = Utils.getErrorMsg(error);\n        this.setState({errMessage: errMessage});\n      });\n    }\n  }\n\n  toggle = () => {\n    this.props.toggleTransferGroupDialog();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('Transfer Group')}</ModalHeader>\n        <ModalBody>\n          <p>{gettext('Transfer group to')}</p>\n          <UserSelect\n            ref=\"userSelect\"\n            isMulti={false}\n            className=\"reviewer-select\"\n            placeholder={gettext('Please enter 1 or more character')}\n            onSelectChange={this.handleSelectChange}\n          />\n          <div className=\"error\">{this.state.errMessage}</div>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Close')}</Button>\n          <Button color=\"primary\" onClick={this.transferGroup}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nTransferGroupDialog.propTypes = propTypes;\n\nexport default TransferGroupDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Alert, Modal, ModalHeader, ModalBody, ModalFooter, Button } from 'reactstrap';\nimport { gettext, siteRoot, groupImportMembersExtraMsg } from '../../utils/constants';\n\nconst propTypes = {\n  toggleImportMembersDialog: PropTypes.func.isRequired,\n  importMembersInBatch: PropTypes.func.isRequired,\n};\n\nclass ImportMembersDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      errorMsg: ''\n    };\n    this.fileInputRef = React.createRef();\n  }\n\n  toggle = () => {\n    this.props.toggleImportMembersDialog();\n  }\n\n  openFileInput = () => {\n    this.fileInputRef.current.click();\n  }\n\n  uploadFile = (e) => {\n    // no file selected\n    if (!this.fileInputRef.current.files.length) {\n      return;\n    }\n    // check file extension\n    let fileName = this.fileInputRef.current.files[0].name;\n    if(fileName.substr(fileName.lastIndexOf('.') + 1) != 'xlsx') {\n      this.setState({\n        errorMsg: gettext('Please choose a .xlsx file.')\n      });\n      return;\n    }\n    const file = this.fileInputRef.current.files[0];\n    this.props.importMembersInBatch(file);\n    this.toggle();\n  }\n\n  render() {\n    let { errorMsg } = this.state;\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('Import members from a .xlsx file')}</ModalHeader>\n\n        <ModalBody>\n          <p>{groupImportMembersExtraMsg}</p>\n          <p><a className=\"text-secondary small\" href={`${siteRoot}api/v2.1/group-members-import-example/`}>{gettext('Download an example file')}</a></p>\n          <button className=\"btn btn-outline-primary\" onClick={this.openFileInput}>{gettext('Upload file')}</button>\n          <input className=\"d-none\" type=\"file\" onChange={this.uploadFile} ref={this.fileInputRef} />\n          {errorMsg && <Alert color=\"danger\">{errorMsg}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nImportMembersDialog.propTypes = propTypes;\n\nexport default ImportMembersDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Table } from 'reactstrap';\nimport { Utils } from '../utils/utils';\nimport { gettext } from '../utils/constants';\nimport { seafileAPI } from '../utils/seafile-api';\nimport RoleEditor from './select-editor/role-editor';\nimport toaster from './toast';\nimport OpIcon from './op-icon';\n\nconst propTypes = {\n  groupMembers: PropTypes.array.isRequired,\n  groupID: PropTypes.string.isRequired,\n  isOwner: PropTypes.bool.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  toggleItemFreezed: PropTypes.func.isRequired,\n  changeMember: PropTypes.func.isRequired,\n  deleteMember: PropTypes.func.isRequired\n};\n\nclass GroupMembers extends React.Component {\n\n  render() {\n    const { groupMembers, changeMember, deleteMember, groupID, isOwner, isItemFreezed, toggleItemFreezed } = this.props;\n    return (\n      <Table size=\"sm\" className=\"manage-members-table\">\n        <thead>\n          <tr>\n            <th width=\"15%\"></th>\n            <th width=\"45%\">{gettext('Name')}</th>\n            <th width=\"30%\">{gettext('Role')}</th>\n            <th width=\"10%\"></th>\n          </tr>\n        </thead>\n        <tbody>\n          {groupMembers.map((item, index) => {\n            return (\n              <Member\n                key={index}\n                item={item}\n                changeMember={changeMember}\n                deleteMember={deleteMember}\n                groupID={groupID}\n                isOwner={isOwner}\n                isItemFreezed={isItemFreezed}\n                toggleItemFreezed={toggleItemFreezed}\n              />\n            );\n          })\n          }\n        </tbody>\n      </Table>\n    );\n  }\n}\n\nGroupMembers.propTypes = propTypes;\n\nconst MemberPropTypes = {\n  item: PropTypes.object.isRequired,\n  changeMember: PropTypes.func.isRequired,\n  deleteMember: PropTypes.func.isRequired,\n  toggleItemFreezed: PropTypes.func.isRequired,\n  groupID: PropTypes.string.isRequired,\n  isOwner: PropTypes.bool.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired\n};\n\nclass Member extends React.PureComponent {\n\n  constructor(props) {\n    super(props);\n    this.roles = ['Admin', 'Member'];\n    this.state = ({\n      highlight: false,\n    });\n  }\n\n  onChangeUserRole = (role) => {\n    let isAdmin = role === 'Admin' ? 'True' : 'False';\n    seafileAPI.setGroupAdmin(this.props.groupID, this.props.item.email, isAdmin).then((res) => {\n      this.props.changeMember(res.data);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  deleteMember = () => {\n    const { item } = this.props;\n    seafileAPI.deleteGroupMember(this.props.groupID, item.email).then((res) => {\n      this.props.deleteMember(item);\n      toaster.success(gettext('Successfully deleted {name}.').replace('{name}', item.name));\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  handleMouseOver = () => {\n    if (this.props.isItemFreezed) return;\n    this.setState({\n      highlight: true,\n    });\n  }\n\n  handleMouseLeave = () => {\n    if (this.props.isItemFreezed) return;\n    this.setState({\n      highlight: false,\n    });\n  }\n\n  translateRole = (role) => {\n    if (role === 'Admin') {\n      return gettext('Admin');\n    }\n    else if (role === 'Member') {\n      return gettext('Member');\n    }\n    else if (role === 'Owner') {\n      return gettext('Owner');\n    }\n  }\n\n  render() {\n    const { item, isOwner } = this.props;\n    const deleteAuthority = (item.role !== 'Owner' && isOwner === true) || (item.role === 'Member' && isOwner === false);\n    return(\n      <tr onMouseOver={this.handleMouseOver} onMouseLeave={this.handleMouseLeave} className={this.state.highlight ? 'tr-highlight' : ''} tabIndex=\"0\" onFocus={this.handleMouseOver}>\n        <th scope=\"row\"><img className=\"avatar\" src={item.avatar_url} alt=\"\"/></th>\n        <td>{item.name}</td>\n        <td>\n          {((isOwner === false) || (isOwner === true && item.role === 'Owner')) &&\n            <span className=\"group-admin\">{this.translateRole(item.role)}</span>\n          }\n          {(isOwner === true && item.role !== 'Owner') &&\n            <RoleEditor\n              isTextMode={true}\n              isEditIconShow={this.state.highlight}\n              currentRole={item.role}\n              roles={this.roles}\n              onRoleChanged={this.onChangeUserRole}\n              toggleItemFreezed={this.props.toggleItemFreezed}\n            />\n          }\n        </td>\n        <td>\n          {(deleteAuthority && this.state.highlight) &&\n          <OpIcon\n            className=\"action-icon sf2-icon-x3\"\n            title={gettext('Delete')}\n            op={this.deleteMember}\n          />\n          }\n        </td>\n      </tr>\n    );\n  }\n}\n\nMember.propTypes = MemberPropTypes;\n\n\nexport default GroupMembers;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, InputGroup, InputGroupText, Input } from 'reactstrap';\nimport { Utils } from '../utils/utils';\nimport { gettext } from '../utils/constants';\nimport { seafileAPI } from '../utils/seafile-api';\nimport UserSelect from './user-select';\nimport toaster from './toast';\nimport Loading from './loading';\nimport GroupMembers from './group-members';\n\nconst propTypes = {\n  groupID: PropTypes.string.isRequired,\n  isOwner: PropTypes.bool.isRequired\n};\n\nclass ManageMembersDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true, // first loading\n      isLoadingMore: false,\n      groupMembers: [],\n      page: 1,\n      perPage: 100,\n      hasNextPage: false,\n      selectedOption: null,\n      errMessage: [],\n      isItemFreezed: false,\n      searchActive: false,\n      keyword: '',\n      membersFound: []\n    };\n  }\n\n  componentDidMount() {\n    this.listGroupMembers(this.state.page);\n  }\n\n  listGroupMembers = (page) => {\n    const { groupID } = this.props;\n    const { perPage, groupMembers } = this.state;\n    seafileAPI.listGroupMembers(groupID, page, perPage).then((res) => {\n      const members = res.data;\n      this.setState({\n        isLoading: false,\n        isLoadingMore: false,\n        page: page,\n        hasNextPage: members.length < perPage ? false : true,\n        groupMembers: groupMembers.concat(members)\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n      this.setState({\n        isLoading: false,\n        isLoadingMore: false,\n        hasNextPage: false\n      });\n    });\n  }\n\n  onSelectChange = (option) => {\n    this.setState({\n      selectedOption: option,\n      errMessage: [],\n    });\n  }\n\n  addGroupMember = () => {\n    let emails = [];\n    for (let i = 0; i < this.state.selectedOption.length; i++) {\n      emails.push(this.state.selectedOption[i].email);\n    }\n    seafileAPI.addGroupMembers(this.props.groupID, emails).then((res) => {\n      const newMembers = res.data.success;\n      this.setState({\n        groupMembers: [].concat(newMembers, this.state.groupMembers),\n        selectedOption: null,\n      });\n      this.refs.userSelect.clearSelect();\n      if (res.data.failed.length > 0) {\n        this.setState({\n          errMessage: res.data.failed\n        });\n      }\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  toggleItemFreezed = (isFreezed) => {\n    this.setState({\n      isItemFreezed: isFreezed\n    });\n  }\n\n  handleScroll = (event) => {\n    // isLoadingMore: to avoid repeated request\n    const { page, hasNextPage, isLoadingMore } = this.state;\n    if (hasNextPage && !isLoadingMore) {\n      const clientHeight = event.target.clientHeight;\n      const scrollHeight = event.target.scrollHeight;\n      const scrollTop    = event.target.scrollTop;\n      const isBottom = (clientHeight + scrollTop + 1 >= scrollHeight);\n      if (isBottom) { // scroll to the bottom\n        this.setState({isLoadingMore: true}, () => {\n          this.listGroupMembers(page + 1);\n        });\n      }\n    }\n  }\n\n  changeMember = (targetMember) => {\n    this.setState({\n      groupMembers: this.state.groupMembers.map((item) => {\n        if (item.email == targetMember.email) {\n          item = targetMember;\n        }\n        return item;\n      })\n    });\n  }\n\n  deleteMember = (targetMember) => {\n    const groupMembers = this.state.groupMembers;\n    groupMembers.splice(groupMembers.indexOf(targetMember), 1);\n    this.setState({\n      groupMembers: groupMembers\n    });\n  }\n\n  searchMembers = (e) => {\n    const { groupMembers } = this.state;\n    const keyword = e.target.value;\n    const value = keyword.trim().toLowerCase();\n    const membersFound = groupMembers.filter(item => item.name.toLowerCase().indexOf(value) > -1);\n    this.setState({ keyword, membersFound });\n  }\n\n  clearSearch = () => {\n    this.setState({\n      keyword: '',\n      membersFound: []\n    });\n  }\n\n  onSearchInputFocus = () => {\n    this.setState({\n      searchActive: true\n    });\n  }\n\n  onSearchInputBlur = () => {\n    this.setState({\n      searchActive: false\n    });\n  }\n\n  render() {\n    const {\n      isLoading, hasNextPage, groupMembers,\n      keyword, membersFound,\n      searchActive\n    } = this.state;\n    return (\n      <Fragment>\n        <p className=\"mb-2\">{gettext('Add group member')}</p>\n        <div className='add-members'>\n          <UserSelect\n            placeholder={gettext('Search users...')}\n            onSelectChange={this.onSelectChange}\n            ref=\"userSelect\"\n            isMulti={true}\n            className=\"add-members-select\"\n          />\n          {this.state.selectedOption ?\n            <Button color=\"secondary\" onClick={this.addGroupMember}>{gettext('Submit')}</Button> :\n            <Button color=\"secondary\" disabled>{gettext('Submit')}</Button>\n          }\n        </div>\n        {\n          this.state.errMessage.length > 0 &&\n            this.state.errMessage.map((item, index = 0) => {\n              return (\n                <div className=\"group-error error\" key={index}>{item.error_msg}</div>\n              );\n            })\n        }\n        {groupMembers.length > 10 &&\n          <InputGroup className={`search-group-members rounded ${searchActive ? 'active' : ''}`}>\n            <InputGroupText>\n              <i className=\"fas fa-search\" aria-hidden={true}></i>\n            </InputGroupText>\n            <Input\n              type=\"text\"\n              className=\"input-group-input px-0\"\n              placeholder={gettext('Search group members')}\n              value={keyword}\n              onChange={this.searchMembers}\n              onFocus={this.onSearchInputFocus}\n              onBlur={this.onSearchInputBlur}\n            />\n            {keyword && (\n              <InputGroupText>\n                <i className=\"sf2-icon-x1\" aria-hidden={true} onClick={this.clearSearch}></i>\n              </InputGroupText>\n            )}\n          </InputGroup>\n        }\n        <div className=\"manage-members\" onScroll={keyword.trim() ? () => {} : this.handleScroll}>\n          {isLoading ? <Loading /> : (\n            <Fragment>\n              <GroupMembers\n                groupMembers={keyword.trim() ? membersFound : groupMembers}\n                changeMember={this.changeMember}\n                deleteMember={this.deleteMember}\n                groupID={this.props.groupID}\n                isOwner={this.props.isOwner}\n                isItemFreezed={this.state.isItemFreezed}\n                toggleItemFreezed={this.toggleItemFreezed}\n              />\n              {(!keyword.trim() && hasNextPage) && <Loading />}\n            </Fragment>\n          )}\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nManageMembersDialog.propTypes = propTypes;\n\nexport default ManageMembersDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport ListAndAddGroupMembers from '../list-and-add-group-members';\n\nimport '../../css/manage-members-dialog.css';\n\nconst propTypes = {\n  groupID: PropTypes.string.isRequired,\n  isOwner: PropTypes.bool.isRequired,\n  toggleManageMembersDialog: PropTypes.func.isRequired\n};\n\nclass ManageMembersDialog extends React.Component {\n\n  render() {\n    const { groupID, isOwner, toggleManageMembersDialog: toggle } = this.props;\n    return (\n      <Modal isOpen={true} toggle={toggle} className=\"group-manage-members-dialog\">\n        <ModalHeader toggle={toggle}>{gettext('Manage group members')}</ModalHeader>\n        <ModalBody className=\"pb-0\">\n          <ListAndAddGroupMembers\n            groupID={groupID}\n            isOwner={isOwner}\n          />\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nManageMembersDialog.propTypes = propTypes;\n\nexport default ManageMembersDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button } from 'reactstrap';\nimport { gettext, username } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nclass LeaveGroupDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  leaveGroup = () => {\n    seafileAPI.quitGroup(this.props.groupID, username).then((res)=> {\n      this.props.onGroupChanged();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return(\n      <Modal isOpen={true} toggle={this.props.toggleLeaveGroupDialog}>\n        <ModalHeader toggle={this.props.toggleLeaveGroupDialog}>{gettext('Leave Group')}</ModalHeader>\n        <ModalBody>\n          <p>{gettext('Really want to leave this group?')}</p>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleLeaveGroupDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.leaveGroup}>{gettext('Leave')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nconst LeaveGroupDialogPropTypes = {\n  toggleLeaveGroupDialog: PropTypes.func.isRequired,\n  groupID: PropTypes.string.isRequired,\n  onGroupChanged: PropTypes.func.isRequired,\n};\n\nLeaveGroupDialog.propTypes = LeaveGroupDialogPropTypes;\n\nexport default LeaveGroupDialog;\n","import React,{ Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport cookie from 'react-cookies';\nimport { gettext, siteRoot, username, canAddRepo } from '../../utils/constants';\nimport { Link } from '@gatsbyjs/reach-router';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport ModalPortal from '../../components/modal-portal';\nimport Group from '../../models/group';\nimport Repo from '../../models/repo';\nimport toaster from '../../components/toast';\nimport OpIcon from '../../components/op-icon';\nimport CommonToolbar from '../../components/toolbar/common-toolbar';\nimport CreateRepoDialog from '../../components/dialog/create-repo-dialog';\nimport CreateDepartmentRepoDialog from '../../components/dialog/create-department-repo-dialog';\nimport DismissGroupDialog from '../../components/dialog/dismiss-group-dialog';\nimport RenameGroupDialog from '../../components/dialog/rename-group-dialog';\nimport TransferGroupDialog from '../../components/dialog/transfer-group-dialog';\nimport ImportMembersDialog from '../../components/dialog/import-members-dialog';\nimport ManageMembersDialog from '../../components/dialog/manage-members-dialog';\nimport LeaveGroupDialog from '../../components/dialog/leave-group-dialog';\nimport SharedRepoListView from '../../components/shared-repo-list-view/shared-repo-list-view';\nimport LibDetail from '../../components/dirent-detail/lib-details';\nimport SortOptionsDialog from '../../components/dialog/sort-options';\n\nimport '../../css/group-view.css';\n\nconst propTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n  onGroupChanged: PropTypes.func.isRequired,\n  onTabNavClick: PropTypes.func.isRequired,\n  groupID: PropTypes.string,\n};\n\nclass GroupView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true, // first loading\n      isLoadingMore: false,\n      errMessage: '',\n      emptyTip: null,\n      currentGroup: null,\n      currentRepo: null,\n      isStaff: false,\n      isOwner: false,\n      sortBy: cookie.load('seafile-repo-dir-sort-by') || 'name', // 'name' or 'time' or 'size'\n      sortOrder: cookie.load('seafile-repo-dir-sort-order') || 'asc', // 'asc' or 'desc'\n      isSortOptionsDialogOpen: false,\n      repoList: [],\n      currentPage: 1,\n      perPage: 300,\n      hasNextPage: false,\n      libraryType: 'group',\n      isCreateRepoDialogShow: false,\n      isDepartmentGroup: false,\n      showGroupDropdown: false,\n      showGroupMembersPopover: false,\n      showRenameGroupDialog: false,\n      showDismissGroupDialog: false,\n      showTransferGroupDialog: false,\n      showImportMembersDialog: false,\n      showManageMembersDialog: false,\n      groupMembers: [],\n      isShowDetails: false,\n      isLeaveGroupDialogOpen: false,\n    };\n  }\n\n  componentDidMount() {\n    let groupID = this.props.groupID;\n    this.loadGroup(groupID);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.groupID !== this.props.groupID) {\n      this.loadGroup(nextProps.groupID);\n    }\n  }\n\n  loadGroup = (groupID) => {\n    seafileAPI.getGroup(groupID).then((res) => {\n      let currentGroup = new Group(res.data);\n      let emptyTip = this.getEmptyTip(currentGroup);\n      let isStaff  = currentGroup.admins.indexOf(username) > -1;  //for item operations\n      let isOwner = currentGroup.owner === username ? true : false;\n      let isDepartmentGroup = currentGroup.parent_group_id !== 0;\n      this.setState({\n        emptyTip: emptyTip,\n        currentGroup: currentGroup,\n        isStaff: isStaff,\n        isDepartmentGroup: isDepartmentGroup,\n        isOwner: isOwner,\n        currentPage: 1,\n        repoList: []  // empty it for the current group\n      }, () => {\n        this.loadRepos(this.state.currentPage);\n      });\n    }).catch((error) => {\n      this.setState({\n        isLoading: false,\n        errMessage: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  loadRepos = (page) => {\n    const { perPage } = this.state;\n    seafileAPI.listGroupRepos(this.props.groupID, page, perPage).then((res) => {\n      let hasNextPage = true;\n      if (res.data.length < perPage) {\n        hasNextPage = false;\n      }\n      let repoList = this.state.repoList;\n      let newRepoList = res.data.map(item => {\n        let repo = new Repo(item);\n        return repo;\n      });\n      if (newRepoList.length) {\n        repoList = repoList.concat(newRepoList);\n      }\n      this.setState({\n        isLoading: false,\n        isLoadingMore: false,\n        currentPage: page,\n        hasNextPage: hasNextPage,\n        repoList: Utils.sortRepos(repoList, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        isLoading: false,\n        isLoadingMore: false,\n        errMessage: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  getEmptyTip = (currentGroup) => {\n    let emptyTip = null;\n    if (currentGroup) {\n      if (currentGroup.parent_group_id === 0) {\n        emptyTip = (\n          <EmptyTip>\n            <h2>{gettext('No libraries shared with this group')}</h2>\n            <p>{gettext('No libraries have been shared with this group yet. A library shared with a group can be accessed by all group members. You can share a library with a group in \"My Libraries\". You can also create a new library to be shared with this group by clicking the \"New Library\" button in the menu bar.')}</p>\n          </EmptyTip>\n        );\n      } else {\n        if (currentGroup.admins.indexOf(username) == -1) {  // is a member of this group\n          emptyTip = (\n            <EmptyTip>\n              <h2>{gettext('No libraries')}</h2>\n            </EmptyTip>\n          );\n        } else {\n          emptyTip = (\n            <EmptyTip>\n              <h2>{gettext('No libraries')}</h2>\n              <p>{gettext('You can create libraries by clicking the \"New Library\" button above.')}</p>\n            </EmptyTip>\n          );\n        }\n      }\n    }\n    return emptyTip;\n  }\n\n  onCreateRepoToggle = () => {\n    this.setState({isCreateRepoDialogShow: !this.state.isCreateRepoDialogShow});\n  }\n\n  onCreateRepo = (repo, groupOwnerType) => {\n    let groupId = this.props.groupID;\n    if (groupOwnerType && groupOwnerType === 'department') {\n      seafileAPI.createGroupOwnedLibrary(groupId, repo).then(res => { //need modify endpoint api\n        let object = {\n          repo_id: res.data.id,\n          repo_name: res.data.name,\n          owner_name: res.data.group_name,\n          owner_email: res.data.owner,\n          permission: res.data.permission,\n          mtime: res.data.mtime,\n          size: res.data.size,\n          encrypted: res.data.encrypted,\n        };\n        let repo = new Repo(object);\n        let repoList = this.addRepoItem(repo);\n        this.setState({repoList: repoList});\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n\n    } else {\n      seafileAPI.createGroupRepo(groupId, repo).then(res => {\n        let repo = new Repo(res.data);\n        let repoList = this.addRepoItem(repo);\n        this.setState({repoList: repoList});\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n    this.onCreateRepoToggle();\n  }\n\n  onItemDelete = (repo) => {\n    let groupID = this.props.groupID;\n    let repoList = this.state.repoList.filter(item => {\n      return item.repo_id !== repo.repo_id;\n    });\n    this.setState({repoList: repoList});\n    this.loadGroup(groupID);\n  }\n\n  addRepoItem = (repo) => {\n    let newRepoList = this.state.repoList.map(item => {return item;});\n    newRepoList.unshift(repo);\n    return newRepoList;\n  }\n\n  onItemUnshare = (repo) => {\n    let group = this.state.currentGroup;\n    seafileAPI.unshareRepoToGroup(repo.repo_id, group.id).then(() => {\n      let repoList = this.state.repoList.filter(item => {\n        return item.repo_id !== repo.repo_id;\n      });\n      this.setState({repoList: repoList});\n      this.loadGroup(group.id);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onItemRename = (repo, newName) => {\n    seafileAPI.renameGroupOwnedLibrary(this.props.groupID, repo.repo_id, newName).then(res => {\n      let repoList = this.state.repoList.map(item => {\n        if (item.repo_id === repo.repo_id) {\n          item.repo_name = newName;\n        }\n        return item;\n      });\n      this.setState({repoList: repoList});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onMonitorRepo = (repo, monitored) => {\n    let repoList = this.state.repoList.map(item => {\n      if (item.repo_id === repo.repo_id) {\n        item.monitored = monitored;\n      }\n      return item;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  onTabNavClick = (tabName) => {\n    this.props.onTabNavClick(tabName);\n  }\n\n  toggleGroupDropdown = () => {\n    this.setState({\n      showGroupDropdown: !this.state.showGroupDropdown\n    });\n  }\n\n  toggleDismissGroupDialog = () => {\n    this.setState({\n      showDismissGroupDialog: !this.state.showDismissGroupDialog,\n      showGroupDropdown: false,\n    });\n  }\n\n  toggleRenameGroupDialog = () => {\n    this.setState({\n      showRenameGroupDialog: !this.state.showRenameGroupDialog,\n      showGroupDropdown: false,\n    });\n  }\n\n  toggleTransferGroupDialog = () => {\n    this.setState({\n      showTransferGroupDialog: !this.state.showTransferGroupDialog,\n      showGroupDropdown: false,\n    });\n  }\n\n  toggleImportMembersDialog= () => {\n    this.setState({\n      showImportMembersDialog: !this.state.showImportMembersDialog\n    });\n  }\n\n  importMembersInBatch= (file) => {\n    toaster.notify(gettext('It may take some time, please wait.'));\n    seafileAPI.importGroupMembersViaFile(this.state.currentGroup.id, file).then((res) => {\n      res.data.failed.map(item => {\n        const msg = `${item.email}: ${item.error_msg}`;\n        toaster.danger(msg);\n      });\n    }).catch((error) => {\n      let errMsg = Utils.getErrorMsg(error);\n      toaster.danger(errMsg);\n    });\n  }\n\n  toggleManageMembersDialog = () => {\n    this.setState({\n      showManageMembersDialog: !this.state.showManageMembersDialog,\n      showGroupDropdown: false,\n    });\n  }\n\n  toggleLeaveGroupDialog = () => {\n    this.setState({\n      isLeaveGroupDialogOpen: !this.state.isLeaveGroupDialogOpen,\n      showGroupDropdown: false,\n    });\n  }\n\n  listGroupMembers = () => {\n    seafileAPI.listGroupMembers(this.props.groupID).then((res) => {\n      this.setState({\n        groupMembers: res.data\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  toggleGroupMembersPopover = (state) => {\n    if (state === 'open') {\n      this.listGroupMembers();\n      this.setState({\n        showGroupMembersPopover: true\n      });\n    } else {\n      this.setState({\n        showGroupMembersPopover: false\n      });\n    }\n  }\n\n  onItemDetails = (repo) => {\n    this.setState({\n      isShowDetails: true,\n      currentRepo: repo,\n    });\n  }\n\n  closeDetails = () => {\n    this.setState({isShowDetails: false});\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    cookie.save('seafile-repo-dir-sort-by', sortBy);\n    cookie.save('seafile-repo-dir-sort-order', sortOrder);\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      repoList: Utils.sortRepos(this.state.repoList, sortBy, sortOrder)\n    });\n  }\n\n  translateRole = (role) => {\n    if (role === 'Admin') {\n      return gettext('Admin');\n    }\n    else if (role === 'Member') {\n      return gettext('Member');\n    }\n    else if (role === 'Owner') {\n      return gettext('Owner');\n    }\n  }\n\n  toggleSortOptionsDialog = () => {\n    this.setState({\n      isSortOptionsDialogOpen: !this.state.isSortOptionsDialogOpen\n    });\n  }\n\n  handleScroll = (event) => {\n    // isLoadingMore: to avoid repeated request\n    const { currentPage, hasNextPage, isLoadingMore } = this.state;\n    if (hasNextPage && !isLoadingMore) {\n      const clientHeight = event.target.clientHeight;\n      const scrollHeight = event.target.scrollHeight;\n      const scrollTop    = event.target.scrollTop;\n      const isBottom = (clientHeight + scrollTop + 1 >= scrollHeight);\n      if (isBottom) { // scroll to the bottom\n        this.setState({isLoadingMore: true}, () => {\n          this.loadRepos(currentPage + 1);\n        });\n      }\n    }\n  }\n\n  render() {\n    let { errMessage, emptyTip, currentGroup, isDepartmentGroup, isStaff } = this.state;\n    let isShowSettingIcon = false;\n    if (currentGroup) { // group message is loaded\n      if (currentGroup.parent_group_id === 0) {\n        isShowSettingIcon = true;\n      } else {\n        if (currentGroup.admins.indexOf(username) > -1) {\n          isShowSettingIcon = true;\n        }\n      }\n    }\n    let useRate = 0;\n    if (isDepartmentGroup && currentGroup.group_quota) {\n      useRate = currentGroup.group_quota_usage / currentGroup.group_quota * 100 + '%';\n    }\n    return (\n      <Fragment>\n        <div className=\"main-panel-north border-left-show\">\n          <div className=\"cur-view-toolbar\">\n            <span className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\" title=\"Side Nav Menu\" onClick={this.props.onShowSidePanel}></span>\n            <div className=\"operation\">\n              {((!isDepartmentGroup && canAddRepo) || (isDepartmentGroup && isStaff)) && (\n                Utils.isDesktop() ? (\n                  <button className=\"btn btn-secondary operation-item\" title={gettext('New Library')} onClick={this.onCreateRepoToggle}>\n                    <i className=\"fas fa-plus-square text-secondary mr-1\"></i>{gettext('New Library')}\n                  </button>\n                ) : (\n                  <span className=\"sf2-icon-plus mobile-toolbar-icon\" title={gettext('New Library')} onClick={this.onCreateRepoToggle}></span>\n                )\n              )}\n            </div>\n          </div>\n          <CommonToolbar onSearchedClick={this.props.onSearchedClick} />\n        </div>\n        <div className=\"main-panel-center flex-row\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              {currentGroup && (\n                <Fragment>\n                  <div className=\"path-container\">\n                    <Link to={`${siteRoot}groups/`} onClick={() => this.onTabNavClick('groups')}>{gettext('Groups')}</Link>\n                    <span className=\"path-split\">/</span>\n                    <span>{currentGroup.name}</span>\n                    {isDepartmentGroup && (\n                      <Fragment>\n                        <span className=\"department-group-icon fas fa-building\" title={gettext('This is a special group representing a department.')}></span>\n                        {currentGroup.group_quota > 0 &&\n                          <span className=\"department-usage-container\">\n                            <div className=\"department-usage\">\n                              <span id=\"quota-bar\" className=\"department-quota-bar\"><span id=\"quota-usage\" className=\"usage\" style={{width: useRate}}></span></span>\n                              <span className=\"department-quota-info\">{Utils.bytesToSize(currentGroup.group_quota_usage)} / {Utils.bytesToSize(currentGroup.group_quota)}</span>\n                            </div>\n                          </span>\n                        }\n                      </Fragment>\n                    )}\n                  </div>\n                  <div className=\"path-tool\">\n                    { isShowSettingIcon &&\n                    <React.Fragment>\n                      <OpIcon\n                        className=\"sf2-icon-cog1 action-icon group-top-action-icon\"\n                        title={gettext('Settings')}\n                        op={this.toggleGroupDropdown}\n                      />\n                      {this.state.showGroupDropdown &&\n                        <div className=\"sf-popover\" id=\"group-setting-popover\">\n                          <div className=\"sf-popover-hd sf-popover-title\">\n                            <span>{gettext('Settings')}</span>\n                            <a href=\"#\" className=\"sf-popover-close js-close sf2-icon-x1 action-icon\"\n                              role=\"button\"\n                              aria-label={gettext('Close')}\n                              onClick={this.toggleGroupDropdown}></a>\n                          </div>\n                          <div className=\"sf-popover-con\">\n                            {(this.state.isStaff || this.state.isOwner) &&\n                            <ul className=\"sf-popover-list\">\n                              <li><a href=\"#\" className=\"sf-popover-item\" onClick={this.toggleRenameGroupDialog}>{gettext('Rename')}</a></li>\n                              {\n                                this.state.isOwner &&\n                                <li><a href=\"#\" className=\"sf-popover-item\" onClick={this.toggleTransferGroupDialog} >{gettext('Transfer')}</a></li>\n                              }\n                            </ul>\n                            }\n                            {(this.state.isStaff || this.state.isOwner) &&\n                            <ul className=\"sf-popover-list\">\n                              <li><a href=\"#\" className=\"sf-popover-item\" onClick={this.toggleImportMembersDialog} >{gettext('Import Members')}</a></li>\n                              <li><a href=\"#\" className=\"sf-popover-item\" onClick={this.toggleManageMembersDialog} >{gettext('Manage Members')}</a></li>\n                            </ul>\n                            }\n                            {\n                              this.state.isOwner &&\n                              <ul className=\"sf-popover-list\">\n                                <li><a href=\"#\" className=\"sf-popover-item\" onClick={this.toggleDismissGroupDialog}>{gettext('Delete Group')}</a></li>\n                              </ul>\n                            }\n                            {/* gourp owner only can dissmiss group, admin could not quit, department member could not quit */}\n                            {(!this.state.isOwner && !isDepartmentGroup) &&\n                            <ul className=\"sf-popover-list\">\n                              <li><a href=\"#\" className=\"sf-popover-item\" onClick={this.toggleLeaveGroupDialog}>{gettext('Leave Group')}</a></li>\n                            </ul>\n                            }\n                          </div>\n                        </div>}\n                    </React.Fragment>\n                    }\n                    <a href=\"#\"\n                      className=\"sf2-icon-user2 action-icon group-top-action-icon\"\n                      title={gettext('Members')} id=\"groupMembers\"\n                      onClick={() => this.toggleGroupMembersPopover('open')}>\n                    </a>\n                    {this.state.showGroupMembersPopover &&\n                    <div className=\"sf-popover\" id=\"group-members-popover\">\n                      <div className=\"sf-popover-hd sf-popover-title group-member-list-header\">\n                        <span>{gettext('Members')}</span>\n                        <a href=\"#\" className=\"sf-popover-close js-close sf2-icon-x1 action-icon\"\n                          onClick={this.toggleGroupMembersPopover}></a>\n                      </div>\n                      <div className=\"sf-popover-con\">\n                        <ul className=\"sf-popover-list group-member-list\">\n                          {this.state.groupMembers.map((item, index) => {\n                            return (\n                              <li key={index}>\n                                <a href=\"#\" className=\"sf-popover-item user-item d-flex\">\n                                  <img src={item.avatar_url} alt=\"\" className=\"group-member-avatar avatar\"/>\n                                  <span className=\"txt-item ellipsis d-flex\">\n                                    <span className=\"group-member-name ellipsis\">{item.name}</span>\n                                    <span className=\"group-member-admin\">{this.translateRole(item.role)}</span>\n                                  </span>\n                                </a>\n                              </li>\n                            );\n                          })}\n                        </ul>\n                      </div>\n                    </div>}\n                    {(!Utils.isDesktop() && this.state.repoList.length > 0) && <span className=\"sf3-font sf3-font-sort action-icon\" onClick={this.toggleSortOptionsDialog}></span>}\n                    {this.state.isSortOptionsDialogOpen &&\n                    <SortOptionsDialog\n                      toggleDialog={this.toggleSortOptionsDialog}\n                      sortBy={this.state.sortBy}\n                      sortOrder={this.state.sortOrder}\n                      sortItems={this.sortItems}\n                    />\n                    }\n                  </div>\n                </Fragment>\n              )}\n            </div>\n            <div className=\"cur-view-content d-block\" onScroll={this.handleScroll}>\n              {this.state.isLoading && <Loading />}\n              {(!this.state.isLoading && errMessage) && <div className=\"error text-center mt-2\">{errMessage}</div>}\n              {(!this.state.isLoading && this.state.repoList.length === 0) && emptyTip}\n              {(!this.state.isLoading && this.state.repoList.length > 0) &&\n                <SharedRepoListView\n                  repoList={this.state.repoList}\n                  hasNextPage={this.state.hasNextPage}\n                  currentGroup={this.state.currentGroup}\n                  sortBy={this.state.sortBy}\n                  sortOrder={this.state.sortOrder}\n                  sortItems={this.sortItems}\n                  onItemUnshare={this.onItemUnshare}\n                  onItemDelete={this.onItemDelete}\n                  onItemDetails={this.onItemDetails}\n                  onItemRename={this.onItemRename}\n                  onMonitorRepo={this.onMonitorRepo}\n                />\n              }\n            </div>\n          </div>\n          {this.state.isShowDetails && (\n            <div className=\"cur-view-detail\">\n              <LibDetail currentRepo={this.state.currentRepo} closeDetails={this.closeDetails}/>\n            </div>\n          )}\n        </div>\n        {this.state.isCreateRepoDialogShow && !this.state.isDepartmentGroup && (\n          <ModalPortal>\n            <CreateRepoDialog\n              libraryType={this.state.libraryType}\n              onCreateToggle={this.onCreateRepoToggle}\n              onCreateRepo={this.onCreateRepo}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isCreateRepoDialogShow && this.state.isDepartmentGroup &&\n          <CreateRepoDialog\n            isAdmin={this.state.isAdmin}\n            onCreateToggle={this.onCreateRepoToggle}\n            onCreateRepo={this.onCreateRepo}\n            libraryType='department'\n          />\n        }\n        {this.state.showRenameGroupDialog &&\n          <RenameGroupDialog\n            showRenameGroupDialog={this.state.showRenameGroupDialog}\n            toggleRenameGroupDialog={this.toggleRenameGroupDialog}\n            loadGroup={this.loadGroup}\n            groupID={this.props.groupID}\n            onGroupChanged={this.props.onGroupChanged}\n            currentGroupName={currentGroup.name}\n          />\n        }\n        {this.state.showDismissGroupDialog &&\n          <DismissGroupDialog\n            showDismissGroupDialog={this.state.showDismissGroupDialog}\n            toggleDismissGroupDialog={this.toggleDismissGroupDialog}\n            loadGroup={this.loadGroup}\n            groupID={this.props.groupID}\n            onGroupChanged={this.props.onGroupChanged}\n          />\n        }\n        {this.state.showTransferGroupDialog &&\n          <TransferGroupDialog\n            toggleTransferGroupDialog={this.toggleTransferGroupDialog}\n            groupID={this.props.groupID}\n            onGroupChanged={this.props.onGroupChanged}\n          />\n        }\n        { this.state.showImportMembersDialog &&\n          <ImportMembersDialog\n            toggleImportMembersDialog={this.toggleImportMembersDialog}\n            importMembersInBatch={this.importMembersInBatch}\n          />\n        }\n        {this.state.showManageMembersDialog &&\n          <ManageMembersDialog\n            toggleManageMembersDialog={this.toggleManageMembersDialog}\n            groupID={this.props.groupID}\n            onGroupChanged={this.props.onGroupChanged}\n            isOwner={this.state.isOwner}\n          />\n        }\n        {this.state.isLeaveGroupDialogOpen &&\n          <LeaveGroupDialog\n            toggleLeaveGroupDialog={this.toggleLeaveGroupDialog}\n            groupID={this.props.groupID}\n            onGroupChanged={this.props.onGroupChanged}\n          />\n        }\n      </Fragment>\n    );\n  }\n}\n\nGroupView.propTypes = propTypes;\n\nexport default GroupView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport MediaQuery from 'react-responsive';\nimport CommonToolbar from './common-toolbar';\nimport { Button } from 'reactstrap';\nimport { gettext, canAddGroup } from '../../utils/constants';\n\nconst propTypes = {\n  searchPlaceholder: PropTypes.string,\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n  toggleAddGroupModal: PropTypes.func.isRequired,\n};\n\nclass GroupsToolbar extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    let { onShowSidePanel, onSearchedClick } = this.props;\n    return (\n      <div className=\"main-panel-north border-left-show\">\n        <div className=\"cur-view-toolbar\">\n          <span title=\"Side Nav Menu\" onClick={onShowSidePanel} className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\"></span>\n          {canAddGroup && (\n            <div className=\"operation\">\n              <MediaQuery query=\"(min-width: 768px)\">\n                <Button color=\"btn btn-secondary operation-item\" onClick={this.props.toggleAddGroupModal}>\n                  <i className=\"fas fa-plus-square text-secondary mr-1\"></i>{gettext('New Group')}\n                </Button>\n              </MediaQuery>\n              <MediaQuery query=\"(max-width: 767.8px)\">\n                <span className=\"sf2-icon-plus mobile-toolbar-icon\" title={gettext('New Group')} onClick={this.props.toggleAddGroupModal}></span>\n              </MediaQuery>\n            </div>\n          )}\n        </div>\n        <CommonToolbar searchPlaceholder={this.props.searchPlaceholder} onSearchedClick={onSearchedClick}/>\n      </div>\n    );\n  }\n}\n\nGroupsToolbar.propTypes = propTypes;\n\nexport default GroupsToolbar;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Input, Button } from 'reactstrap';\nimport { Utils } from '../../utils/utils';\n\nclass CreateGroupDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      groupName: '',\n      errorMsg: '',\n      isSubmitBtnActive: false,\n    };\n  }\n\n  handleGroupChange = (event) => {\n    let name = event.target.value;\n\n    if (!name.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n    this.setState({\n      groupName: name\n    });\n    if (this.state.errorMsg) {\n      this.setState({\n        errorMsg: ''\n      });\n    }\n  }\n\n  handleSubmitGroup = () => {\n    let name = this.state.groupName.trim();\n    if (name) {\n      let that = this;\n      seafileAPI.createGroup(name).then((res)=> {\n        that.props.onCreateGroup();\n      }).catch((error) => {\n        let errorMsg = Utils.getErrorMsg(error);\n        this.setState({errorMsg: errorMsg});\n      });\n    } else {\n      this.setState({\n        errorMsg: gettext('Name is required')\n      });\n    }\n    this.setState({\n      groupName: '',\n    });\n  }\n\n  handleKeyDown = (e) => {\n    if (e.keyCode === 13) {\n      this.handleSubmitGroup();\n      e.preventDefault();\n    }\n  }\n\n  render() {\n    return(\n      <Modal isOpen={this.props.showAddGroupModal} toggle={this.props.toggleAddGroupModal} autoFocus={false}>\n        <ModalHeader toggle={this.props.toggleAddGroupModal}>{gettext('New Group')}</ModalHeader>\n        <ModalBody>\n          <label htmlFor=\"groupName\">{gettext('Name')}</label>\n          <Input\n            type=\"text\"\n            id=\"groupName\"\n            value={this.state.groupName}\n            onChange={this.handleGroupChange}\n            onKeyDown={this.handleKeyDown}\n            autoFocus={true}\n          />\n          <span className=\"error\">{this.state.errorMsg}</span>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleAddGroupModal}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmitGroup} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nconst CreateGroupDialogPropTypes = {\n  toggleAddGroupModal: PropTypes.func.isRequired,\n  onCreateGroup: PropTypes.func.isRequired,\n  showAddGroupModal: PropTypes.bool.isRequired,\n};\n\nCreateGroupDialog.propTypes = CreateGroupDialogPropTypes;\n\nexport default CreateGroupDialog;","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext, siteRoot, canAddGroup } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../../components/loading';\nimport Group from '../../models/group';\nimport Repo from '../../models/repo';\nimport toaster from '../../components/toast';\nimport GroupsToolbar from '../../components/toolbar/groups-toolbar';\nimport SharedRepoListView from '../../components/shared-repo-list-view/shared-repo-list-view';\nimport CreateGroupDialog from '../../components/dialog/create-group-dialog';\nimport LibDetail from '../../components/dirent-detail/lib-details';\nimport EmptyTip from '../../components/empty-tip';\n\nimport '../../css/groups.css';\n\nconst propTypes = {\n  group: PropTypes.object.isRequired,\n  onItemDetails: PropTypes.func.isRequired,\n};\n\n\nclass RepoListViewPanel extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      repoList: [],\n    };\n  }\n\n  componentDidMount() {\n    let group = this.props.group;\n    let repoList = group.repos.map(item => {\n      let repo = new Repo(item);\n      return repo;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  onItemUnshare = (repo) => {\n    let group = this.props.group;\n    seafileAPI.unshareRepoToGroup(repo.repo_id, group.id).then(() => {\n      let repoList = this.state.repoList.filter(item => {\n        return item.repo_id !== repo.repo_id;\n      });\n      this.setState({repoList: repoList});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onItemDelete = (repo) => {\n    let repoList = this.state.repoList.filter(item => {\n      return item.repo_id !== repo.repo_id;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  onItemRename = (repo, newName) => {\n    let group = this.props.group;\n    seafileAPI.renameGroupOwnedLibrary(group.id, repo.repo_id, newName).then(res => {\n      let repoList = this.state.repoList.map(item => {\n        if (item.repo_id === repo.repo_id) {\n          item.repo_name = newName;\n        }\n        return item;\n      });\n      this.setState({repoList: repoList});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onMonitorRepo = (repo, monitored) => {\n    let repoList = this.state.repoList.map(item => {\n      if (item.repo_id === repo.repo_id) {\n        item.monitored = monitored;\n      }\n      return item;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  render() {\n    let group = this.props.group;\n    const emptyTip = <p className=\"group-item-empty-tip\">{gettext('No libraries')}</p>;\n    return (\n      <div className=\"group-list-panel\">\n        <h4 className=\"group-item-heading ellipsis\">\n          <a href={`${siteRoot}group/${group.id}/`} title={group.name}>{group.name}</a>\n        </h4>\n        {this.state.repoList.length === 0 ?\n          emptyTip :\n          <SharedRepoListView\n            isShowTableThread={false}\n            isShowRepoOwner={false}\n            currentGroup={this.props.group}\n            repoList={this.state.repoList}\n            onItemUnshare={this.onItemUnshare}\n            onItemDelete={this.onItemDelete}\n            onItemDetails={this.props.onItemDetails}\n            onItemRename={this.onItemRename}\n            onMonitorRepo={this.onMonitorRepo}\n          />\n        }\n      </div>\n    );\n  }\n}\n\nRepoListViewPanel.propTypes = propTypes;\n\nclass GroupsView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      errorMsg: '',\n      groupList: [],\n      showAddGroupModal: false,\n      isShowDetails: false,\n      currentRepo: null,\n    };\n  }\n\n  listGroups = () => {\n    seafileAPI.listGroups(true).then((res) => {\n      // `{'with_repos': 1}`: list repos of every group\n      // res: {data: [...], status: 200, statusText: \"OK\", headers: {}, config: {},}\n      let groupList = res.data.map(item => {\n        let group = new Group(item);\n        return group;\n      });\n      this.setState({\n        isLoading: false,\n        groupList: groupList.sort((a, b) => {\n          return a.name.toLowerCase() < b.name.toLowerCase() ? -1 : 1;\n        })\n      });\n    }).catch((error) => {\n      this.setState({\n        isLoading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  toggleAddGroupModal = () => {\n    this.setState({\n      showAddGroupModal: !this.state.showAddGroupModal\n    });\n  }\n\n  onCreateGroup = () => {\n    this.setState({\n      showAddGroupModal: false,\n      isLoading: true,\n      groupList: [],\n    });\n    this.listGroups();\n  }\n\n  componentDidMount() {\n    this.listGroups();\n  }\n\n  onItemDetails = (repo) => {\n    this.setState({\n      isShowDetails: true,\n      currentRepo: repo,\n    });\n  }\n\n  closeDetails = () => {\n    this.setState({isShowDetails: false});\n  }\n\n  render() {\n    const emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No groups')}</h2>\n        {canAddGroup ?\n          <p>{gettext('You are not in any groups. Groups allow multiple people to collaborate on libraries. You can create a group by clicking the \"New Group\" button in the menu bar.')}</p> :\n          <p>{gettext('You are not in any groups. Groups allow multiple people to collaborate on libraries. Groups you join will be listed here.')}</p>\n        }\n      </EmptyTip>\n    );\n\n    return (\n      <Fragment>\n        <GroupsToolbar\n          onShowSidePanel={this.props.onShowSidePanel}\n          onSearchedClick={this.props.onSearchedClick}\n          toggleAddGroupModal={this.toggleAddGroupModal}\n        />\n        <div className=\"main-panel-center flex-row\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading\">{gettext('My Groups')}</h3>\n            </div>\n            <div className=\"cur-view-content cur-view-content-groups\">\n              {this.state.isLoading && <Loading />}\n              {(!this.state.isLoading && this.state.errorMsg) && <div className=\"error text-center mt-2\">{this.state.errorMsg}</div>}\n              {(!this.state.isLoading && !this.state.errorMsg && this.state.groupList.length == 0) && emptyTip}\n              {!this.state.isLoading && this.state.groupList.map((group, index) => {\n                return (\n                  <RepoListViewPanel\n                    key={index}\n                    group={group}\n                    onItemDetails={this.onItemDetails}\n                  />\n                );\n              })}\n            </div>\n          </div>\n          {this.state.isShowDetails && (\n            <div className=\"cur-view-detail\">\n              <LibDetail currentRepo={this.state.currentRepo} closeDetails={this.closeDetails}/>\n            </div>\n          )}\n        </div>\n        { this.state.showAddGroupModal &&\n          <CreateGroupDialog\n            toggleAddGroupModal={this.toggleAddGroupModal}\n            onCreateGroup={this.onCreateGroup}\n            showAddGroupModal={this.state.showAddGroupModal}\n          />\n        }\n      </Fragment>\n    );\n  }\n}\n\nconst GroupsViewPropTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n};\n\nGroupsView.propTypes = GroupsViewPropTypes;\n\nexport default GroupsView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport CommonToolbar from './common-toolbar';\nimport { Button } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n  toggleInvitePeopleDialog: PropTypes.func.isRequired,\n};\n\nclass InvitationsToolbar extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    let { onShowSidePanel, onSearchedClick, toggleInvitePeopleDialog } = this.props;\n    return (\n      <div className=\"main-panel-north border-left-show\">\n        <div className=\"cur-view-toolbar\">\n          <span title=\"Side Nav Menu\" onClick={onShowSidePanel} className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\">\n          </span>\n          {Utils.isDesktop() ? (\n            <div className=\"operation\">\n              <Button color=\"btn btn-secondary operation-item\" onClick={toggleInvitePeopleDialog}>\n                <i className=\"fas fa-plus-square text-secondary mr-1\"></i>{gettext('Invite Guest')}\n              </Button>\n            </div>\n          ) : (\n            <span className=\"sf2-icon-plus mobile-toolbar-icon\" title={gettext('Invite Guest')} onClick={toggleInvitePeopleDialog}></span>\n          )}\n        </div>\n        <CommonToolbar searchPlaceholder={this.props.searchPlaceholder} onSearchedClick={onSearchedClick}/>\n      </div>\n    );\n  }\n}\n\nInvitationsToolbar.propTypes = propTypes;\n\nexport default InvitationsToolbar;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Utils } from '../../utils/utils';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Input, Button } from 'reactstrap';\nimport toaster from '../toast';\nimport Loading from '../loading';\n\nconst InvitePeopleDialogPropTypes = {\n  onInvitePeople: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired,\n};\n\nclass InvitePeopleDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      emails: '',\n      errorMsg: '',\n      isSubmitting: false\n    };\n  }\n\n  handleInputChange = (e) => {\n    let emails = e.target.value;\n    this.setState({\n      emails: emails\n    });\n    if (this.state.errorMsg) {\n      this.setState({\n        errorMsg: ''\n      });\n    }\n  }\n\n  handleKeyDown = (e) => {\n    if (e.keyCode === 13) {\n      e.preventDefault();\n      this.handleSubmitInvite();\n    }\n  }\n\n  handleSubmitInvite = () => {\n    let emails = this.state.emails.trim();\n    if (!emails) {\n      this.setState({\n        errorMsg: gettext('It is required.')\n      });\n      return false;\n    }\n\n    let emailsArray = [];\n    emails = emails.split(',');\n    for (let i = 0, len = emails.length; i < len; i++) {\n      let email = emails[i].trim();\n      if (email) {\n        emailsArray.push(email);\n      }\n    }\n\n    if (!emailsArray.length) {\n      this.setState({\n        errorMsg: gettext('Email is invalid.')\n      });\n      return false;\n    }\n\n    this.setState({\n      isSubmitting: true\n    });\n    seafileAPI.invitePeople(emailsArray).then((res) => {\n      this.props.toggleDialog();\n      const success = res.data.success;\n      if (success.length) {\n        let successMsg = '';\n        if (success.length == 1) {\n          successMsg = gettext('Successfully invited %(email).')\n            .replace('%(email)', success[0].accepter);\n        } else {\n          successMsg = gettext('Successfully invited %(email) and %(num) other people.')\n            .replace('%(email)', success[0].accepter)\n            .replace('%(num)', success.length - 1);\n        }\n        toaster.success(successMsg);\n        this.props.onInvitePeople(success);\n      }\n      const failed = res.data.failed;\n      if (failed.length) {\n        for (let i = 0, len = failed.length; i < len; i++) {\n          let failedMsg = failed[i].email + ': ' + failed[i].error_msg;\n          toaster.danger(failedMsg);\n        }\n      }\n    }).catch((error) => {\n      const errorMsg = Utils.getErrorMsg(error);\n      toaster.danger(errorMsg);\n      this.props.toggleDialog();\n    });\n  }\n\n  render() {\n    const { isSubmitting } = this.state;\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleDialog}>\n        <ModalHeader toggle={this.props.toggleDialog}>{gettext('Invite Guest')}</ModalHeader>\n        <ModalBody>\n          <label htmlFor=\"emails\">{gettext('Emails')}</label>\n          <Input\n            type=\"text\"\n            id=\"emails\"\n            placeholder={gettext('Emails, separated by \\',\\'')}\n            value={this.state.emails}\n            onChange={this.handleInputChange}\n            onKeyDown={this.handleKeyDown}\n          />\n          <p className=\"error mt-2\">{this.state.errorMsg}</p>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleDialog}>{gettext('Cancel')}</Button>\n          <Button className=\"submit-btn\" color=\"primary\" onClick={this.handleSubmitInvite} disabled={isSubmitting}>{isSubmitting ? <Loading /> : gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nInvitePeopleDialog.propTypes = InvitePeopleDialogPropTypes;\n\nexport default InvitePeopleDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../loading';\nimport toaster from '../toast';\n\nconst propTypes = {\n  accepter: PropTypes.string.isRequired,\n  token: PropTypes.string.isRequired,\n  revokeInvitation: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass InvitationRevokeDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isSubmitting: false\n    };\n  }\n\n  onRevokeInvitation = () => {\n    this.setState({\n      isSubmitting: true,\n    });\n\n    seafileAPI.revokeInvitation(this.props.token).then((res) => {\n      this.props.revokeInvitation();\n      this.props.toggleDialog();\n      const msg = gettext('Successfully revoked access of user {placeholder}.').replace('{placeholder}', this.props.accepter);\n      toaster.success(msg);\n    }).catch((error) => {\n      const errorMsg = Utils.getErrorMsg(error);\n      toaster.danger(errorMsg);\n      this.props.toggleDialog();\n    });\n  };\n\n  render() {\n    const { accepter, toggleDialog } = this.props;\n    const { isSubmitting } = this.state;\n    const email = '<span class=\"op-target\">' + Utils.HTMLescape(this.props.accepter) + '</span>';\n    const content = gettext('Are you sure to revoke access of user {placeholder} ?').replace('{placeholder}', email);\n\n    return (\n      <Modal isOpen={true} toggle={toggleDialog}>\n        <ModalHeader toggle={toggleDialog}>{gettext('Revoke Access')}</ModalHeader>\n        <ModalBody>\n          <p dangerouslySetInnerHTML={{__html: content}}></p>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={toggleDialog}>{gettext('Cancel')}</Button>\n          <Button className=\"submit-btn\" color=\"primary\" onClick={this.onRevokeInvitation} disabled={isSubmitting}>{isSubmitting ? <Loading /> : gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nInvitationRevokeDialog.propTypes = propTypes;\n\nexport default InvitationRevokeDialog;\n","import React, { Component, Fragment } from 'react';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport InvitationsToolbar from '../../components/toolbar/invitations-toolbar';\nimport InvitePeopleDialog from '../../components/dialog/invite-people-dialog';\nimport InvitationRevokeDialog from '../../components/dialog/invitation-revoke-dialog';\nimport Loading from '../../components/loading';\nimport toaster from '../../components/toast';\nimport EmptyTip from '../../components/empty-tip';\n\nimport '../../css/invitations.css';\n\nclass Item extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpIconShown: false,\n      isOpMenuOpen: false, // for mobile\n      isRevokeDialogOpen: false\n    };\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  onMouseEnter = () => {\n    this.setState({\n      isOpIconShown: true\n    });\n  }\n\n  onMouseLeave = () => {\n    this.setState({\n      isOpIconShown: false\n    });\n  }\n\n  deleteItem = (e) => {\n    e.preventDefault();\n    // make the icon avoid being clicked repeatedly\n    this.setState({\n      isOpIconShown: false\n    });\n    const token = this.props.invitation.token;\n    seafileAPI.deleteInvitation(token).then((res) => {\n      this.setState({deleted: true});\n      toaster.success(gettext('Successfully deleted 1 item.'));\n    }).catch((error) => {\n      const errorMsg = Utils.getErrorMsg(error);\n      toaster.danger(errorMsg);\n      this.setState({\n        isOpIconShown: true\n      });\n    });\n  }\n\n  revokeItem = () => {\n    this.setState({deleted: true});\n  }\n\n  toggleRevokeDialog = (e) => {\n    e.preventDefault();\n    this.setState({\n      isRevokeDialogOpen: !this.state.isRevokeDialogOpen\n    });\n  }\n\n  render() {\n    const { isOpIconShown, deleted, isRevokeDialogOpen } = this.state;\n\n    if (deleted) {\n      return null;\n    }\n\n    const item = this.props.invitation;\n\n    const desktopItem = (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter} tabIndex=\"0\">\n        <td>{item.accepter}</td>\n        <td>{moment(item.invite_time).format('YYYY-MM-DD')}</td>\n        <td>{moment(item.expire_time).format('YYYY-MM-DD')}</td>\n        <td>{item.accept_time && <i className=\"sf2-icon-tick invite-accept-icon\"></i>}</td>\n        <td>\n          {isOpIconShown && (\n            item.accept_time ?\n              <a href=\"#\"\n                role=\"button\"\n                className=\"action-icon sf3-font sf3-font-cancel-invitation\"\n                title={gettext('Revoke Access')}\n                aria-label={gettext('Revoke Access')}\n                onClick={this.toggleRevokeDialog}>\n              </a> :\n              <a href=\"#\"\n                role=\"button\"\n                className=\"action-icon sf2-icon-x3\"\n                title={gettext('Delete')}\n                aria-label={gettext('Delete')}\n                onClick={this.deleteItem}>\n              </a>\n          )}\n        </td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <tr>\n        <td>\n          {item.accepter}<br />\n          <span className=\"item-meta-info\">{moment(item.invite_time).format('YYYY-MM-DD')}<span className=\"small\">({gettext('Invite Time')})</span></span>\n          <span className=\"item-meta-info\">{moment(item.expire_time).format('YYYY-MM-DD')}<span className=\"small\">({gettext('Expiration')})</span></span>\n          <span className=\"item-meta-info\">{item.accept_time && gettext('Accepted')}</span>\n        </td>\n        <td>\n          <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n            <DropdownToggle\n              tag=\"i\"\n              className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isOpMenuOpen}\n            />\n            <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n              <div className=\"mobile-operation-menu-bg-layer\"></div>\n              <div className=\"mobile-operation-menu\">\n                {item.accept_time ?\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.toggleRevokeDialog}>{gettext('Revoke Access')}</DropdownItem> :\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.deleteItem}>{gettext('Delete')}</DropdownItem>\n                }\n              </div>\n            </div>\n          </Dropdown>\n        </td>\n      </tr>\n    );\n\n    return (\n      <Fragment>\n        {this.props.isDesktop ? desktopItem : mobileItem}\n        {isRevokeDialogOpen &&\n        <InvitationRevokeDialog\n          accepter={item.accepter}\n          token={item.token}\n          revokeInvitation={this.revokeItem}\n          toggleDialog={this.toggleRevokeDialog}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nconst ItemPropTypes = {\n  invitation: PropTypes.object.isRequired,\n};\n\nItem.propTypes = ItemPropTypes;\n\nclass Content extends Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    const {\n      loading, errorMsg, invitationsList\n    } = this.props.data;\n\n    if (loading) {\n      return <Loading />;\n    }\n\n    if (errorMsg) {\n      return <p className=\"error text-center mt-2\">{errorMsg}</p>;\n    }\n\n    if (!invitationsList.length) {\n      return (\n        <EmptyTip>\n          <h2>{gettext('No guest invitations')}</h2>\n          <p>{gettext('You have not invited any guests yet. A guest can access shared libraries through the web interface allowing more efficient ways to collaborate than through links. You can invite a guest by clicking the \"Invite Guest\" button in the menu bar.')}</p>\n        </EmptyTip>\n      );\n    }\n\n    const isDesktop = Utils.isDesktop();\n    return (\n      <table className={`table-hover${isDesktop ? '': ' table-thead-hidden'}`}>\n        <thead>\n          {isDesktop ?\n            <tr>\n              <th width=\"25%\">{gettext('Email')}</th>\n              <th width=\"20%\">{gettext('Invite Time')}</th>\n              <th width=\"20%\">{gettext('Expiration')}</th>\n              <th width=\"18%\">{gettext('Accepted')}</th>\n              <th width=\"7%\"></th>\n            </tr>\n            :\n            <tr>\n              <th width=\"92%\"></th>\n              <th width=\"8%\"></th>\n            </tr>\n          }\n        </thead>\n        <tbody>\n          {invitationsList.map((invitation, index) => {\n            return (\n              <Item\n                key={index}\n                isDesktop={isDesktop}\n                invitation={invitation}\n              />\n            );\n          })}\n        </tbody>\n      </table>\n    );\n  }\n}\n\nclass InvitationsView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      invitationsList: [],\n      isInvitePeopleDialogOpen: false\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listInvitations().then((res) => {\n      this.setState({\n        invitationsList: res.data,\n        loading: false\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  onInvitePeople = (invitationsArray) => {\n    invitationsArray.push.apply(invitationsArray, this.state.invitationsList);\n    this.setState({\n      invitationsList: invitationsArray,\n    });\n  }\n\n  toggleInvitePeopleDialog = () => {\n    this.setState({\n      isInvitePeopleDialogOpen: !this.state.isInvitePeopleDialogOpen\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <InvitationsToolbar\n          onShowSidePanel={this.props.onShowSidePanel}\n          onSearchedClick={this.props.onSearchedClick}\n          toggleInvitePeopleDialog={this.toggleInvitePeopleDialog}\n        />\n        <div className=\"main-panel-center flex-row\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading\">{gettext('Invite Guest')}</h3>\n            </div>\n            <div className=\"cur-view-content\">\n              <Content data={this.state} />\n            </div>\n          </div>\n        </div>\n        {this.state.isInvitePeopleDialogOpen &&\n        <InvitePeopleDialog\n          onInvitePeople={this.onInvitePeople}\n          toggleDialog={this.toggleInvitePeopleDialog}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nconst InvitationsViewPropTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n};\n\nInvitationsView.propTypes = InvitationsViewPropTypes;\n\nexport default InvitationsView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Input } from 'reactstrap';\n\nconst propTypes = {\n  toggleCancel: PropTypes.func.isRequired,\n  addWiki: PropTypes.func.isRequired,\n};\n\nclass NewWikiDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isExist: false,\n      name: '',\n      repoID: '',\n      isSubmitBtnActive: false,\n    };\n  }\n\n  inputNewName = (e) => {\n    if (!event.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({\n      name: e.target.value,\n    });\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n    }\n  }\n\n  handleSubmit = () => {\n    let { isExist, name, repoID } = this.state;\n    this.props.addWiki(isExist, name, repoID);\n    this.props.toggleCancel();\n  }\n\n  toggle = () => {\n    this.props.toggleCancel();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} autoFocus={false}>\n        <ModalHeader toggle={this.toggle}>{gettext('New Wiki')}</ModalHeader>\n        <ModalBody>\n          <label className=\"form-label\">{gettext('Name')}</label>\n          <Input onKeyPress={this.handleKeyPress} autoFocus={true} value={this.state.name} onChange={this.inputNewName}/>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nNewWikiDialog.propTypes = propTypes;\n\nexport default NewWikiDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport moment from 'moment';\nimport Repo from '../../models/repo';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  toggleCancel: PropTypes.func.isRequired,\n  addWiki: PropTypes.func.isRequired\n};\n\nclass WikiSelectDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      repos: [],\n      repoID: '',\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepos().then(res => {\n      let repoList = res.data.repos\n        .filter(item => {\n          switch (item.type) {\n            case 'mine': // my libraries\n              return !item.encrypted;\n            case 'shared': // libraries shared with me\n              // 'is_admin': the library is shared with 'admin' permission\n              return !item.encrypted && item.is_admin;\n            case 'group':\n            default:\n              return !item.encrypted && !res.data.repos.some(repo => {\n                // just remove the duplicated libraries\n                return repo.type != item.type && repo.repo_id == item.repo_id;\n              });\n          }\n        })\n        .map(item => {\n          let repo = new Repo(item);\n          return repo;\n        });\n      repoList = Utils.sortRepos(repoList, 'name', 'asc');\n      this.setState({repos: repoList});\n    });\n  }\n\n  onChange = (repo) => {\n    this.setState({\n      repoID: repo.repo_id,\n    });\n  }\n\n  handleSubmit = () => {\n    let { repoID } = this.state;\n    this.props.addWiki(repoID);\n    this.props.toggleCancel();\n  }\n\n  toggle = () => {\n    this.props.toggleCancel();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.toggle}>{gettext('Publish a Library')}</ModalHeader>\n        <ModalBody className=\"dialog-list-container\">\n          <table>\n            <thead>\n              <tr>\n                <th width='6%'>{/* select */}</th>\n                <th width='9%'>{/* icon */}</th>\n                <th width='55%'>{gettext('Name')}</th>\n                <th width='30%'>{gettext('Last Update')}</th>\n              </tr>\n            </thead>\n            <tbody>\n              {this.state.repos.map((repo, index) => {\n                return (\n                  <tr key={index}>\n                    <td className=\"text-center\"><input type=\"radio\" className=\"vam\" name=\"repo\" value={repo.repo_id} onChange={this.onChange.bind(this, repo)} /></td>\n                    <td className=\"text-center\"><img src={Utils.getLibIconUrl(repo, false)} width=\"24\" title={Utils.getLibIconTitle(repo)} alt={Utils.getLibIconTitle(repo)} /></td>\n                    <td>{repo.repo_name}</td>\n                    <td>{moment(repo.last_modified).fromNow()}</td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          {this.state.repoID ?\n            <Button color=\"primary\" onClick={this.handleSubmit}>{gettext('Submit')}</Button>:\n            <Button color=\"primary\" disabled>{gettext('Submit')}</Button>\n          }\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nWikiSelectDialog.propTypes = propTypes;\n\nexport default WikiSelectDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\n\nconst propTypes = {\n  toggleCancel: PropTypes.func.isRequired,\n  handleSubmit: PropTypes.func.isRequired,\n};\n\nclass WikiDeleteDialog extends React.Component {\n\n  toggle = () => {\n    this.props.toggleCancel();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('Unpublish Library')}</ModalHeader>\n        <ModalBody>\n          <p>{gettext('Are you sure you want to unpublish this library?')}</p>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.props.handleSubmit}>{gettext('Unpublish')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nWikiDeleteDialog.propTypes = propTypes;\n\nexport default WikiDeleteDialog;\n","import React, { Component, Fragment } from 'react';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { siteRoot, gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n// import { seafileAPI } from '../../utils/seafile-api';\n// import Toast from '../toast';\nimport ModalPortal from '../modal-portal';\nimport WikiDeleteDialog from '../dialog/wiki-delete-dialog';\n// import Rename from '../rename';\n\nconst propTypes = {\n  wiki: PropTypes.object.isRequired,\n  // renameWiki: PropTypes.func.isRequired,\n  deleteWiki: PropTypes.func.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  onFreezedItem: PropTypes.func.isRequired,\n  onUnfreezedItem: PropTypes.func.isRequired,\n};\n\nclass WikiListItem extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpMenuOpen: false, // for mobile\n      isShowDeleteDialog: false,\n      // isRenameing: false,\n      highlight: false,\n      // permission: this.props.wiki.permission,\n    };\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  // clickMenuToggle = (e) => {\n  //   e.preventDefault();\n  //   this.onMenuToggle(e);\n  // }\n\n  // onMenuToggle = (e) => {\n  //   let targetType = e.target.dataset.toggle;\n  //   if (targetType !== 'item') {\n  //     if (this.props.isItemFreezed) {\n  //       this.setState({\n  //         highlight: false,\n  //         isShowMenuControl: false,\n  //         isShowWikiMenu: !this.state.isShowWikiMenu\n  //       });\n  //       this.props.onUnfreezedItem();\n  //     } else {\n  //       this.setState({\n  //         isShowWikiMenu: !this.state.isShowWikiMenu\n  //       });\n  //       this.props.onFreezedItem();\n  //     }\n  //   }\n  // }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({ highlight: true });\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({ highlight: false });\n    }\n  }\n\n  // changePerm = (permission) => {\n  //   let wiki = this.props.wiki;\n  //   seafileAPI.updateWikiPermission(wiki.slug, permission).then(() => {\n  //     this.setState({permission: permission});\n  //   }).catch((error) => {\n  //     if(error.response) {\n  //       let errorMsg = error.response.data.error_msg;\n  //       Toast.danger(errorMsg);\n  //     }\n  //   });\n  // }\n\n  // onRenameToggle = (e) => {\n  //   this.props.onFreezedItem();\n  //   this.setState({\n  //     isShowWikiMenu: false,\n  //     isShowMenuControl: false,\n  //     isRenameing: true,\n  //   });\n  // }\n\n  // onRenameConfirm = (newName) => {\n  //   this.renameWiki(newName);\n  //   this.onRenameCancel();\n  // }\n\n  // onRenameCancel = () => {\n  //   this.props.onUnfreezedItem();\n  //   this.setState({isRenameing: false});\n  // }\n\n  onDeleteToggle = (e) => {\n    e.preventDefault();\n    this.props.onUnfreezedItem();\n    this.setState({\n      isShowDeleteDialog: !this.state.isShowDeleteDialog,\n    });\n  }\n\n  onDeleteCancel = () => {\n    this.props.onUnfreezedItem();\n    this.setState({\n      isShowDeleteDialog: !this.state.isShowDeleteDialog,\n    });\n  }\n\n  // renameWiki = (newName) => {\n  //   let wiki = this.props.wiki;\n  //   this.props.renameWiki(wiki, newName);\n  // }\n\n  deleteWiki = () => {\n    let wiki = this.props.wiki;\n    this.props.deleteWiki(wiki);\n    this.setState({\n      isShowDeleteDialog: !this.state.isShowDeleteDialog,\n    });\n  }\n\n  render() {\n    let wiki = this.props.wiki;\n    let userProfileURL = `${siteRoot}profile/${encodeURIComponent(wiki.owner)}/`;\n    let fileIconUrl = Utils.getDefaultLibIconUrl(false);\n    let deleteIcon = `action-icon sf2-icon-x3 ${this.state.highlight ? '' : 'invisible'}`;\n\n    const desktopItem = (\n      <tr className={this.state.highlight ? 'tr-highlight' : ''} onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter}>\n        <td><img src={fileIconUrl} width=\"24\" alt=\"\" /></td>\n        <td className=\"name\">\n          <a href={wiki.link}>{wiki.name}</a>\n          {/*this.state.isRenameing ?\n              <Rename wiki={wiki} name={wiki.name} onRenameConfirm={this.onRenameConfirm} onRenameCancel={this.onRenameCancel}/> :\n              <a href={wiki.link}>{wiki.name}</a>\n            */}\n        </td>\n        <td><a href={userProfileURL} target='_blank'>{wiki.owner_nickname}</a></td>\n        <td>{moment(wiki.updated_at).fromNow()}</td>\n        <td className=\"text-center cursor-pointer\">\n          <a href=\"#\" role=\"button\" aria-label={gettext('Unpublish')} title={gettext('Unpublish')} className={deleteIcon} onClick={this.onDeleteToggle}></a>\n        </td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <tr className={this.state.highlight ? 'tr-highlight' : ''} onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td><img src={fileIconUrl} width=\"24\" alt=\"\" /></td>\n        <td>\n          <a href={wiki.link}>{wiki.name}</a><br />\n          <a href={userProfileURL} target='_blank' className=\"item-meta-info\">{wiki.owner_nickname}</a>\n          <span className=\"item-meta-info\">{moment(wiki.updated_at).fromNow()}</span>\n        </td>\n        <td>\n          <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n            <DropdownToggle\n              tag=\"i\"\n              className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isOpMenuOpen}\n            />\n            <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n              <div className=\"mobile-operation-menu-bg-layer\"></div>\n              <div className=\"mobile-operation-menu\">\n                <DropdownItem className=\"mobile-menu-item\" onClick={this.onDeleteToggle}>{gettext('Unpublish')}</DropdownItem>\n              </div>\n            </div>\n          </Dropdown>\n        </td>\n      </tr>\n    );\n\n    return (\n      <Fragment>\n        {Utils.isDesktop() ? desktopItem : mobileItem}\n        {this.state.isShowDeleteDialog &&\n          <ModalPortal>\n            <WikiDeleteDialog\n              toggleCancel={this.onDeleteCancel}\n              handleSubmit={this.deleteWiki}\n            />\n          </ModalPortal>\n        }\n      </Fragment>\n    );\n  }\n}\n\nWikiListItem.propTypes = propTypes;\n\nexport default WikiListItem;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport WikiListItem from './wiki-list-item';\nimport LibsMobileThead from '../libs-mobile-thead';\n\nconst propTypes = {\n  data: PropTypes.object.isRequired,\n  renameWiki: PropTypes.func.isRequired,\n  deleteWiki: PropTypes.func.isRequired,\n};\n\nclass WikiListView extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n    };\n  }\n\n  onFreezedItem = () => {\n    this.setState({isItemFreezed: true});\n  }\n\n  onUnfreezedItem = () => {\n    this.setState({isItemFreezed: false});\n  }\n\n  render() {\n    let { loading, errorMsg, wikis } = this.props.data;\n\n    if (loading) {\n      return <span className=\"loading-icon loading-tip\"></span>;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const isDesktop = Utils.isDesktop();\n      const desktopThead = (\n        <thead>\n          <tr>\n            <th width=\"4%\"></th>\n            <th width=\"36%\">{gettext('Name')}</th>\n            <th width=\"25%\">{gettext('Owner')}</th>\n            <th width=\"25%\">{gettext('Last Update')}</th>\n            <th width=\"10%\">{/* operation */}</th>\n          </tr>\n        </thead>\n      );\n      return (\n        <table className={isDesktop ? '' : 'table-thead-hidden'}>\n          {isDesktop ? desktopThead : <LibsMobileThead />}\n          <tbody>\n            {wikis.map((wiki, index) => {\n              return (\n                <WikiListItem\n                  key={index}\n                  wiki={wiki}\n                  renameWiki={this.props.renameWiki}\n                  deleteWiki={this.props.deleteWiki}\n                  isItemFreezed={this.state.isItemFreezed}\n                  onFreezedItem={this.onFreezedItem}\n                  onUnfreezedItem={this.onUnfreezedItem}\n                />\n              );\n            })}\n          </tbody>\n        </table>\n      );\n    }\n  }\n}\n\nWikiListView.propTypes = propTypes;\n\nexport default WikiListView;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button } from 'reactstrap';\nimport MediaQuery from 'react-responsive';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, canPublishRepo } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport ModalPortal from '../../components/modal-portal';\nimport EmptyTip from '../../components/empty-tip';\nimport CommonToolbar from '../../components/toolbar/common-toolbar';\nimport NewWikiDialog from '../../components/dialog/new-wiki-dialog';\nimport WikiSelectDialog from '../../components/dialog/wiki-select-dialog';\nimport WikiListView from '../../components/wiki-list-view/wiki-list-view';\n\nconst propTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n};\n\nclass Wikis extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      wikis: [],\n      isShowAddWikiMenu: false,\n      isShowSelectDialog: false,\n      isShowCreateDialog: false,\n    };\n  }\n\n  componentDidMount() {\n    this.getWikis();\n  }\n\n  getWikis = () => {\n    seafileAPI.listWikis().then(res => {\n      this.setState({\n        loading: false,\n        wikis: res.data.data\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  clickMenuToggle = (e) => {\n    e.preventDefault();\n    this.onMenuToggle();\n  }\n\n  onMenuToggle = () => {\n    this.setState({isShowAddWikiMenu: !this.state.isShowAddWikiMenu});\n  }\n\n  onSelectToggle = () => {\n    this.setState({isShowSelectDialog: !this.state.isShowSelectDialog});\n  }\n\n  onCreateToggle = () => {\n    this.setState({isShowCreateDialog: !this.state.isShowCreateDialog});\n  }\n\n  addWiki = (repoID) => {\n    seafileAPI.addWiki(repoID).then((res) => {\n      this.state.wikis.push(res.data);\n      this.setState({wikis: this.state.wikis});\n    }).catch((error) => {\n      if(error.response) {\n        let errorMsg = error.response.data.error_msg;\n        toaster.danger(errorMsg);\n      }\n    });\n  }\n\n  renameWiki = (wiki, newName) => {\n    seafileAPI.renameWiki(wiki.slug, newName).then((res) => {\n      let wikis = this.state.wikis.map((item) => {\n        if (item.name === wiki.name) {\n          item = res.data;\n        }\n        return item;\n      });\n      this.setState({wikis: wikis});\n    }).catch((error) => {\n      if(error.response) {\n        let errorMsg = error.response.data.error_msg;\n        toaster.danger(errorMsg);\n      }\n    });\n  }\n\n  deleteWiki = (wiki) => {\n    seafileAPI.deleteWiki(wiki.slug).then(() => {\n      let wikis = this.state.wikis.filter(item => {\n        return item.name !== wiki.name;\n      });\n      this.setState({wikis: wikis});\n    }).catch((error) => {\n      if(error.response) {\n        let errorMsg = error.response.data.error_msg;\n        toaster.danger(errorMsg);\n      }\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"main-panel-north border-left-show\">\n          <div className=\"cur-view-toolbar\">\n            <span className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\" title=\"Side Nav Menu\" onClick={this.props.onShowSidePanel}></span>\n            {canPublishRepo &&\n            <div className=\"operation\">\n              <Fragment>\n                <MediaQuery query=\"(min-width: 768px)\">\n                  <Button className=\"btn btn-secondary operation-item\" onClick={this.onSelectToggle}>{gettext('Publish a Library')}</Button>\n                </MediaQuery>\n                <MediaQuery query=\"(max-width: 767.8px)\">\n                  <span className=\"sf2-icon-plus mobile-toolbar-icon\" title={gettext('Publish a Library')} onClick={this.onSelectToggle}></span>\n                </MediaQuery>\n              </Fragment>\n            </div>\n            }\n          </div>\n          <CommonToolbar onSearchedClick={this.props.onSearchedClick} />\n        </div>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\" id=\"wikis\">\n            <div className=\"cur-view-path\">\n              <div className=\"path-container\">\n                <h3 className=\"sf-heading m-0\">{gettext('Published Libraries')}</h3>\n              </div>\n            </div>\n            <div className=\"cur-view-content\">\n              {(this.state.loading || this.state.wikis.length !== 0) &&\n                <WikiListView\n                  data={this.state}\n                  renameWiki={this.renameWiki}\n                  deleteWiki={this.deleteWiki}\n                />\n              }\n              {(!this.state.loading && this.state.wikis.length === 0) &&\n                <EmptyTip>\n                  <h2>{gettext('No published libraries')}</h2>\n                  <p>{gettext('You have not published any libraries yet. A published library can be accessed by anyone, not only users, via its URL. You can publish a library by clicking the \"Publish a Library\" button in the menu bar.')}</p>\n                </EmptyTip>\n              }\n            </div>\n          </div>\n        </div>\n        {this.state.isShowCreateDialog && (\n          <ModalPortal>\n            <NewWikiDialog\n              toggleCancel={this.onCreateToggle}\n              addWiki={this.addWiki}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isShowSelectDialog && (\n          <ModalPortal>\n            <WikiSelectDialog\n              toggleCancel={this.onSelectToggle}\n              addWiki={this.addWiki}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nWikis.propTypes = propTypes;\n\nexport default Wikis;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport CommonToolbar from './common-toolbar';\n\nconst propTypes = {\n  searchPlaceholder: PropTypes.string,\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n};\n\nclass GeneralToolbar extends React.Component {\n\n  render() {\n    // todo get repoID?\n    let { onShowSidePanel, onSearchedClick } = this.props;\n    return (\n      <div className=\"main-panel-north\">\n        <div className=\"cur-view-toolbar\">\n          <span\n            className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\"\n            title=\"Side Nav Menu\"\n            onClick={onShowSidePanel}>\n          </span>\n        </div>\n        <CommonToolbar\n          searchPlaceholder={this.props.searchPlaceholder}\n          onSearchedClick={onSearchedClick}\n        />\n      </div>\n    );\n  }\n}\n\nGeneralToolbar.propTypes = propTypes;\n\nexport default GeneralToolbar;\n","import React, { Fragment } from 'react';\nimport GeneralToolBar from './toolbar/general-toolbar';\n\nconst MainContentWrapper = (WrapperedComponent) => {\n  return class Wrapper extends React.Component {\n\n    constructor(props) {\n      super(props);\n    }\n\n    render() {\n      return (\n        <Fragment>\n          <GeneralToolBar {...this.props} />\n          <WrapperedComponent {...this.props} />\n        </Fragment>\n      );\n    }\n  };\n};\n\nexport default MainContentWrapper;\n","import React, { Component } from 'react';\nimport ReactDom from 'react-dom';\nimport { Router, navigate } from '@gatsbyjs/reach-router';\nimport MediaQuery from 'react-responsive';\nimport { Modal } from 'reactstrap';\nimport { siteRoot, canAddRepo, isDocs } from './utils/constants';\nimport { Utils } from './utils/utils';\nimport SystemNotification from './components/system-notification';\nimport SidePanel from './components/side-panel';\nimport MainPanel from './components/main-panel';\nimport DraftsView from './pages/drafts/drafts-view';\nimport DraftContent from './pages/drafts/draft-content';\nimport FilesActivities from './pages/dashboard/files-activities';\nimport Starred from './pages/starred/starred';\nimport LinkedDevices from './pages/linked-devices/linked-devices';\nimport editUtilities from './utils/editor-utilities';\nimport ShareAdminLibraries from './pages/share-admin/libraries';\nimport ShareAdminFolders from './pages/share-admin/folders';\nimport ShareAdminShareLinks from './pages/share-admin/share-links';\nimport ShareAdminUploadLinks from './pages/share-admin/upload-links';\nimport SharedLibraries from './pages/shared-libs/shared-libs';\nimport ShareWithOCM from './pages/share-with-ocm/shared-with-ocm';\nimport OCMViaWebdav from './pages/ocm-via-webdav/ocm-via-webdav';\nimport OCMRepoDir from './pages/share-with-ocm/remote-dir-view';\nimport MyLibraries from './pages/my-libs/my-libs';\nimport MyLibDeleted from './pages/my-libs/my-libs-deleted';\nimport PublicSharedView from './pages/shared-with-all/public-shared-view';\nimport LibContentView from './pages/lib-content-view/lib-content-view';\nimport Group from './pages/groups/group-view';\nimport Groups from './pages/groups/groups-view';\nimport InvitationsView from './pages/invitations/invitations-view';\nimport Wikis from './pages/wikis/wikis';\nimport MainContentWrapper from './components/main-content-wrapper';\n\nimport './css/layout.css';\nimport './css/toolbar.css';\nimport './css/search.css';\n\nconst FilesActivitiesWrapper = MainContentWrapper(FilesActivities);\nconst DraftsViewWrapper = MainContentWrapper(DraftsView);\nconst StarredWrapper = MainContentWrapper(Starred);\nconst LinkedDevicesWrapper = MainContentWrapper(LinkedDevices);\nconst SharedLibrariesWrapper = MainContentWrapper(SharedLibraries);\nconst SharedWithOCMWrapper = MainContentWrapper(ShareWithOCM);\nconst OCMViaWebdavWrapper = MainContentWrapper(OCMViaWebdav);\nconst ShareAdminLibrariesWrapper = MainContentWrapper(ShareAdminLibraries);\nconst ShareAdminFoldersWrapper = MainContentWrapper(ShareAdminFolders);\n\nclass App extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpen: false,\n      isSidePanelClosed: false,\n      draftCounts: 0,\n      draftList:[],\n      isLoadingDraft: true,\n      currentTab: '/',\n      pathPrefix: [],\n    };\n    this.dirViewPanels = ['my-libs', 'shared-libs', 'org']; // and group\n    window.onpopstate = this.onpopstate;\n  }\n\n  onpopstate = (event) => {\n    if (event.state && event.state.currentTab && event.state.pathPrefix) {\n      let { currentTab, pathPrefix } = event.state;\n      this.setState({currentTab, pathPrefix});\n    }\n  }\n\n  componentWillMount() {\n    if (!Utils.isDesktop()) {\n      this.setState({\n        isSidePanelClosed: true\n      });\n    }\n  }\n\n  navigateClientUrlToLib = () =>{\n    if(window.location.hash && window.location.hash.indexOf('common/lib') != -1){\n      let splitUrlArray = window.location.hash.split('/');\n      let repoID = splitUrlArray[splitUrlArray.length - 2];\n      let url = siteRoot + 'library/' + repoID + '/';\n      navigate(url, {repalce: true});\n    }\n  }\n\n  componentDidMount() {\n    // url from client  e.g. http://127.0.0.1:8000/#common/lib/34e7fb92-e91d-499d-bcde-c30ea8af9828/\n    // navigate to library page http://127.0.0.1:8000/library/34e7fb92-e91d-499d-bcde-c30ea8af9828/\n    this.navigateClientUrlToLib();\n\n    // e.g.  from http://127.0.0.1:8000/drafts/reviews/\n    // get reviews\n    // TODO: need refactor later\n    let href = window.location.href.split('/');\n    if (isDocs) {\n      this.getDrafts();\n    }\n    this.setState({currentTab: href[href.length - 2]});\n  }\n\n  getDrafts = () => {\n    editUtilities.listDrafts().then(res => {\n      this.setState({\n        draftCounts: res.data.draft_counts,\n        draftList: res.data.data,\n        isLoadingDraft: false,\n      });\n    });\n  }\n\n  updateDraftsList = (draft_id) => {\n    this.setState({\n      draftCounts: this.state.draftCounts - 1,\n      draftList: this.state.draftList.filter(draft => draft.id != draft_id),\n    });\n  }\n\n  onCloseSidePanel = () => {\n    this.setState({\n      isSidePanelClosed: !this.state.isSidePanelClosed\n    });\n  }\n\n  onShowSidePanel = () => {\n    this.setState({\n      isSidePanelClosed: !this.state.isSidePanelClosed\n    });\n  }\n\n  onSearchedClick = (selectedItem) => {\n    if (selectedItem.is_dir === true) {\n      this.setState({currentTab: '', pathPrefix: []});\n      let url = siteRoot + 'library/' + selectedItem.repo_id + '/' + selectedItem.repo_name + selectedItem.path;\n      navigate(url, {repalce: true});\n    } else {\n      let url = siteRoot + 'lib/' + selectedItem.repo_id + '/file' + Utils.encodePath(selectedItem.path);\n      let isWeChat = Utils.isWeChat();\n      if (!isWeChat) {\n        let newWindow = window.open('about:blank');\n        newWindow.location.href = url;\n      } else {\n        location.href = url;\n      }\n    }\n  }\n\n  onGroupChanged = (groupID) => {\n    setTimeout(function(){\n      let url;\n      if (groupID) {\n        url = siteRoot + 'group/' + groupID + '/';\n      }\n      else {\n        url = siteRoot + 'groups/';\n      }\n      window.location = url.toString();\n    }, 1);\n  }\n\n  tabItemClick = (tabName, groupID) => {\n    let pathPrefix = [];\n    if (groupID || this.dirViewPanels.indexOf(tabName) > -1) {\n      pathPrefix = this.generatorPrefix(tabName, groupID);\n    }\n    this.setState({\n      currentTab: tabName,\n      pathPrefix: pathPrefix\n    }, () => {\n      let { currentTab, pathPrefix } = this.state;\n      window.history.replaceState({currentTab: currentTab, pathPrefix: pathPrefix}, null);\n    });\n    if (!Utils.isDesktop() && !this.state.isSidePanelClosed) {\n      this.setState({ isSidePanelClosed: true });\n    }\n  }\n\n  generatorPrefix = (tabName, groupID) => {\n    let pathPrefix = [];\n    if (groupID) {\n      let navTab1 = {\n        url: siteRoot + 'groups/',\n        showName: 'Groups',\n        name: 'groups',\n        id: null,\n      };\n      let navTab2 = {\n        url: siteRoot + 'group/' + groupID + '/',\n        showName: tabName,\n        name: tabName,\n        id: groupID,\n      };\n      pathPrefix.push(navTab1);\n      pathPrefix.push(navTab2);\n    } else {\n      let navTab = {\n        url: siteRoot + tabName + '/',\n        showName: this.getTabShowName(tabName),\n        name: tabName,\n        id: null,\n      };\n      pathPrefix.push(navTab);\n    }\n    return pathPrefix;\n  }\n\n  getTabShowName = (tabName) => {\n    if (tabName === 'my-libs') {\n      return 'Libraries';\n    }\n    if (tabName === 'shared-libs') {\n      return 'Shared with me';\n    }\n    if (tabName === 'org') {\n      return 'Shared with all';\n    }\n  }\n\n  toggleSidePanel = () => {\n    this.setState({\n      isSidePanelClosed: !this.state.isSidePanelClosed\n    });\n  }\n\n  render() {\n    let { currentTab, isSidePanelClosed } = this.state;\n\n    const home = canAddRepo ?\n      <MyLibraries path={ siteRoot } onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} /> :\n      <SharedLibrariesWrapper path={ siteRoot } onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />;\n\n    return (\n      <React.Fragment>\n        <SystemNotification />\n        <div id=\"main\">\n          <SidePanel isSidePanelClosed={this.state.isSidePanelClosed} onCloseSidePanel={this.onCloseSidePanel} currentTab={currentTab} tabItemClick={this.tabItemClick} draftCounts={this.state.draftCounts} />\n          <MainPanel>\n            <Router className=\"reach-router\">\n              {home}\n              <FilesActivitiesWrapper path={siteRoot + 'dashboard'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <DraftsViewWrapper path={siteRoot + 'drafts'}\n                onShowSidePanel={this.onShowSidePanel}\n                onSearchedClick={this.onSearchedClick}\n              >\n                <DraftContent\n                  path='/'\n                  getDrafts={this.getDrafts}\n                  isLoadingDraft={this.state.isLoadingDraft}\n                  draftList={this.state.draftList}\n                  updateDraftsList={this.updateDraftsList}\n                />\n              </DraftsViewWrapper>\n              <StarredWrapper path={siteRoot + 'starred'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <LinkedDevicesWrapper path={siteRoot + 'linked-devices'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <ShareAdminLibrariesWrapper path={siteRoot + 'share-admin-libs'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <ShareAdminFoldersWrapper path={siteRoot + 'share-admin-folders'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <ShareAdminShareLinks path={siteRoot + 'share-admin-share-links'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <ShareAdminUploadLinks path={siteRoot + 'share-admin-upload-links'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <SharedLibrariesWrapper path={siteRoot + 'shared-libs'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <SharedWithOCMWrapper path={siteRoot + 'shared-with-ocm'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <OCMViaWebdavWrapper path={siteRoot + 'ocm-via-webdav'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <MyLibraries path={siteRoot + 'my-libs'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <MyLibDeleted path={siteRoot + 'my-libs/deleted/'} onSearchedClick={this.onSearchedClick} />\n              <LibContentView path={siteRoot + 'library/:repoID/*'} pathPrefix={this.state.pathPrefix} onMenuClick={this.onShowSidePanel} onTabNavClick={this.tabItemClick}/>\n              <OCMRepoDir path={siteRoot + 'remote-library/:providerID/:repoID/*'} pathPrefix={this.state.pathPrefix} onMenuClick={this.onShowSidePanel} onTabNavClick={this.tabItemClick}/>\n              <Groups path={siteRoot + 'groups'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick}/>\n              <Group\n                path={siteRoot + 'group/:groupID'}\n                onShowSidePanel={this.onShowSidePanel}\n                onSearchedClick={this.onSearchedClick}\n                onTabNavClick={this.tabItemClick}\n                onGroupChanged={this.onGroupChanged}\n              />\n              <Wikis path={siteRoot + 'published'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick}/>\n              <PublicSharedView path={siteRoot + 'org/'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} onTabNavClick={this.tabItemClick}/>\n              <InvitationsView path={siteRoot + 'invitations/'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n            </Router>\n          </MainPanel>\n          <MediaQuery query=\"(max-width: 767.8px)\">\n            <Modal zIndex=\"1030\" isOpen={!isSidePanelClosed} toggle={this.toggleSidePanel} contentClassName=\"d-none\"></Modal>\n          </MediaQuery>\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n\nReactDom.render(<App />, document.getElementById('wrapper'));\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport listener from '../context-menu/globalEventListener';\nimport { Dropdown, ButtonDropdown, DropdownMenu, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  tagName: PropTypes.string,\n  item: PropTypes.object.isRequired,\n  toggleClass: PropTypes.string,\n  isHandleContextMenuEvent: PropTypes.bool,\n  getMenuList: PropTypes.func.isRequired,\n  onMenuItemClick: PropTypes.func.isRequired,\n  freezeItem: PropTypes.func,\n  unfreezeItem: PropTypes.func,\n};\n\nclass ItemDropdownMenu extends React.Component {\n\n  static defaultProps = {\n    isHandleContextMenuEvent: true,\n    toggleClass: 'sf2-icon-caret-down'\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      menuList: [],\n      isItemMenuShow: false,\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.isHandleContextMenuEvent) {\n      this.listenerId = listener.register(this.onShowMenu, this.onHideMenu);\n    }\n    let { item } = this.props;\n    let menuList = this.props.getMenuList(item);\n    this.setState({menuList: menuList});\n  }\n\n  componentWillReceiveProps(nextProps) {  // for toolbar item operation\n    let { item } = nextProps;\n    if (item.name !== this.props.item.name) {\n      let menuList = this.props.getMenuList(item);\n      this.setState({menuList: menuList});\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.props.isHandleContextMenuEvent && this.listenerId) {\n      listener.unregister(this.listenerId);\n    }\n  }\n\n  onShowMenu = () => {\n    // nothing todo\n  }\n\n  onHideMenu = () => {\n    if (this.state.isItemMenuShow) {\n      this.setState({isItemMenuShow: false});\n      if (typeof(this.props.unfreezeItem) === 'function') {\n        this.props.unfreezeItem();\n      }\n    }\n  }\n\n  onDropdownToggleKeyDown = (e) => {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      this.onDropdownToggleClick(e);\n    }\n  }\n\n  onDropdownToggleClick = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.toggleOperationMenu();\n  }\n\n  toggleOperationMenu = () => {\n    this.setState(\n      {isItemMenuShow: !this.state.isItemMenuShow},\n      () => {\n        if (this.state.isItemMenuShow && typeof(this.props.freezeItem) === 'function') {\n          this.props.freezeItem();\n        } else if (!this.state.isItemMenuShow && typeof(this.props.unfreezeItem) === 'function') {\n          this.props.unfreezeItem();\n        }\n      }\n    );\n  }\n\n  onMenuItemKeyDown = (e) => {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      this.onMenuItemClick(e);\n    }\n  }\n\n  onMenuItemClick = (event) => {\n    let operation = Utils.getEventData(event, 'toggle');\n    let item = this.props.item;\n    this.props.onMenuItemClick(operation, event, item);\n  }\n\n  render() {\n    let menuList = this.state.menuList;\n    let { toggleClass, tagName } = this.props;\n    toggleClass = 'sf-dropdown-toggle ' + toggleClass;\n\n    if (!menuList.length) {\n      return '';\n    }\n\n    if (tagName && tagName === 'button') {\n      return (\n        <ButtonDropdown isOpen={this.state.isItemMenuShow} toggle={this.onDropdownToggleClick}>\n          <DropdownToggle\n            className={toggleClass}\n            data-toggle=\"dropdown\"\n            title={gettext('More Operations')}\n            aria-label={gettext('More Operations')}\n            aria-expanded={this.state.isItemMenuShow}\n            onKeyDown={this.onDropdownToggleKeyDown}\n            // onClick={this.onDropdownToggleClick}\n          >\n          </DropdownToggle>\n          <DropdownMenu>\n            {menuList.map((menuItem, index) => {\n              if (menuItem === 'Divider') {\n                return <DropdownItem key={index} divider />;\n              } else {\n                return (\n                  <DropdownItem key={index} data-toggle={menuItem.key} onClick={this.onMenuItemClick} onKeyDown={this.onMenuItemKeyDown}>{menuItem.value}</DropdownItem>\n                );\n              }\n            })}\n          </DropdownMenu>\n        </ButtonDropdown>\n      );\n    }\n\n    return (\n      <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.onDropdownToggleClick} className=\"vam\">\n        <DropdownToggle\n          tag={tagName || 'i'}\n          role=\"button\"\n          tabIndex=\"0\"\n          className={toggleClass}\n          title={gettext('More Operations')}\n          data-toggle=\"dropdown\"\n          aria-expanded={this.state.isItemMenuShow}\n          aria-label={gettext('More Operations')}\n          onKeyDown={this.onDropdownToggleKeyDown}\n          // onClick={this.onDropdownToggleClick}\n        />\n        <DropdownMenu>\n          {menuList.map((menuItem, index) => {\n            if (menuItem === 'Divider') {\n              return <DropdownItem key={index} divider />;\n            } else {\n              return (\n                <DropdownItem key={index} data-toggle={menuItem.key} onClick={this.onMenuItemClick} onKeyDown={this.onMenuItemKeyDown}>{menuItem.value}</DropdownItem>\n              );\n            }\n          })}\n        </DropdownMenu>\n      </Dropdown>\n    );\n  }\n}\n\nItemDropdownMenu.propTypes = propTypes;\n\nexport default ItemDropdownMenu;\n","/**\n * Compiles a querystring\n * Returns string representation of the object\n *\n * @param {Object}\n * @api private\n */\n\nexports.encode = function (obj) {\n  var str = '';\n\n  for (var i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      if (str.length) str += '&';\n      str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\n    }\n  }\n\n  return str;\n};\n\n/**\n * Parses a simple querystring into an object\n *\n * @param {String} qs\n * @api private\n */\n\nexports.decode = function(qs){\n  var qry = {};\n  var pairs = qs.split('&');\n  for (var i = 0, l = pairs.length; i < l; i++) {\n    var pair = pairs[i].split('=');\n    qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n  }\n  return qry;\n};\n","\nmodule.exports = function(a, b){\n  var fn = function(){};\n  fn.prototype = b.prototype;\n  a.prototype = new fn;\n  a.prototype.constructor = a;\n};","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\n\nimport Lightbox from '@seafile/react-image-lightbox';\nimport '@seafile/react-image-lightbox/style.css';\n\nconst propTypes = {\n  imageItems: PropTypes.array.isRequired,\n  imageIndex: PropTypes.number.isRequired,\n  closeImagePopup: PropTypes.func.isRequired,\n  moveToPrevImage: PropTypes.func.isRequired,\n  moveToNextImage: PropTypes.func.isRequired\n};\n\nclass ImageDialog extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    const imageItems = this.props.imageItems;\n    const imageIndex = this.props.imageIndex;\n    const imageItemsLength = imageItems.length;\n    const name = imageItems[imageIndex].name;\n    const imageTitle = `${name} (${imageIndex + 1}/${imageItemsLength})`;\n\n    return (\n      <Lightbox\n        imageTitle={imageTitle}\n        mainSrc={imageItems[imageIndex].src}\n        nextSrc={imageItems[(imageIndex + 1) % imageItemsLength].src}\n        prevSrc={imageItems[(imageIndex + imageItemsLength - 1) % imageItemsLength].src}\n        onCloseRequest={this.props.closeImagePopup}\n        onMovePrevRequest={this.props.moveToPrevImage}\n        onMoveNextRequest={this.props.moveToNextImage}\n        imagePadding={70}\n        imageLoadErrorMessage={gettext('The image could not be loaded.')}\n        prevLabel={gettext('Previous (Left arrow key)')}\n        nextLabel={gettext('Next (Right arrow key)')}\n        closeLabel={gettext('Close (Esc)')}\n        zoomInLabel={gettext('Zoom in')}\n        zoomOutLabel={gettext('Zoom out')}\n      />\n    );\n  }\n}\n\nImageDialog.propTypes = propTypes;\n\nexport default ImageDialog;\n","\n/**\n * Module dependencies.\n */\n\nvar debug = require('debug')('socket.io-parser');\nvar Emitter = require('component-emitter');\nvar binary = require('./binary');\nvar isArray = require('isarray');\nvar isBuf = require('./is-buffer');\n\n/**\n * Protocol version.\n *\n * @api public\n */\n\nexports.protocol = 4;\n\n/**\n * Packet types.\n *\n * @api public\n */\n\nexports.types = [\n  'CONNECT',\n  'DISCONNECT',\n  'EVENT',\n  'ACK',\n  'ERROR',\n  'BINARY_EVENT',\n  'BINARY_ACK'\n];\n\n/**\n * Packet type `connect`.\n *\n * @api public\n */\n\nexports.CONNECT = 0;\n\n/**\n * Packet type `disconnect`.\n *\n * @api public\n */\n\nexports.DISCONNECT = 1;\n\n/**\n * Packet type `event`.\n *\n * @api public\n */\n\nexports.EVENT = 2;\n\n/**\n * Packet type `ack`.\n *\n * @api public\n */\n\nexports.ACK = 3;\n\n/**\n * Packet type `error`.\n *\n * @api public\n */\n\nexports.ERROR = 4;\n\n/**\n * Packet type 'binary event'\n *\n * @api public\n */\n\nexports.BINARY_EVENT = 5;\n\n/**\n * Packet type `binary ack`. For acks with binary arguments.\n *\n * @api public\n */\n\nexports.BINARY_ACK = 6;\n\n/**\n * Encoder constructor.\n *\n * @api public\n */\n\nexports.Encoder = Encoder;\n\n/**\n * Decoder constructor.\n *\n * @api public\n */\n\nexports.Decoder = Decoder;\n\n/**\n * A socket.io Encoder instance\n *\n * @api public\n */\n\nfunction Encoder() {}\n\nvar ERROR_PACKET = exports.ERROR + '\"encode error\"';\n\n/**\n * Encode a packet as a single string if non-binary, or as a\n * buffer sequence, depending on packet type.\n *\n * @param {Object} obj - packet object\n * @param {Function} callback - function to handle encodings (likely engine.write)\n * @return Calls callback with Array of encodings\n * @api public\n */\n\nEncoder.prototype.encode = function(obj, callback){\n  debug('encoding packet %j', obj);\n\n  if (exports.BINARY_EVENT === obj.type || exports.BINARY_ACK === obj.type) {\n    encodeAsBinary(obj, callback);\n  } else {\n    var encoding = encodeAsString(obj);\n    callback([encoding]);\n  }\n};\n\n/**\n * Encode packet as string.\n *\n * @param {Object} packet\n * @return {String} encoded\n * @api private\n */\n\nfunction encodeAsString(obj) {\n\n  // first is type\n  var str = '' + obj.type;\n\n  // attachments if we have them\n  if (exports.BINARY_EVENT === obj.type || exports.BINARY_ACK === obj.type) {\n    str += obj.attachments + '-';\n  }\n\n  // if we have a namespace other than `/`\n  // we append it followed by a comma `,`\n  if (obj.nsp && '/' !== obj.nsp) {\n    str += obj.nsp + ',';\n  }\n\n  // immediately followed by the id\n  if (null != obj.id) {\n    str += obj.id;\n  }\n\n  // json data\n  if (null != obj.data) {\n    var payload = tryStringify(obj.data);\n    if (payload !== false) {\n      str += payload;\n    } else {\n      return ERROR_PACKET;\n    }\n  }\n\n  debug('encoded %j as %s', obj, str);\n  return str;\n}\n\nfunction tryStringify(str) {\n  try {\n    return JSON.stringify(str);\n  } catch(e){\n    return false;\n  }\n}\n\n/**\n * Encode packet as 'buffer sequence' by removing blobs, and\n * deconstructing packet into object with placeholders and\n * a list of buffers.\n *\n * @param {Object} packet\n * @return {Buffer} encoded\n * @api private\n */\n\nfunction encodeAsBinary(obj, callback) {\n\n  function writeEncoding(bloblessData) {\n    var deconstruction = binary.deconstructPacket(bloblessData);\n    var pack = encodeAsString(deconstruction.packet);\n    var buffers = deconstruction.buffers;\n\n    buffers.unshift(pack); // add packet info to beginning of data list\n    callback(buffers); // write all the buffers\n  }\n\n  binary.removeBlobs(obj, writeEncoding);\n}\n\n/**\n * A socket.io Decoder instance\n *\n * @return {Object} decoder\n * @api public\n */\n\nfunction Decoder() {\n  this.reconstructor = null;\n}\n\n/**\n * Mix in `Emitter` with Decoder.\n */\n\nEmitter(Decoder.prototype);\n\n/**\n * Decodes an encoded packet string into packet JSON.\n *\n * @param {String} obj - encoded packet\n * @return {Object} packet\n * @api public\n */\n\nDecoder.prototype.add = function(obj) {\n  var packet;\n  if (typeof obj === 'string') {\n    if (this.reconstructor) {\n      throw new Error(\"got plaintext data when reconstructing a packet\");\n    }\n    packet = decodeString(obj);\n    if (exports.BINARY_EVENT === packet.type || exports.BINARY_ACK === packet.type) { // binary packet's json\n      this.reconstructor = new BinaryReconstructor(packet);\n\n      // no attachments, labeled binary but no binary data to follow\n      if (this.reconstructor.reconPack.attachments === 0) {\n        this.emit('decoded', packet);\n      }\n    } else { // non-binary full packet\n      this.emit('decoded', packet);\n    }\n  } else if (isBuf(obj) || obj.base64) { // raw binary data\n    if (!this.reconstructor) {\n      throw new Error('got binary data when not reconstructing a packet');\n    } else {\n      packet = this.reconstructor.takeBinaryData(obj);\n      if (packet) { // received final buffer\n        this.reconstructor = null;\n        this.emit('decoded', packet);\n      }\n    }\n  } else {\n    throw new Error('Unknown type: ' + obj);\n  }\n};\n\n/**\n * Decode a packet String (JSON data)\n *\n * @param {String} str\n * @return {Object} packet\n * @api private\n */\n\nfunction decodeString(str) {\n  var i = 0;\n  // look up type\n  var p = {\n    type: Number(str.charAt(0))\n  };\n\n  if (null == exports.types[p.type]) {\n    return error('unknown packet type ' + p.type);\n  }\n\n  // look up attachments if type binary\n  if (exports.BINARY_EVENT === p.type || exports.BINARY_ACK === p.type) {\n    var start = i + 1;\n    while (str.charAt(++i) !== '-' && i != str.length) {}\n    var buf = str.substring(start, i);\n    if (buf != Number(buf) || str.charAt(i) !== '-') {\n      throw new Error('Illegal attachments');\n    }\n    p.attachments = Number(buf);\n  }\n\n  // look up namespace (if any)\n  if ('/' === str.charAt(i + 1)) {\n    var start = i + 1;\n    while (++i) {\n      var c = str.charAt(i);\n      if (',' === c) break;\n      if (i === str.length) break;\n    }\n    p.nsp = str.substring(start, i);\n  } else {\n    p.nsp = '/';\n  }\n\n  // look up id\n  var next = str.charAt(i + 1);\n  if ('' !== next && Number(next) == next) {\n    var start = i + 1;\n    while (++i) {\n      var c = str.charAt(i);\n      if (null == c || Number(c) != c) {\n        --i;\n        break;\n      }\n      if (i === str.length) break;\n    }\n    p.id = Number(str.substring(start, i + 1));\n  }\n\n  // look up json data\n  if (str.charAt(++i)) {\n    var payload = tryParse(str.substr(i));\n    var isPayloadValid = payload !== false && (p.type === exports.ERROR || isArray(payload));\n    if (isPayloadValid) {\n      p.data = payload;\n    } else {\n      return error('invalid payload');\n    }\n  }\n\n  debug('decoded %s as %j', str, p);\n  return p;\n}\n\nfunction tryParse(str) {\n  try {\n    return JSON.parse(str);\n  } catch(e){\n    return false;\n  }\n}\n\n/**\n * Deallocates a parser's resources\n *\n * @api public\n */\n\nDecoder.prototype.destroy = function() {\n  if (this.reconstructor) {\n    this.reconstructor.finishedReconstruction();\n  }\n};\n\n/**\n * A manager of a binary event's 'buffer sequence'. Should\n * be constructed whenever a packet of type BINARY_EVENT is\n * decoded.\n *\n * @param {Object} packet\n * @return {BinaryReconstructor} initialized reconstructor\n * @api private\n */\n\nfunction BinaryReconstructor(packet) {\n  this.reconPack = packet;\n  this.buffers = [];\n}\n\n/**\n * Method to be called when binary data received from connection\n * after a BINARY_EVENT packet.\n *\n * @param {Buffer | ArrayBuffer} binData - the raw binary data received\n * @return {null | Object} returns null if more binary data is expected or\n *   a reconstructed packet object if all buffers have been received.\n * @api private\n */\n\nBinaryReconstructor.prototype.takeBinaryData = function(binData) {\n  this.buffers.push(binData);\n  if (this.buffers.length === this.reconPack.attachments) { // done with buffer list\n    var packet = binary.reconstructPacket(this.reconPack, this.buffers);\n    this.finishedReconstruction();\n    return packet;\n  }\n  return null;\n};\n\n/**\n * Cleans up binary packet reconstruction variables.\n *\n * @api private\n */\n\nBinaryReconstructor.prototype.finishedReconstruction = function() {\n  this.reconPack = null;\n  this.buffers = [];\n};\n\nfunction error(msg) {\n  return {\n    type: exports.ERROR,\n    data: 'parser error: ' + msg\n  };\n}\n","// browser shim for xmlhttprequest module\n\nvar hasCORS = require('has-cors');\nvar globalThis = require('../globalThis');\n\nmodule.exports = function (opts) {\n  var xdomain = opts.xdomain;\n\n  // scheme must be same when usign XDomainRequest\n  // http://blogs.msdn.com/b/ieinternals/archive/2010/05/13/xdomainrequest-restrictions-limitations-and-workarounds.aspx\n  var xscheme = opts.xscheme;\n\n  // XDomainRequest has a flow of not sending cookie, therefore it should be disabled as a default.\n  // https://github.com/Automattic/engine.io-client/pull/217\n  var enablesXDR = opts.enablesXDR;\n\n  // XMLHttpRequest can be disabled on IE\n  try {\n    if ('undefined' !== typeof XMLHttpRequest && (!xdomain || hasCORS)) {\n      return new XMLHttpRequest();\n    }\n  } catch (e) { }\n\n  // Use XDomainRequest for IE8 if enablesXDR is true\n  // because loading bar keeps flashing when using jsonp-polling\n  // https://github.com/yujiosaka/socke.io-ie8-loading-example\n  try {\n    if ('undefined' !== typeof XDomainRequest && !xscheme && enablesXDR) {\n      return new XDomainRequest();\n    }\n  } catch (e) { }\n\n  if (!xdomain) {\n    try {\n      return new globalThis[['Active'].concat('Object').join('X')]('Microsoft.XMLHTTP');\n    } catch (e) { }\n  }\n};\n","module.exports = (function () {\n  if (typeof self !== 'undefined') {\n    return self;\n  } else if (typeof window !== 'undefined') {\n    return window;\n  } else {\n    return Function('return this')(); // eslint-disable-line no-new-func\n  }\n})();\n","/**\n * Module dependencies.\n */\n\nvar parser = require('engine.io-parser');\nvar Emitter = require('component-emitter');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Transport;\n\n/**\n * Transport abstract constructor.\n *\n * @param {Object} options.\n * @api private\n */\n\nfunction Transport (opts) {\n  this.path = opts.path;\n  this.hostname = opts.hostname;\n  this.port = opts.port;\n  this.secure = opts.secure;\n  this.query = opts.query;\n  this.timestampParam = opts.timestampParam;\n  this.timestampRequests = opts.timestampRequests;\n  this.readyState = '';\n  this.agent = opts.agent || false;\n  this.socket = opts.socket;\n  this.enablesXDR = opts.enablesXDR;\n  this.withCredentials = opts.withCredentials;\n\n  // SSL options for Node.js client\n  this.pfx = opts.pfx;\n  this.key = opts.key;\n  this.passphrase = opts.passphrase;\n  this.cert = opts.cert;\n  this.ca = opts.ca;\n  this.ciphers = opts.ciphers;\n  this.rejectUnauthorized = opts.rejectUnauthorized;\n  this.forceNode = opts.forceNode;\n\n  // results of ReactNative environment detection\n  this.isReactNative = opts.isReactNative;\n\n  // other options for Node.js client\n  this.extraHeaders = opts.extraHeaders;\n  this.localAddress = opts.localAddress;\n}\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Transport.prototype);\n\n/**\n * Emits an error.\n *\n * @param {String} str\n * @return {Transport} for chaining\n * @api public\n */\n\nTransport.prototype.onError = function (msg, desc) {\n  var err = new Error(msg);\n  err.type = 'TransportError';\n  err.description = desc;\n  this.emit('error', err);\n  return this;\n};\n\n/**\n * Opens the transport.\n *\n * @api public\n */\n\nTransport.prototype.open = function () {\n  if ('closed' === this.readyState || '' === this.readyState) {\n    this.readyState = 'opening';\n    this.doOpen();\n  }\n\n  return this;\n};\n\n/**\n * Closes the transport.\n *\n * @api private\n */\n\nTransport.prototype.close = function () {\n  if ('opening' === this.readyState || 'open' === this.readyState) {\n    this.doClose();\n    this.onClose();\n  }\n\n  return this;\n};\n\n/**\n * Sends multiple packets.\n *\n * @param {Array} packets\n * @api private\n */\n\nTransport.prototype.send = function (packets) {\n  if ('open' === this.readyState) {\n    this.write(packets);\n  } else {\n    throw new Error('Transport not open');\n  }\n};\n\n/**\n * Called upon open\n *\n * @api private\n */\n\nTransport.prototype.onOpen = function () {\n  this.readyState = 'open';\n  this.writable = true;\n  this.emit('open');\n};\n\n/**\n * Called with data.\n *\n * @param {String} data\n * @api private\n */\n\nTransport.prototype.onData = function (data) {\n  var packet = parser.decodePacket(data, this.socket.binaryType);\n  this.onPacket(packet);\n};\n\n/**\n * Called with a decoded packet.\n */\n\nTransport.prototype.onPacket = function (packet) {\n  this.emit('packet', packet);\n};\n\n/**\n * Called upon close.\n *\n * @api private\n */\n\nTransport.prototype.onClose = function () {\n  this.readyState = 'closed';\n  this.emit('close');\n};\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, ModalHeader, ModalBody, ModalFooter, Input } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  onRepoTagCreated: PropTypes.func,\n  toggleCancel: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired\n};\n\nclass CreateTagDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      tagName: '',\n      tagColor: '',\n      newTag: {},\n      errorMsg: '',\n      colorList: ['#FBD44A', '#EAA775', '#F4667C', '#DC82D2', '#9860E5', '#9F8CF1', '#59CB74', '#ADDF84', '#89D2EA', '#4ECCCB', '#46A1FD', '#C2C2C2'],\n    };\n  }\n\n  inputNewName = (e) => {\n    this.setState({\n      tagName: e.target.value,\n    });\n    if (this.state.errorMsg) {\n      this.setState({errorMsg: ''});\n    }\n  }\n\n  selectTagcolor = (e) => {\n    this.setState({\n      tagColor: e.target.value,\n    });\n  }\n\n  createTag = () => {\n    let name = this.state.tagName;\n    let color = this.state.tagColor;\n    let repoID = this.props.repoID;\n    seafileAPI.createRepoTag(repoID, name, color).then((res) => {\n      let repoTagID = res.data.repo_tag.repo_tag_id;\n      if (this.props.onRepoTagCreated) this.props.onRepoTagCreated(repoTagID);\n      this.props.toggleCancel();\n    }).catch((error) => {\n      let errMessage;\n      if (error.response.status === 500) {\n        errMessage = gettext('Internal Server Error');\n      } else if (error.response.status === 400) {\n        errMessage = gettext('Tag \"{name}\" already exists.');\n        errMessage = errMessage.replace('{name}', Utils.HTMLescape(name));\n      }\n      this.setState({errorMsg: errMessage});\n    });\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.createTag();\n    }\n  }\n\n  componentDidMount() {\n    this.setState({\n      tagColor: this.state.colorList[0]\n    });\n  }\n\n  render() {\n    let colorList = this.state.colorList;\n    let canSave = this.state.tagName.trim() ? true : false;\n    return (\n      <Fragment>\n        <ModalHeader toggle={this.props.onClose}>\n          <span className=\"tag-dialog-back fas fa-sm fa-arrow-left\" onClick={this.props.toggleCancel} aria-label={gettext('Back')}></span>\n          {gettext('New Tag')}\n        </ModalHeader>\n        <ModalBody>\n          <div role=\"form\" className=\"tag-create\">\n            <div className=\"form-group\">\n              <label className=\"form-label\">{gettext('Name')}</label>\n              <Input onKeyPress={this.handleKeyPress} autoFocus={true} value={this.state.tagName} onChange={this.inputNewName}/>\n              <div className=\"mt-2\"><span className=\"error\">{this.state.errorMsg}</span></div>\n            </div>\n            <div className=\"form-group\">\n              <label className=\"form-label\">{gettext('Select a color')}</label>\n              <div className=\"d-flex justify-content-between\">\n                {colorList.map((item, index)=>{\n                  return (\n                    <div key={index} className=\"tag-color-option\" onChange={this.selectTagcolor}>\n                      <label className=\"colorinput\">\n                        {index===0 ?\n                          <input name=\"color\" type=\"radio\" value={item} className=\"colorinput-input\" defaultChecked onClick={this.selectTagcolor}></input> :\n                          <input name=\"color\" type=\"radio\" value={item} className=\"colorinput-input\" onClick={this.selectTagcolor}></input>}\n                        <span className=\"colorinput-color rounded-circle d-flex align-items-center justify-content-center\" style={{backgroundColor:item}}>\n                          <i className=\"fas fa-check color-selected\"></i>\n                        </span>\n                      </label>\n                    </div>\n                  );\n                })\n                }\n              </div>\n            </div>\n          </div>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleCancel}>{gettext('Cancel')}</Button>\n          {canSave ?\n            <Button color=\"primary\" onClick={this.createTag}>{gettext('Save')}</Button> :\n            <Button color=\"primary\" disabled>{gettext('Save')}</Button>\n          }\n        </ModalFooter>\n      </Fragment>\n    );\n  }\n}\n\nCreateTagDialog.propTypes = propTypes;\n\nexport default CreateTagDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button } from 'reactstrap';\nimport copy from '../copy-to-clipboard';\nimport { gettext } from '../../utils/constants';\nimport toaster from '../../components/toast';\n\nconst propTypes = {\n  link: PropTypes.string.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass ShareAdminLink extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n copyToClipboard = () => {\n   copy(this.props.link);\n   this.props.toggleDialog();\n   toaster.success(gettext('The link is copied to the clipboard.')), {duration: 2};\n }\n\n render() {\n   const { link, toggleDialog } = this.props;\n   return (\n     <Modal isOpen={true} toggle={toggleDialog}>\n       <ModalHeader toggle={toggleDialog}>{gettext('Link')}</ModalHeader>\n       <ModalBody>\n         <a href={link}>{link}</a>\n       </ModalBody>\n       <ModalFooter>\n         <Button color=\"primary\" onClick={this.copyToClipboard}>{gettext('Copy')}</Button>\n         <Button color=\"secondary\" onClick={toggleDialog}>{gettext('Close')}</Button>\n       </ModalFooter>\n     </Modal>\n   );\n }\n}\n\nShareAdminLink.propTypes = propTypes;\n\nexport default ShareAdminLink;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport moment from 'moment';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  currentTag: PropTypes.object.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired,\n  updateUsedRepoTags: PropTypes.func,\n  onFileTagChanged: PropTypes.func,\n  shareLinkToken: PropTypes.string,\n  enableFileDownload: PropTypes.bool\n};\n\nclass ListTaggedFilesDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      taggedFileList: [],\n    };\n  }\n\n  onFileTagChanged = (TaggedFile) => {\n    const path = TaggedFile.parent_path;\n    const dirent = {name: TaggedFile.filename};\n    let direntPath = path === '/' ? path + TaggedFile.filename : path + '/' + TaggedFile.filename;\n    this.props.onFileTagChanged(dirent, direntPath);\n  }\n\n  onDeleteTaggedFile = (taggedFile) => {\n    let repoID = this.props.repoID;\n    let fileTagID = taggedFile.file_tag_id;\n    seafileAPI.deleteFileTag(repoID, fileTagID).then(res => {\n      this.getTaggedFiles();\n      this.props.updateUsedRepoTags();\n      if ((this.props.onFileTagChanged) && !taggedFile.file_deleted) this.onFileTagChanged(taggedFile);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  componentDidMount() {\n    this.getTaggedFiles();\n  }\n\n  getTaggedFiles = () => {\n    let { repoID, currentTag, shareLinkToken } = this.props;\n    let request = shareLinkToken ?\n      seafileAPI.getShareLinkTaggedFiles(shareLinkToken, currentTag.id) :\n      seafileAPI.listTaggedFiles(repoID, currentTag.id);\n    request.then(res => {\n      let taggedFileList = [];\n      res.data.tagged_files !== undefined &&\n      res.data.tagged_files.forEach(file => {\n        let taggedFile = file;\n        taggedFileList.push(taggedFile);\n      });\n      this.setState({\n        taggedFileList: taggedFileList,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    let taggedFileList = this.state.taggedFileList;\n    return (\n      <Modal isOpen={true} style={{maxWidth: '678px'}}>\n        <ModalHeader toggle={this.props.onClose}>{gettext('Tagged Files')}</ModalHeader>\n        <ModalBody className=\"dialog-list-container\">\n          <table>\n            <thead>\n              <tr>\n                <th width='50%' className=\"ellipsis\">{gettext('Name')}</th>\n                <th width='20%'>{gettext('Size')}</th>\n                <th width='22%'>{gettext('Last Update')}</th>\n                <th width='8%'></th>\n              </tr>\n            </thead>\n            <tbody>\n              {taggedFileList.map((taggedFile, index) => {\n                return (\n                  <TaggedFile\n                    key={index}\n                    repoID={this.props.repoID}\n                    taggedFile={taggedFile}\n                    onDeleteTaggedFile={this.onDeleteTaggedFile}\n                    shareLinkToken={this.props.shareLinkToken}\n                    enableFileDownload={this.props.enableFileDownload}\n                  />\n                );\n              })}\n            </tbody>\n          </table>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleCancel}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nListTaggedFilesDialog.propTypes = propTypes;\n\nexport default ListTaggedFilesDialog;\n\nconst TaggedFilePropTypes = {\n  repoID: PropTypes.string.isRequired,\n  taggedFile: PropTypes.object,\n  onDeleteTaggedFile: PropTypes.func.isRequired,\n  shareLinkToken: PropTypes.string,\n  enableFileDownload: PropTypes.bool\n};\n\nclass TaggedFile extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = ({\n      active: false,\n    });\n  }\n\n  onMouseEnter = () => {\n    this.setState({\n      active: true\n    });\n  }\n\n  onMouseLeave = () => {\n    this.setState({\n      active: false\n    });\n  }\n\n  deleteFile = (e) => {\n    e.preventDefault();\n    this.props.onDeleteTaggedFile(this.props.taggedFile);\n  }\n\n  render() {\n    const { taggedFile, shareLinkToken, enableFileDownload } = this.props;\n\n    let path = taggedFile.parent_path ? Utils.joinPath(taggedFile.parent_path, taggedFile.filename) : '';\n    let href = shareLinkToken ?\n      siteRoot + 'd/' + shareLinkToken + '/files/?p=' + Utils.encodePath(path) :\n      siteRoot + 'lib/' + this.props.repoID + '/file' + Utils.encodePath(path);\n\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter}>\n        {taggedFile.file_deleted ?\n          <Fragment>\n            <td colSpan='3' className=\"name\">{taggedFile.filename}{' '}\n              <span style={{color:'red'}}>{gettext('deleted')}</span>\n            </td>\n          </Fragment>\n          :\n          <Fragment>\n            <td><a href={href} target='_blank' className=\"d-inline-block w-100 ellipsis\" title={taggedFile.filename} rel=\"noreferrer\">{taggedFile.filename}</a></td>\n            <td>{Utils.bytesToSize(taggedFile.size)}</td>\n            <td>{moment.unix(taggedFile.mtime).fromNow()}</td>\n          </Fragment>\n        }\n        <td>\n          {!shareLinkToken &&\n            <a href=\"#\" role=\"button\" aria-label={gettext('Delete')} title={gettext('Delete')} className={`action-icon sf2-icon-x3${this.state.active ? '' : ' invisible'}`} onClick={this.deleteFile}></a>\n          }\n          {(shareLinkToken && enableFileDownload) &&\n            <a className={`action-icon sf2-icon-download${this.state.active ? '' : ' invisible'}`} href={`${href}&dl=1`} title={gettext('Download')} aria-label={gettext('Download')}></a>\n          }\n        </td>\n      </tr>\n    );\n  }\n}\n\nTaggedFile.propTypes = TaggedFilePropTypes;\n","import moment from 'moment';\n\nclass Draft {\n\n  constructor(item) {\n    this.created = item.created_at;\n    this.createdStr = moment((new Date(item.created_at)).getTime()).format('YYYY-MM-DD HH:mm');\n    this.id = item.id;\n    this.ownerNickname = item.owner_nickname;\n    this.originRepoID = item.origin_repo_id;\n    this.draftFilePath = item.draft_file_path;\n  }\n}\n\nexport default Draft;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport moment from 'moment';\nimport editorUtilities from '../../utils/editor-utilities';\nimport toaster from '../../components/toast';\nimport { Utils } from '../../utils/utils';\nimport Draft from '../../models/draft';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  toggle: PropTypes.func.isRequired,\n};\n\nclass ListRepoDraftsDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      drafts: [],\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepoDrafts(this.props.repoID).then(res => {\n      let drafts = res.data.drafts.map(item => {\n        let draft = new Draft(item);\n        return draft;\n      });\n      this.setState({\n        drafts: drafts\n      });\n    });\n  }\n\n  onDeleteDraftItem = (draft) => {\n    editorUtilities.deleteDraft(draft.id).then(() => {\n      let drafts = this.state.drafts.filter(item => {\n        return item.id !== draft.id;\n      });\n      this.setState({drafts: drafts});\n      let msg = gettext('Successfully deleted draft %(draft)s.');\n      msg = msg.replace('%(draft)s', draft.draftFilePath);\n      toaster.success(msg);\n    }).catch(() => {\n      let msg = gettext('Failed to delete draft %(draft)s.');\n      msg = msg.replace('%(draft)s', draft.draftFilePath);\n      toaster.danger(msg);\n    });\n  }\n\n  toggle = () => {\n    this.props.toggle();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.toggle}>{gettext('Drafts')}</ModalHeader>\n        <ModalBody className=\"dialog-list-container\">\n          <table>\n            <thead>\n              <tr>\n                <th width='50%' className=\"ellipsis\">{gettext('Name')}</th>\n                <th width='20%'>{gettext('Owner')}</th>\n                <th width='20%'>{gettext('Last Update')}</th>\n                <th width='10%'></th>\n              </tr>\n            </thead>\n            <tbody>\n              {this.state.drafts.map((item, index) => {\n                return (\n                  <DraftItem\n                    key={index}\n                    draftItem={item}\n                    onDeleteDraftItem={this.onDeleteDraftItem}\n                  />\n                );\n              })}\n            </tbody>\n          </table>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nListRepoDraftsDialog.propTypes = propTypes;\n\nexport default ListRepoDraftsDialog;\n\nconst DraftItemPropTypes = {\n  draftItem: PropTypes.object,\n  onDeleteDraftItem: PropTypes.func.isRequired,\n};\n\nclass DraftItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = ({\n      active: false,\n    });\n  }\n\n  onMouseEnter = () => {\n    this.setState({\n      active: true\n    });\n  }\n\n  onMouseLeave = () => {\n    this.setState({\n      active: false\n    });\n  }\n\n  render() {\n    const draftItem = this.props.draftItem;\n    let href = siteRoot + 'drafts/' + draftItem.id + '/';\n    let className = this.state.active ? 'action-icon sf2-icon-x3' : 'action-icon vh sf2-icon-x3';\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td className=\"name\">\n          <a href={href} target='_blank'>{Utils.getFileName(draftItem.draftFilePath)}</a>\n        </td>\n        <td>{draftItem.ownerNickname}</td>\n        <td>{moment(draftItem.createdStr).fromNow()}</td>\n        <td>\n          <i className={className} onClick={this.props.onDeleteDraftItem.bind(this, draftItem)}></i>\n        </td>\n      </tr>\n    );\n  }\n}\n\nDraftItem.propTypes = DraftItemPropTypes;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { MarkdownViewer } from '@seafile/seafile-editor';\nimport Loading from '../../components/loading';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, mediaUrl } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  filePath: PropTypes.string.isRequired,\n  fileName: PropTypes.string.isRequired,\n  href: PropTypes.string,\n  toggleCancel: PropTypes.func.isRequired,\n};\n\nclass ReadmeDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      readmeContent: null,\n      isLoading: true,\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.getFileDownloadLink(this.props.repoID, this.props.filePath).then(res => {\n      seafileAPI.getFileContent(res.data).then(res => {\n        this.setState({\n          readmeContent: res.data,\n          isLoading: false,\n        });\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleCancel} className=\"readme-dialog\" size=\"lg\">\n        <ModalHeader>{this.props.fileName}\n          <a className=\"readme-dialog-edit\" href={this.props.href} target='_blank'><i className=\"fa fa-pencil-alt\"></i></a>\n        </ModalHeader>\n        <ModalBody>\n          {this.state.isLoading ?\n            <Loading />:\n            <MarkdownViewer\n              markdownContent={this.state.readmeContent}\n              showTOC={false}\n              scriptSource={mediaUrl + 'js/mathjax/tex-svg.js'}\n            />\n          }\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleCancel}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nReadmeDialog.propTypes = propTypes;\n\nexport default ReadmeDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport ModalPortal from './modal-portal';\nimport ListTaggedFilesDialog from './dialog/list-taggedfiles-dialog';\nimport ListRepoDraftsDialog from './dialog/list-repo-drafts-dialog';\nimport ReadmeDialog from './dialog/readme-dialog';\nimport { siteRoot, gettext } from '../utils/constants';\nimport { Utils } from '../utils/utils';\n\nimport '../css/repo-info-bar.css';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  usedRepoTags: PropTypes.array.isRequired,\n  readmeMarkdown: PropTypes.object,\n  draftCounts: PropTypes.number,\n  updateUsedRepoTags: PropTypes.func,\n  onFileTagChanged: PropTypes.func,\n  className: PropTypes.string,\n  shareLinkToken: PropTypes.string,\n  enableFileDownload: PropTypes.bool\n};\n\nclass RepoInfoBar extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentTag: null,\n      isListTaggedFileShow: false,\n      showRepoDrafts: false,\n      showReadmeDialog: false,\n    };\n  }\n\n  onListTaggedFiles = (currentTag) => {\n    this.setState({\n      currentTag: currentTag,\n      isListTaggedFileShow: !this.state.isListTaggedFileShow,\n    });\n  }\n\n  onCloseDialog = () => {\n    this.setState({\n      isListTaggedFileShow: false\n    });\n  }\n\n  toggleDrafts = () => {\n    this.setState({\n      showRepoDrafts: !this.state.showRepoDrafts\n    });\n  }\n\n  toggleReadme = () => {\n    this.setState({\n      showReadmeDialog: !this.state.showReadmeDialog\n    });\n  }\n\n  render() {\n    let { repoID, currentPath, usedRepoTags, readmeMarkdown, draftCounts, className } = this.props;\n\n    // to be compatible with the existing code\n    if (readmeMarkdown === undefined) {\n      readmeMarkdown = null;\n    }\n    if (draftCounts === undefined) {\n      draftCounts = 0;\n    }\n\n    let href = readmeMarkdown !== null ? siteRoot + 'lib/' + repoID + '/file' + Utils.joinPath(currentPath, readmeMarkdown.name) +  '?mode=edit' : '';\n    let filePath = readmeMarkdown !== null ? currentPath + readmeMarkdown.name : '';\n    return (\n      <div className={`repo-info-bar ${className ? className : ''}`}>\n        {usedRepoTags.length > 0 && (\n          <ul className=\"used-tag-list\">\n            {usedRepoTags.map((usedRepoTag) => {\n              return (\n                <li key={usedRepoTag.id} className=\"used-tag-item\">\n                  <span className=\"used-tag\" style={{backgroundColor:usedRepoTag.color}}></span>\n                  <span className=\"used-tag-name\" title={usedRepoTag.name}>{usedRepoTag.name}</span>\n                  <button type=\"button\" className=\"used-tag-files border-0 bg-transparent\" onClick={this.onListTaggedFiles.bind(this, usedRepoTag)}>\n                    {usedRepoTag.fileCount > 1 ? usedRepoTag.fileCount + ' files' : usedRepoTag.fileCount + ' file'}\n                  </button>\n                </li>\n              );\n            })}\n          </ul>\n        )}\n        <div className={(usedRepoTags.length > 0 && readmeMarkdown) ? 'file-info-list mt-1' : 'file-info-list'}>\n          {(readmeMarkdown !== null && parseInt(readmeMarkdown.size) > 1) &&\n            <span className=\"file-info\" onClick={this.toggleReadme}>\n              <span className=\"info-icon sf2-icon-readme\"></span>\n              <span className=\"used-tag-name\">{readmeMarkdown.name}</span>\n            </span>\n          }\n          {(readmeMarkdown !== null && parseInt(readmeMarkdown.size) < 2) &&\n            <span className=\"file-info\">\n              <span className=\"info-icon sf2-icon-readme\"></span>\n              <a className=\"used-tag-name\" href={href} target='_blank' rel=\"noreferrer\">{readmeMarkdown.name}</a>\n            </span>\n          }\n          {draftCounts > 0 &&\n            <span className=\"file-info\">\n              <span className=\"info-icon sf2-icon-drafts\"></span>\n              <span className=\"used-tag-name\">{gettext('draft')}</span>\n              <button type=\"button\" className=\"used-tag-files border-0 bg-transparent\" onClick={this.toggleDrafts}>\n                {draftCounts > 1 ? draftCounts + ' files' : draftCounts + ' file'}\n              </button>\n            </span>\n          }\n        </div>\n        {this.state.isListTaggedFileShow && (\n          <ModalPortal>\n            <ListTaggedFilesDialog\n              repoID={repoID}\n              currentTag={this.state.currentTag}\n              onClose={this.onCloseDialog}\n              toggleCancel={this.onListTaggedFiles}\n              updateUsedRepoTags={this.props.updateUsedRepoTags}\n              onFileTagChanged={this.props.onFileTagChanged}\n              shareLinkToken={this.props.shareLinkToken}\n              enableFileDownload={this.props.enableFileDownload}\n            />\n          </ModalPortal>\n        )}\n\n        {this.state.showRepoDrafts && (\n          <ModalPortal>\n            <ListRepoDraftsDialog\n              toggle={this.toggleDrafts}\n              repoID={this.props.repoID}\n            />\n          </ModalPortal>\n        )}\n\n        {this.state.showReadmeDialog && (\n          <ModalPortal>\n            <ReadmeDialog\n              toggleCancel={this.toggleReadme}\n              repoID={repoID}\n              filePath={filePath}\n              href={href}\n              fileName={readmeMarkdown.name}\n            />\n          </ModalPortal>\n        )}\n      </div>\n    );\n  }\n}\n\nRepoInfoBar.propTypes = propTypes;\n\nexport default RepoInfoBar;\n","/**\n * Parses an URI\n *\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\n * @api private\n */\n\nvar re = /^(?:(?![^:@]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\n\nvar parts = [\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\n];\n\nmodule.exports = function parseuri(str) {\n    var src = str,\n        b = str.indexOf('['),\n        e = str.indexOf(']');\n\n    if (b != -1 && e != -1) {\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\n    }\n\n    var m = re.exec(str || ''),\n        uri = {},\n        i = 14;\n\n    while (i--) {\n        uri[parts[i]] = m[i] || '';\n    }\n\n    if (b != -1 && e != -1) {\n        uri.source = src;\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\n        uri.ipv6uri = true;\n    }\n\n    uri.pathNames = pathNames(uri, uri['path']);\n    uri.queryKey = queryKey(uri, uri['query']);\n\n    return uri;\n};\n\nfunction pathNames(obj, path) {\n    var regx = /\\/{2,9}/g,\n        names = path.replace(regx, \"/\").split(\"/\");\n\n    if (path.substr(0, 1) == '/' || path.length === 0) {\n        names.splice(0, 1);\n    }\n    if (path.substr(path.length - 1, 1) == '/') {\n        names.splice(names.length - 1, 1);\n    }\n\n    return names;\n}\n\nfunction queryKey(uri, query) {\n    var data = {};\n\n    query.replace(/(?:^|&)([^&=]*)=?([^&]*)/g, function ($0, $1, $2) {\n        if ($1) {\n            data[$1] = $2;\n        }\n    });\n\n    return data;\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","\nmodule.exports = isBuf;\n\nvar withNativeBuffer = typeof Buffer === 'function' && typeof Buffer.isBuffer === 'function';\nvar withNativeArrayBuffer = typeof ArrayBuffer === 'function';\n\nvar isView = function (obj) {\n  return typeof ArrayBuffer.isView === 'function' ? ArrayBuffer.isView(obj) : (obj.buffer instanceof ArrayBuffer);\n};\n\n/**\n * Returns true if obj is a buffer or an arraybuffer.\n *\n * @api private\n */\n\nfunction isBuf(obj) {\n  return (withNativeBuffer && Buffer.isBuffer(obj)) ||\n          (withNativeArrayBuffer && (obj instanceof ArrayBuffer || isView(obj)));\n}\n","\n/**\n * Module dependencies.\n */\n\nvar eio = require('engine.io-client');\nvar Socket = require('./socket');\nvar Emitter = require('component-emitter');\nvar parser = require('socket.io-parser');\nvar on = require('./on');\nvar bind = require('component-bind');\nvar debug = require('debug')('socket.io-client:manager');\nvar indexOf = require('indexof');\nvar Backoff = require('backo2');\n\n/**\n * IE6+ hasOwnProperty\n */\n\nvar has = Object.prototype.hasOwnProperty;\n\n/**\n * Module exports\n */\n\nmodule.exports = Manager;\n\n/**\n * `Manager` constructor.\n *\n * @param {String} engine instance or engine uri/opts\n * @param {Object} options\n * @api public\n */\n\nfunction Manager (uri, opts) {\n  if (!(this instanceof Manager)) return new Manager(uri, opts);\n  if (uri && ('object' === typeof uri)) {\n    opts = uri;\n    uri = undefined;\n  }\n  opts = opts || {};\n\n  opts.path = opts.path || '/socket.io';\n  this.nsps = {};\n  this.subs = [];\n  this.opts = opts;\n  this.reconnection(opts.reconnection !== false);\n  this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n  this.reconnectionDelay(opts.reconnectionDelay || 1000);\n  this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n  this.randomizationFactor(opts.randomizationFactor || 0.5);\n  this.backoff = new Backoff({\n    min: this.reconnectionDelay(),\n    max: this.reconnectionDelayMax(),\n    jitter: this.randomizationFactor()\n  });\n  this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n  this.readyState = 'closed';\n  this.uri = uri;\n  this.connecting = [];\n  this.lastPing = null;\n  this.encoding = false;\n  this.packetBuffer = [];\n  var _parser = opts.parser || parser;\n  this.encoder = new _parser.Encoder();\n  this.decoder = new _parser.Decoder();\n  this.autoConnect = opts.autoConnect !== false;\n  if (this.autoConnect) this.open();\n}\n\n/**\n * Propagate given event to sockets and emit on `this`\n *\n * @api private\n */\n\nManager.prototype.emitAll = function () {\n  this.emit.apply(this, arguments);\n  for (var nsp in this.nsps) {\n    if (has.call(this.nsps, nsp)) {\n      this.nsps[nsp].emit.apply(this.nsps[nsp], arguments);\n    }\n  }\n};\n\n/**\n * Update `socket.id` of all sockets\n *\n * @api private\n */\n\nManager.prototype.updateSocketIds = function () {\n  for (var nsp in this.nsps) {\n    if (has.call(this.nsps, nsp)) {\n      this.nsps[nsp].id = this.generateId(nsp);\n    }\n  }\n};\n\n/**\n * generate `socket.id` for the given `nsp`\n *\n * @param {String} nsp\n * @return {String}\n * @api private\n */\n\nManager.prototype.generateId = function (nsp) {\n  return (nsp === '/' ? '' : (nsp + '#')) + this.engine.id;\n};\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Manager.prototype);\n\n/**\n * Sets the `reconnection` config.\n *\n * @param {Boolean} true/false if it should automatically reconnect\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnection = function (v) {\n  if (!arguments.length) return this._reconnection;\n  this._reconnection = !!v;\n  return this;\n};\n\n/**\n * Sets the reconnection attempts config.\n *\n * @param {Number} max reconnection attempts before giving up\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionAttempts = function (v) {\n  if (!arguments.length) return this._reconnectionAttempts;\n  this._reconnectionAttempts = v;\n  return this;\n};\n\n/**\n * Sets the delay between reconnections.\n *\n * @param {Number} delay\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionDelay = function (v) {\n  if (!arguments.length) return this._reconnectionDelay;\n  this._reconnectionDelay = v;\n  this.backoff && this.backoff.setMin(v);\n  return this;\n};\n\nManager.prototype.randomizationFactor = function (v) {\n  if (!arguments.length) return this._randomizationFactor;\n  this._randomizationFactor = v;\n  this.backoff && this.backoff.setJitter(v);\n  return this;\n};\n\n/**\n * Sets the maximum delay between reconnections.\n *\n * @param {Number} delay\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionDelayMax = function (v) {\n  if (!arguments.length) return this._reconnectionDelayMax;\n  this._reconnectionDelayMax = v;\n  this.backoff && this.backoff.setMax(v);\n  return this;\n};\n\n/**\n * Sets the connection timeout. `false` to disable\n *\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.timeout = function (v) {\n  if (!arguments.length) return this._timeout;\n  this._timeout = v;\n  return this;\n};\n\n/**\n * Starts trying to reconnect if reconnection is enabled and we have not\n * started reconnecting yet\n *\n * @api private\n */\n\nManager.prototype.maybeReconnectOnOpen = function () {\n  // Only try to reconnect if it's the first time we're connecting\n  if (!this.reconnecting && this._reconnection && this.backoff.attempts === 0) {\n    // keeps reconnection from firing twice for the same reconnection loop\n    this.reconnect();\n  }\n};\n\n/**\n * Sets the current transport `socket`.\n *\n * @param {Function} optional, callback\n * @return {Manager} self\n * @api public\n */\n\nManager.prototype.open =\nManager.prototype.connect = function (fn, opts) {\n  debug('readyState %s', this.readyState);\n  if (~this.readyState.indexOf('open')) return this;\n\n  debug('opening %s', this.uri);\n  this.engine = eio(this.uri, this.opts);\n  var socket = this.engine;\n  var self = this;\n  this.readyState = 'opening';\n  this.skipReconnect = false;\n\n  // emit `open`\n  var openSub = on(socket, 'open', function () {\n    self.onopen();\n    fn && fn();\n  });\n\n  // emit `connect_error`\n  var errorSub = on(socket, 'error', function (data) {\n    debug('connect_error');\n    self.cleanup();\n    self.readyState = 'closed';\n    self.emitAll('connect_error', data);\n    if (fn) {\n      var err = new Error('Connection error');\n      err.data = data;\n      fn(err);\n    } else {\n      // Only do this if there is no fn to handle the error\n      self.maybeReconnectOnOpen();\n    }\n  });\n\n  // emit `connect_timeout`\n  if (false !== this._timeout) {\n    var timeout = this._timeout;\n    debug('connect attempt will timeout after %d', timeout);\n\n    if (timeout === 0) {\n      openSub.destroy(); // prevents a race condition with the 'open' event\n    }\n\n    // set timer\n    var timer = setTimeout(function () {\n      debug('connect attempt timed out after %d', timeout);\n      openSub.destroy();\n      socket.close();\n      socket.emit('error', 'timeout');\n      self.emitAll('connect_timeout', timeout);\n    }, timeout);\n\n    this.subs.push({\n      destroy: function () {\n        clearTimeout(timer);\n      }\n    });\n  }\n\n  this.subs.push(openSub);\n  this.subs.push(errorSub);\n\n  return this;\n};\n\n/**\n * Called upon transport open.\n *\n * @api private\n */\n\nManager.prototype.onopen = function () {\n  debug('open');\n\n  // clear old subs\n  this.cleanup();\n\n  // mark as open\n  this.readyState = 'open';\n  this.emit('open');\n\n  // add new subs\n  var socket = this.engine;\n  this.subs.push(on(socket, 'data', bind(this, 'ondata')));\n  this.subs.push(on(socket, 'ping', bind(this, 'onping')));\n  this.subs.push(on(socket, 'pong', bind(this, 'onpong')));\n  this.subs.push(on(socket, 'error', bind(this, 'onerror')));\n  this.subs.push(on(socket, 'close', bind(this, 'onclose')));\n  this.subs.push(on(this.decoder, 'decoded', bind(this, 'ondecoded')));\n};\n\n/**\n * Called upon a ping.\n *\n * @api private\n */\n\nManager.prototype.onping = function () {\n  this.lastPing = new Date();\n  this.emitAll('ping');\n};\n\n/**\n * Called upon a packet.\n *\n * @api private\n */\n\nManager.prototype.onpong = function () {\n  this.emitAll('pong', new Date() - this.lastPing);\n};\n\n/**\n * Called with data.\n *\n * @api private\n */\n\nManager.prototype.ondata = function (data) {\n  this.decoder.add(data);\n};\n\n/**\n * Called when parser fully decodes a packet.\n *\n * @api private\n */\n\nManager.prototype.ondecoded = function (packet) {\n  this.emit('packet', packet);\n};\n\n/**\n * Called upon socket error.\n *\n * @api private\n */\n\nManager.prototype.onerror = function (err) {\n  debug('error', err);\n  this.emitAll('error', err);\n};\n\n/**\n * Creates a new socket for the given `nsp`.\n *\n * @return {Socket}\n * @api public\n */\n\nManager.prototype.socket = function (nsp, opts) {\n  var socket = this.nsps[nsp];\n  if (!socket) {\n    socket = new Socket(this, nsp, opts);\n    this.nsps[nsp] = socket;\n    var self = this;\n    socket.on('connecting', onConnecting);\n    socket.on('connect', function () {\n      socket.id = self.generateId(nsp);\n    });\n\n    if (this.autoConnect) {\n      // manually call here since connecting event is fired before listening\n      onConnecting();\n    }\n  }\n\n  function onConnecting () {\n    if (!~indexOf(self.connecting, socket)) {\n      self.connecting.push(socket);\n    }\n  }\n\n  return socket;\n};\n\n/**\n * Called upon a socket close.\n *\n * @param {Socket} socket\n */\n\nManager.prototype.destroy = function (socket) {\n  var index = indexOf(this.connecting, socket);\n  if (~index) this.connecting.splice(index, 1);\n  if (this.connecting.length) return;\n\n  this.close();\n};\n\n/**\n * Writes a packet.\n *\n * @param {Object} packet\n * @api private\n */\n\nManager.prototype.packet = function (packet) {\n  debug('writing packet %j', packet);\n  var self = this;\n  if (packet.query && packet.type === 0) packet.nsp += '?' + packet.query;\n\n  if (!self.encoding) {\n    // encode, then write to engine with result\n    self.encoding = true;\n    this.encoder.encode(packet, function (encodedPackets) {\n      for (var i = 0; i < encodedPackets.length; i++) {\n        self.engine.write(encodedPackets[i], packet.options);\n      }\n      self.encoding = false;\n      self.processPacketQueue();\n    });\n  } else { // add packet to the queue\n    self.packetBuffer.push(packet);\n  }\n};\n\n/**\n * If packet buffer is non-empty, begins encoding the\n * next packet in line.\n *\n * @api private\n */\n\nManager.prototype.processPacketQueue = function () {\n  if (this.packetBuffer.length > 0 && !this.encoding) {\n    var pack = this.packetBuffer.shift();\n    this.packet(pack);\n  }\n};\n\n/**\n * Clean up transport subscriptions and packet buffer.\n *\n * @api private\n */\n\nManager.prototype.cleanup = function () {\n  debug('cleanup');\n\n  var subsLength = this.subs.length;\n  for (var i = 0; i < subsLength; i++) {\n    var sub = this.subs.shift();\n    sub.destroy();\n  }\n\n  this.packetBuffer = [];\n  this.encoding = false;\n  this.lastPing = null;\n\n  this.decoder.destroy();\n};\n\n/**\n * Close the current socket.\n *\n * @api private\n */\n\nManager.prototype.close =\nManager.prototype.disconnect = function () {\n  debug('disconnect');\n  this.skipReconnect = true;\n  this.reconnecting = false;\n  if ('opening' === this.readyState) {\n    // `onclose` will not fire because\n    // an open event never happened\n    this.cleanup();\n  }\n  this.backoff.reset();\n  this.readyState = 'closed';\n  if (this.engine) this.engine.close();\n};\n\n/**\n * Called upon engine close.\n *\n * @api private\n */\n\nManager.prototype.onclose = function (reason) {\n  debug('onclose');\n\n  this.cleanup();\n  this.backoff.reset();\n  this.readyState = 'closed';\n  this.emit('close', reason);\n\n  if (this._reconnection && !this.skipReconnect) {\n    this.reconnect();\n  }\n};\n\n/**\n * Attempt a reconnection.\n *\n * @api private\n */\n\nManager.prototype.reconnect = function () {\n  if (this.reconnecting || this.skipReconnect) return this;\n\n  var self = this;\n\n  if (this.backoff.attempts >= this._reconnectionAttempts) {\n    debug('reconnect failed');\n    this.backoff.reset();\n    this.emitAll('reconnect_failed');\n    this.reconnecting = false;\n  } else {\n    var delay = this.backoff.duration();\n    debug('will wait %dms before reconnect attempt', delay);\n\n    this.reconnecting = true;\n    var timer = setTimeout(function () {\n      if (self.skipReconnect) return;\n\n      debug('attempting reconnect');\n      self.emitAll('reconnect_attempt', self.backoff.attempts);\n      self.emitAll('reconnecting', self.backoff.attempts);\n\n      // check again for the case socket closed in above events\n      if (self.skipReconnect) return;\n\n      self.open(function (err) {\n        if (err) {\n          debug('reconnect attempt error');\n          self.reconnecting = false;\n          self.reconnect();\n          self.emitAll('reconnect_error', err.data);\n        } else {\n          debug('reconnect success');\n          self.onreconnect();\n        }\n      });\n    }, delay);\n\n    this.subs.push({\n      destroy: function () {\n        clearTimeout(timer);\n      }\n    });\n  }\n};\n\n/**\n * Called upon successful reconnect.\n *\n * @api private\n */\n\nManager.prototype.onreconnect = function () {\n  var attempt = this.backoff.attempts;\n  this.reconnecting = false;\n  this.backoff.reset();\n  this.updateSocketIds();\n  this.emitAll('reconnect', attempt);\n};\n","/**\n * Module dependencies\n */\n\nvar XMLHttpRequest = require('./xmlhttprequest');\nvar XHR = require('./polling-xhr');\nvar JSONP = require('./polling-jsonp');\nvar websocket = require('./websocket');\n\n/**\n * Export transports.\n */\n\nexports.polling = polling;\nexports.websocket = websocket;\n\n/**\n * Polling transport polymorphic constructor.\n * Decides on xhr vs jsonp based on feature detection.\n *\n * @api private\n */\n\nfunction polling (opts) {\n  var xhr;\n  var xd = false;\n  var xs = false;\n  var jsonp = false !== opts.jsonp;\n\n  if (typeof location !== 'undefined') {\n    var isSSL = 'https:' === location.protocol;\n    var port = location.port;\n\n    // some user agents have empty `location.port`\n    if (!port) {\n      port = isSSL ? 443 : 80;\n    }\n\n    xd = opts.hostname !== location.hostname || port !== opts.port;\n    xs = opts.secure !== isSSL;\n  }\n\n  opts.xdomain = xd;\n  opts.xscheme = xs;\n  xhr = new XMLHttpRequest(opts);\n\n  if ('open' in xhr && !opts.forceJSONP) {\n    return new XHR(opts);\n  } else {\n    if (!jsonp) throw new Error('JSONP disabled');\n    return new JSONP(opts);\n  }\n}\n","/**\n * Module dependencies.\n */\n\nvar Transport = require('../transport');\nvar parseqs = require('parseqs');\nvar parser = require('engine.io-parser');\nvar inherit = require('component-inherit');\nvar yeast = require('yeast');\nvar debug = require('debug')('engine.io-client:polling');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Polling;\n\n/**\n * Is XHR2 supported?\n */\n\nvar hasXHR2 = (function () {\n  var XMLHttpRequest = require('./xmlhttprequest');\n  var xhr = new XMLHttpRequest({ xdomain: false });\n  return null != xhr.responseType;\n})();\n\n/**\n * Polling interface.\n *\n * @param {Object} opts\n * @api private\n */\n\nfunction Polling (opts) {\n  var forceBase64 = (opts && opts.forceBase64);\n  if (!hasXHR2 || forceBase64) {\n    this.supportsBinary = false;\n  }\n  Transport.call(this, opts);\n}\n\n/**\n * Inherits from Transport.\n */\n\ninherit(Polling, Transport);\n\n/**\n * Transport name.\n */\n\nPolling.prototype.name = 'polling';\n\n/**\n * Opens the socket (triggers polling). We write a PING message to determine\n * when the transport is open.\n *\n * @api private\n */\n\nPolling.prototype.doOpen = function () {\n  this.poll();\n};\n\n/**\n * Pauses polling.\n *\n * @param {Function} callback upon buffers are flushed and transport is paused\n * @api private\n */\n\nPolling.prototype.pause = function (onPause) {\n  var self = this;\n\n  this.readyState = 'pausing';\n\n  function pause () {\n    debug('paused');\n    self.readyState = 'paused';\n    onPause();\n  }\n\n  if (this.polling || !this.writable) {\n    var total = 0;\n\n    if (this.polling) {\n      debug('we are currently polling - waiting to pause');\n      total++;\n      this.once('pollComplete', function () {\n        debug('pre-pause polling complete');\n        --total || pause();\n      });\n    }\n\n    if (!this.writable) {\n      debug('we are currently writing - waiting to pause');\n      total++;\n      this.once('drain', function () {\n        debug('pre-pause writing complete');\n        --total || pause();\n      });\n    }\n  } else {\n    pause();\n  }\n};\n\n/**\n * Starts polling cycle.\n *\n * @api public\n */\n\nPolling.prototype.poll = function () {\n  debug('polling');\n  this.polling = true;\n  this.doPoll();\n  this.emit('poll');\n};\n\n/**\n * Overloads onData to detect payloads.\n *\n * @api private\n */\n\nPolling.prototype.onData = function (data) {\n  var self = this;\n  debug('polling got data %s', data);\n  var callback = function (packet, index, total) {\n    // if its the first message we consider the transport open\n    if ('opening' === self.readyState && packet.type === 'open') {\n      self.onOpen();\n    }\n\n    // if its a close packet, we close the ongoing requests\n    if ('close' === packet.type) {\n      self.onClose();\n      return false;\n    }\n\n    // otherwise bypass onData and handle the message\n    self.onPacket(packet);\n  };\n\n  // decode payload\n  parser.decodePayload(data, this.socket.binaryType, callback);\n\n  // if an event did not trigger closing\n  if ('closed' !== this.readyState) {\n    // if we got data we're not polling\n    this.polling = false;\n    this.emit('pollComplete');\n\n    if ('open' === this.readyState) {\n      this.poll();\n    } else {\n      debug('ignoring poll - transport state \"%s\"', this.readyState);\n    }\n  }\n};\n\n/**\n * For polling, send a close packet.\n *\n * @api private\n */\n\nPolling.prototype.doClose = function () {\n  var self = this;\n\n  function close () {\n    debug('writing close packet');\n    self.write([{ type: 'close' }]);\n  }\n\n  if ('open' === this.readyState) {\n    debug('transport open - closing');\n    close();\n  } else {\n    // in case we're trying to close while\n    // handshaking is in progress (GH-164)\n    debug('transport not open - deferring close');\n    this.once('open', close);\n  }\n};\n\n/**\n * Writes a packets payload.\n *\n * @param {Array} data packets\n * @param {Function} drain callback\n * @api private\n */\n\nPolling.prototype.write = function (packets) {\n  var self = this;\n  this.writable = false;\n  var callbackfn = function () {\n    self.writable = true;\n    self.emit('drain');\n  };\n\n  parser.encodePayload(packets, this.supportsBinary, function (data) {\n    self.doWrite(data, callbackfn);\n  });\n};\n\n/**\n * Generates uri for connection.\n *\n * @api private\n */\n\nPolling.prototype.uri = function () {\n  var query = this.query || {};\n  var schema = this.secure ? 'https' : 'http';\n  var port = '';\n\n  // cache busting is forced\n  if (false !== this.timestampRequests) {\n    query[this.timestampParam] = yeast();\n  }\n\n  if (!this.supportsBinary && !query.sid) {\n    query.b64 = 1;\n  }\n\n  query = parseqs.encode(query);\n\n  // avoid port if default for schema\n  if (this.port && (('https' === schema && Number(this.port) !== 443) ||\n     ('http' === schema && Number(this.port) !== 80))) {\n    port = ':' + this.port;\n  }\n\n  // prepend ? to query\n  if (query.length) {\n    query = '?' + query;\n  }\n\n  var ipv6 = this.hostname.indexOf(':') !== -1;\n  return schema + '://' + (ipv6 ? '[' + this.hostname + ']' : this.hostname) + port + this.path + query;\n};\n","/* global Blob File */\n\n/*\n * Module requirements.\n */\n\nvar isArray = require('isarray');\n\nvar toString = Object.prototype.toString;\nvar withNativeBlob = typeof Blob === 'function' ||\n                        typeof Blob !== 'undefined' && toString.call(Blob) === '[object BlobConstructor]';\nvar withNativeFile = typeof File === 'function' ||\n                        typeof File !== 'undefined' && toString.call(File) === '[object FileConstructor]';\n\n/**\n * Module exports.\n */\n\nmodule.exports = hasBinary;\n\n/**\n * Checks for binary data.\n *\n * Supports Buffer, ArrayBuffer, Blob and File.\n *\n * @param {Object} anything\n * @api public\n */\n\nfunction hasBinary (obj) {\n  if (!obj || typeof obj !== 'object') {\n    return false;\n  }\n\n  if (isArray(obj)) {\n    for (var i = 0, l = obj.length; i < l; i++) {\n      if (hasBinary(obj[i])) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  if ((typeof Buffer === 'function' && Buffer.isBuffer && Buffer.isBuffer(obj)) ||\n    (typeof ArrayBuffer === 'function' && obj instanceof ArrayBuffer) ||\n    (withNativeBlob && obj instanceof Blob) ||\n    (withNativeFile && obj instanceof File)\n  ) {\n    return true;\n  }\n\n  // see: https://github.com/Automattic/has-binary/pull/4\n  if (obj.toJSON && typeof obj.toJSON === 'function' && arguments.length === 1) {\n    return hasBinary(obj.toJSON(), true);\n  }\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key) && hasBinary(obj[key])) {\n      return true;\n    }\n  }\n\n  return false;\n}\n","'use strict';\n\nvar alphabet = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_'.split('')\n  , length = 64\n  , map = {}\n  , seed = 0\n  , i = 0\n  , prev;\n\n/**\n * Return a string representing the specified number.\n *\n * @param {Number} num The number to convert.\n * @returns {String} The string representation of the number.\n * @api public\n */\nfunction encode(num) {\n  var encoded = '';\n\n  do {\n    encoded = alphabet[num % length] + encoded;\n    num = Math.floor(num / length);\n  } while (num > 0);\n\n  return encoded;\n}\n\n/**\n * Return the integer value specified by the given string.\n *\n * @param {String} str The string to convert.\n * @returns {Number} The integer value represented by the string.\n * @api public\n */\nfunction decode(str) {\n  var decoded = 0;\n\n  for (i = 0; i < str.length; i++) {\n    decoded = decoded * length + map[str.charAt(i)];\n  }\n\n  return decoded;\n}\n\n/**\n * Yeast: A tiny growing id generator.\n *\n * @returns {String} A unique id.\n * @api public\n */\nfunction yeast() {\n  var now = encode(+new Date());\n\n  if (now !== prev) return seed = 0, prev = now;\n  return now +'.'+ encode(seed++);\n}\n\n//\n// Map each character to its index.\n//\nfor (; i < length; i++) map[alphabet[i]] = i;\n\n//\n// Expose the `yeast`, `encode` and `decode` functions.\n//\nyeast.encode = encode;\nyeast.decode = decode;\nmodule.exports = yeast;\n","\nvar indexOf = [].indexOf;\n\nmodule.exports = function(arr, obj){\n  if (indexOf) return arr.indexOf(obj);\n  for (var i = 0; i < arr.length; ++i) {\n    if (arr[i] === obj) return i;\n  }\n  return -1;\n};","\n/**\n * Module dependencies.\n */\n\nvar parser = require('socket.io-parser');\nvar Emitter = require('component-emitter');\nvar toArray = require('to-array');\nvar on = require('./on');\nvar bind = require('component-bind');\nvar debug = require('debug')('socket.io-client:socket');\nvar parseqs = require('parseqs');\nvar hasBin = require('has-binary2');\n\n/**\n * Module exports.\n */\n\nmodule.exports = exports = Socket;\n\n/**\n * Internal events (blacklisted).\n * These events can't be emitted by the user.\n *\n * @api private\n */\n\nvar events = {\n  connect: 1,\n  connect_error: 1,\n  connect_timeout: 1,\n  connecting: 1,\n  disconnect: 1,\n  error: 1,\n  reconnect: 1,\n  reconnect_attempt: 1,\n  reconnect_failed: 1,\n  reconnect_error: 1,\n  reconnecting: 1,\n  ping: 1,\n  pong: 1\n};\n\n/**\n * Shortcut to `Emitter#emit`.\n */\n\nvar emit = Emitter.prototype.emit;\n\n/**\n * `Socket` constructor.\n *\n * @api public\n */\n\nfunction Socket (io, nsp, opts) {\n  this.io = io;\n  this.nsp = nsp;\n  this.json = this; // compat\n  this.ids = 0;\n  this.acks = {};\n  this.receiveBuffer = [];\n  this.sendBuffer = [];\n  this.connected = false;\n  this.disconnected = true;\n  this.flags = {};\n  if (opts && opts.query) {\n    this.query = opts.query;\n  }\n  if (this.io.autoConnect) this.open();\n}\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Socket.prototype);\n\n/**\n * Subscribe to open, close and packet events\n *\n * @api private\n */\n\nSocket.prototype.subEvents = function () {\n  if (this.subs) return;\n\n  var io = this.io;\n  this.subs = [\n    on(io, 'open', bind(this, 'onopen')),\n    on(io, 'packet', bind(this, 'onpacket')),\n    on(io, 'close', bind(this, 'onclose'))\n  ];\n};\n\n/**\n * \"Opens\" the socket.\n *\n * @api public\n */\n\nSocket.prototype.open =\nSocket.prototype.connect = function () {\n  if (this.connected) return this;\n\n  this.subEvents();\n  if (!this.io.reconnecting) this.io.open(); // ensure open\n  if ('open' === this.io.readyState) this.onopen();\n  this.emit('connecting');\n  return this;\n};\n\n/**\n * Sends a `message` event.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.send = function () {\n  var args = toArray(arguments);\n  args.unshift('message');\n  this.emit.apply(this, args);\n  return this;\n};\n\n/**\n * Override `emit`.\n * If the event is in `events`, it's emitted normally.\n *\n * @param {String} event name\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.emit = function (ev) {\n  if (events.hasOwnProperty(ev)) {\n    emit.apply(this, arguments);\n    return this;\n  }\n\n  var args = toArray(arguments);\n  var packet = {\n    type: (this.flags.binary !== undefined ? this.flags.binary : hasBin(args)) ? parser.BINARY_EVENT : parser.EVENT,\n    data: args\n  };\n\n  packet.options = {};\n  packet.options.compress = !this.flags || false !== this.flags.compress;\n\n  // event ack callback\n  if ('function' === typeof args[args.length - 1]) {\n    debug('emitting packet with ack id %d', this.ids);\n    this.acks[this.ids] = args.pop();\n    packet.id = this.ids++;\n  }\n\n  if (this.connected) {\n    this.packet(packet);\n  } else {\n    this.sendBuffer.push(packet);\n  }\n\n  this.flags = {};\n\n  return this;\n};\n\n/**\n * Sends a packet.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.packet = function (packet) {\n  packet.nsp = this.nsp;\n  this.io.packet(packet);\n};\n\n/**\n * Called upon engine `open`.\n *\n * @api private\n */\n\nSocket.prototype.onopen = function () {\n  debug('transport is open - connecting');\n\n  // write connect packet if necessary\n  if ('/' !== this.nsp) {\n    if (this.query) {\n      var query = typeof this.query === 'object' ? parseqs.encode(this.query) : this.query;\n      debug('sending connect packet with query %s', query);\n      this.packet({type: parser.CONNECT, query: query});\n    } else {\n      this.packet({type: parser.CONNECT});\n    }\n  }\n};\n\n/**\n * Called upon engine `close`.\n *\n * @param {String} reason\n * @api private\n */\n\nSocket.prototype.onclose = function (reason) {\n  debug('close (%s)', reason);\n  this.connected = false;\n  this.disconnected = true;\n  delete this.id;\n  this.emit('disconnect', reason);\n};\n\n/**\n * Called with socket packet.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onpacket = function (packet) {\n  var sameNamespace = packet.nsp === this.nsp;\n  var rootNamespaceError = packet.type === parser.ERROR && packet.nsp === '/';\n\n  if (!sameNamespace && !rootNamespaceError) return;\n\n  switch (packet.type) {\n    case parser.CONNECT:\n      this.onconnect();\n      break;\n\n    case parser.EVENT:\n      this.onevent(packet);\n      break;\n\n    case parser.BINARY_EVENT:\n      this.onevent(packet);\n      break;\n\n    case parser.ACK:\n      this.onack(packet);\n      break;\n\n    case parser.BINARY_ACK:\n      this.onack(packet);\n      break;\n\n    case parser.DISCONNECT:\n      this.ondisconnect();\n      break;\n\n    case parser.ERROR:\n      this.emit('error', packet.data);\n      break;\n  }\n};\n\n/**\n * Called upon a server event.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onevent = function (packet) {\n  var args = packet.data || [];\n  debug('emitting event %j', args);\n\n  if (null != packet.id) {\n    debug('attaching ack callback to event');\n    args.push(this.ack(packet.id));\n  }\n\n  if (this.connected) {\n    emit.apply(this, args);\n  } else {\n    this.receiveBuffer.push(args);\n  }\n};\n\n/**\n * Produces an ack callback to emit with an event.\n *\n * @api private\n */\n\nSocket.prototype.ack = function (id) {\n  var self = this;\n  var sent = false;\n  return function () {\n    // prevent double callbacks\n    if (sent) return;\n    sent = true;\n    var args = toArray(arguments);\n    debug('sending ack %j', args);\n\n    self.packet({\n      type: hasBin(args) ? parser.BINARY_ACK : parser.ACK,\n      id: id,\n      data: args\n    });\n  };\n};\n\n/**\n * Called upon a server acknowlegement.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onack = function (packet) {\n  var ack = this.acks[packet.id];\n  if ('function' === typeof ack) {\n    debug('calling ack %s with %j', packet.id, packet.data);\n    ack.apply(this, packet.data);\n    delete this.acks[packet.id];\n  } else {\n    debug('bad ack %s', packet.id);\n  }\n};\n\n/**\n * Called upon server connect.\n *\n * @api private\n */\n\nSocket.prototype.onconnect = function () {\n  this.connected = true;\n  this.disconnected = false;\n  this.emit('connect');\n  this.emitBuffered();\n};\n\n/**\n * Emit buffered events (received and emitted).\n *\n * @api private\n */\n\nSocket.prototype.emitBuffered = function () {\n  var i;\n  for (i = 0; i < this.receiveBuffer.length; i++) {\n    emit.apply(this, this.receiveBuffer[i]);\n  }\n  this.receiveBuffer = [];\n\n  for (i = 0; i < this.sendBuffer.length; i++) {\n    this.packet(this.sendBuffer[i]);\n  }\n  this.sendBuffer = [];\n};\n\n/**\n * Called upon server disconnect.\n *\n * @api private\n */\n\nSocket.prototype.ondisconnect = function () {\n  debug('server disconnect (%s)', this.nsp);\n  this.destroy();\n  this.onclose('io server disconnect');\n};\n\n/**\n * Called upon forced client/server side disconnections,\n * this method ensures the manager stops tracking us and\n * that reconnections don't get triggered for this.\n *\n * @api private.\n */\n\nSocket.prototype.destroy = function () {\n  if (this.subs) {\n    // clean subscriptions to avoid reconnections\n    for (var i = 0; i < this.subs.length; i++) {\n      this.subs[i].destroy();\n    }\n    this.subs = null;\n  }\n\n  this.io.destroy(this);\n};\n\n/**\n * Disconnects the socket manually.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.close =\nSocket.prototype.disconnect = function () {\n  if (this.connected) {\n    debug('performing disconnect (%s)', this.nsp);\n    this.packet({ type: parser.DISCONNECT });\n  }\n\n  // remove socket from pool\n  this.destroy();\n\n  if (this.connected) {\n    // fire events\n    this.onclose('io client disconnect');\n  }\n  return this;\n};\n\n/**\n * Sets the compress flag.\n *\n * @param {Boolean} if `true`, compresses the sending data\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.compress = function (compress) {\n  this.flags.compress = compress;\n  return this;\n};\n\n/**\n * Sets the binary flag\n *\n * @param {Boolean} whether the emitted data contains binary\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.binary = function (binary) {\n  this.flags.binary = binary;\n  return this;\n};\n","\n/**\n * Module exports.\n */\n\nmodule.exports = on;\n\n/**\n * Helper for subscriptions.\n *\n * @param {Object|EventEmitter} obj with `Emitter` mixin or `EventEmitter`\n * @param {String} event name\n * @param {Function} callback\n * @api public\n */\n\nfunction on (obj, ev, fn) {\n  obj.on(ev, fn);\n  return {\n    destroy: function () {\n      obj.removeListener(ev, fn);\n    }\n  };\n}\n","/**\n * Slice reference.\n */\n\nvar slice = [].slice;\n\n/**\n * Bind `obj` to `fn`.\n *\n * @param {Object} obj\n * @param {Function|String} fn or string\n * @return {Function}\n * @api public\n */\n\nmodule.exports = function(obj, fn){\n  if ('string' == typeof fn) fn = obj[fn];\n  if ('function' != typeof fn) throw new Error('bind() requires a function');\n  var args = slice.call(arguments, 2);\n  return function(){\n    return fn.apply(obj, args.concat(slice.call(arguments)));\n  }\n};\n","\n/**\n * Module dependencies.\n */\n\nvar url = require('./url');\nvar parser = require('socket.io-parser');\nvar Manager = require('./manager');\nvar debug = require('debug')('socket.io-client');\n\n/**\n * Module exports.\n */\n\nmodule.exports = exports = lookup;\n\n/**\n * Managers cache.\n */\n\nvar cache = exports.managers = {};\n\n/**\n * Looks up an existing `Manager` for multiplexing.\n * If the user summons:\n *\n *   `io('http://localhost/a');`\n *   `io('http://localhost/b');`\n *\n * We reuse the existing instance based on same scheme/port/host,\n * and we initialize sockets for each namespace.\n *\n * @api public\n */\n\nfunction lookup (uri, opts) {\n  if (typeof uri === 'object') {\n    opts = uri;\n    uri = undefined;\n  }\n\n  opts = opts || {};\n\n  var parsed = url(uri);\n  var source = parsed.source;\n  var id = parsed.id;\n  var path = parsed.path;\n  var sameNamespace = cache[id] && path in cache[id].nsps;\n  var newConnection = opts.forceNew || opts['force new connection'] ||\n                      false === opts.multiplex || sameNamespace;\n\n  var io;\n\n  if (newConnection) {\n    debug('ignoring socket cache for %s', source);\n    io = Manager(source, opts);\n  } else {\n    if (!cache[id]) {\n      debug('new io instance for %s', source);\n      cache[id] = Manager(source, opts);\n    }\n    io = cache[id];\n  }\n  if (parsed.query && !opts.query) {\n    opts.query = parsed.query;\n  }\n  return io.socket(parsed.path, opts);\n}\n\n/**\n * Protocol version.\n *\n * @api public\n */\n\nexports.protocol = parser.protocol;\n\n/**\n * `connect`.\n *\n * @param {String} uri\n * @api public\n */\n\nexports.connect = lookup;\n\n/**\n * Expose constructors for standalone build.\n *\n * @api public\n */\n\nexports.Manager = require('./manager');\nexports.Socket = require('./socket');\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { MarkdownViewer } from '@seafile/seafile-editor';\nimport { gettext, repoID, slug, serviceURL, isPublicWiki, sharedToken, mediaUrl } from '../utils/constants';\nimport Loading from './loading';\nimport { Utils } from '../utils/utils';\n\nconst propTypes = {\n  children: PropTypes.object,\n  isFileLoading: PropTypes.bool.isRequired,\n  markdownContent: PropTypes.string.isRequired,\n  latestContributor: PropTypes.string.isRequired,\n  lastModified: PropTypes.string.isRequired,\n  onLinkClick: PropTypes.func.isRequired,\n  isWiki: PropTypes.bool,\n  isTOCShow: PropTypes.bool,\n  // for dir-column-file component(import repoID is undefined)\n  repoID: PropTypes.string,\n  path: PropTypes.string,\n};\n\nconst contentClass = 'wiki-page-content';\n\nclass WikiMarkdownViewer extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      activeTitleIndex: 0,\n    };\n    this.markdownContainer = React.createRef();\n    this.links = [];\n    this.titlesInfo = [];\n  }\n\n  componentDidMount() {\n    // Bind event when first loaded\n    this.links = document.querySelectorAll(`.${contentClass} a`);\n    this.links.forEach(link => {\n      link.addEventListener('click', this.onLinkClick);\n    });\n\n    this.getTitlesInfo();\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (this.props.markdownContent === nextProps.markdownContent) {\n      return;\n    }\n    // Unbound event when updating\n    this.links.forEach(link => {\n      link.removeEventListener('click', this.onLinkClick);\n    });\n  }\n\n  componentDidUpdate() {\n    // Update completed, rebind event\n    this.links = document.querySelectorAll(`.${contentClass} a`);\n    this.links.forEach(link => {\n      link.addEventListener('click', this.onLinkClick);\n    });\n    if (this.titlesInfo.length === 0) {\n      this.getTitlesInfo();\n    }\n  }\n\n  componentWillUnmount() {\n    // Unbound events when the component is destroyed\n    this.links.forEach(link => {\n      link.removeEventListener('click', this.onLinkClick);\n    });\n  }\n\n  getTitlesInfo = () => {\n    let titlesInfo = [];\n    const titleDom = document.querySelectorAll('h1[id^=\"user-content\"]')[0];\n    if (titleDom) {\n      const id = titleDom.getAttribute('id');\n      let content = id && id.replace('user-content-', '');\n      content = content ? `${content} - ${slug}` : slug;\n      Utils.updateTabTitle(content);\n    }\n    let headingList = document.querySelectorAll('h2[id^=\"user-content\"], h3[id^=\"user-content\"]');\n    for (let i = 0; i < headingList.length; i++) {\n      titlesInfo.push(headingList[i].offsetTop);\n    }\n    this.titlesInfo = titlesInfo;\n  }\n\n  onLinkClick = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n    let link = '';\n    if (event.target.tagName !== 'A') {\n      let target = event.target.parentNode;\n      while (target.tagName !== 'A') {\n        target = target.parentNode;\n      }\n      link = target.href;\n    } else {\n      link = event.target.href;\n    }\n    this.props.onLinkClick(link);\n  }\n\n  onScrollHandler = () => {\n    const contentScrollTop = this.markdownContainer.current.scrollTop + 180;\n    let titlesLength = this.titlesInfo.length;\n    let activeTitleIndex;\n    if (contentScrollTop <= this.titlesInfo[0]) {\n      activeTitleIndex = 0;\n      this.setState({activeTitleIndex: activeTitleIndex});\n      return;\n    }\n    if (contentScrollTop > this.titlesInfo[titlesLength - 1]) {\n      activeTitleIndex = this.titlesInfo.length - 1;\n      this.setState({activeTitleIndex: activeTitleIndex});\n      return;\n    }\n    for (let i = 0; i < titlesLength; i++) {\n      if (contentScrollTop > this.titlesInfo[i]) {\n        continue;\n      } else {\n        activeTitleIndex = i - 1;\n        break;\n      }\n    }\n    this.setState({activeTitleIndex: activeTitleIndex});\n  }\n\n  changeInlineNode = (item) => {\n    let url, imagePath;\n\n    if (item.type == 'image' && isPublicWiki) { // change image url\n      url = item.data.src;\n      const re = new RegExp(serviceURL + '/lib/' + repoID +'/file.*raw=1');\n      // different repo\n      if (re.test(url)) {\n        // get image path\n        let index = url.indexOf('/file');\n        let index2 = url.indexOf('?');\n        imagePath = url.substring(index + 5, index2);\n      } else if (/^\\.\\.\\/*/.test(url) || /^\\.\\/*/.test(url)) {\n        const path = this.props.path;\n        const originalPath = path.slice(0, path.lastIndexOf('/')) + '/' + url;\n        imagePath = Utils.pathNormalize(originalPath);\n      } else {\n        return;\n      }\n      item.data.src = serviceURL + '/view-image-via-public-wiki/?slug=' + slug + '&path=' + imagePath;\n    } else if (item.type == 'link') { // change link url\n      url = item.data.href;\n      if (Utils.isInternalFileLink(url, repoID)) { // change file url\n        if (Utils.isInternalMarkdownLink(url, repoID)) {\n          let path = Utils.getPathFromInternalMarkdownLink(url, repoID);\n          // replace url\n          item.data.href = serviceURL + '/published/' + slug + path;\n        } else {\n          item.data.href = url.replace(/(.*)lib\\/([-0-9a-f]{36})\\/file(.*)/g, (match, p1, p2, p3) => {\n            return `${p1}d/${sharedToken}/files/?p=${p3}&dl=1`;\n          });\n        }\n      } else if (Utils.isInternalDirLink(url, repoID)) { // change dir url\n        let path = Utils.getPathFromInternalDirLink(url, repoID);\n        // replace url\n        item.data.href = serviceURL + '/published/' + slug + path;\n      }\n    }\n\n    return item;\n  }\n\n  modifyValueBeforeRender = (value) => {\n    let newNodes = Utils.changeMarkdownNodes(value, this.changeInlineNode);\n    return newNodes;\n  }\n\n  renderMarkdown = () => {\n    let isTOCShow = true;\n    if (this.props.isTOCShow === false) {\n      isTOCShow = false;\n    }\n    if (this.props.isWiki) {\n      return (\n        <MarkdownViewer\n          showTOC={isTOCShow}\n          scriptSource={mediaUrl + 'js/mathjax/tex-svg.js'}\n          markdownContent={this.props.markdownContent}\n          activeTitleIndex={this.state.activeTitleIndex}\n          modifyValueBeforeRender={this.modifyValueBeforeRender}\n        />\n      );\n    }\n\n    return (\n      <MarkdownViewer\n        showTOC={isTOCShow}\n        scriptSource={mediaUrl + 'js/mathjax/tex-svg.js'}\n        markdownContent={this.props.markdownContent}\n        activeTitleIndex={this.state.activeTitleIndex}\n      />\n    );\n  }\n\n  render() {\n    if (this.props.isFileLoading) {\n      return <Loading />;\n    }\n    // In dir-column-file repoID is one of props, width is 100%; In wiki-viewer repoID is not props, width isn't 100%\n    let contentClassName = `${this.props.repoID ? contentClass + ' w-100' : contentClass}`;\n    return (\n      <div ref={this.markdownContainer} className=\"wiki-page-container\" onScroll={this.onScrollHandler.bind(this)}>\n        <div className={contentClassName}>\n          {this.props.children}\n          {this.renderMarkdown()}\n          <p id=\"wiki-page-last-modified\">{gettext('Last modified by')} {this.props.latestContributor}, <span>{this.props.lastModified}</span></p>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst defaultProps = {\n  isWiki: false,\n};\n\nWikiMarkdownViewer.propTypes = propTypes;\nMarkdownViewer.defaultProps = defaultProps;\n\nexport default WikiMarkdownViewer;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\n\nconst propTypes = {\n  type: PropTypes.oneOf(['move', 'copy']).isRequired,\n  asyncOperatedFilesLength: PropTypes.number.isRequired,\n  asyncOperationProgress: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\n  toggleDialog: PropTypes.func.isRequired,\n};\n\nclass CopyMoveDirentProgressDialog extends React.Component {\n\n  render() {\n\n    let { type , asyncOperationProgress, asyncOperatedFilesLength } = this.props;\n    let title = type === 'move' ? gettext('Move {num} items') : gettext('Copy {num} items');\n    title = title.replace('{num}', asyncOperatedFilesLength);\n    let progressStyle = {\n      width: asyncOperationProgress + '%',\n      lineHeight: '40px',\n      textAlign: 'left',\n    };\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.props.toggleDialog}>{title}</ModalHeader>\n        <ModalBody style={{minHeight: '80px'}}>\n          <div className=\"progress\" style={{height: '40px'}}>\n            <div\n              className=\"progress-bar pl-2\"\n              role=\"progressbar\"\n              style={progressStyle}\n              aria-valuenow={asyncOperationProgress}\n              aria-valuemin=\"0\"\n              aria-valuemax=\"100\"\n            >\n              {asyncOperationProgress + '%'}\n            </div>\n          </div>\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nCopyMoveDirentProgressDialog.propTypes = propTypes;\n\nexport default CopyMoveDirentProgressDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { permission } from '../../utils/constants';\nimport TextTranslation from '../../utils/text-translation';\nimport ItemDropdownMenu from '../dropdown-menu/item-dropdown-menu';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  userPerm: PropTypes.string,\n  node: PropTypes.object.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  paddingLeft: PropTypes.number.isRequired,\n  isNodeMenuShow: PropTypes.bool.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  onNodeClick: PropTypes.func.isRequired,\n  onNodeExpanded: PropTypes.func.isRequired,\n  onNodeCollapse: PropTypes.func.isRequired,\n  onNodeDragStart: PropTypes.func.isRequired,\n  freezeItem: PropTypes.func.isRequired,\n  unfreezeItem: PropTypes.func.isRequired,\n  onMenuItemClick: PropTypes.func,\n  onNodeDragMove: PropTypes.func,\n  onNodeDrop: PropTypes.func,\n  handleContextClick: PropTypes.func.isRequired,\n  onNodeDragEnter: PropTypes.func.isRequired,\n  onNodeDragLeave:PropTypes.func.isRequired,\n};\n\nclass TreeNodeView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isHighlight: false,\n      isShowOperationMenu: false,\n      isNodeDropShow: false,\n    };\n    const { userPerm } = props;\n    this.canDrag = userPerm === 'rw';\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    if (isCustomPermission) {\n      const { modify } = customPermission.permission;\n      this.canDrag = modify;\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (!nextProps.isItemFreezed) {\n      this.setState({\n        isShowOperationMenu: false,\n        isHighlight: false,\n      });\n    }\n  }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isShowOperationMenu: true,\n        isHighlight: true,\n      });\n    }\n  }\n\n  onMouseOver = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isShowOperationMenu: true,\n        isHighlight: true,\n      });\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isShowOperationMenu: false,\n        isHighlight: false,\n      });\n    }\n  }\n\n  onNodeClick = () => {\n    const { node } = this.props;\n    const { object } = node;\n    if (object.isDir()) {\n      this.props.onNodeClick(this.props.node);\n      return;\n    }\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(object.permission);\n    if (isCustomPermission) {\n      const { preview: canPreview, modify: canModify } = customPermission.permission;\n      if (!canPreview && !canModify) return;\n    } \n    this.props.onNodeClick(this.props.node);\n  }\n\n  onLoadToggle = (e) => {\n    e.stopPropagation();\n    let { node } = this.props;\n    if (node.isExpanded) {\n      this.props.onNodeCollapse(node);\n    } else {\n      this.props.onNodeExpanded(node);\n    }\n  }\n\n  onNodeDragStart = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    this.props.onNodeDragStart(e, this.props.node);\n  }\n\n  onNodeDragEnter = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    if (this.props.node.object.type === 'dir') {\n      this.setState({isNodeDropShow: true});\n    }\n    this.props.onNodeDragEnter(e, this.props.node);\n  }\n\n  onNodeDragMove = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    this.props.onNodeDragMove(e);\n  }\n\n  onNodeDragLeave = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    this.setState({isNodeDropShow: false});\n    this.props.onNodeDragLeave(e, this.props.node);\n  }\n\n  onNodeDrop = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    e.stopPropagation();\n    this.setState({isNodeDropShow: false});\n    this.props.onNodeDrop(e, this.props.node);\n  }\n\n  unfreezeItem = () => {\n    this.setState({isShowOperationMenu: false});\n    this.props.unfreezeItem();\n  }\n\n  onMenuItemClick = (operation, event, node) => {\n    this.props.onMenuItemClick(operation, node);\n  }\n\n  onItemMouseDown = (event) => {\n    event.stopPropagation();\n    if (event.button === 2) {\n      return;\n    }\n  }\n\n  onItemContextMenu = (event) => {\n    this.handleContextClick(event);\n  }\n\n  handleContextClick = (event) => {\n    this.props.handleContextClick(event, this.props.node);\n    this.setState({isShowOperationMenu: false});\n  }\n\n  getNodeTypeAndIcon = () => {\n    let { node } = this.props;\n    let icon = '';\n    let type = '';\n    if (node.object.type === 'dir') {\n      icon = <i className=\"far fa-folder\"></i>;\n      type = 'dir';\n    } else {\n      let index = node.object.name.lastIndexOf('.');\n      if (index === -1) {\n        icon = <i className=\"far fa-file\"></i>;\n        type = 'file';\n      } else {\n        let suffix = node.object.name.slice(index).toLowerCase();\n        if (suffix === '.png' || suffix === '.jpg' || suffix === '.jpeg' || suffix === '.gif' || suffix === '.bmp') {\n          icon = <i className=\"far fa-image\"></i>;\n          type = 'image';\n        }\n        else if (suffix === '.md' || suffix === '.markdown') {\n          icon = <i className=\"far fa-file-alt\"></i>;\n          type = 'file';\n        }\n        else {\n          icon = <i className=\"far fa-file\"></i>;\n          type = 'file';\n        }\n      }\n    }\n    return {icon, type};\n  }\n\n  calculateMenuList = (node) => {\n    let { NEW_FOLDER, NEW_FILE, COPY, MOVE, RENAME, DELETE, OPEN_VIA_CLIENT} =  TextTranslation;\n\n    let menuList = [RENAME, DELETE, COPY, MOVE, OPEN_VIA_CLIENT];\n    if (node.object.type === 'dir') {\n      menuList = [NEW_FOLDER, NEW_FILE, COPY, MOVE, RENAME, DELETE];\n    }\n\n    const { userPerm } = this.props;\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    if (!isCustomPermission) {\n      return menuList;\n    }\n\n    menuList = [];\n    const { create: canCreate, modify: canModify, delete: canDelete, copy: canCopy } = customPermission.permission;\n    if (node.object.type === 'dir') {\n      canCreate && menuList.push(NEW_FOLDER, NEW_FILE);\n    }\n\n    canCopy && menuList.push(COPY);\n    canModify && menuList.push(MOVE, RENAME);\n    canDelete && menuList.push(DELETE);\n\n    if (node.object.type !== 'dir') { \n      menuList.push(OPEN_VIA_CLIENT);\n    }\n\n    return menuList;\n  }\n\n  renderChildren = () => {\n    let { node, paddingLeft } = this.props;\n    if (!node.hasChildren()) {\n      return '';\n    }\n    return (\n      <div className=\"children\" style={{paddingLeft: paddingLeft}}>\n        {node.children.map(item => {\n          return (\n            <TreeNodeView\n              key={item.path}\n              node={item}\n              paddingLeft={paddingLeft}\n              userPerm={this.props.userPerm}\n              currentPath={this.props.currentPath}\n              isNodeMenuShow={this.props.isNodeMenuShow}\n              isItemFreezed={this.props.isItemFreezed}\n              onNodeClick={this.props.onNodeClick}\n              onNodeCollapse={this.props.onNodeCollapse}\n              onNodeExpanded={this.props.onNodeExpanded}\n              freezeItem={this.props.freezeItem}\n              onMenuItemClick={this.props.onMenuItemClick}\n              unfreezeItem={this.unfreezeItem}\n              onNodeDragStart={this.props.onNodeDragStart}\n              onNodeDragMove={this.props.onNodeDragMove}\n              onNodeDrop={this.props.onNodeDrop}\n              onNodeDragEnter={this.props.onNodeDragEnter}\n              onNodeDragLeave={this.props.onNodeDragLeave}\n              handleContextClick={this.props.handleContextClick}\n            />\n          );\n        })}\n      </div>\n    );\n  }\n\n  render() {\n    let { currentPath, node, isNodeMenuShow, userPerm } = this.props;\n    let { type, icon } = this.getNodeTypeAndIcon();\n    let hlClass = this.state.isHighlight ? 'tree-node-inner-hover ' : '';\n    if (node.path === currentPath) {\n      hlClass = 'tree-node-hight-light';\n    }\n\n    const { isCustomPermission } = Utils.getUserPermission(userPerm)\n    return (\n      <div className=\"tree-node\">\n        <div\n          type={type}\n          className={`tree-node-inner text-nowrap ${hlClass} ${node.path === '/'? 'hide': ''} ${this.state.isNodeDropShow ? 'tree-node-drop' : ''}`}\n          title={node.object.name}\n          onMouseEnter={this.onMouseEnter}\n          onMouseOver={this.onMouseOver}\n          onMouseLeave={this.onMouseLeave}\n          onMouseDown={this.onItemMouseDown}\n          onContextMenu={this.onItemContextMenu}\n          onClick={this.onNodeClick}\n        >\n          <div className=\"tree-node-text\" draggable={this.canDrag} onDragStart={this.onNodeDragStart} onDragEnter={this.onNodeDragEnter} onDragLeave={this.onNodeDragLeave} onDragOver={this.onNodeDragMove} onDrop={this.onNodeDrop}>{node.object.name}</div>\n          <div className=\"left-icon\">\n            {type === 'dir' && (!node.isLoaded ||  (node.isLoaded && node.hasChildren())) && (\n              <i\n                className={`folder-toggle-icon fa ${node.isExpanded ? 'fa-caret-down' : 'fa-caret-right'}`}\n                onMouseDown={e => e.stopPropagation()}\n                onClick={this.onLoadToggle}\n              ></i>\n            )}\n            <i className=\"tree-node-icon\">{icon}</i>\n          </div>\n          {isNodeMenuShow && (\n            <div className=\"right-icon\">\n              {((userPerm === 'rw' || permission || isCustomPermission) && this.state.isShowOperationMenu) && (\n                <ItemDropdownMenu\n                  item={this.props.node}\n                  toggleClass={'fas fa-ellipsis-v'}\n                  getMenuList={this.calculateMenuList}\n                  onMenuItemClick={this.onMenuItemClick}\n                  freezeItem={this.props.freezeItem}\n                  unfreezeItem={this.unfreezeItem}\n                />\n              )}\n            </div>\n          )}\n        </div>\n        {node.isExpanded && this.renderChildren()}\n      </div>\n    );\n  }\n}\n\nTreeNodeView.propTypes = propTypes;\n\nexport default TreeNodeView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport TextTranslation from '../../utils/text-translation';\nimport TreeNodeView from './tree-node-view';\nimport ContextMenu from '../context-menu/context-menu';\nimport { hideMenu, showMenu } from '../context-menu/actions';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  userPerm: PropTypes.string,\n  isNodeMenuShow: PropTypes.bool.isRequired,\n  treeData: PropTypes.object.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  onMenuItemClick: PropTypes.func,\n  onNodeClick: PropTypes.func.isRequired,\n  onNodeExpanded: PropTypes.func.isRequired,\n  onNodeCollapse: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func,\n  currentRepoInfo: PropTypes.object,\n  selectedDirentList: PropTypes.array,\n  onItemsMove: PropTypes.func,\n};\n\nconst PADDING_LEFT = 20;\n\nclass TreeView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n      isTreeViewDropTipShow: false,\n    };\n    const { userPerm } = props;\n    this.canDrop = userPerm === 'rw';\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    if (isCustomPermission) {\n      const { modify } = customPermission.permission;\n      this.canDrop = modify;\n    }\n  }\n\n  onItemMove = (repo, dirent, selectedPath, currentPath) => {\n    this.props.onItemMove(repo, dirent, selectedPath, currentPath);\n  }\n\n  onNodeDragStart = (e, node) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    let dragStartNodeData = {nodeDirent: node.object, nodeParentPath: node.parentNode.path, nodeRootPath: node.path};\n    dragStartNodeData = JSON.stringify(dragStartNodeData);\n\n    e.dataTransfer.effectAllowed = 'move';\n    e.dataTransfer.setData('applicaiton/drag-item-info', dragStartNodeData);\n  }\n\n  onNodeDragEnter = (e, node) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    e.persist();\n    if (e.target.className === 'tree-view tree ') {\n      this.setState({\n        isTreeViewDropTipShow: true,\n      });\n    }\n  }\n\n  onNodeDragMove = (e) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  }\n\n  onNodeDragLeave = (e, node) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    if (e.target.className === 'tree-view tree tree-view-drop') {\n      this.setState({\n        isTreeViewDropTipShow: false,\n      });\n    }\n  }\n\n  onContainerClick = (event) => {\n    hideMenu();\n  }\n\n  onNodeClick = (node) => {\n    hideMenu();\n    this.props.onNodeClick(node);\n  }\n\n  onNodeDrop = (e, node) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    if (e.dataTransfer.files.length) { // uploaded files\n      return;\n    }\n    let dragStartNodeData = e.dataTransfer.getData('applicaiton/drag-item-info');\n    dragStartNodeData = JSON.parse(dragStartNodeData);\n\n    let {nodeDirent, nodeParentPath, nodeRootPath} = dragStartNodeData;\n    let dropNodeData = node;\n\n    if (Array.isArray(dragStartNodeData)) { //move items\n      if (!dropNodeData) { //move items to root\n        if (dragStartNodeData[0].nodeParentPath === '/') {\n          this.setState({isTreeViewDropTipShow: false});\n          return;\n        }\n        this.props.onItemsMove(this.props.currentRepoInfo, '/');\n        this.setState({isTreeViewDropTipShow: false});\n        return;\n      }\n      this.onMoveItems(dragStartNodeData, dropNodeData, this.props.currentRepoInfo, dropNodeData.path);\n      return;\n    }\n\n    if (!dropNodeData) {\n      if (nodeParentPath === '/') {\n        this.setState({isTreeViewDropTipShow: false});\n        return;\n      }\n      this.onItemMove(this.props.currentRepoInfo, nodeDirent, '/', nodeParentPath);\n      this.setState({isTreeViewDropTipShow: false});\n      return;\n    }\n\n    if (dropNodeData.object.type !== 'dir') {\n      return;\n    }\n\n    if (nodeParentPath === dropNodeData.path) {\n      return;\n    }\n\n    // copy the dirent to itself. eg: A/B -> A/B\n    if (nodeParentPath === dropNodeData.parentNode.path) {\n      if (dropNodeData.object.name === nodeDirent.name) {\n        return;\n      }\n    }\n\n    // copy the dirent to it's child. eg: A/B -> A/B/C\n    if (dropNodeData.object.type === 'dir' && nodeDirent.type === 'dir') {\n      if (dropNodeData.parentNode.path !== nodeParentPath) {\n        let paths = Utils.getPaths(dropNodeData.path);\n        if (paths.includes(nodeRootPath)) {\n          return;\n        }\n      }\n    }\n\n    this.onItemMove(this.props.currentRepoInfo, nodeDirent, dropNodeData.path, nodeParentPath);\n  }\n\n  onMoveItems = (dragStartNodeData, dropNodeData, destRepo, destDirentPath) => {\n    let direntPaths = [];\n    let paths = Utils.getPaths(destDirentPath);\n    dragStartNodeData.forEach(dirent => {\n      let path = dirent.nodeRootPath;\n      direntPaths.push(path);\n    });\n\n    if (dropNodeData.object.type !== 'dir') {\n      return;\n    }\n\n    // move dirents to one of them. eg: A/B, A/C -> A/B\n    if (direntPaths.some(direntPath => { return direntPath === destDirentPath;})) {\n      return;\n    }\n\n    // move dirents to current path\n    if (dragStartNodeData[0].nodeParentPath && dragStartNodeData[0].nodeParentPath === dropNodeData.path ) {\n      return;\n    }\n\n    // move dirents to one of their child. eg: A/B, A/D -> A/B/C\n    let isChildPath = direntPaths.some(direntPath => {\n      return paths.includes(direntPath);\n    });\n    if (isChildPath) {\n      return;\n    }\n\n    this.props.onItemsMove(destRepo, destDirentPath);\n  }\n\n  freezeItem = () => {\n    this.setState({isItemFreezed: true});\n  }\n\n  unfreezeItem = () => {\n    this.setState({isItemFreezed: false});\n  }\n\n  onMenuItemClick = (operation, node) => {\n    this.props.onMenuItemClick(operation, node);\n    hideMenu();\n  }\n\n  onMouseDown = (event) => {\n    event.stopPropagation();\n    if (event.button === 2) {\n      return;\n    }\n  }\n\n  onContextMenu = (event) => {\n    event.preventDefault();\n\n    let currentRepoInfo = this.props.currentRepoInfo;\n    if (currentRepoInfo.permission !== 'admin' && currentRepoInfo.permission !== 'rw') {\n      return '';\n    }\n    this.handleContextClick(event);\n  }\n\n  handleContextClick = (event, node) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    if (!this.props.isNodeMenuShow) {\n      return;\n    }\n\n    let x = event.clientX || (event.touches && event.touches[0].pageX);\n    let y = event.clientY || (event.touches && event.touches[0].pageY);\n\n    if (this.props.posX) {\n      x -= this.props.posX;\n    }\n    if (this.props.posY) {\n      y -= this.props.posY;\n    }\n\n    hideMenu();\n\n    let menuList = this.getMenuList(node);\n\n    let showMenuConfig = {\n      id: 'tree-node-contextmenu',\n      position: { x, y },\n      target: event.target,\n      currentObject: node,\n      menuList: menuList,\n    };\n\n    showMenu(showMenuConfig);\n  }\n\n  getMenuList = (node) => {\n    let menuList = [];\n\n    let { NEW_FOLDER, NEW_FILE, COPY, MOVE, RENAME, DELETE, OPEN_VIA_CLIENT } = TextTranslation;\n\n    if (!node) {\n      return [NEW_FOLDER, NEW_FILE];\n    }\n\n    if (node.object.type === 'dir') {\n      menuList = [NEW_FOLDER, NEW_FILE, COPY, MOVE, RENAME, DELETE];\n    } else {\n      menuList = [RENAME, DELETE, COPY, MOVE, OPEN_VIA_CLIENT];\n    }\n\n    const { userPerm } = this.props;\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    if (!isCustomPermission) {\n      return menuList;\n    }\n\n    menuList = [];\n\n    const { create: canCreate, modify: canModify, delete: canDelete, copy: canCopy } = customPermission.permission;\n    if (!node) {\n      canCreate && menuList.push(NEW_FOLDER, NEW_FILE);\n      return menuList;\n    }\n\n    if (node.object.type === 'dir') {\n      canCreate && menuList.push(NEW_FOLDER, NEW_FILE);\n    }\n\n    canCopy && menuList.push(COPY);\n    canModify && menuList.push(MOVE, RENAME);\n    canDelete && menuList.push(DELETE);\n\n    if (node.object.type !== 'dir') { \n      menuList.push(OPEN_VIA_CLIENT);\n    }\n\n    return menuList;\n  }\n\n  onShowMenu = () => {\n    this.freezeItem();\n  }\n\n  onHideMenu = () => {\n    this.unfreezeItem();\n  }\n\n  render() {\n    return (\n      <div\n        className={`tree-view tree ${(this.state.isTreeViewDropTipShow && this.canDrop) ? 'tree-view-drop' : ''}`}\n        onDrop={this.onNodeDrop}\n        onDragEnter={this.onNodeDragEnter}\n        onDragLeave={this.onNodeDragLeave}\n        onMouseDown={this.onMouseDown}\n        onContextMenu={this.onContextMenu}\n        onClick={this.onContainerClick}\n      >\n        <TreeNodeView\n          userPerm={this.props.userPerm}\n          node={this.props.treeData.root}\n          currentPath={this.props.currentPath}\n          paddingLeft={PADDING_LEFT}\n          isNodeMenuShow={this.props.isNodeMenuShow}\n          isItemFreezed={this.state.isItemFreezed}\n          onNodeClick={this.onNodeClick}\n          onMenuItemClick={this.props.onMenuItemClick}\n          onNodeExpanded={this.props.onNodeExpanded}\n          onNodeCollapse={this.props.onNodeCollapse}\n          onNodeDragStart={this.onNodeDragStart}\n          freezeItem={this.freezeItem}\n          unfreezeItem={this.unfreezeItem}\n          onNodeDragMove={this.onNodeDragMove}\n          onNodeDrop={this.onNodeDrop}\n          onNodeDragEnter={this.onNodeDragEnter}\n          onNodeDragLeave={this.onNodeDragLeave}\n          handleContextClick={this.handleContextClick}\n        />\n        <ContextMenu\n          id={'tree-node-contextmenu'}\n          onMenuItemClick={this.onMenuItemClick}\n          onHideMenu={this.onHideMenu}\n          onShowMenu={this.onShowMenu}\n        />\n      </div>\n    );\n  }\n}\n\nTreeView.propTypes = propTypes;\n\nexport default TreeView;\n","\n/**\n * Module dependencies.\n */\n\nvar parseuri = require('parseuri');\nvar debug = require('debug')('socket.io-client:url');\n\n/**\n * Module exports.\n */\n\nmodule.exports = url;\n\n/**\n * URL parser.\n *\n * @param {String} url\n * @param {Object} An object meant to mimic window.location.\n *                 Defaults to window.location.\n * @api public\n */\n\nfunction url (uri, loc) {\n  var obj = uri;\n\n  // default to window.location\n  loc = loc || (typeof location !== 'undefined' && location);\n  if (null == uri) uri = loc.protocol + '//' + loc.host;\n\n  // relative path support\n  if ('string' === typeof uri) {\n    if ('/' === uri.charAt(0)) {\n      if ('/' === uri.charAt(1)) {\n        uri = loc.protocol + uri;\n      } else {\n        uri = loc.host + uri;\n      }\n    }\n\n    if (!/^(https?|wss?):\\/\\//.test(uri)) {\n      debug('protocol-less url %s', uri);\n      if ('undefined' !== typeof loc) {\n        uri = loc.protocol + '//' + uri;\n      } else {\n        uri = 'https://' + uri;\n      }\n    }\n\n    // parse\n    debug('parse %s', uri);\n    obj = parseuri(uri);\n  }\n\n  // make sure we treat `localhost:80` and `localhost` equally\n  if (!obj.port) {\n    if (/^(http|ws)$/.test(obj.protocol)) {\n      obj.port = '80';\n    } else if (/^(http|ws)s$/.test(obj.protocol)) {\n      obj.port = '443';\n    }\n  }\n\n  obj.path = obj.path || '/';\n\n  var ipv6 = obj.host.indexOf(':') !== -1;\n  var host = ipv6 ? '[' + obj.host + ']' : obj.host;\n\n  // define unique id\n  obj.id = obj.protocol + '://' + host + ':' + obj.port;\n  // define href\n  obj.href = obj.protocol + '://' + host + (loc && loc.port === obj.port ? '' : (':' + obj.port));\n\n  return obj;\n}\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = createDebug.debug = createDebug['default'] = createDebug;\nexports.coerce = coerce;\nexports.disable = disable;\nexports.enable = enable;\nexports.enabled = enabled;\nexports.humanize = require('ms');\n\n/**\n * Active `debug` instances.\n */\nexports.instances = [];\n\n/**\n * The currently active debug mode names, and names to skip.\n */\n\nexports.names = [];\nexports.skips = [];\n\n/**\n * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n *\n * Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n */\n\nexports.formatters = {};\n\n/**\n * Select a color.\n * @param {String} namespace\n * @return {Number}\n * @api private\n */\n\nfunction selectColor(namespace) {\n  var hash = 0, i;\n\n  for (i in namespace) {\n    hash  = ((hash << 5) - hash) + namespace.charCodeAt(i);\n    hash |= 0; // Convert to 32bit integer\n  }\n\n  return exports.colors[Math.abs(hash) % exports.colors.length];\n}\n\n/**\n * Create a debugger with the given `namespace`.\n *\n * @param {String} namespace\n * @return {Function}\n * @api public\n */\n\nfunction createDebug(namespace) {\n\n  var prevTime;\n\n  function debug() {\n    // disabled?\n    if (!debug.enabled) return;\n\n    var self = debug;\n\n    // set `diff` timestamp\n    var curr = +new Date();\n    var ms = curr - (prevTime || curr);\n    self.diff = ms;\n    self.prev = prevTime;\n    self.curr = curr;\n    prevTime = curr;\n\n    // turn the `arguments` into a proper Array\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n\n    args[0] = exports.coerce(args[0]);\n\n    if ('string' !== typeof args[0]) {\n      // anything else let's inspect with %O\n      args.unshift('%O');\n    }\n\n    // apply any `formatters` transformations\n    var index = 0;\n    args[0] = args[0].replace(/%([a-zA-Z%])/g, function(match, format) {\n      // if we encounter an escaped % then don't increase the array index\n      if (match === '%%') return match;\n      index++;\n      var formatter = exports.formatters[format];\n      if ('function' === typeof formatter) {\n        var val = args[index];\n        match = formatter.call(self, val);\n\n        // now we need to remove `args[index]` since it's inlined in the `format`\n        args.splice(index, 1);\n        index--;\n      }\n      return match;\n    });\n\n    // apply env-specific formatting (colors, etc.)\n    exports.formatArgs.call(self, args);\n\n    var logFn = debug.log || exports.log || console.log.bind(console);\n    logFn.apply(self, args);\n  }\n\n  debug.namespace = namespace;\n  debug.enabled = exports.enabled(namespace);\n  debug.useColors = exports.useColors();\n  debug.color = selectColor(namespace);\n  debug.destroy = destroy;\n\n  // env-specific initialization logic for debug instances\n  if ('function' === typeof exports.init) {\n    exports.init(debug);\n  }\n\n  exports.instances.push(debug);\n\n  return debug;\n}\n\nfunction destroy () {\n  var index = exports.instances.indexOf(this);\n  if (index !== -1) {\n    exports.instances.splice(index, 1);\n    return true;\n  } else {\n    return false;\n  }\n}\n\n/**\n * Enables a debug mode by namespaces. This can include modes\n * separated by a colon and wildcards.\n *\n * @param {String} namespaces\n * @api public\n */\n\nfunction enable(namespaces) {\n  exports.save(namespaces);\n\n  exports.names = [];\n  exports.skips = [];\n\n  var i;\n  var split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n  var len = split.length;\n\n  for (i = 0; i < len; i++) {\n    if (!split[i]) continue; // ignore empty strings\n    namespaces = split[i].replace(/\\*/g, '.*?');\n    if (namespaces[0] === '-') {\n      exports.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n    } else {\n      exports.names.push(new RegExp('^' + namespaces + '$'));\n    }\n  }\n\n  for (i = 0; i < exports.instances.length; i++) {\n    var instance = exports.instances[i];\n    instance.enabled = exports.enabled(instance.namespace);\n  }\n}\n\n/**\n * Disable debug output.\n *\n * @api public\n */\n\nfunction disable() {\n  exports.enable('');\n}\n\n/**\n * Returns true if the given mode name is enabled, false otherwise.\n *\n * @param {String} name\n * @return {Boolean}\n * @api public\n */\n\nfunction enabled(name) {\n  if (name[name.length - 1] === '*') {\n    return true;\n  }\n  var i, len;\n  for (i = 0, len = exports.skips.length; i < len; i++) {\n    if (exports.skips[i].test(name)) {\n      return false;\n    }\n  }\n  for (i = 0, len = exports.names.length; i < len; i++) {\n    if (exports.names[i].test(name)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Coerce `val`.\n *\n * @param {Mixed} val\n * @return {Mixed}\n * @api private\n */\n\nfunction coerce(val) {\n  if (val instanceof Error) return val.stack || val.message;\n  return val;\n}\n","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isNaN(val) === false) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^((?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  if (ms >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (ms >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (ms >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (ms >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  return plural(ms, d, 'day') ||\n    plural(ms, h, 'hour') ||\n    plural(ms, m, 'minute') ||\n    plural(ms, s, 'second') ||\n    ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, n, name) {\n  if (ms < n) {\n    return;\n  }\n  if (ms < n * 1.5) {\n    return Math.floor(ms / n) + ' ' + name;\n  }\n  return Math.ceil(ms / n) + ' ' + name + 's';\n}\n","/*global Blob,File*/\n\n/**\n * Module requirements\n */\n\nvar isArray = require('isarray');\nvar isBuf = require('./is-buffer');\nvar toString = Object.prototype.toString;\nvar withNativeBlob = typeof Blob === 'function' || (typeof Blob !== 'undefined' && toString.call(Blob) === '[object BlobConstructor]');\nvar withNativeFile = typeof File === 'function' || (typeof File !== 'undefined' && toString.call(File) === '[object FileConstructor]');\n\n/**\n * Replaces every Buffer | ArrayBuffer in packet with a numbered placeholder.\n * Anything with blobs or files should be fed through removeBlobs before coming\n * here.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @api public\n */\n\nexports.deconstructPacket = function(packet) {\n  var buffers = [];\n  var packetData = packet.data;\n  var pack = packet;\n  pack.data = _deconstructPacket(packetData, buffers);\n  pack.attachments = buffers.length; // number of binary 'attachments'\n  return {packet: pack, buffers: buffers};\n};\n\nfunction _deconstructPacket(data, buffers) {\n  if (!data) return data;\n\n  if (isBuf(data)) {\n    var placeholder = { _placeholder: true, num: buffers.length };\n    buffers.push(data);\n    return placeholder;\n  } else if (isArray(data)) {\n    var newData = new Array(data.length);\n    for (var i = 0; i < data.length; i++) {\n      newData[i] = _deconstructPacket(data[i], buffers);\n    }\n    return newData;\n  } else if (typeof data === 'object' && !(data instanceof Date)) {\n    var newData = {};\n    for (var key in data) {\n      newData[key] = _deconstructPacket(data[key], buffers);\n    }\n    return newData;\n  }\n  return data;\n}\n\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @api public\n */\n\nexports.reconstructPacket = function(packet, buffers) {\n  packet.data = _reconstructPacket(packet.data, buffers);\n  packet.attachments = undefined; // no longer useful\n  return packet;\n};\n\nfunction _reconstructPacket(data, buffers) {\n  if (!data) return data;\n\n  if (data && data._placeholder === true) {\n    var isIndexValid =\n      typeof data.num === \"number\" &&\n      data.num >= 0 &&\n      data.num < buffers.length;\n    if (isIndexValid) {\n      return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n    } else {\n      throw new Error(\"illegal attachments\");\n    }\n  } else if (isArray(data)) {\n    for (var i = 0; i < data.length; i++) {\n      data[i] = _reconstructPacket(data[i], buffers);\n    }\n  } else if (typeof data === 'object') {\n    for (var key in data) {\n      data[key] = _reconstructPacket(data[key], buffers);\n    }\n  }\n\n  return data;\n}\n\n/**\n * Asynchronously removes Blobs or Files from data via\n * FileReader's readAsArrayBuffer method. Used before encoding\n * data as msgpack. Calls callback with the blobless data.\n *\n * @param {Object} data\n * @param {Function} callback\n * @api private\n */\n\nexports.removeBlobs = function(data, callback) {\n  function _removeBlobs(obj, curKey, containingObject) {\n    if (!obj) return obj;\n\n    // convert any blob\n    if ((withNativeBlob && obj instanceof Blob) ||\n        (withNativeFile && obj instanceof File)) {\n      pendingBlobs++;\n\n      // async filereader\n      var fileReader = new FileReader();\n      fileReader.onload = function() { // this.result == arraybuffer\n        if (containingObject) {\n          containingObject[curKey] = this.result;\n        }\n        else {\n          bloblessData = this.result;\n        }\n\n        // if nothing pending its callback time\n        if(! --pendingBlobs) {\n          callback(bloblessData);\n        }\n      };\n\n      fileReader.readAsArrayBuffer(obj); // blob -> arraybuffer\n    } else if (isArray(obj)) { // handle array\n      for (var i = 0; i < obj.length; i++) {\n        _removeBlobs(obj[i], i, obj);\n      }\n    } else if (typeof obj === 'object' && !isBuf(obj)) { // and object\n      for (var key in obj) {\n        _removeBlobs(obj[key], key, obj);\n      }\n    }\n  }\n\n  var pendingBlobs = 0;\n  var bloblessData = data;\n  _removeBlobs(bloblessData);\n  if (!pendingBlobs) {\n    callback(bloblessData);\n  }\n};\n","\nmodule.exports = require('./socket');\n\n/**\n * Exports parser\n *\n * @api public\n *\n */\nmodule.exports.parser = require('engine.io-parser');\n","/**\n * Module dependencies.\n */\n\nvar transports = require('./transports/index');\nvar Emitter = require('component-emitter');\nvar debug = require('debug')('engine.io-client:socket');\nvar index = require('indexof');\nvar parser = require('engine.io-parser');\nvar parseuri = require('parseuri');\nvar parseqs = require('parseqs');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Socket;\n\n/**\n * Socket constructor.\n *\n * @param {String|Object} uri or options\n * @param {Object} options\n * @api public\n */\n\nfunction Socket (uri, opts) {\n  if (!(this instanceof Socket)) return new Socket(uri, opts);\n\n  opts = opts || {};\n\n  if (uri && 'object' === typeof uri) {\n    opts = uri;\n    uri = null;\n  }\n\n  if (uri) {\n    uri = parseuri(uri);\n    opts.hostname = uri.host;\n    opts.secure = uri.protocol === 'https' || uri.protocol === 'wss';\n    opts.port = uri.port;\n    if (uri.query) opts.query = uri.query;\n  } else if (opts.host) {\n    opts.hostname = parseuri(opts.host).host;\n  }\n\n  this.secure = null != opts.secure ? opts.secure\n    : (typeof location !== 'undefined' && 'https:' === location.protocol);\n\n  if (opts.hostname && !opts.port) {\n    // if no port is specified manually, use the protocol default\n    opts.port = this.secure ? '443' : '80';\n  }\n\n  this.agent = opts.agent || false;\n  this.hostname = opts.hostname ||\n    (typeof location !== 'undefined' ? location.hostname : 'localhost');\n  this.port = opts.port || (typeof location !== 'undefined' && location.port\n      ? location.port\n      : (this.secure ? 443 : 80));\n  this.query = opts.query || {};\n  if ('string' === typeof this.query) this.query = parseqs.decode(this.query);\n  this.upgrade = false !== opts.upgrade;\n  this.path = (opts.path || '/engine.io').replace(/\\/$/, '') + '/';\n  this.forceJSONP = !!opts.forceJSONP;\n  this.jsonp = false !== opts.jsonp;\n  this.forceBase64 = !!opts.forceBase64;\n  this.enablesXDR = !!opts.enablesXDR;\n  this.withCredentials = false !== opts.withCredentials;\n  this.timestampParam = opts.timestampParam || 't';\n  this.timestampRequests = opts.timestampRequests;\n  this.transports = opts.transports || ['polling', 'websocket'];\n  this.transportOptions = opts.transportOptions || {};\n  this.readyState = '';\n  this.writeBuffer = [];\n  this.prevBufferLen = 0;\n  this.policyPort = opts.policyPort || 843;\n  this.rememberUpgrade = opts.rememberUpgrade || false;\n  this.binaryType = null;\n  this.onlyBinaryUpgrades = opts.onlyBinaryUpgrades;\n  this.perMessageDeflate = false !== opts.perMessageDeflate ? (opts.perMessageDeflate || {}) : false;\n\n  if (true === this.perMessageDeflate) this.perMessageDeflate = {};\n  if (this.perMessageDeflate && null == this.perMessageDeflate.threshold) {\n    this.perMessageDeflate.threshold = 1024;\n  }\n\n  // SSL options for Node.js client\n  this.pfx = opts.pfx || undefined;\n  this.key = opts.key || undefined;\n  this.passphrase = opts.passphrase || undefined;\n  this.cert = opts.cert || undefined;\n  this.ca = opts.ca || undefined;\n  this.ciphers = opts.ciphers || undefined;\n  this.rejectUnauthorized = opts.rejectUnauthorized === undefined ? true : opts.rejectUnauthorized;\n  this.forceNode = !!opts.forceNode;\n\n  // detect ReactNative environment\n  this.isReactNative = (typeof navigator !== 'undefined' && typeof navigator.product === 'string' && navigator.product.toLowerCase() === 'reactnative');\n\n  // other options for Node.js or ReactNative client\n  if (typeof self === 'undefined' || this.isReactNative) {\n    if (opts.extraHeaders && Object.keys(opts.extraHeaders).length > 0) {\n      this.extraHeaders = opts.extraHeaders;\n    }\n\n    if (opts.localAddress) {\n      this.localAddress = opts.localAddress;\n    }\n  }\n\n  // set on handshake\n  this.id = null;\n  this.upgrades = null;\n  this.pingInterval = null;\n  this.pingTimeout = null;\n\n  // set on heartbeat\n  this.pingIntervalTimer = null;\n  this.pingTimeoutTimer = null;\n\n  this.open();\n}\n\nSocket.priorWebsocketSuccess = false;\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Socket.prototype);\n\n/**\n * Protocol version.\n *\n * @api public\n */\n\nSocket.protocol = parser.protocol; // this is an int\n\n/**\n * Expose deps for legacy compatibility\n * and standalone browser access.\n */\n\nSocket.Socket = Socket;\nSocket.Transport = require('./transport');\nSocket.transports = require('./transports/index');\nSocket.parser = require('engine.io-parser');\n\n/**\n * Creates transport of the given type.\n *\n * @param {String} transport name\n * @return {Transport}\n * @api private\n */\n\nSocket.prototype.createTransport = function (name) {\n  debug('creating transport \"%s\"', name);\n  var query = clone(this.query);\n\n  // append engine.io protocol identifier\n  query.EIO = parser.protocol;\n\n  // transport name\n  query.transport = name;\n\n  // per-transport options\n  var options = this.transportOptions[name] || {};\n\n  // session id if we already have one\n  if (this.id) query.sid = this.id;\n\n  var transport = new transports[name]({\n    query: query,\n    socket: this,\n    agent: options.agent || this.agent,\n    hostname: options.hostname || this.hostname,\n    port: options.port || this.port,\n    secure: options.secure || this.secure,\n    path: options.path || this.path,\n    forceJSONP: options.forceJSONP || this.forceJSONP,\n    jsonp: options.jsonp || this.jsonp,\n    forceBase64: options.forceBase64 || this.forceBase64,\n    enablesXDR: options.enablesXDR || this.enablesXDR,\n    withCredentials: options.withCredentials || this.withCredentials,\n    timestampRequests: options.timestampRequests || this.timestampRequests,\n    timestampParam: options.timestampParam || this.timestampParam,\n    policyPort: options.policyPort || this.policyPort,\n    pfx: options.pfx || this.pfx,\n    key: options.key || this.key,\n    passphrase: options.passphrase || this.passphrase,\n    cert: options.cert || this.cert,\n    ca: options.ca || this.ca,\n    ciphers: options.ciphers || this.ciphers,\n    rejectUnauthorized: options.rejectUnauthorized || this.rejectUnauthorized,\n    perMessageDeflate: options.perMessageDeflate || this.perMessageDeflate,\n    extraHeaders: options.extraHeaders || this.extraHeaders,\n    forceNode: options.forceNode || this.forceNode,\n    localAddress: options.localAddress || this.localAddress,\n    requestTimeout: options.requestTimeout || this.requestTimeout,\n    protocols: options.protocols || void (0),\n    isReactNative: this.isReactNative\n  });\n\n  return transport;\n};\n\nfunction clone (obj) {\n  var o = {};\n  for (var i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      o[i] = obj[i];\n    }\n  }\n  return o;\n}\n\n/**\n * Initializes transport to use and starts probe.\n *\n * @api private\n */\nSocket.prototype.open = function () {\n  var transport;\n  if (this.rememberUpgrade && Socket.priorWebsocketSuccess && this.transports.indexOf('websocket') !== -1) {\n    transport = 'websocket';\n  } else if (0 === this.transports.length) {\n    // Emit error on next tick so it can be listened to\n    var self = this;\n    setTimeout(function () {\n      self.emit('error', 'No transports available');\n    }, 0);\n    return;\n  } else {\n    transport = this.transports[0];\n  }\n  this.readyState = 'opening';\n\n  // Retry with the next transport if the transport is disabled (jsonp: false)\n  try {\n    transport = this.createTransport(transport);\n  } catch (e) {\n    this.transports.shift();\n    this.open();\n    return;\n  }\n\n  transport.open();\n  this.setTransport(transport);\n};\n\n/**\n * Sets the current transport. Disables the existing one (if any).\n *\n * @api private\n */\n\nSocket.prototype.setTransport = function (transport) {\n  debug('setting transport %s', transport.name);\n  var self = this;\n\n  if (this.transport) {\n    debug('clearing existing transport %s', this.transport.name);\n    this.transport.removeAllListeners();\n  }\n\n  // set up transport\n  this.transport = transport;\n\n  // set up transport listeners\n  transport\n  .on('drain', function () {\n    self.onDrain();\n  })\n  .on('packet', function (packet) {\n    self.onPacket(packet);\n  })\n  .on('error', function (e) {\n    self.onError(e);\n  })\n  .on('close', function () {\n    self.onClose('transport close');\n  });\n};\n\n/**\n * Probes a transport.\n *\n * @param {String} transport name\n * @api private\n */\n\nSocket.prototype.probe = function (name) {\n  debug('probing transport \"%s\"', name);\n  var transport = this.createTransport(name, { probe: 1 });\n  var failed = false;\n  var self = this;\n\n  Socket.priorWebsocketSuccess = false;\n\n  function onTransportOpen () {\n    if (self.onlyBinaryUpgrades) {\n      var upgradeLosesBinary = !this.supportsBinary && self.transport.supportsBinary;\n      failed = failed || upgradeLosesBinary;\n    }\n    if (failed) return;\n\n    debug('probe transport \"%s\" opened', name);\n    transport.send([{ type: 'ping', data: 'probe' }]);\n    transport.once('packet', function (msg) {\n      if (failed) return;\n      if ('pong' === msg.type && 'probe' === msg.data) {\n        debug('probe transport \"%s\" pong', name);\n        self.upgrading = true;\n        self.emit('upgrading', transport);\n        if (!transport) return;\n        Socket.priorWebsocketSuccess = 'websocket' === transport.name;\n\n        debug('pausing current transport \"%s\"', self.transport.name);\n        self.transport.pause(function () {\n          if (failed) return;\n          if ('closed' === self.readyState) return;\n          debug('changing transport and sending upgrade packet');\n\n          cleanup();\n\n          self.setTransport(transport);\n          transport.send([{ type: 'upgrade' }]);\n          self.emit('upgrade', transport);\n          transport = null;\n          self.upgrading = false;\n          self.flush();\n        });\n      } else {\n        debug('probe transport \"%s\" failed', name);\n        var err = new Error('probe error');\n        err.transport = transport.name;\n        self.emit('upgradeError', err);\n      }\n    });\n  }\n\n  function freezeTransport () {\n    if (failed) return;\n\n    // Any callback called by transport should be ignored since now\n    failed = true;\n\n    cleanup();\n\n    transport.close();\n    transport = null;\n  }\n\n  // Handle any error that happens while probing\n  function onerror (err) {\n    var error = new Error('probe error: ' + err);\n    error.transport = transport.name;\n\n    freezeTransport();\n\n    debug('probe transport \"%s\" failed because of error: %s', name, err);\n\n    self.emit('upgradeError', error);\n  }\n\n  function onTransportClose () {\n    onerror('transport closed');\n  }\n\n  // When the socket is closed while we're probing\n  function onclose () {\n    onerror('socket closed');\n  }\n\n  // When the socket is upgraded while we're probing\n  function onupgrade (to) {\n    if (transport && to.name !== transport.name) {\n      debug('\"%s\" works - aborting \"%s\"', to.name, transport.name);\n      freezeTransport();\n    }\n  }\n\n  // Remove all listeners on the transport and on self\n  function cleanup () {\n    transport.removeListener('open', onTransportOpen);\n    transport.removeListener('error', onerror);\n    transport.removeListener('close', onTransportClose);\n    self.removeListener('close', onclose);\n    self.removeListener('upgrading', onupgrade);\n  }\n\n  transport.once('open', onTransportOpen);\n  transport.once('error', onerror);\n  transport.once('close', onTransportClose);\n\n  this.once('close', onclose);\n  this.once('upgrading', onupgrade);\n\n  transport.open();\n};\n\n/**\n * Called when connection is deemed open.\n *\n * @api public\n */\n\nSocket.prototype.onOpen = function () {\n  debug('socket open');\n  this.readyState = 'open';\n  Socket.priorWebsocketSuccess = 'websocket' === this.transport.name;\n  this.emit('open');\n  this.flush();\n\n  // we check for `readyState` in case an `open`\n  // listener already closed the socket\n  if ('open' === this.readyState && this.upgrade && this.transport.pause) {\n    debug('starting upgrade probes');\n    for (var i = 0, l = this.upgrades.length; i < l; i++) {\n      this.probe(this.upgrades[i]);\n    }\n  }\n};\n\n/**\n * Handles a packet.\n *\n * @api private\n */\n\nSocket.prototype.onPacket = function (packet) {\n  if ('opening' === this.readyState || 'open' === this.readyState ||\n      'closing' === this.readyState) {\n    debug('socket receive: type \"%s\", data \"%s\"', packet.type, packet.data);\n\n    this.emit('packet', packet);\n\n    // Socket is live - any packet counts\n    this.emit('heartbeat');\n\n    switch (packet.type) {\n      case 'open':\n        this.onHandshake(JSON.parse(packet.data));\n        break;\n\n      case 'pong':\n        this.setPing();\n        this.emit('pong');\n        break;\n\n      case 'error':\n        var err = new Error('server error');\n        err.code = packet.data;\n        this.onError(err);\n        break;\n\n      case 'message':\n        this.emit('data', packet.data);\n        this.emit('message', packet.data);\n        break;\n    }\n  } else {\n    debug('packet received with socket readyState \"%s\"', this.readyState);\n  }\n};\n\n/**\n * Called upon handshake completion.\n *\n * @param {Object} handshake obj\n * @api private\n */\n\nSocket.prototype.onHandshake = function (data) {\n  this.emit('handshake', data);\n  this.id = data.sid;\n  this.transport.query.sid = data.sid;\n  this.upgrades = this.filterUpgrades(data.upgrades);\n  this.pingInterval = data.pingInterval;\n  this.pingTimeout = data.pingTimeout;\n  this.onOpen();\n  // In case open handler closes socket\n  if ('closed' === this.readyState) return;\n  this.setPing();\n\n  // Prolong liveness of socket on heartbeat\n  this.removeListener('heartbeat', this.onHeartbeat);\n  this.on('heartbeat', this.onHeartbeat);\n};\n\n/**\n * Resets ping timeout.\n *\n * @api private\n */\n\nSocket.prototype.onHeartbeat = function (timeout) {\n  clearTimeout(this.pingTimeoutTimer);\n  var self = this;\n  self.pingTimeoutTimer = setTimeout(function () {\n    if ('closed' === self.readyState) return;\n    self.onClose('ping timeout');\n  }, timeout || (self.pingInterval + self.pingTimeout));\n};\n\n/**\n * Pings server every `this.pingInterval` and expects response\n * within `this.pingTimeout` or closes connection.\n *\n * @api private\n */\n\nSocket.prototype.setPing = function () {\n  var self = this;\n  clearTimeout(self.pingIntervalTimer);\n  self.pingIntervalTimer = setTimeout(function () {\n    debug('writing ping packet - expecting pong within %sms', self.pingTimeout);\n    self.ping();\n    self.onHeartbeat(self.pingTimeout);\n  }, self.pingInterval);\n};\n\n/**\n* Sends a ping packet.\n*\n* @api private\n*/\n\nSocket.prototype.ping = function () {\n  var self = this;\n  this.sendPacket('ping', function () {\n    self.emit('ping');\n  });\n};\n\n/**\n * Called on `drain` event\n *\n * @api private\n */\n\nSocket.prototype.onDrain = function () {\n  this.writeBuffer.splice(0, this.prevBufferLen);\n\n  // setting prevBufferLen = 0 is very important\n  // for example, when upgrading, upgrade packet is sent over,\n  // and a nonzero prevBufferLen could cause problems on `drain`\n  this.prevBufferLen = 0;\n\n  if (0 === this.writeBuffer.length) {\n    this.emit('drain');\n  } else {\n    this.flush();\n  }\n};\n\n/**\n * Flush write buffers.\n *\n * @api private\n */\n\nSocket.prototype.flush = function () {\n  if ('closed' !== this.readyState && this.transport.writable &&\n    !this.upgrading && this.writeBuffer.length) {\n    debug('flushing %d packets in socket', this.writeBuffer.length);\n    this.transport.send(this.writeBuffer);\n    // keep track of current length of writeBuffer\n    // splice writeBuffer and callbackBuffer on `drain`\n    this.prevBufferLen = this.writeBuffer.length;\n    this.emit('flush');\n  }\n};\n\n/**\n * Sends a message.\n *\n * @param {String} message.\n * @param {Function} callback function.\n * @param {Object} options.\n * @return {Socket} for chaining.\n * @api public\n */\n\nSocket.prototype.write =\nSocket.prototype.send = function (msg, options, fn) {\n  this.sendPacket('message', msg, options, fn);\n  return this;\n};\n\n/**\n * Sends a packet.\n *\n * @param {String} packet type.\n * @param {String} data.\n * @param {Object} options.\n * @param {Function} callback function.\n * @api private\n */\n\nSocket.prototype.sendPacket = function (type, data, options, fn) {\n  if ('function' === typeof data) {\n    fn = data;\n    data = undefined;\n  }\n\n  if ('function' === typeof options) {\n    fn = options;\n    options = null;\n  }\n\n  if ('closing' === this.readyState || 'closed' === this.readyState) {\n    return;\n  }\n\n  options = options || {};\n  options.compress = false !== options.compress;\n\n  var packet = {\n    type: type,\n    data: data,\n    options: options\n  };\n  this.emit('packetCreate', packet);\n  this.writeBuffer.push(packet);\n  if (fn) this.once('flush', fn);\n  this.flush();\n};\n\n/**\n * Closes the connection.\n *\n * @api private\n */\n\nSocket.prototype.close = function () {\n  if ('opening' === this.readyState || 'open' === this.readyState) {\n    this.readyState = 'closing';\n\n    var self = this;\n\n    if (this.writeBuffer.length) {\n      this.once('drain', function () {\n        if (this.upgrading) {\n          waitForUpgrade();\n        } else {\n          close();\n        }\n      });\n    } else if (this.upgrading) {\n      waitForUpgrade();\n    } else {\n      close();\n    }\n  }\n\n  function close () {\n    self.onClose('forced close');\n    debug('socket closing - telling transport to close');\n    self.transport.close();\n  }\n\n  function cleanupAndClose () {\n    self.removeListener('upgrade', cleanupAndClose);\n    self.removeListener('upgradeError', cleanupAndClose);\n    close();\n  }\n\n  function waitForUpgrade () {\n    // wait for upgrade to finish since we can't send packets while pausing a transport\n    self.once('upgrade', cleanupAndClose);\n    self.once('upgradeError', cleanupAndClose);\n  }\n\n  return this;\n};\n\n/**\n * Called upon transport error\n *\n * @api private\n */\n\nSocket.prototype.onError = function (err) {\n  debug('socket error %j', err);\n  Socket.priorWebsocketSuccess = false;\n  this.emit('error', err);\n  this.onClose('transport error', err);\n};\n\n/**\n * Called upon transport close.\n *\n * @api private\n */\n\nSocket.prototype.onClose = function (reason, desc) {\n  if ('opening' === this.readyState || 'open' === this.readyState || 'closing' === this.readyState) {\n    debug('socket close with reason: \"%s\"', reason);\n    var self = this;\n\n    // clear timers\n    clearTimeout(this.pingIntervalTimer);\n    clearTimeout(this.pingTimeoutTimer);\n\n    // stop event from firing again for transport\n    this.transport.removeAllListeners('close');\n\n    // ensure transport won't stay open\n    this.transport.close();\n\n    // ignore further transport communication\n    this.transport.removeAllListeners();\n\n    // set ready state\n    this.readyState = 'closed';\n\n    // clear session id\n    this.id = null;\n\n    // emit close event\n    this.emit('close', reason, desc);\n\n    // clean buffers after, so users can still\n    // grab the buffers on `close` event\n    self.writeBuffer = [];\n    self.prevBufferLen = 0;\n  }\n};\n\n/**\n * Filters upgrades, returning only those matching client transports.\n *\n * @param {Array} server upgrades\n * @api private\n *\n */\n\nSocket.prototype.filterUpgrades = function (upgrades) {\n  var filteredUpgrades = [];\n  for (var i = 0, j = upgrades.length; i < j; i++) {\n    if (~index(this.transports, upgrades[i])) filteredUpgrades.push(upgrades[i]);\n  }\n  return filteredUpgrades;\n};\n","\n/**\n * Module exports.\n *\n * Logic borrowed from Modernizr:\n *\n *   - https://github.com/Modernizr/Modernizr/blob/master/feature-detects/cors.js\n */\n\ntry {\n  module.exports = typeof XMLHttpRequest !== 'undefined' &&\n    'withCredentials' in new XMLHttpRequest();\n} catch (err) {\n  // if XMLHttp support is disabled in IE then it will throw\n  // when trying to create\n  module.exports = false;\n}\n","/* global attachEvent */\n\n/**\n * Module requirements.\n */\n\nvar XMLHttpRequest = require('./xmlhttprequest');\nvar Polling = require('./polling');\nvar Emitter = require('component-emitter');\nvar inherit = require('component-inherit');\nvar debug = require('debug')('engine.io-client:polling-xhr');\nvar globalThis = require('../globalThis');\n\n/**\n * Module exports.\n */\n\nmodule.exports = XHR;\nmodule.exports.Request = Request;\n\n/**\n * Empty function\n */\n\nfunction empty () {}\n\n/**\n * XHR Polling constructor.\n *\n * @param {Object} opts\n * @api public\n */\n\nfunction XHR (opts) {\n  Polling.call(this, opts);\n  this.requestTimeout = opts.requestTimeout;\n  this.extraHeaders = opts.extraHeaders;\n\n  if (typeof location !== 'undefined') {\n    var isSSL = 'https:' === location.protocol;\n    var port = location.port;\n\n    // some user agents have empty `location.port`\n    if (!port) {\n      port = isSSL ? 443 : 80;\n    }\n\n    this.xd = (typeof location !== 'undefined' && opts.hostname !== location.hostname) ||\n      port !== opts.port;\n    this.xs = opts.secure !== isSSL;\n  }\n}\n\n/**\n * Inherits from Polling.\n */\n\ninherit(XHR, Polling);\n\n/**\n * XHR supports binary\n */\n\nXHR.prototype.supportsBinary = true;\n\n/**\n * Creates a request.\n *\n * @param {String} method\n * @api private\n */\n\nXHR.prototype.request = function (opts) {\n  opts = opts || {};\n  opts.uri = this.uri();\n  opts.xd = this.xd;\n  opts.xs = this.xs;\n  opts.agent = this.agent || false;\n  opts.supportsBinary = this.supportsBinary;\n  opts.enablesXDR = this.enablesXDR;\n  opts.withCredentials = this.withCredentials;\n\n  // SSL options for Node.js client\n  opts.pfx = this.pfx;\n  opts.key = this.key;\n  opts.passphrase = this.passphrase;\n  opts.cert = this.cert;\n  opts.ca = this.ca;\n  opts.ciphers = this.ciphers;\n  opts.rejectUnauthorized = this.rejectUnauthorized;\n  opts.requestTimeout = this.requestTimeout;\n\n  // other options for Node.js client\n  opts.extraHeaders = this.extraHeaders;\n\n  return new Request(opts);\n};\n\n/**\n * Sends data.\n *\n * @param {String} data to send.\n * @param {Function} called upon flush.\n * @api private\n */\n\nXHR.prototype.doWrite = function (data, fn) {\n  var isBinary = typeof data !== 'string' && data !== undefined;\n  var req = this.request({ method: 'POST', data: data, isBinary: isBinary });\n  var self = this;\n  req.on('success', fn);\n  req.on('error', function (err) {\n    self.onError('xhr post error', err);\n  });\n  this.sendXhr = req;\n};\n\n/**\n * Starts a poll cycle.\n *\n * @api private\n */\n\nXHR.prototype.doPoll = function () {\n  debug('xhr poll');\n  var req = this.request();\n  var self = this;\n  req.on('data', function (data) {\n    self.onData(data);\n  });\n  req.on('error', function (err) {\n    self.onError('xhr poll error', err);\n  });\n  this.pollXhr = req;\n};\n\n/**\n * Request constructor\n *\n * @param {Object} options\n * @api public\n */\n\nfunction Request (opts) {\n  this.method = opts.method || 'GET';\n  this.uri = opts.uri;\n  this.xd = !!opts.xd;\n  this.xs = !!opts.xs;\n  this.async = false !== opts.async;\n  this.data = undefined !== opts.data ? opts.data : null;\n  this.agent = opts.agent;\n  this.isBinary = opts.isBinary;\n  this.supportsBinary = opts.supportsBinary;\n  this.enablesXDR = opts.enablesXDR;\n  this.withCredentials = opts.withCredentials;\n  this.requestTimeout = opts.requestTimeout;\n\n  // SSL options for Node.js client\n  this.pfx = opts.pfx;\n  this.key = opts.key;\n  this.passphrase = opts.passphrase;\n  this.cert = opts.cert;\n  this.ca = opts.ca;\n  this.ciphers = opts.ciphers;\n  this.rejectUnauthorized = opts.rejectUnauthorized;\n\n  // other options for Node.js client\n  this.extraHeaders = opts.extraHeaders;\n\n  this.create();\n}\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Request.prototype);\n\n/**\n * Creates the XHR object and sends the request.\n *\n * @api private\n */\n\nRequest.prototype.create = function () {\n  var opts = { agent: this.agent, xdomain: this.xd, xscheme: this.xs, enablesXDR: this.enablesXDR };\n\n  // SSL options for Node.js client\n  opts.pfx = this.pfx;\n  opts.key = this.key;\n  opts.passphrase = this.passphrase;\n  opts.cert = this.cert;\n  opts.ca = this.ca;\n  opts.ciphers = this.ciphers;\n  opts.rejectUnauthorized = this.rejectUnauthorized;\n\n  var xhr = this.xhr = new XMLHttpRequest(opts);\n  var self = this;\n\n  try {\n    debug('xhr open %s: %s', this.method, this.uri);\n    xhr.open(this.method, this.uri, this.async);\n    try {\n      if (this.extraHeaders) {\n        xhr.setDisableHeaderCheck && xhr.setDisableHeaderCheck(true);\n        for (var i in this.extraHeaders) {\n          if (this.extraHeaders.hasOwnProperty(i)) {\n            xhr.setRequestHeader(i, this.extraHeaders[i]);\n          }\n        }\n      }\n    } catch (e) {}\n\n    if ('POST' === this.method) {\n      try {\n        if (this.isBinary) {\n          xhr.setRequestHeader('Content-type', 'application/octet-stream');\n        } else {\n          xhr.setRequestHeader('Content-type', 'text/plain;charset=UTF-8');\n        }\n      } catch (e) {}\n    }\n\n    try {\n      xhr.setRequestHeader('Accept', '*/*');\n    } catch (e) {}\n\n    // ie6 check\n    if ('withCredentials' in xhr) {\n      xhr.withCredentials = this.withCredentials;\n    }\n\n    if (this.requestTimeout) {\n      xhr.timeout = this.requestTimeout;\n    }\n\n    if (this.hasXDR()) {\n      xhr.onload = function () {\n        self.onLoad();\n      };\n      xhr.onerror = function () {\n        self.onError(xhr.responseText);\n      };\n    } else {\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState === 2) {\n          try {\n            var contentType = xhr.getResponseHeader('Content-Type');\n            if (self.supportsBinary && contentType === 'application/octet-stream' || contentType === 'application/octet-stream; charset=UTF-8') {\n              xhr.responseType = 'arraybuffer';\n            }\n          } catch (e) {}\n        }\n        if (4 !== xhr.readyState) return;\n        if (200 === xhr.status || 1223 === xhr.status) {\n          self.onLoad();\n        } else {\n          // make sure the `error` event handler that's user-set\n          // does not throw in the same tick and gets caught here\n          setTimeout(function () {\n            self.onError(typeof xhr.status === 'number' ? xhr.status : 0);\n          }, 0);\n        }\n      };\n    }\n\n    debug('xhr data %s', this.data);\n    xhr.send(this.data);\n  } catch (e) {\n    // Need to defer since .create() is called directly fhrom the constructor\n    // and thus the 'error' event can only be only bound *after* this exception\n    // occurs.  Therefore, also, we cannot throw here at all.\n    setTimeout(function () {\n      self.onError(e);\n    }, 0);\n    return;\n  }\n\n  if (typeof document !== 'undefined') {\n    this.index = Request.requestsCount++;\n    Request.requests[this.index] = this;\n  }\n};\n\n/**\n * Called upon successful response.\n *\n * @api private\n */\n\nRequest.prototype.onSuccess = function () {\n  this.emit('success');\n  this.cleanup();\n};\n\n/**\n * Called if we have data.\n *\n * @api private\n */\n\nRequest.prototype.onData = function (data) {\n  this.emit('data', data);\n  this.onSuccess();\n};\n\n/**\n * Called upon error.\n *\n * @api private\n */\n\nRequest.prototype.onError = function (err) {\n  this.emit('error', err);\n  this.cleanup(true);\n};\n\n/**\n * Cleans up house.\n *\n * @api private\n */\n\nRequest.prototype.cleanup = function (fromError) {\n  if ('undefined' === typeof this.xhr || null === this.xhr) {\n    return;\n  }\n  // xmlhttprequest\n  if (this.hasXDR()) {\n    this.xhr.onload = this.xhr.onerror = empty;\n  } else {\n    this.xhr.onreadystatechange = empty;\n  }\n\n  if (fromError) {\n    try {\n      this.xhr.abort();\n    } catch (e) {}\n  }\n\n  if (typeof document !== 'undefined') {\n    delete Request.requests[this.index];\n  }\n\n  this.xhr = null;\n};\n\n/**\n * Called upon load.\n *\n * @api private\n */\n\nRequest.prototype.onLoad = function () {\n  var data;\n  try {\n    var contentType;\n    try {\n      contentType = this.xhr.getResponseHeader('Content-Type');\n    } catch (e) {}\n    if (contentType === 'application/octet-stream' || contentType === 'application/octet-stream; charset=UTF-8') {\n      data = this.xhr.response || this.xhr.responseText;\n    } else {\n      data = this.xhr.responseText;\n    }\n  } catch (e) {\n    this.onError(e);\n  }\n  if (null != data) {\n    this.onData(data);\n  }\n};\n\n/**\n * Check if it has XDomainRequest.\n *\n * @api private\n */\n\nRequest.prototype.hasXDR = function () {\n  return typeof XDomainRequest !== 'undefined' && !this.xs && this.enablesXDR;\n};\n\n/**\n * Aborts the request.\n *\n * @api public\n */\n\nRequest.prototype.abort = function () {\n  this.cleanup();\n};\n\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\n\nRequest.requestsCount = 0;\nRequest.requests = {};\n\nif (typeof document !== 'undefined') {\n  if (typeof attachEvent === 'function') {\n    attachEvent('onunload', unloadHandler);\n  } else if (typeof addEventListener === 'function') {\n    var terminationEvent = 'onpagehide' in globalThis ? 'pagehide' : 'unload';\n    addEventListener(terminationEvent, unloadHandler, false);\n  }\n}\n\nfunction unloadHandler () {\n  for (var i in Request.requests) {\n    if (Request.requests.hasOwnProperty(i)) {\n      Request.requests[i].abort();\n    }\n  }\n}\n","\n/**\n * Gets the keys for an object.\n *\n * @return {Array} keys\n * @api private\n */\n\nmodule.exports = Object.keys || function keys (obj){\n  var arr = [];\n  var has = Object.prototype.hasOwnProperty;\n\n  for (var i in obj) {\n    if (has.call(obj, i)) {\n      arr.push(i);\n    }\n  }\n  return arr;\n};\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","/**\n * An abstraction for slicing an arraybuffer even when\n * ArrayBuffer.prototype.slice is not supported\n *\n * @api public\n */\n\nmodule.exports = function(arraybuffer, start, end) {\n  var bytes = arraybuffer.byteLength;\n  start = start || 0;\n  end = end || bytes;\n\n  if (arraybuffer.slice) { return arraybuffer.slice(start, end); }\n\n  if (start < 0) { start += bytes; }\n  if (end < 0) { end += bytes; }\n  if (end > bytes) { end = bytes; }\n\n  if (start >= bytes || start >= end || bytes === 0) {\n    return new ArrayBuffer(0);\n  }\n\n  var abv = new Uint8Array(arraybuffer);\n  var result = new Uint8Array(end - start);\n  for (var i = start, ii = 0; i < end; i++, ii++) {\n    result[ii] = abv[i];\n  }\n  return result.buffer;\n};\n","module.exports = after\n\nfunction after(count, callback, err_cb) {\n    var bail = false\n    err_cb = err_cb || noop\n    proxy.count = count\n\n    return (count === 0) ? callback() : proxy\n\n    function proxy(err, result) {\n        if (proxy.count <= 0) {\n            throw new Error('after called too many times')\n        }\n        --proxy.count\n\n        // after first error, rest are passed to err_cb\n        if (err) {\n            bail = true\n            callback(err)\n            // future error callbacks will go to error handler\n            callback = err_cb\n        } else if (proxy.count === 0 && !bail) {\n            callback(null, result)\n        }\n    }\n}\n\nfunction noop() {}\n","/*! https://mths.be/utf8js v2.1.2 by @mathias */\n\nvar stringFromCharCode = String.fromCharCode;\n\n// Taken from https://mths.be/punycode\nfunction ucs2decode(string) {\n\tvar output = [];\n\tvar counter = 0;\n\tvar length = string.length;\n\tvar value;\n\tvar extra;\n\twhile (counter < length) {\n\t\tvalue = string.charCodeAt(counter++);\n\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t// high surrogate, and there is a next character\n\t\t\textra = string.charCodeAt(counter++);\n\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t} else {\n\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\toutput.push(value);\n\t\t\t\tcounter--;\n\t\t\t}\n\t\t} else {\n\t\t\toutput.push(value);\n\t\t}\n\t}\n\treturn output;\n}\n\n// Taken from https://mths.be/punycode\nfunction ucs2encode(array) {\n\tvar length = array.length;\n\tvar index = -1;\n\tvar value;\n\tvar output = '';\n\twhile (++index < length) {\n\t\tvalue = array[index];\n\t\tif (value > 0xFFFF) {\n\t\t\tvalue -= 0x10000;\n\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t}\n\t\toutput += stringFromCharCode(value);\n\t}\n\treturn output;\n}\n\nfunction checkScalarValue(codePoint, strict) {\n\tif (codePoint >= 0xD800 && codePoint <= 0xDFFF) {\n\t\tif (strict) {\n\t\t\tthrow Error(\n\t\t\t\t'Lone surrogate U+' + codePoint.toString(16).toUpperCase() +\n\t\t\t\t' is not a scalar value'\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\treturn true;\n}\n/*--------------------------------------------------------------------------*/\n\nfunction createByte(codePoint, shift) {\n\treturn stringFromCharCode(((codePoint >> shift) & 0x3F) | 0x80);\n}\n\nfunction encodeCodePoint(codePoint, strict) {\n\tif ((codePoint & 0xFFFFFF80) == 0) { // 1-byte sequence\n\t\treturn stringFromCharCode(codePoint);\n\t}\n\tvar symbol = '';\n\tif ((codePoint & 0xFFFFF800) == 0) { // 2-byte sequence\n\t\tsymbol = stringFromCharCode(((codePoint >> 6) & 0x1F) | 0xC0);\n\t}\n\telse if ((codePoint & 0xFFFF0000) == 0) { // 3-byte sequence\n\t\tif (!checkScalarValue(codePoint, strict)) {\n\t\t\tcodePoint = 0xFFFD;\n\t\t}\n\t\tsymbol = stringFromCharCode(((codePoint >> 12) & 0x0F) | 0xE0);\n\t\tsymbol += createByte(codePoint, 6);\n\t}\n\telse if ((codePoint & 0xFFE00000) == 0) { // 4-byte sequence\n\t\tsymbol = stringFromCharCode(((codePoint >> 18) & 0x07) | 0xF0);\n\t\tsymbol += createByte(codePoint, 12);\n\t\tsymbol += createByte(codePoint, 6);\n\t}\n\tsymbol += stringFromCharCode((codePoint & 0x3F) | 0x80);\n\treturn symbol;\n}\n\nfunction utf8encode(string, opts) {\n\topts = opts || {};\n\tvar strict = false !== opts.strict;\n\n\tvar codePoints = ucs2decode(string);\n\tvar length = codePoints.length;\n\tvar index = -1;\n\tvar codePoint;\n\tvar byteString = '';\n\twhile (++index < length) {\n\t\tcodePoint = codePoints[index];\n\t\tbyteString += encodeCodePoint(codePoint, strict);\n\t}\n\treturn byteString;\n}\n\n/*--------------------------------------------------------------------------*/\n\nfunction readContinuationByte() {\n\tif (byteIndex >= byteCount) {\n\t\tthrow Error('Invalid byte index');\n\t}\n\n\tvar continuationByte = byteArray[byteIndex] & 0xFF;\n\tbyteIndex++;\n\n\tif ((continuationByte & 0xC0) == 0x80) {\n\t\treturn continuationByte & 0x3F;\n\t}\n\n\t// If we end up here, its not a continuation byte\n\tthrow Error('Invalid continuation byte');\n}\n\nfunction decodeSymbol(strict) {\n\tvar byte1;\n\tvar byte2;\n\tvar byte3;\n\tvar byte4;\n\tvar codePoint;\n\n\tif (byteIndex > byteCount) {\n\t\tthrow Error('Invalid byte index');\n\t}\n\n\tif (byteIndex == byteCount) {\n\t\treturn false;\n\t}\n\n\t// Read first byte\n\tbyte1 = byteArray[byteIndex] & 0xFF;\n\tbyteIndex++;\n\n\t// 1-byte sequence (no continuation bytes)\n\tif ((byte1 & 0x80) == 0) {\n\t\treturn byte1;\n\t}\n\n\t// 2-byte sequence\n\tif ((byte1 & 0xE0) == 0xC0) {\n\t\tbyte2 = readContinuationByte();\n\t\tcodePoint = ((byte1 & 0x1F) << 6) | byte2;\n\t\tif (codePoint >= 0x80) {\n\t\t\treturn codePoint;\n\t\t} else {\n\t\t\tthrow Error('Invalid continuation byte');\n\t\t}\n\t}\n\n\t// 3-byte sequence (may include unpaired surrogates)\n\tif ((byte1 & 0xF0) == 0xE0) {\n\t\tbyte2 = readContinuationByte();\n\t\tbyte3 = readContinuationByte();\n\t\tcodePoint = ((byte1 & 0x0F) << 12) | (byte2 << 6) | byte3;\n\t\tif (codePoint >= 0x0800) {\n\t\t\treturn checkScalarValue(codePoint, strict) ? codePoint : 0xFFFD;\n\t\t} else {\n\t\t\tthrow Error('Invalid continuation byte');\n\t\t}\n\t}\n\n\t// 4-byte sequence\n\tif ((byte1 & 0xF8) == 0xF0) {\n\t\tbyte2 = readContinuationByte();\n\t\tbyte3 = readContinuationByte();\n\t\tbyte4 = readContinuationByte();\n\t\tcodePoint = ((byte1 & 0x07) << 0x12) | (byte2 << 0x0C) |\n\t\t\t(byte3 << 0x06) | byte4;\n\t\tif (codePoint >= 0x010000 && codePoint <= 0x10FFFF) {\n\t\t\treturn codePoint;\n\t\t}\n\t}\n\n\tthrow Error('Invalid UTF-8 detected');\n}\n\nvar byteArray;\nvar byteCount;\nvar byteIndex;\nfunction utf8decode(byteString, opts) {\n\topts = opts || {};\n\tvar strict = false !== opts.strict;\n\n\tbyteArray = ucs2decode(byteString);\n\tbyteCount = byteArray.length;\n\tbyteIndex = 0;\n\tvar codePoints = [];\n\tvar tmp;\n\twhile ((tmp = decodeSymbol(strict)) !== false) {\n\t\tcodePoints.push(tmp);\n\t}\n\treturn ucs2encode(codePoints);\n}\n\nmodule.exports = {\n\tversion: '2.1.2',\n\tencode: utf8encode,\n\tdecode: utf8decode\n};\n","/*\n * base64-arraybuffer\n * https://github.com/niklasvh/base64-arraybuffer\n *\n * Copyright (c) 2012 Niklas von Hertzen\n * Licensed under the MIT license.\n */\n(function(chars){\n  \"use strict\";\n\n  exports.encode = function(arraybuffer) {\n    var bytes = new Uint8Array(arraybuffer),\n    i, len = bytes.length, base64 = \"\";\n\n    for (i = 0; i < len; i+=3) {\n      base64 += chars[bytes[i] >> 2];\n      base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n      base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n      base64 += chars[bytes[i + 2] & 63];\n    }\n\n    if ((len % 3) === 2) {\n      base64 = base64.substring(0, base64.length - 1) + \"=\";\n    } else if (len % 3 === 1) {\n      base64 = base64.substring(0, base64.length - 2) + \"==\";\n    }\n\n    return base64;\n  };\n\n  exports.decode =  function(base64) {\n    var bufferLength = base64.length * 0.75,\n    len = base64.length, i, p = 0,\n    encoded1, encoded2, encoded3, encoded4;\n\n    if (base64[base64.length - 1] === \"=\") {\n      bufferLength--;\n      if (base64[base64.length - 2] === \"=\") {\n        bufferLength--;\n      }\n    }\n\n    var arraybuffer = new ArrayBuffer(bufferLength),\n    bytes = new Uint8Array(arraybuffer);\n\n    for (i = 0; i < len; i+=4) {\n      encoded1 = chars.indexOf(base64[i]);\n      encoded2 = chars.indexOf(base64[i+1]);\n      encoded3 = chars.indexOf(base64[i+2]);\n      encoded4 = chars.indexOf(base64[i+3]);\n\n      bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n      bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n      bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n\n    return arraybuffer;\n  };\n})(\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\");\n","/**\r\n * Create a blob builder even when vendor prefixes exist\r\n */\r\n\r\nvar BlobBuilder = typeof BlobBuilder !== 'undefined' ? BlobBuilder :\r\n  typeof WebKitBlobBuilder !== 'undefined' ? WebKitBlobBuilder :\r\n  typeof MSBlobBuilder !== 'undefined' ? MSBlobBuilder :\r\n  typeof MozBlobBuilder !== 'undefined' ? MozBlobBuilder : \r\n  false;\r\n\r\n/**\r\n * Check if Blob constructor is supported\r\n */\r\n\r\nvar blobSupported = (function() {\r\n  try {\r\n    var a = new Blob(['hi']);\r\n    return a.size === 2;\r\n  } catch(e) {\r\n    return false;\r\n  }\r\n})();\r\n\r\n/**\r\n * Check if Blob constructor supports ArrayBufferViews\r\n * Fails in Safari 6, so we need to map to ArrayBuffers there.\r\n */\r\n\r\nvar blobSupportsArrayBufferView = blobSupported && (function() {\r\n  try {\r\n    var b = new Blob([new Uint8Array([1,2])]);\r\n    return b.size === 2;\r\n  } catch(e) {\r\n    return false;\r\n  }\r\n})();\r\n\r\n/**\r\n * Check if BlobBuilder is supported\r\n */\r\n\r\nvar blobBuilderSupported = BlobBuilder\r\n  && BlobBuilder.prototype.append\r\n  && BlobBuilder.prototype.getBlob;\r\n\r\n/**\r\n * Helper function that maps ArrayBufferViews to ArrayBuffers\r\n * Used by BlobBuilder constructor and old browsers that didn't\r\n * support it in the Blob constructor.\r\n */\r\n\r\nfunction mapArrayBufferViews(ary) {\r\n  return ary.map(function(chunk) {\r\n    if (chunk.buffer instanceof ArrayBuffer) {\r\n      var buf = chunk.buffer;\r\n\r\n      // if this is a subarray, make a copy so we only\r\n      // include the subarray region from the underlying buffer\r\n      if (chunk.byteLength !== buf.byteLength) {\r\n        var copy = new Uint8Array(chunk.byteLength);\r\n        copy.set(new Uint8Array(buf, chunk.byteOffset, chunk.byteLength));\r\n        buf = copy.buffer;\r\n      }\r\n\r\n      return buf;\r\n    }\r\n\r\n    return chunk;\r\n  });\r\n}\r\n\r\nfunction BlobBuilderConstructor(ary, options) {\r\n  options = options || {};\r\n\r\n  var bb = new BlobBuilder();\r\n  mapArrayBufferViews(ary).forEach(function(part) {\r\n    bb.append(part);\r\n  });\r\n\r\n  return (options.type) ? bb.getBlob(options.type) : bb.getBlob();\r\n};\r\n\r\nfunction BlobConstructor(ary, options) {\r\n  return new Blob(mapArrayBufferViews(ary), options || {});\r\n};\r\n\r\nif (typeof Blob !== 'undefined') {\r\n  BlobBuilderConstructor.prototype = Blob.prototype;\r\n  BlobConstructor.prototype = Blob.prototype;\r\n}\r\n\r\nmodule.exports = (function() {\r\n  if (blobSupported) {\r\n    return blobSupportsArrayBufferView ? Blob : BlobConstructor;\r\n  } else if (blobBuilderSupported) {\r\n    return BlobBuilderConstructor;\r\n  } else {\r\n    return undefined;\r\n  }\r\n})();\r\n","/**\n * Module requirements.\n */\n\nvar Polling = require('./polling');\nvar inherit = require('component-inherit');\nvar globalThis = require('../globalThis');\n\n/**\n * Module exports.\n */\n\nmodule.exports = JSONPPolling;\n\n/**\n * Cached regular expressions.\n */\n\nvar rNewline = /\\n/g;\nvar rEscapedNewline = /\\\\n/g;\n\n/**\n * Global JSONP callbacks.\n */\n\nvar callbacks;\n\n/**\n * Noop.\n */\n\nfunction empty () { }\n\n/**\n * JSONP Polling constructor.\n *\n * @param {Object} opts.\n * @api public\n */\n\nfunction JSONPPolling (opts) {\n  Polling.call(this, opts);\n\n  this.query = this.query || {};\n\n  // define global callbacks array if not present\n  // we do this here (lazily) to avoid unneeded global pollution\n  if (!callbacks) {\n    // we need to consider multiple engines in the same page\n    callbacks = globalThis.___eio = (globalThis.___eio || []);\n  }\n\n  // callback identifier\n  this.index = callbacks.length;\n\n  // add callback to jsonp global\n  var self = this;\n  callbacks.push(function (msg) {\n    self.onData(msg);\n  });\n\n  // append to query string\n  this.query.j = this.index;\n\n  // prevent spurious errors from being emitted when the window is unloaded\n  if (typeof addEventListener === 'function') {\n    addEventListener('beforeunload', function () {\n      if (self.script) self.script.onerror = empty;\n    }, false);\n  }\n}\n\n/**\n * Inherits from Polling.\n */\n\ninherit(JSONPPolling, Polling);\n\n/*\n * JSONP only supports binary as base64 encoded strings\n */\n\nJSONPPolling.prototype.supportsBinary = false;\n\n/**\n * Closes the socket.\n *\n * @api private\n */\n\nJSONPPolling.prototype.doClose = function () {\n  if (this.script) {\n    this.script.parentNode.removeChild(this.script);\n    this.script = null;\n  }\n\n  if (this.form) {\n    this.form.parentNode.removeChild(this.form);\n    this.form = null;\n    this.iframe = null;\n  }\n\n  Polling.prototype.doClose.call(this);\n};\n\n/**\n * Starts a poll cycle.\n *\n * @api private\n */\n\nJSONPPolling.prototype.doPoll = function () {\n  var self = this;\n  var script = document.createElement('script');\n\n  if (this.script) {\n    this.script.parentNode.removeChild(this.script);\n    this.script = null;\n  }\n\n  script.async = true;\n  script.src = this.uri();\n  script.onerror = function (e) {\n    self.onError('jsonp poll error', e);\n  };\n\n  var insertAt = document.getElementsByTagName('script')[0];\n  if (insertAt) {\n    insertAt.parentNode.insertBefore(script, insertAt);\n  } else {\n    (document.head || document.body).appendChild(script);\n  }\n  this.script = script;\n\n  var isUAgecko = 'undefined' !== typeof navigator && /gecko/i.test(navigator.userAgent);\n\n  if (isUAgecko) {\n    setTimeout(function () {\n      var iframe = document.createElement('iframe');\n      document.body.appendChild(iframe);\n      document.body.removeChild(iframe);\n    }, 100);\n  }\n};\n\n/**\n * Writes with a hidden iframe.\n *\n * @param {String} data to send\n * @param {Function} called upon flush.\n * @api private\n */\n\nJSONPPolling.prototype.doWrite = function (data, fn) {\n  var self = this;\n\n  if (!this.form) {\n    var form = document.createElement('form');\n    var area = document.createElement('textarea');\n    var id = this.iframeId = 'eio_iframe_' + this.index;\n    var iframe;\n\n    form.className = 'socketio';\n    form.style.position = 'absolute';\n    form.style.top = '-1000px';\n    form.style.left = '-1000px';\n    form.target = id;\n    form.method = 'POST';\n    form.setAttribute('accept-charset', 'utf-8');\n    area.name = 'd';\n    form.appendChild(area);\n    document.body.appendChild(form);\n\n    this.form = form;\n    this.area = area;\n  }\n\n  this.form.action = this.uri();\n\n  function complete () {\n    initIframe();\n    fn();\n  }\n\n  function initIframe () {\n    if (self.iframe) {\n      try {\n        self.form.removeChild(self.iframe);\n      } catch (e) {\n        self.onError('jsonp polling iframe removal error', e);\n      }\n    }\n\n    try {\n      // ie6 dynamic iframes with target=\"\" support (thanks Chris Lambacher)\n      var html = '<iframe src=\"javascript:0\" name=\"' + self.iframeId + '\">';\n      iframe = document.createElement(html);\n    } catch (e) {\n      iframe = document.createElement('iframe');\n      iframe.name = self.iframeId;\n      iframe.src = 'javascript:0';\n    }\n\n    iframe.id = self.iframeId;\n\n    self.form.appendChild(iframe);\n    self.iframe = iframe;\n  }\n\n  initIframe();\n\n  // escape \\n to prevent it from being converted into \\r\\n by some UAs\n  // double escaping is required for escaped new lines because unescaping of new lines can be done safely on server-side\n  data = data.replace(rEscapedNewline, '\\\\\\n');\n  this.area.value = data.replace(rNewline, '\\\\n');\n\n  try {\n    this.form.submit();\n  } catch (e) {}\n\n  if (this.iframe.attachEvent) {\n    this.iframe.onreadystatechange = function () {\n      if (self.iframe.readyState === 'complete') {\n        complete();\n      }\n    };\n  } else {\n    this.iframe.onload = complete;\n  }\n};\n","/**\n * Module dependencies.\n */\n\nvar Transport = require('../transport');\nvar parser = require('engine.io-parser');\nvar parseqs = require('parseqs');\nvar inherit = require('component-inherit');\nvar yeast = require('yeast');\nvar debug = require('debug')('engine.io-client:websocket');\n\nvar BrowserWebSocket, NodeWebSocket;\n\nif (typeof WebSocket !== 'undefined') {\n  BrowserWebSocket = WebSocket;\n} else if (typeof self !== 'undefined') {\n  BrowserWebSocket = self.WebSocket || self.MozWebSocket;\n}\n\nif (typeof window === 'undefined') {\n  try {\n    NodeWebSocket = require('ws');\n  } catch (e) { }\n}\n\n/**\n * Get either the `WebSocket` or `MozWebSocket` globals\n * in the browser or try to resolve WebSocket-compatible\n * interface exposed by `ws` for Node-like environment.\n */\n\nvar WebSocketImpl = BrowserWebSocket || NodeWebSocket;\n\n/**\n * Module exports.\n */\n\nmodule.exports = WS;\n\n/**\n * WebSocket transport constructor.\n *\n * @api {Object} connection options\n * @api public\n */\n\nfunction WS (opts) {\n  var forceBase64 = (opts && opts.forceBase64);\n  if (forceBase64) {\n    this.supportsBinary = false;\n  }\n  this.perMessageDeflate = opts.perMessageDeflate;\n  this.usingBrowserWebSocket = BrowserWebSocket && !opts.forceNode;\n  this.protocols = opts.protocols;\n  if (!this.usingBrowserWebSocket) {\n    WebSocketImpl = NodeWebSocket;\n  }\n  Transport.call(this, opts);\n}\n\n/**\n * Inherits from Transport.\n */\n\ninherit(WS, Transport);\n\n/**\n * Transport name.\n *\n * @api public\n */\n\nWS.prototype.name = 'websocket';\n\n/*\n * WebSockets support binary\n */\n\nWS.prototype.supportsBinary = true;\n\n/**\n * Opens socket.\n *\n * @api private\n */\n\nWS.prototype.doOpen = function () {\n  if (!this.check()) {\n    // let probe timeout\n    return;\n  }\n\n  var uri = this.uri();\n  var protocols = this.protocols;\n\n  var opts = {};\n\n  if (!this.isReactNative) {\n    opts.agent = this.agent;\n    opts.perMessageDeflate = this.perMessageDeflate;\n\n    // SSL options for Node.js client\n    opts.pfx = this.pfx;\n    opts.key = this.key;\n    opts.passphrase = this.passphrase;\n    opts.cert = this.cert;\n    opts.ca = this.ca;\n    opts.ciphers = this.ciphers;\n    opts.rejectUnauthorized = this.rejectUnauthorized;\n  }\n\n  if (this.extraHeaders) {\n    opts.headers = this.extraHeaders;\n  }\n  if (this.localAddress) {\n    opts.localAddress = this.localAddress;\n  }\n\n  try {\n    this.ws =\n      this.usingBrowserWebSocket && !this.isReactNative\n        ? protocols\n          ? new WebSocketImpl(uri, protocols)\n          : new WebSocketImpl(uri)\n        : new WebSocketImpl(uri, protocols, opts);\n  } catch (err) {\n    return this.emit('error', err);\n  }\n\n  if (this.ws.binaryType === undefined) {\n    this.supportsBinary = false;\n  }\n\n  if (this.ws.supports && this.ws.supports.binary) {\n    this.supportsBinary = true;\n    this.ws.binaryType = 'nodebuffer';\n  } else {\n    this.ws.binaryType = 'arraybuffer';\n  }\n\n  this.addEventListeners();\n};\n\n/**\n * Adds event listeners to the socket\n *\n * @api private\n */\n\nWS.prototype.addEventListeners = function () {\n  var self = this;\n\n  this.ws.onopen = function () {\n    self.onOpen();\n  };\n  this.ws.onclose = function () {\n    self.onClose();\n  };\n  this.ws.onmessage = function (ev) {\n    self.onData(ev.data);\n  };\n  this.ws.onerror = function (e) {\n    self.onError('websocket error', e);\n  };\n};\n\n/**\n * Writes data to socket.\n *\n * @param {Array} array of packets.\n * @api private\n */\n\nWS.prototype.write = function (packets) {\n  var self = this;\n  this.writable = false;\n\n  // encodePacket efficient as it uses WS framing\n  // no need for encodePayload\n  var total = packets.length;\n  for (var i = 0, l = total; i < l; i++) {\n    (function (packet) {\n      parser.encodePacket(packet, self.supportsBinary, function (data) {\n        if (!self.usingBrowserWebSocket) {\n          // always create a new object (GH-437)\n          var opts = {};\n          if (packet.options) {\n            opts.compress = packet.options.compress;\n          }\n\n          if (self.perMessageDeflate) {\n            var len = 'string' === typeof data ? Buffer.byteLength(data) : data.length;\n            if (len < self.perMessageDeflate.threshold) {\n              opts.compress = false;\n            }\n          }\n        }\n\n        // Sometimes the websocket has already been closed but the browser didn't\n        // have a chance of informing us about it yet, in that case send will\n        // throw an error\n        try {\n          if (self.usingBrowserWebSocket) {\n            // TypeError is thrown when passing the second argument on Safari\n            self.ws.send(data);\n          } else {\n            self.ws.send(data, opts);\n          }\n        } catch (e) {\n          debug('websocket closed before onclose event');\n        }\n\n        --total || done();\n      });\n    })(packets[i]);\n  }\n\n  function done () {\n    self.emit('flush');\n\n    // fake drain\n    // defer to next tick to allow Socket to clear writeBuffer\n    setTimeout(function () {\n      self.writable = true;\n      self.emit('drain');\n    }, 0);\n  }\n};\n\n/**\n * Called upon close\n *\n * @api private\n */\n\nWS.prototype.onClose = function () {\n  Transport.prototype.onClose.call(this);\n};\n\n/**\n * Closes socket.\n *\n * @api private\n */\n\nWS.prototype.doClose = function () {\n  if (typeof this.ws !== 'undefined') {\n    this.ws.close();\n  }\n};\n\n/**\n * Generates uri for connection.\n *\n * @api private\n */\n\nWS.prototype.uri = function () {\n  var query = this.query || {};\n  var schema = this.secure ? 'wss' : 'ws';\n  var port = '';\n\n  // avoid port if default for schema\n  if (this.port && (('wss' === schema && Number(this.port) !== 443) ||\n    ('ws' === schema && Number(this.port) !== 80))) {\n    port = ':' + this.port;\n  }\n\n  // append timestamp to URI\n  if (this.timestampRequests) {\n    query[this.timestampParam] = yeast();\n  }\n\n  // communicate binary support capabilities\n  if (!this.supportsBinary) {\n    query.b64 = 1;\n  }\n\n  query = parseqs.encode(query);\n\n  // prepend ? to query\n  if (query.length) {\n    query = '?' + query;\n  }\n\n  var ipv6 = this.hostname.indexOf(':') !== -1;\n  return schema + '://' + (ipv6 ? '[' + this.hostname + ']' : this.hostname) + port + this.path + query;\n};\n\n/**\n * Feature detection for WebSocket.\n *\n * @return {Boolean} whether this transport is available.\n * @api public\n */\n\nWS.prototype.check = function () {\n  return !!WebSocketImpl && !('__initialize' in WebSocketImpl && this.name === WS.prototype.name);\n};\n","module.exports = toArray\n\nfunction toArray(list, index) {\n    var array = []\n\n    index = index || 0\n\n    for (var i = index || 0; i < list.length; i++) {\n        array[i - index] = list[i]\n    }\n\n    return array\n}\n","\n/**\n * Expose `Backoff`.\n */\n\nmodule.exports = Backoff;\n\n/**\n * Initialize backoff timer with `opts`.\n *\n * - `min` initial timeout in milliseconds [100]\n * - `max` max timeout [10000]\n * - `jitter` [0]\n * - `factor` [2]\n *\n * @param {Object} opts\n * @api public\n */\n\nfunction Backoff(opts) {\n  opts = opts || {};\n  this.ms = opts.min || 100;\n  this.max = opts.max || 10000;\n  this.factor = opts.factor || 2;\n  this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;\n  this.attempts = 0;\n}\n\n/**\n * Return the backoff duration.\n *\n * @return {Number}\n * @api public\n */\n\nBackoff.prototype.duration = function(){\n  var ms = this.ms * Math.pow(this.factor, this.attempts++);\n  if (this.jitter) {\n    var rand =  Math.random();\n    var deviation = Math.floor(rand * this.jitter * ms);\n    ms = (Math.floor(rand * 10) & 1) == 0  ? ms - deviation : ms + deviation;\n  }\n  return Math.min(ms, this.max) | 0;\n};\n\n/**\n * Reset the number of attempts.\n *\n * @api public\n */\n\nBackoff.prototype.reset = function(){\n  this.attempts = 0;\n};\n\n/**\n * Set the minimum duration\n *\n * @api public\n */\n\nBackoff.prototype.setMin = function(min){\n  this.ms = min;\n};\n\n/**\n * Set the maximum duration\n *\n * @api public\n */\n\nBackoff.prototype.setMax = function(max){\n  this.max = max;\n};\n\n/**\n * Set the jitter\n *\n * @api public\n */\n\nBackoff.prototype.setJitter = function(jitter){\n  this.jitter = jitter;\n};\n\n","import assign from 'object-assign';\n\nimport { store } from './helpers';\n\nexport const MENU_SHOW = 'REACT_CONTEXTMENU_SHOW';\nexport const MENU_HIDE = 'REACT_CONTEXTMENU_HIDE';\n\n\nexport function dispatchGlobalEvent(eventName, opts, target = window) {\n  // Compatibale with IE\n  // @see http://stackoverflow.com/questions/26596123/internet-explorer-9-10-11-event-constructor-doesnt-work\n  let event;\n\n  if (typeof window.CustomEvent === 'function') {\n    event = new window.CustomEvent(eventName, { detail: opts });\n  } else {\n    event = document.createEvent('CustomEvent');\n    event.initCustomEvent(eventName, false, true, opts);\n  }\n\n  if (target) {\n    target.dispatchEvent(event);\n    assign(store, opts);\n  }\n}\n\nexport function showMenu(opts = {}, target) {\n  dispatchGlobalEvent(MENU_SHOW, assign({}, opts, { type: MENU_SHOW }), target);\n}\n\nexport function hideMenu(opts = {}, target) {\n  dispatchGlobalEvent(MENU_HIDE, assign({}, opts, { type: MENU_HIDE }), target);\n}\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.BrowserSpriteSymbol = factory());\n}(this, (function () { 'use strict';\n\nvar SpriteSymbol = function SpriteSymbol(ref) {\n  var id = ref.id;\n  var viewBox = ref.viewBox;\n  var content = ref.content;\n\n  this.id = id;\n  this.viewBox = viewBox;\n  this.content = content;\n};\n\n/**\n * @return {string}\n */\nSpriteSymbol.prototype.stringify = function stringify () {\n  return this.content;\n};\n\n/**\n * @return {string}\n */\nSpriteSymbol.prototype.toString = function toString () {\n  return this.stringify();\n};\n\nSpriteSymbol.prototype.destroy = function destroy () {\n    var this$1 = this;\n\n  ['id', 'viewBox', 'content'].forEach(function (prop) { return delete this$1[prop]; });\n};\n\n/**\n * @param {string} content\n * @return {Element}\n */\nvar parse = function (content) {\n  var hasImportNode = !!document.importNode;\n  var doc = new DOMParser().parseFromString(content, 'image/svg+xml').documentElement;\n\n  /**\n   * Fix for browser which are throwing WrongDocumentError\n   * if you insert an element which is not part of the document\n   * @see http://stackoverflow.com/a/7986519/4624403\n   */\n  if (hasImportNode) {\n    return document.importNode(doc, true);\n  }\n\n  return doc;\n};\n\nvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n\n\n\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar deepmerge = createCommonjsModule(function (module, exports) {\n(function (root, factory) {\n    if (typeof undefined === 'function' && undefined.amd) {\n        undefined(factory);\n    } else {\n        module.exports = factory();\n    }\n}(commonjsGlobal, function () {\n\nfunction isMergeableObject(val) {\n    var nonNullObject = val && typeof val === 'object';\n\n    return nonNullObject\n        && Object.prototype.toString.call(val) !== '[object RegExp]'\n        && Object.prototype.toString.call(val) !== '[object Date]'\n}\n\nfunction emptyTarget(val) {\n    return Array.isArray(val) ? [] : {}\n}\n\nfunction cloneIfNecessary(value, optionsArgument) {\n    var clone = optionsArgument && optionsArgument.clone === true;\n    return (clone && isMergeableObject(value)) ? deepmerge(emptyTarget(value), value, optionsArgument) : value\n}\n\nfunction defaultArrayMerge(target, source, optionsArgument) {\n    var destination = target.slice();\n    source.forEach(function(e, i) {\n        if (typeof destination[i] === 'undefined') {\n            destination[i] = cloneIfNecessary(e, optionsArgument);\n        } else if (isMergeableObject(e)) {\n            destination[i] = deepmerge(target[i], e, optionsArgument);\n        } else if (target.indexOf(e) === -1) {\n            destination.push(cloneIfNecessary(e, optionsArgument));\n        }\n    });\n    return destination\n}\n\nfunction mergeObject(target, source, optionsArgument) {\n    var destination = {};\n    if (isMergeableObject(target)) {\n        Object.keys(target).forEach(function (key) {\n            destination[key] = cloneIfNecessary(target[key], optionsArgument);\n        });\n    }\n    Object.keys(source).forEach(function (key) {\n        if (!isMergeableObject(source[key]) || !target[key]) {\n            destination[key] = cloneIfNecessary(source[key], optionsArgument);\n        } else {\n            destination[key] = deepmerge(target[key], source[key], optionsArgument);\n        }\n    });\n    return destination\n}\n\nfunction deepmerge(target, source, optionsArgument) {\n    var array = Array.isArray(source);\n    var options = optionsArgument || { arrayMerge: defaultArrayMerge };\n    var arrayMerge = options.arrayMerge || defaultArrayMerge;\n\n    if (array) {\n        return Array.isArray(target) ? arrayMerge(target, source, optionsArgument) : cloneIfNecessary(source, optionsArgument)\n    } else {\n        return mergeObject(target, source, optionsArgument)\n    }\n}\n\ndeepmerge.all = function deepmergeAll(array, optionsArgument) {\n    if (!Array.isArray(array) || array.length < 2) {\n        throw new Error('first argument should be an array with at least two elements')\n    }\n\n    // we are sure there are at least 2 values, so it is safe to have no initial value\n    return array.reduce(function(prev, next) {\n        return deepmerge(prev, next, optionsArgument)\n    })\n};\n\nreturn deepmerge\n\n}));\n});\n\nvar namespaces_1 = createCommonjsModule(function (module, exports) {\nvar namespaces = {\n  svg: {\n    name: 'xmlns',\n    uri: 'http://www.w3.org/2000/svg'\n  },\n  xlink: {\n    name: 'xmlns:xlink',\n    uri: 'http://www.w3.org/1999/xlink'\n  }\n};\n\nexports.default = namespaces;\nmodule.exports = exports.default;\n});\n\n/**\n * @param {Object} attrs\n * @return {string}\n */\nvar objectToAttrsString = function (attrs) {\n  return Object.keys(attrs).map(function (attr) {\n    var value = attrs[attr].toString().replace(/\"/g, '&quot;');\n    return (attr + \"=\\\"\" + value + \"\\\"\");\n  }).join(' ');\n};\n\nvar svg = namespaces_1.svg;\nvar xlink = namespaces_1.xlink;\n\nvar defaultAttrs = {};\ndefaultAttrs[svg.name] = svg.uri;\ndefaultAttrs[xlink.name] = xlink.uri;\n\n/**\n * @param {string} [content]\n * @param {Object} [attributes]\n * @return {string}\n */\nvar wrapInSvgString = function (content, attributes) {\n  if ( content === void 0 ) content = '';\n\n  var attrs = deepmerge(defaultAttrs, attributes || {});\n  var attrsRendered = objectToAttrsString(attrs);\n  return (\"<svg \" + attrsRendered + \">\" + content + \"</svg>\");\n};\n\nvar BrowserSpriteSymbol = (function (SpriteSymbol$$1) {\n  function BrowserSpriteSymbol () {\n    SpriteSymbol$$1.apply(this, arguments);\n  }\n\n  if ( SpriteSymbol$$1 ) BrowserSpriteSymbol.__proto__ = SpriteSymbol$$1;\n  BrowserSpriteSymbol.prototype = Object.create( SpriteSymbol$$1 && SpriteSymbol$$1.prototype );\n  BrowserSpriteSymbol.prototype.constructor = BrowserSpriteSymbol;\n\n  var prototypeAccessors = { isMounted: {} };\n\n  prototypeAccessors.isMounted.get = function () {\n    return !!this.node;\n  };\n\n  /**\n   * @param {Element} node\n   * @return {BrowserSpriteSymbol}\n   */\n  BrowserSpriteSymbol.createFromExistingNode = function createFromExistingNode (node) {\n    return new BrowserSpriteSymbol({\n      id: node.getAttribute('id'),\n      viewBox: node.getAttribute('viewBox'),\n      content: node.outerHTML\n    });\n  };\n\n  BrowserSpriteSymbol.prototype.destroy = function destroy () {\n    if (this.isMounted) {\n      this.unmount();\n    }\n    SpriteSymbol$$1.prototype.destroy.call(this);\n  };\n\n  /**\n   * @param {Element|string} target\n   * @return {Element}\n   */\n  BrowserSpriteSymbol.prototype.mount = function mount (target) {\n    if (this.isMounted) {\n      return this.node;\n    }\n\n    var mountTarget = typeof target === 'string' ? document.querySelector(target) : target;\n    var node = this.render();\n    this.node = node;\n\n    mountTarget.appendChild(node);\n\n    return node;\n  };\n\n  /**\n   * @return {Element}\n   */\n  BrowserSpriteSymbol.prototype.render = function render () {\n    var content = this.stringify();\n    return parse(wrapInSvgString(content)).childNodes[0];\n  };\n\n  BrowserSpriteSymbol.prototype.unmount = function unmount () {\n    this.node.parentNode.removeChild(this.node);\n  };\n\n  Object.defineProperties( BrowserSpriteSymbol.prototype, prototypeAccessors );\n\n  return BrowserSpriteSymbol;\n}(SpriteSymbol));\n\nreturn BrowserSpriteSymbol;\n\n})));\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.BrowserSprite = factory());\n}(this, (function () { 'use strict';\n\nvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n\n\n\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar deepmerge = createCommonjsModule(function (module, exports) {\n(function (root, factory) {\n    if (typeof undefined === 'function' && undefined.amd) {\n        undefined(factory);\n    } else {\n        module.exports = factory();\n    }\n}(commonjsGlobal, function () {\n\nfunction isMergeableObject(val) {\n    var nonNullObject = val && typeof val === 'object';\n\n    return nonNullObject\n        && Object.prototype.toString.call(val) !== '[object RegExp]'\n        && Object.prototype.toString.call(val) !== '[object Date]'\n}\n\nfunction emptyTarget(val) {\n    return Array.isArray(val) ? [] : {}\n}\n\nfunction cloneIfNecessary(value, optionsArgument) {\n    var clone = optionsArgument && optionsArgument.clone === true;\n    return (clone && isMergeableObject(value)) ? deepmerge(emptyTarget(value), value, optionsArgument) : value\n}\n\nfunction defaultArrayMerge(target, source, optionsArgument) {\n    var destination = target.slice();\n    source.forEach(function(e, i) {\n        if (typeof destination[i] === 'undefined') {\n            destination[i] = cloneIfNecessary(e, optionsArgument);\n        } else if (isMergeableObject(e)) {\n            destination[i] = deepmerge(target[i], e, optionsArgument);\n        } else if (target.indexOf(e) === -1) {\n            destination.push(cloneIfNecessary(e, optionsArgument));\n        }\n    });\n    return destination\n}\n\nfunction mergeObject(target, source, optionsArgument) {\n    var destination = {};\n    if (isMergeableObject(target)) {\n        Object.keys(target).forEach(function (key) {\n            destination[key] = cloneIfNecessary(target[key], optionsArgument);\n        });\n    }\n    Object.keys(source).forEach(function (key) {\n        if (!isMergeableObject(source[key]) || !target[key]) {\n            destination[key] = cloneIfNecessary(source[key], optionsArgument);\n        } else {\n            destination[key] = deepmerge(target[key], source[key], optionsArgument);\n        }\n    });\n    return destination\n}\n\nfunction deepmerge(target, source, optionsArgument) {\n    var array = Array.isArray(source);\n    var options = optionsArgument || { arrayMerge: defaultArrayMerge };\n    var arrayMerge = options.arrayMerge || defaultArrayMerge;\n\n    if (array) {\n        return Array.isArray(target) ? arrayMerge(target, source, optionsArgument) : cloneIfNecessary(source, optionsArgument)\n    } else {\n        return mergeObject(target, source, optionsArgument)\n    }\n}\n\ndeepmerge.all = function deepmergeAll(array, optionsArgument) {\n    if (!Array.isArray(array) || array.length < 2) {\n        throw new Error('first argument should be an array with at least two elements')\n    }\n\n    // we are sure there are at least 2 values, so it is safe to have no initial value\n    return array.reduce(function(prev, next) {\n        return deepmerge(prev, next, optionsArgument)\n    })\n};\n\nreturn deepmerge\n\n}));\n});\n\n//      \n// An event handler can take an optional event argument\n// and should not return a value\n                                          \n// An array of all currently registered event handlers for a type\n                                            \n// A map of event types and their corresponding event handlers.\n                        \n                                   \n  \n\n/** Mitt: Tiny (~200b) functional event emitter / pubsub.\n *  @name mitt\n *  @returns {Mitt}\n */\nfunction mitt(all                 ) {\n\tall = all || Object.create(null);\n\n\treturn {\n\t\t/**\n\t\t * Register an event handler for the given type.\n\t\t *\n\t\t * @param  {String} type\tType of event to listen for, or `\"*\"` for all events\n\t\t * @param  {Function} handler Function to call in response to given event\n\t\t * @memberOf mitt\n\t\t */\n\t\ton: function on(type        , handler              ) {\n\t\t\t(all[type] || (all[type] = [])).push(handler);\n\t\t},\n\n\t\t/**\n\t\t * Remove an event handler for the given type.\n\t\t *\n\t\t * @param  {String} type\tType of event to unregister `handler` from, or `\"*\"`\n\t\t * @param  {Function} handler Handler function to remove\n\t\t * @memberOf mitt\n\t\t */\n\t\toff: function off(type        , handler              ) {\n\t\t\tif (all[type]) {\n\t\t\t\tall[type].splice(all[type].indexOf(handler) >>> 0, 1);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Invoke all handlers for the given type.\n\t\t * If present, `\"*\"` handlers are invoked after type-matched handlers.\n\t\t *\n\t\t * @param {String} type  The event type to invoke\n\t\t * @param {Any} [evt]  Any value (object is recommended and powerful), passed to each handler\n\t\t * @memberof mitt\n\t\t */\n\t\temit: function emit(type        , evt     ) {\n\t\t\t(all[type] || []).map(function (handler) { handler(evt); });\n\t\t\t(all['*'] || []).map(function (handler) { handler(type, evt); });\n\t\t}\n\t};\n}\n\nvar namespaces_1 = createCommonjsModule(function (module, exports) {\nvar namespaces = {\n  svg: {\n    name: 'xmlns',\n    uri: 'http://www.w3.org/2000/svg'\n  },\n  xlink: {\n    name: 'xmlns:xlink',\n    uri: 'http://www.w3.org/1999/xlink'\n  }\n};\n\nexports.default = namespaces;\nmodule.exports = exports.default;\n});\n\n/**\n * @param {Object} attrs\n * @return {string}\n */\nvar objectToAttrsString = function (attrs) {\n  return Object.keys(attrs).map(function (attr) {\n    var value = attrs[attr].toString().replace(/\"/g, '&quot;');\n    return (attr + \"=\\\"\" + value + \"\\\"\");\n  }).join(' ');\n};\n\nvar svg = namespaces_1.svg;\nvar xlink = namespaces_1.xlink;\n\nvar defaultAttrs = {};\ndefaultAttrs[svg.name] = svg.uri;\ndefaultAttrs[xlink.name] = xlink.uri;\n\n/**\n * @param {string} [content]\n * @param {Object} [attributes]\n * @return {string}\n */\nvar wrapInSvgString = function (content, attributes) {\n  if ( content === void 0 ) content = '';\n\n  var attrs = deepmerge(defaultAttrs, attributes || {});\n  var attrsRendered = objectToAttrsString(attrs);\n  return (\"<svg \" + attrsRendered + \">\" + content + \"</svg>\");\n};\n\nvar svg$1 = namespaces_1.svg;\nvar xlink$1 = namespaces_1.xlink;\n\nvar defaultConfig = {\n  attrs: ( obj = {\n    style: ['position: absolute', 'width: 0', 'height: 0'].join('; '),\n    'aria-hidden': 'true'\n  }, obj[svg$1.name] = svg$1.uri, obj[xlink$1.name] = xlink$1.uri, obj )\n};\nvar obj;\n\nvar Sprite = function Sprite(config) {\n  this.config = deepmerge(defaultConfig, config || {});\n  this.symbols = [];\n};\n\n/**\n * Add new symbol. If symbol with the same id exists it will be replaced.\n * @param {SpriteSymbol} symbol\n * @return {boolean} `true` - symbol was added, `false` - replaced\n */\nSprite.prototype.add = function add (symbol) {\n  var ref = this;\n    var symbols = ref.symbols;\n  var existing = this.find(symbol.id);\n\n  if (existing) {\n    symbols[symbols.indexOf(existing)] = symbol;\n    return false;\n  }\n\n  symbols.push(symbol);\n  return true;\n};\n\n/**\n * Remove symbol & destroy it\n * @param {string} id\n * @return {boolean} `true` - symbol was found & successfully destroyed, `false` - otherwise\n */\nSprite.prototype.remove = function remove (id) {\n  var ref = this;\n    var symbols = ref.symbols;\n  var symbol = this.find(id);\n\n  if (symbol) {\n    symbols.splice(symbols.indexOf(symbol), 1);\n    symbol.destroy();\n    return true;\n  }\n\n  return false;\n};\n\n/**\n * @param {string} id\n * @return {SpriteSymbol|null}\n */\nSprite.prototype.find = function find (id) {\n  return this.symbols.filter(function (s) { return s.id === id; })[0] || null;\n};\n\n/**\n * @param {string} id\n * @return {boolean}\n */\nSprite.prototype.has = function has (id) {\n  return this.find(id) !== null;\n};\n\n/**\n * @return {string}\n */\nSprite.prototype.stringify = function stringify () {\n  var ref = this.config;\n    var attrs = ref.attrs;\n  var stringifiedSymbols = this.symbols.map(function (s) { return s.stringify(); }).join('');\n  return wrapInSvgString(stringifiedSymbols, attrs);\n};\n\n/**\n * @return {string}\n */\nSprite.prototype.toString = function toString () {\n  return this.stringify();\n};\n\nSprite.prototype.destroy = function destroy () {\n  this.symbols.forEach(function (s) { return s.destroy(); });\n};\n\nvar SpriteSymbol = function SpriteSymbol(ref) {\n  var id = ref.id;\n  var viewBox = ref.viewBox;\n  var content = ref.content;\n\n  this.id = id;\n  this.viewBox = viewBox;\n  this.content = content;\n};\n\n/**\n * @return {string}\n */\nSpriteSymbol.prototype.stringify = function stringify () {\n  return this.content;\n};\n\n/**\n * @return {string}\n */\nSpriteSymbol.prototype.toString = function toString () {\n  return this.stringify();\n};\n\nSpriteSymbol.prototype.destroy = function destroy () {\n    var this$1 = this;\n\n  ['id', 'viewBox', 'content'].forEach(function (prop) { return delete this$1[prop]; });\n};\n\n/**\n * @param {string} content\n * @return {Element}\n */\nvar parse = function (content) {\n  var hasImportNode = !!document.importNode;\n  var doc = new DOMParser().parseFromString(content, 'image/svg+xml').documentElement;\n\n  /**\n   * Fix for browser which are throwing WrongDocumentError\n   * if you insert an element which is not part of the document\n   * @see http://stackoverflow.com/a/7986519/4624403\n   */\n  if (hasImportNode) {\n    return document.importNode(doc, true);\n  }\n\n  return doc;\n};\n\nvar BrowserSpriteSymbol = (function (SpriteSymbol$$1) {\n  function BrowserSpriteSymbol () {\n    SpriteSymbol$$1.apply(this, arguments);\n  }\n\n  if ( SpriteSymbol$$1 ) BrowserSpriteSymbol.__proto__ = SpriteSymbol$$1;\n  BrowserSpriteSymbol.prototype = Object.create( SpriteSymbol$$1 && SpriteSymbol$$1.prototype );\n  BrowserSpriteSymbol.prototype.constructor = BrowserSpriteSymbol;\n\n  var prototypeAccessors = { isMounted: {} };\n\n  prototypeAccessors.isMounted.get = function () {\n    return !!this.node;\n  };\n\n  /**\n   * @param {Element} node\n   * @return {BrowserSpriteSymbol}\n   */\n  BrowserSpriteSymbol.createFromExistingNode = function createFromExistingNode (node) {\n    return new BrowserSpriteSymbol({\n      id: node.getAttribute('id'),\n      viewBox: node.getAttribute('viewBox'),\n      content: node.outerHTML\n    });\n  };\n\n  BrowserSpriteSymbol.prototype.destroy = function destroy () {\n    if (this.isMounted) {\n      this.unmount();\n    }\n    SpriteSymbol$$1.prototype.destroy.call(this);\n  };\n\n  /**\n   * @param {Element|string} target\n   * @return {Element}\n   */\n  BrowserSpriteSymbol.prototype.mount = function mount (target) {\n    if (this.isMounted) {\n      return this.node;\n    }\n\n    var mountTarget = typeof target === 'string' ? document.querySelector(target) : target;\n    var node = this.render();\n    this.node = node;\n\n    mountTarget.appendChild(node);\n\n    return node;\n  };\n\n  /**\n   * @return {Element}\n   */\n  BrowserSpriteSymbol.prototype.render = function render () {\n    var content = this.stringify();\n    return parse(wrapInSvgString(content)).childNodes[0];\n  };\n\n  BrowserSpriteSymbol.prototype.unmount = function unmount () {\n    this.node.parentNode.removeChild(this.node);\n  };\n\n  Object.defineProperties( BrowserSpriteSymbol.prototype, prototypeAccessors );\n\n  return BrowserSpriteSymbol;\n}(SpriteSymbol));\n\nvar defaultConfig$1 = {\n  /**\n   * Should following options be automatically configured:\n   * - `syncUrlsWithBaseTag`\n   * - `locationChangeAngularEmitter`\n   * - `moveGradientsOutsideSymbol`\n   * @type {boolean}\n   */\n  autoConfigure: true,\n\n  /**\n   * Default mounting selector\n   * @type {string}\n   */\n  mountTo: 'body',\n\n  /**\n   * Fix disappearing SVG elements when <base href> exists.\n   * Executes when sprite mounted.\n   * @see http://stackoverflow.com/a/18265336/796152\n   * @see https://github.com/everdimension/angular-svg-base-fix\n   * @see https://github.com/angular/angular.js/issues/8934#issuecomment-56568466\n   * @type {boolean}\n   */\n  syncUrlsWithBaseTag: false,\n\n  /**\n   * Should sprite listen custom location change event\n   * @type {boolean}\n   */\n  listenLocationChangeEvent: true,\n\n  /**\n   * Custom window event name which should be emitted to update sprite urls\n   * @type {string}\n   */\n  locationChangeEvent: 'locationChange',\n\n  /**\n   * Emit location change event in Angular automatically\n   * @type {boolean}\n   */\n  locationChangeAngularEmitter: false,\n\n  /**\n   * Selector to find symbols usages when updating sprite urls\n   * @type {string}\n   */\n  usagesToUpdate: 'use[*|href]',\n\n  /**\n   * Fix Firefox bug when gradients and patterns don't work if they are within a symbol.\n   * Executes when sprite is rendered, but not mounted.\n   * @see https://bugzilla.mozilla.org/show_bug.cgi?id=306674\n   * @see https://bugzilla.mozilla.org/show_bug.cgi?id=353575\n   * @see https://bugzilla.mozilla.org/show_bug.cgi?id=1235364\n   * @type {boolean}\n   */\n  moveGradientsOutsideSymbol: false\n};\n\n/**\n * @param {*} arrayLike\n * @return {Array}\n */\nvar arrayFrom = function (arrayLike) {\n  return Array.prototype.slice.call(arrayLike, 0);\n};\n\nvar browser = {\n  isChrome: function () { return /chrome/i.test(navigator.userAgent); },\n  isFirefox: function () { return /firefox/i.test(navigator.userAgent); },\n\n  // https://msdn.microsoft.com/en-us/library/ms537503(v=vs.85).aspx\n  isIE: function () { return /msie/i.test(navigator.userAgent) || /trident/i.test(navigator.userAgent); },\n  isEdge: function () { return /edge/i.test(navigator.userAgent); }\n};\n\n/**\n * @param {string} name\n * @param {*} data\n */\nvar dispatchEvent = function (name, data) {\n  var event = document.createEvent('CustomEvent');\n  event.initCustomEvent(name, false, false, data);\n  window.dispatchEvent(event);\n};\n\n/**\n * IE doesn't evaluate <style> tags in SVGs that are dynamically added to the page.\n * This trick will trigger IE to read and use any existing SVG <style> tags.\n * @see https://github.com/iconic/SVGInjector/issues/23\n * @see https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/10898469/\n *\n * @param {Element} node DOM Element to search <style> tags in\n * @return {Array<HTMLStyleElement>}\n */\nvar evalStylesIEWorkaround = function (node) {\n  var updatedNodes = [];\n\n  arrayFrom(node.querySelectorAll('style'))\n    .forEach(function (style) {\n      style.textContent += '';\n      updatedNodes.push(style);\n    });\n\n  return updatedNodes;\n};\n\n/**\n * @param {string} [url] If not provided - current URL will be used\n * @return {string}\n */\nvar getUrlWithoutFragment = function (url) {\n  return (url || window.location.href).split('#')[0];\n};\n\n/* global angular */\n/**\n * @param {string} eventName\n */\nvar locationChangeAngularEmitter = function (eventName) {\n  angular.module('ng').run(['$rootScope', function ($rootScope) {\n    $rootScope.$on('$locationChangeSuccess', function (e, newUrl, oldUrl) {\n      dispatchEvent(eventName, { oldUrl: oldUrl, newUrl: newUrl });\n    });\n  }]);\n};\n\nvar defaultSelector = 'linearGradient, radialGradient, pattern, mask, clipPath';\n\n/**\n * @param {Element} svg\n * @param {string} [selector]\n * @return {Element}\n */\nvar moveGradientsOutsideSymbol = function (svg, selector) {\n  if ( selector === void 0 ) selector = defaultSelector;\n\n  arrayFrom(svg.querySelectorAll('symbol')).forEach(function (symbol) {\n    arrayFrom(symbol.querySelectorAll(selector)).forEach(function (node) {\n      symbol.parentNode.insertBefore(node, symbol);\n    });\n  });\n  return svg;\n};\n\n/**\n * @param {NodeList} nodes\n * @param {Function} [matcher]\n * @return {Attr[]}\n */\nfunction selectAttributes(nodes, matcher) {\n  var attrs = arrayFrom(nodes).reduce(function (acc, node) {\n    if (!node.attributes) {\n      return acc;\n    }\n\n    var arrayfied = arrayFrom(node.attributes);\n    var matched = matcher ? arrayfied.filter(matcher) : arrayfied;\n    return acc.concat(matched);\n  }, []);\n\n  return attrs;\n}\n\n/**\n * @param {NodeList|Node} nodes\n * @param {boolean} [clone=true]\n * @return {string}\n */\n\nvar xLinkNS = namespaces_1.xlink.uri;\nvar xLinkAttrName = 'xlink:href';\n\n// eslint-disable-next-line no-useless-escape\nvar specialUrlCharsPattern = /[{}|\\\\\\^\\[\\]`\"<>]/g;\n\nfunction encoder(url) {\n  return url.replace(specialUrlCharsPattern, function (match) {\n    return (\"%\" + (match[0].charCodeAt(0).toString(16).toUpperCase()));\n  });\n}\n\nfunction escapeRegExp(str) {\n  return str.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\"); // $& means the whole matched string\n}\n\n/**\n * @param {NodeList} nodes\n * @param {string} startsWith\n * @param {string} replaceWith\n * @return {NodeList}\n */\nfunction updateReferences(nodes, startsWith, replaceWith) {\n  arrayFrom(nodes).forEach(function (node) {\n    var href = node.getAttribute(xLinkAttrName);\n    if (href && href.indexOf(startsWith) === 0) {\n      var newUrl = href.replace(startsWith, replaceWith);\n      node.setAttributeNS(xLinkNS, xLinkAttrName, newUrl);\n    }\n  });\n\n  return nodes;\n}\n\n/**\n * List of SVG attributes to update url() target in them\n */\nvar attList = [\n  'clipPath',\n  'colorProfile',\n  'src',\n  'cursor',\n  'fill',\n  'filter',\n  'marker',\n  'markerStart',\n  'markerMid',\n  'markerEnd',\n  'mask',\n  'stroke',\n  'style'\n];\n\nvar attSelector = attList.map(function (attr) { return (\"[\" + attr + \"]\"); }).join(',');\n\n/**\n * Update URLs in svg image (like `fill=\"url(...)\"`) and update referencing elements\n * @param {Element} svg\n * @param {NodeList} references\n * @param {string|RegExp} startsWith\n * @param {string} replaceWith\n * @return {void}\n *\n * @example\n * const sprite = document.querySelector('svg.sprite');\n * const usages = document.querySelectorAll('use');\n * updateUrls(sprite, usages, '#', 'prefix#');\n */\nvar updateUrls = function (svg, references, startsWith, replaceWith) {\n  var startsWithEncoded = encoder(startsWith);\n  var replaceWithEncoded = encoder(replaceWith);\n\n  var nodes = svg.querySelectorAll(attSelector);\n  var attrs = selectAttributes(nodes, function (ref) {\n    var localName = ref.localName;\n    var value = ref.value;\n\n    return attList.indexOf(localName) !== -1 && value.indexOf((\"url(\" + startsWithEncoded)) !== -1;\n  });\n\n  attrs.forEach(function (attr) { return attr.value = attr.value.replace(new RegExp(escapeRegExp(startsWithEncoded), 'g'), replaceWithEncoded); });\n  updateReferences(references, startsWithEncoded, replaceWithEncoded);\n};\n\n/**\n * Internal emitter events\n * @enum\n * @private\n */\nvar Events = {\n  MOUNT: 'mount',\n  SYMBOL_MOUNT: 'symbol_mount'\n};\n\nvar BrowserSprite = (function (Sprite$$1) {\n  function BrowserSprite(cfg) {\n    var this$1 = this;\n    if ( cfg === void 0 ) cfg = {};\n\n    Sprite$$1.call(this, deepmerge(defaultConfig$1, cfg));\n\n    var emitter = mitt();\n    this._emitter = emitter;\n    this.node = null;\n\n    var ref = this;\n    var config = ref.config;\n\n    if (config.autoConfigure) {\n      this._autoConfigure(cfg);\n    }\n\n    if (config.syncUrlsWithBaseTag) {\n      var baseUrl = document.getElementsByTagName('base')[0].getAttribute('href');\n      emitter.on(Events.MOUNT, function () { return this$1.updateUrls('#', baseUrl); });\n    }\n\n    var handleLocationChange = this._handleLocationChange.bind(this);\n    this._handleLocationChange = handleLocationChange;\n\n    // Provide way to update sprite urls externally via dispatching custom window event\n    if (config.listenLocationChangeEvent) {\n      window.addEventListener(config.locationChangeEvent, handleLocationChange);\n    }\n\n    // Emit location change event in Angular automatically\n    if (config.locationChangeAngularEmitter) {\n      locationChangeAngularEmitter(config.locationChangeEvent);\n    }\n\n    // After sprite mounted\n    emitter.on(Events.MOUNT, function (spriteNode) {\n      if (config.moveGradientsOutsideSymbol) {\n        moveGradientsOutsideSymbol(spriteNode);\n      }\n    });\n\n    // After symbol mounted into sprite\n    emitter.on(Events.SYMBOL_MOUNT, function (symbolNode) {\n      if (config.moveGradientsOutsideSymbol) {\n        moveGradientsOutsideSymbol(symbolNode.parentNode);\n      }\n\n      if (browser.isIE() || browser.isEdge()) {\n        evalStylesIEWorkaround(symbolNode);\n      }\n    });\n  }\n\n  if ( Sprite$$1 ) BrowserSprite.__proto__ = Sprite$$1;\n  BrowserSprite.prototype = Object.create( Sprite$$1 && Sprite$$1.prototype );\n  BrowserSprite.prototype.constructor = BrowserSprite;\n\n  var prototypeAccessors = { isMounted: {} };\n\n  /**\n   * @return {boolean}\n   */\n  prototypeAccessors.isMounted.get = function () {\n    return !!this.node;\n  };\n\n  /**\n   * Automatically configure following options\n   * - `syncUrlsWithBaseTag`\n   * - `locationChangeAngularEmitter`\n   * - `moveGradientsOutsideSymbol`\n   * @param {Object} cfg\n   * @private\n   */\n  BrowserSprite.prototype._autoConfigure = function _autoConfigure (cfg) {\n    var ref = this;\n    var config = ref.config;\n\n    if (typeof cfg.syncUrlsWithBaseTag === 'undefined') {\n      config.syncUrlsWithBaseTag = typeof document.getElementsByTagName('base')[0] !== 'undefined';\n    }\n\n    if (typeof cfg.locationChangeAngularEmitter === 'undefined') {\n        config.locationChangeAngularEmitter = typeof window.angular !== 'undefined';\n    }\n\n    if (typeof cfg.moveGradientsOutsideSymbol === 'undefined') {\n      config.moveGradientsOutsideSymbol = browser.isFirefox();\n    }\n  };\n\n  /**\n   * @param {Event} event\n   * @param {Object} event.detail\n   * @param {string} event.detail.oldUrl\n   * @param {string} event.detail.newUrl\n   * @private\n   */\n  BrowserSprite.prototype._handleLocationChange = function _handleLocationChange (event) {\n    var ref = event.detail;\n    var oldUrl = ref.oldUrl;\n    var newUrl = ref.newUrl;\n    this.updateUrls(oldUrl, newUrl);\n  };\n\n  /**\n   * Add new symbol. If symbol with the same id exists it will be replaced.\n   * If sprite already mounted - `symbol.mount(sprite.node)` will be called.\n   * @fires Events#SYMBOL_MOUNT\n   * @param {BrowserSpriteSymbol} symbol\n   * @return {boolean} `true` - symbol was added, `false` - replaced\n   */\n  BrowserSprite.prototype.add = function add (symbol) {\n    var sprite = this;\n    var isNewSymbol = Sprite$$1.prototype.add.call(this, symbol);\n\n    if (this.isMounted && isNewSymbol) {\n      symbol.mount(sprite.node);\n      this._emitter.emit(Events.SYMBOL_MOUNT, symbol.node);\n    }\n\n    return isNewSymbol;\n  };\n\n  /**\n   * Attach to existing DOM node\n   * @param {string|Element} target\n   * @return {Element|null} attached DOM Element. null if node to attach not found.\n   */\n  BrowserSprite.prototype.attach = function attach (target) {\n    var this$1 = this;\n\n    var sprite = this;\n\n    if (sprite.isMounted) {\n      return sprite.node;\n    }\n\n    /** @type Element */\n    var node = typeof target === 'string' ? document.querySelector(target) : target;\n    sprite.node = node;\n\n    // Already added symbols needs to be mounted\n    this.symbols.forEach(function (symbol) {\n      symbol.mount(sprite.node);\n      this$1._emitter.emit(Events.SYMBOL_MOUNT, symbol.node);\n    });\n\n    // Create symbols from existing DOM nodes, add and mount them\n    arrayFrom(node.querySelectorAll('symbol'))\n      .forEach(function (symbolNode) {\n        var symbol = BrowserSpriteSymbol.createFromExistingNode(symbolNode);\n        symbol.node = symbolNode; // hack to prevent symbol mounting to sprite when adding\n        sprite.add(symbol);\n      });\n\n    this._emitter.emit(Events.MOUNT, node);\n\n    return node;\n  };\n\n  BrowserSprite.prototype.destroy = function destroy () {\n    var ref = this;\n    var config = ref.config;\n    var symbols = ref.symbols;\n    var _emitter = ref._emitter;\n\n    symbols.forEach(function (s) { return s.destroy(); });\n\n    _emitter.off('*');\n    window.removeEventListener(config.locationChangeEvent, this._handleLocationChange);\n\n    if (this.isMounted) {\n      this.unmount();\n    }\n  };\n\n  /**\n   * @fires Events#MOUNT\n   * @param {string|Element} [target]\n   * @param {boolean} [prepend=false]\n   * @return {Element|null} rendered sprite node. null if mount node not found.\n   */\n  BrowserSprite.prototype.mount = function mount (target, prepend) {\n    if ( target === void 0 ) target = this.config.mountTo;\n    if ( prepend === void 0 ) prepend = false;\n\n    var sprite = this;\n\n    if (sprite.isMounted) {\n      return sprite.node;\n    }\n\n    var mountNode = typeof target === 'string' ? document.querySelector(target) : target;\n    var node = sprite.render();\n    this.node = node;\n\n    if (prepend && mountNode.childNodes[0]) {\n      mountNode.insertBefore(node, mountNode.childNodes[0]);\n    } else {\n      mountNode.appendChild(node);\n    }\n\n    this._emitter.emit(Events.MOUNT, node);\n\n    return node;\n  };\n\n  /**\n   * @return {Element}\n   */\n  BrowserSprite.prototype.render = function render () {\n    return parse(this.stringify());\n  };\n\n  /**\n   * Detach sprite from the DOM\n   */\n  BrowserSprite.prototype.unmount = function unmount () {\n    this.node.parentNode.removeChild(this.node);\n  };\n\n  /**\n   * Update URLs in sprite and usage elements\n   * @param {string} oldUrl\n   * @param {string} newUrl\n   * @return {boolean} `true` - URLs was updated, `false` - sprite is not mounted\n   */\n  BrowserSprite.prototype.updateUrls = function updateUrls$1 (oldUrl, newUrl) {\n    if (!this.isMounted) {\n      return false;\n    }\n\n    var usages = document.querySelectorAll(this.config.usagesToUpdate);\n\n    updateUrls(\n      this.node,\n      usages,\n      ((getUrlWithoutFragment(oldUrl)) + \"#\"),\n      ((getUrlWithoutFragment(newUrl)) + \"#\")\n    );\n\n    return true;\n  };\n\n  Object.defineProperties( BrowserSprite.prototype, prototypeAccessors );\n\n  return BrowserSprite;\n}(Sprite));\n\nvar ready$1 = createCommonjsModule(function (module) {\n/*!\n  * domready (c) Dustin Diaz 2014 - License MIT\n  */\n!function (name, definition) {\n\n  { module.exports = definition(); }\n\n}('domready', function () {\n\n  var fns = [], listener\n    , doc = document\n    , hack = doc.documentElement.doScroll\n    , domContentLoaded = 'DOMContentLoaded'\n    , loaded = (hack ? /^loaded|^c/ : /^loaded|^i|^c/).test(doc.readyState);\n\n\n  if (!loaded)\n  { doc.addEventListener(domContentLoaded, listener = function () {\n    doc.removeEventListener(domContentLoaded, listener);\n    loaded = 1;\n    while (listener = fns.shift()) { listener(); }\n  }); }\n\n  return function (fn) {\n    loaded ? setTimeout(fn, 0) : fns.push(fn);\n  }\n\n});\n});\n\nvar spriteNodeId = '__SVG_SPRITE_NODE__';\nvar spriteGlobalVarName = '__SVG_SPRITE__';\nvar isSpriteExists = !!window[spriteGlobalVarName];\n\n// eslint-disable-next-line import/no-mutable-exports\nvar sprite;\n\nif (isSpriteExists) {\n  sprite = window[spriteGlobalVarName];\n} else {\n  sprite = new BrowserSprite({\n    attrs: {\n      id: spriteNodeId,\n      'aria-hidden': 'true'\n    }\n  });\n  window[spriteGlobalVarName] = sprite;\n}\n\nvar loadSprite = function () {\n  /**\n   * Check for page already contains sprite node\n   * If found - attach to and reuse it's content\n   * If not - render and mount the new sprite\n   */\n  var existing = document.getElementById(spriteNodeId);\n\n  if (existing) {\n    sprite.attach(existing);\n  } else {\n    sprite.mount(document.body, true);\n  }\n};\n\nif (document.body) {\n  loadSprite();\n} else {\n  ready$1(loadSprite);\n}\n\nvar sprite$1 = sprite;\n\nreturn sprite$1;\n\n})));\n"],"sourceRoot":""}