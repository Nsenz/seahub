(this["webpackJsonpseahub-frontend"]=this["webpackJsonpseahub-frontend"]||[]).push([[38],{1901:function(e,t,a){a(74),e.exports=a(1938)},1938:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(36),i=a.n(s),o=a(33),c=a(367),u=a(4),l=a(21),d=a(3),h=a(5),g=a(6),b=a(7),p=a(135),S=a(8),f=a(10),m=a(445),v=a(99),D=a(0),k=function(e){Object(g.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).onInternalLinkToggle=function(){n.setState({isShowInternalLinkDialog:!n.state.isShowInternalLinkDialog})},n.unmark=function(){var e=n.props,t=e.repoID,a=e.docPath;S.a.sdocUnmarkAsDraft(t,a).then((function(e){n.props.unmarkDraft()})).catch((function(e){var t=u.a.getErrorMsg(e);f.a.danger(t)}))},n.toggleStar=function(){var e=n.props,t=e.isStarred,a=e.repoID,r=e.docPath;t?S.a.unstarItem(a,r).then((function(e){n.props.toggleStar(!1)})).catch((function(e){var t=u.a.getErrorMsg(e);f.a.danger(t)})):S.a.starItem(a,r).then((function(e){n.props.toggleStar(!0)})).catch((function(e){var t=u.a.getErrorMsg(e);f.a.danger(t)}))},n.onShareToggle=function(){n.setState({isShowShareDialog:!n.state.isShowShareDialog})},n.state={isShowInternalLinkDialog:!1,isShowShareDialog:!1},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=p.c.getInstance();this.unsubscribeInternalLinkEvent=e.subscribe(p.b.INTERNAL_LINK_CLICK,this.onInternalLinkToggle),this.unsubscribeStar=e.subscribe(p.b.TOGGLE_STAR,this.toggleStar),this.unsubscribeUnmark=e.subscribe(p.b.UNMARK_AS_DRAFT,this.unmark),this.unsubscribeShare=e.subscribe(p.b.SHARE_SDOC,this.onShareToggle)}},{key:"componentWillUnmount",value:function(){this.unsubscribeInternalLinkEvent(),this.unsubscribeStar(),this.unsubscribeUnmark(),this.unsubscribeShare()}},{key:"render",value:function(){var e=this.props,t=e.repoID,a=e.docPath,n=e.docName,r=e.docPerm,s=this.state,i=s.isShowInternalLinkDialog,o=s.isShowShareDialog;return Object(D.jsxs)(D.Fragment,{children:[i&&Object(D.jsx)(m.a,{repoID:t,path:a,onInternalLinkDialogToggle:this.onInternalLinkToggle}),o&&Object(D.jsx)(v.a,{itemType:"file",itemPath:a,itemName:n,repoID:t,userPerm:r,toggleDialog:this.onShareToggle})]})}}]),a}(r.a.Component),j=function(e){Object(g.a)(a,e);var t=Object(b.a)(a);function a(e){var n;Object(d.a)(this,a),(n=t.call(this,e)).toggleStar=function(e){n.setState({isStarred:e})},n.unmarkDraft=function(){n.setState({isDraft:!1})};var r=window.app.pageOptions,s=r.isStarred,i=r.isSdocDraft;return n.state={isStarred:s,isDraft:i},n}return Object(h.a)(a,[{key:"render",value:function(){var e=window.seafile,t=e.repoID,a=e.docPath,r=e.docName,s=e.docPerm,i=this.state,o=i.isStarred,c=i.isDraft;return Object(D.jsxs)(n.Fragment,{children:[Object(D.jsx)(p.e,{isStarred:o,isDraft:c}),Object(D.jsx)(k,{repoID:t,docPath:a,docName:r,docPerm:s,isStarred:o,toggleStar:this.toggleStar,unmarkDraft:this.unmarkDraft})]})}}]),a}(r.a.Component),w=window.app.config,I=w.serviceURL,O=w.avatarURL,L=w.siteRoot,R=w.lang,U=window.app.userInfo,P=U.username,T=U.name,N=window.app.pageOptions,x=N.repoID,A=N.repoName,y=N.parentDir,E=N.filePerm,C=N.docPath,F=N.docName,M=N.docUuid,_=N.seadocAccessToken,K=N.seadocServerUrl,G=N.assetsUrl,H=N.isSdocRevision,J=N.isPublished,z=N.originFilename,B=N.revisionCreatedAt;window.seafile={repoID:x,docPath:C,docName:F,docUuid:M,isOpenSocket:!0,serviceUrl:I,accessToken:_,sdocServer:K,name:T,username:P,avatarURL:O,siteRoot:L,docPerm:E,historyURL:u.a.generateHistoryURL(L,x,C),parentFolderURL:"".concat(L,"library/").concat(x,"/").concat(u.a.encodePath(A+y)),assetsUrl:G,isShowInternalLink:!0,isStarIconShown:!0,isSdocRevision:H,isPublished:J,revisionURL:u.a.generateRevisionURL(L,x,C),originFilename:z,revisionCreatedAt:B,lang:R},i.a.render(Object(D.jsx)(o.a,{i18n:c.a,children:Object(D.jsx)(n.Suspense,{fallback:Object(D.jsx)(l.a,{}),children:Object(D.jsx)(j,{})})}),document.getElementById("wrapper"))},367:function(e,t,a){"use strict";var n=a(213),r=a(286),s=a(287),i=a(33),o=a(2),c=window.app.pageOptions.lang;n.a.use(r.a).use(s.a).use(i.b).init({lng:c,fallbackLng:"en",ns:["sdoc-editor"],defaultNS:"sdoc-editor",whitelist:["en","zh-CN","fr","de","cs","es","es-AR","es-MX","ru"],backend:{loadPath:o.Sb+"sdoc-editor/locales/{{ lng }}/{{ ns }}.json"},debug:!1,interpolation:{escapeValue:!1},load:"currentOnly",react:{wait:!0}}),t.a=n.a}},[[1901,1,0]]]);
//# sourceMappingURL=viewFileSdoc.chunk.js.map